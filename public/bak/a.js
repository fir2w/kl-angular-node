/*
 wysihtml5x v@VERSION
 https://github.com/Edicy/wysihtml5

 Author: Christopher Blum (https://github.com/tiff)
 Secondary author of extended features: Oliver Pulges (https://github.com/pulges)

 Copyright (C) 2012 XING AG
 Licensed under the MIT license (MIT)

 MIT
 @fileOverview Favico animations
 @author Miroslav Magda, http://blog.ejci.net
 @version 0.3.4
 */
(function (d, a) {
  function f(a) {
    var b = a.length, e = q.type(a);
    return q.isWindow(a) ? !1 : 1 === a.nodeType && b ? !0 : "array" === e || "function" !== e && (0 === b || "number" === typeof b && 0 < b && b - 1 in a)
  }

  function b(a) {
    var b = la[a] = {};
    q.each(a.match(ca) || [], function (a, e) {
      b[e] = !0
    });
    return b
  }

  function e() {
    Object.defineProperty(this.cache = {}, 0, {get: function () {
      return{}
    }});
    this.expando = q.expando + Math.random()
  }

  function g(b, e, f) {
    if (f === a && 1 === b.nodeType)if (f = "data-" + e.replace(ya, "-$1").toLowerCase(), f = b.getAttribute(f), "string" === typeof f) {
      try {
        f =
          "true" === f ? !0 : "false" === f ? !1 : "null" === f ? null : +f + "" === f ? +f : Ka.test(f) ? JSON.parse(f) : f
      } catch (d) {
      }
      X.set(b, e, f)
    } else f = a;
    return f
  }

  function k() {
    return!0
  }

  function h() {
    return!1
  }

  function l() {
    try {
      return O.activeElement
    } catch (a) {
    }
  }

  function n(a, b) {
    for (; (a = a[b]) && 1 !== a.nodeType;);
    return a
  }

  function m(a, b, e) {
    if (q.isFunction(b))return q.grep(a, function (a, f) {
      return!!b.call(a, f, a) !== e
    });
    if (b.nodeType)return q.grep(a, function (a) {
      return a === b !== e
    });
    if ("string" === typeof b) {
      if (Va.test(b))return q.filter(b, a, e);
      b = q.filter(b,
        a)
    }
    return q.grep(a, function (a) {
      return 0 <= W.call(b, a) !== e
    })
  }

  function s(a, b) {
    return q.nodeName(a, "table") && q.nodeName(1 === b.nodeType ? b : b.firstChild, "tr") ? a.getElementsByTagName("tbody")[0] || a.appendChild(a.ownerDocument.createElement("tbody")) : a
  }

  function r(a) {
    a.type = (null !== a.getAttribute("type")) + "/" + a.type;
    return a
  }

  function t(a) {
    var b = Wa.exec(a.type);
    b ? a.type = b[1] : a.removeAttribute("type");
    return a
  }

  function v(a, b) {
    for (var e = a.length, f = 0; f < e; f++)P.set(a[f], "globalEval", !b || P.get(b[f], "globalEval"))
  }

  function p(a, b) {
    var e, f, d, g;
    if (1 === b.nodeType) {
      if (P.hasData(a) && (g = P.access(a), e = P.set(b, g), g = g.events))for (d in delete e.handle, e.events = {}, g)for (e = 0, f = g[d].length; e < f; e++)q.event.add(b, d, g[d][e]);
      X.hasData(a) && (d = X.access(a), d = q.extend({}, d), X.set(b, d))
    }
  }

  function x(b, e) {
    var f = b.getElementsByTagName ? b.getElementsByTagName(e || "*") : b.querySelectorAll ? b.querySelectorAll(e || "*") : [];
    return e === a || e && q.nodeName(b, e) ? q.merge([b], f) : f
  }

  function B(a, b) {
    if (b in a)return b;
    for (var e = b.charAt(0).toUpperCase() +
      b.slice(1), f = b, d = eb.length; d--;)if (b = eb[d] + e, b in a)return b;
    return f
  }

  function C(a, b) {
    a = b || a;
    return"none" === q.css(a, "display") || !q.contains(a.ownerDocument, a)
  }

  function z(a, b) {
    for (var e, f, d, g = [], h = 0, m = a.length; h < m; h++)f = a[h], f.style && (g[h] = P.get(f, "olddisplay"), e = f.style.display, b ? (g[h] || "none" !== e || (f.style.display = ""), "" === f.style.display && C(f) && (g[h] = P.access(f, "olddisplay", y(f.nodeName)))) : g[h] || (d = C(f), (e && "none" !== e || !d) && P.set(f, "olddisplay", d ? e : q.css(f, "display"))));
    for (h = 0; h < m; h++)f = a[h],
      !f.style || b && "none" !== f.style.display && "" !== f.style.display || (f.style.display = b ? g[h] || "" : "none");
    return a
  }

  function A(a, b, e) {
    return(a = qb.exec(b)) ? Math.max(0, a[1] - (e || 0)) + (a[2] || "px") : b
  }

  function u(a, b, e, f, d) {
    b = e === (f ? "border" : "content") ? 4 : "width" === b ? 1 : 0;
    for (var g = 0; 4 > b; b += 2)"margin" === e && (g += q.css(a, e + za[b], !0, d)), f ? ("content" === e && (g -= q.css(a, "padding" + za[b], !0, d)), "margin" !== e && (g -= q.css(a, "border" + za[b] + "Width", !0, d))) : (g += q.css(a, "padding" + za[b], !0, d), "padding" !== e && (g += q.css(a, "border" + za[b] +
      "Width", !0, d)));
    return g
  }

  function w(a, b, e) {
    var f = !0, g = "width" === b ? a.offsetWidth : a.offsetHeight, h = d.getComputedStyle(a, null), m = q.support.boxSizing && "border-box" === q.css(a, "boxSizing", !1, h);
    if (0 >= g || null == g) {
      g = ra(a, b, h);
      if (0 > g || null == g)g = a.style[b];
      if (Xa.test(g))return g;
      f = m && (q.support.boxSizingReliable || g === a.style[b]);
      g = parseFloat(g) || 0
    }
    return g + u(a, b, e || (m ? "border" : "content"), f, h) + "px"
  }

  function y(a) {
    var b = O, e = fb[a];
    e || (e = J(a, b), "none" !== e && e || (ua = (ua || q("<iframe frameborder='0' width='0' height='0'/>").css("cssText",
      "display:block !important")).appendTo(b.documentElement), b = (ua[0].contentWindow || ua[0].contentDocument).document, b.write("<!doctype html><html><body>"), b.close(), e = J(a, b), ua.detach()), fb[a] = e);
    return e
  }

  function J(a, b) {
    var e = q(b.createElement(a)).appendTo(b.body), f = q.css(e[0], "display");
    e.remove();
    return f
  }

  function F(a, b, e, f) {
    var d;
    if (q.isArray(b))q.each(b, function (b, d) {
      e || rb.test(a) ? f(a, d) : F(a + "[" + ("object" === typeof d ? b : "") + "]", d, e, f)
    }); else if (e || "object" !== q.type(b))f(a, b); else for (d in b)F(a + "[" +
      d + "]", b[d], e, f)
  }

  function H(a) {
    return function (b, e) {
      "string" !== typeof b && (e = b, b = "*");
      var f, d = 0, g = b.toLowerCase().match(ca) || [];
      if (q.isFunction(e))for (; f = g[d++];)"+" === f[0] ? (f = f.slice(1) || "*", (a[f] = a[f] || []).unshift(e)) : (a[f] = a[f] || []).push(e)
    }
  }

  function E(a, b, e, f) {
    function d(m) {
      var p;
      g[m] = !0;
      q.each(a[m] || [], function (a, m) {
        var k = m(b, e, f);
        if ("string" === typeof k && !h && !g[k])return b.dataTypes.unshift(k), d(k), !1;
        if (h)return!(p = k)
      });
      return p
    }

    var g = {}, h = a === Ya;
    return d(b.dataTypes[0]) || !g["*"] && d("*")
  }

  function I(b, e) {
    var f, d, g = q.ajaxSettings.flatOptions || {};
    for (f in e)e[f] !== a && ((g[f] ? b : d || (d = {}))[f] = e[f]);
    d && q.extend(!0, b, d);
    return b
  }

  function K() {
    setTimeout(function () {
      Da = a
    });
    return Da = q.now()
  }

  function N(a, b, e) {
    for (var f, d = (La[b] || []).concat(La["*"]), g = 0, h = d.length; g < h; g++)if (f = d[g].call(e, b, a))return f
  }

  function R(a, b, e) {
    var f, d = 0, g = Ra.length, h = q.Deferred().always(function () {
      delete m.elem
    }), m = function () {
      if (f)return!1;
      for (var b = Da || K(), b = Math.max(0, p.startTime + p.duration - b), e = 1 - (b / p.duration || 0), d = 0, g = p.tweens.length; d <
        g; d++)p.tweens[d].run(e);
      h.notifyWith(a, [p, e, b]);
      if (1 > e && g)return b;
      h.resolveWith(a, [p]);
      return!1
    }, p = h.promise({elem: a, props: q.extend({}, b), opts: q.extend(!0, {specialEasing: {}}, e), originalProperties: b, originalOptions: e, startTime: Da || K(), duration: e.duration, tweens: [], createTween: function (b, e) {
      var f = q.Tween(a, p.opts, b, e, p.opts.specialEasing[b] || p.opts.easing);
      p.tweens.push(f);
      return f
    }, stop: function (b) {
      var e = 0, d = b ? p.tweens.length : 0;
      if (f)return this;
      for (f = !0; e < d; e++)p.tweens[e].run(1);
      b ? h.resolveWith(a,
        [p, b]) : h.rejectWith(a, [p, b]);
      return this
    }});
    e = p.props;
    for (S(e, p.opts.specialEasing); d < g; d++)if (b = Ra[d].call(p, a, e, p.opts))return b;
    q.map(e, N, p);
    q.isFunction(p.opts.start) && p.opts.start.call(a, p);
    q.fx.timer(q.extend(m, {elem: a, anim: p, queue: p.opts.queue}));
    return p.progress(p.opts.progress).done(p.opts.done, p.opts.complete).fail(p.opts.fail).always(p.opts.always)
  }

  function S(a, b) {
    var e, f, d, g, h;
    for (e in a)if (f = q.camelCase(e), d = b[f], g = a[e], q.isArray(g) && (d = g[1], g = a[e] = g[0]), e !== f && (a[f] = g, delete a[e]),
      (h = q.cssHooks[f]) && "expand"in h)for (e in g = h.expand(g), delete a[f], g)e in a || (a[e] = g[e], b[e] = d); else b[f] = d
  }

  function L(a, b, e, f, d) {
    return new L.prototype.init(a, b, e, f, d)
  }

  function D(a, b) {
    var e, f = {height: a}, d = 0;
    for (b = b ? 1 : 0; 4 > d; d += 2 - b)e = za[d], f["margin" + e] = f["padding" + e] = a;
    b && (f.opacity = f.width = a);
    return f
  }

  function Y(a) {
    return q.isWindow(a) ? a : 9 === a.nodeType && a.defaultView
  }

  var M, T, da = typeof a, Z = d.location, O = d.document, ja = O.documentElement, ea = d.jQuery, G = d.$, ba = {}, Q = [], aa = Q.concat, fa = Q.push, U = Q.slice, W =
    Q.indexOf, ka = ba.toString, pa = ba.hasOwnProperty, sa = "2.0.3".trim, q = function (a, b) {
    return new q.fn.init(a, b, M)
  }, ta = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source, ca = /\S+/g, Aa = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/, ga = /^<(\w+)\s*\/?>(?:<\/\1>|)$/, Ba = /^-ms-/, ha = /-([\da-z])/gi, Ea = function (a, b) {
    return b.toUpperCase()
  }, wa = function () {
    O.removeEventListener("DOMContentLoaded", wa, !1);
    d.removeEventListener("load", wa, !1);
    q.ready()
  };
  q.fn = q.prototype = {jquery: "2.0.3", constructor: q, init: function (b, e, f) {
    var d;
    if (!b)return this;
    if ("string" === typeof b) {
      d = "<" === b.charAt(0) && ">" === b.charAt(b.length - 1) && 3 <= b.length ? [null, b, null] : Aa.exec(b);
      if (!d || !d[1] && e)return!e || e.jquery ? (e || f).find(b) : this.constructor(e).find(b);
      if (d[1]) {
        if (e = e instanceof q ? e[0] : e, q.merge(this, q.parseHTML(d[1], e && e.nodeType ? e.ownerDocument || e : O, !0)), ga.test(d[1]) && q.isPlainObject(e))for (d in e)if (q.isFunction(this[d]))this[d](e[d]); else this.attr(d, e[d])
      } else(e = O.getElementById(d[2])) && e.parentNode && (this.length = 1, this[0] = e), this.context = O, this.selector =
        b;
      return this
    }
    if (b.nodeType)return this.context = this[0] = b, this.length = 1, this;
    if (q.isFunction(b))return f.ready(b);
    b.selector !== a && (this.selector = b.selector, this.context = b.context);
    return q.makeArray(b, this)
  }, selector: "", length: 0, toArray: function () {
    return U.call(this)
  }, get: function (a) {
    return null == a ? this.toArray() : 0 > a ? this[this.length + a] : this[a]
  }, pushStack: function (a) {
    a = q.merge(this.constructor(), a);
    a.prevObject = this;
    a.context = this.context;
    return a
  }, each: function (a, b) {
    return q.each(this, a, b)
  }, ready: function (a) {
    q.ready.promise().done(a);
    return this
  }, slice: function () {
    return this.pushStack(U.apply(this, arguments))
  }, first: function () {
    return this.eq(0)
  }, last: function () {
    return this.eq(-1)
  }, eq: function (a) {
    var b = this.length;
    a = +a + (0 > a ? b : 0);
    return this.pushStack(0 <= a && a < b ? [this[a]] : [])
  }, map: function (a) {
    return this.pushStack(q.map(this, function (b, e) {
      return a.call(b, e, b)
    }))
  }, end: function () {
    return this.prevObject || this.constructor(null)
  }, push: fa, sort: [].sort, splice: [].splice};
  q.fn.init.prototype = q.fn;
  q.extend = q.fn.extend = function () {
    var b, e, f,
      d, g, h = arguments[0] || {}, m = 1, p = arguments.length, k = !1;
    "boolean" === typeof h && (k = h, h = arguments[1] || {}, m = 2);
    "object" === typeof h || q.isFunction(h) || (h = {});
    p === m && (h = this, --m);
    for (; m < p; m++)if (null != (b = arguments[m]))for (e in b)f = h[e], d = b[e], h !== d && (k && d && (q.isPlainObject(d) || (g = q.isArray(d))) ? (g ? (g = !1, f = f && q.isArray(f) ? f : []) : f = f && q.isPlainObject(f) ? f : {}, h[e] = q.extend(k, f, d)) : d !== a && (h[e] = d));
    return h
  };
  q.extend({expando: "jQuery" + ("2.0.3" + Math.random()).replace(/\D/g, ""), noConflict: function (a) {
    d.$ === q && (d.$ =
      G);
    a && d.jQuery === q && (d.jQuery = ea);
    return q
  }, isReady: !1, readyWait: 1, holdReady: function (a) {
    a ? q.readyWait++ : q.ready(!0)
  }, ready: function (a) {
    (!0 === a ? --q.readyWait : q.isReady) || (q.isReady = !0, !0 !== a && 0 < --q.readyWait || (T.resolveWith(O, [q]), q.fn.trigger && q(O).trigger("ready").off("ready")))
  }, isFunction: function (a) {
    return"function" === q.type(a)
  }, isArray: Array.isArray, isWindow: function (a) {
    return null != a && a === a.window
  }, isNumeric: function (a) {
    return!isNaN(parseFloat(a)) && isFinite(a)
  }, type: function (a) {
    return null ==
      a ? String(a) : "object" === typeof a || "function" === typeof a ? ba[ka.call(a)] || "object" : typeof a
  }, isPlainObject: function (a) {
    if ("object" !== q.type(a) || a.nodeType || q.isWindow(a))return!1;
    try {
      if (a.constructor && !pa.call(a.constructor.prototype, "isPrototypeOf"))return!1
    } catch (b) {
      return!1
    }
    return!0
  }, isEmptyObject: function (a) {
    for (var b in a)return!1;
    return!0
  }, error: function (a) {
    throw Error(a);
  }, parseHTML: function (a, b, e) {
    if (!a || "string" !== typeof a)return null;
    "boolean" === typeof b && (e = b, b = !1);
    b = b || O;
    var f = ga.exec(a);
    e = !e && [];
    if (f)return[b.createElement(f[1])];
    f = q.buildFragment([a], b, e);
    e && q(e).remove();
    return q.merge([], f.childNodes)
  }, parseJSON: JSON.parse, parseXML: function (b) {
    var e, f;
    if (!b || "string" !== typeof b)return null;
    try {
      f = new DOMParser, e = f.parseFromString(b, "text/xml")
    } catch (d) {
      e = a
    }
    e && !e.getElementsByTagName("parsererror").length || q.error("Invalid XML: " + b);
    return e
  }, noop: function () {
  }, globalEval: function (a) {
    var b;
    b = eval;
    if (a = q.trim(a))1 === a.indexOf("use strict") ? (b = O.createElement("script"), b.text = a, O.head.appendChild(b).parentNode.removeChild(b)) :
      b(a)
  }, camelCase: function (a) {
    return a.replace(Ba, "ms-").replace(ha, Ea)
  }, nodeName: function (a, b) {
    return a.nodeName && a.nodeName.toLowerCase() === b.toLowerCase()
  }, each: function (a, b, e) {
    var d, g = 0, h = a.length;
    d = f(a);
    if (e)if (d)for (; g < h && (d = b.apply(a[g], e), !1 !== d); g++); else for (g in a) {
      if (d = b.apply(a[g], e), !1 === d)break
    } else if (d)for (; g < h && (d = b.call(a[g], g, a[g]), !1 !== d); g++); else for (g in a)if (d = b.call(a[g], g, a[g]), !1 === d)break;
    return a
  }, trim: function (a) {
    return null == a ? "" : sa.call(a)
  }, makeArray: function (a, b) {
    var e =
      b || [];
    null != a && (f(Object(a)) ? q.merge(e, "string" === typeof a ? [a] : a) : fa.call(e, a));
    return e
  }, inArray: function (a, b, e) {
    return null == b ? -1 : W.call(b, a, e)
  }, merge: function (b, e) {
    var f = e.length, d = b.length, g = 0;
    if ("number" === typeof f)for (; g < f; g++)b[d++] = e[g]; else for (; e[g] !== a;)b[d++] = e[g++];
    b.length = d;
    return b
  }, grep: function (a, b, e) {
    var f, d = [], g = 0, h = a.length;
    for (e = !!e; g < h; g++)f = !!b(a[g], g), e !== f && d.push(a[g]);
    return d
  }, map: function (a, b, e) {
    var d, g = 0, h = a.length, m = [];
    if (f(a))for (; g < h; g++)d = b(a[g], g, e), null != d && (m[m.length] =
      d); else for (g in a)d = b(a[g], g, e), null != d && (m[m.length] = d);
    return aa.apply([], m)
  }, guid: 1, proxy: function (b, e) {
    var f, d;
    "string" === typeof e && (f = b[e], e = b, b = f);
    if (!q.isFunction(b))return a;
    d = U.call(arguments, 2);
    f = function () {
      return b.apply(e || this, d.concat(U.call(arguments)))
    };
    f.guid = b.guid = b.guid || q.guid++;
    return f
  }, access: function (b, e, f, d, g, h, m) {
    var p = 0, k = b.length, l = null == f;
    if ("object" === q.type(f))for (p in g = !0, f)q.access(b, e, p, f[p], !0, h, m); else if (d !== a && (g = !0, q.isFunction(d) || (m = !0), l && (m ? (e.call(b,
      d), e = null) : (l = e, e = function (a, b, e) {
      return l.call(q(a), e)
    })), e))for (; p < k; p++)e(b[p], f, m ? d : d.call(b[p], p, e(b[p], f)));
    return g ? b : l ? e.call(b) : k ? e(b[0], f) : h
  }, now: Date.now, swap: function (a, b, e, f) {
    var d, g = {};
    for (d in b)g[d] = a.style[d], a.style[d] = b[d];
    e = e.apply(a, f || []);
    for (d in b)a.style[d] = g[d];
    return e
  }});
  q.ready.promise = function (a) {
    T || (T = q.Deferred(), "complete" === O.readyState ? setTimeout(q.ready) : (O.addEventListener("DOMContentLoaded", wa, !1), d.addEventListener("load", wa, !1)));
    return T.promise(a)
  };
  q.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),
    function (a, b) {
      ba["[object " + b + "]"] = b.toLowerCase()
    });
  M = q(O);
  (function (a, b) {
    function e(a, b, f, d) {
      var g, h, m, p, k;
      (b ? b.ownerDocument || b : oa) !== H && M(b);
      b = b || H;
      f = f || [];
      if (!a || "string" !== typeof a)return f;
      if (1 !== (p = b.nodeType) && 9 !== p)return[];
      if (L && !d) {
        if (g = ka.exec(a))if (m = g[1])if (9 === p)if ((h = b.getElementById(m)) && h.parentNode) {
          if (h.id === m)return f.push(h), f
        } else return f; else {
          if (b.ownerDocument && (h = b.ownerDocument.getElementById(m)) && T(b, h) && h.id === m)return f.push(h), f
        } else {
          if (g[2])return ha.apply(f, b.getElementsByTagName(a)),
            f;
          if ((m = g[3]) && z.getElementsByClassName && b.getElementsByClassName)return ha.apply(f, b.getElementsByClassName(m)), f
        }
        if (z.qsa && (!N || !N.test(a))) {
          h = g = I;
          m = b;
          k = 9 === p && a;
          if (1 === p && "object" !== b.nodeName.toLowerCase()) {
            p = n(a);
            (g = b.getAttribute("id")) ? h = g.replace(Ga, "\\$&") : b.setAttribute("id", h);
            h = "[id='" + h + "'] ";
            for (m = p.length; m--;)p[m] = h + r(p[m]);
            m = ra.test(a) && b.parentNode || b;
            k = p.join(",")
          }
          if (k)try {
            return ha.apply(f, m.querySelectorAll(k)), f
          } catch (l) {
          } finally {
            g || b.removeAttribute("id")
          }
        }
      }
      var t;
      a:{
        a = a.replace(Q,
          "$1");
        h = n(a);
        if (!d && 1 === h.length) {
          g = h[0] = h[0].slice(0);
          if (2 < g.length && "ID" === (t = g[0]).type && z.getById && 9 === b.nodeType && L && w.relative[g[1].type]) {
            b = (w.find.ID(t.matches[0].replace(la, ma), b) || [])[0];
            if (!b) {
              t = f;
              break a
            }
            a = a.slice(g.shift().value.length)
          }
          for (p = U.needsContext.test(a) ? 0 : g.length; p--;) {
            t = g[p];
            if (w.relative[m = t.type])break;
            if (m = w.find[m])if (d = m(t.matches[0].replace(la, ma), ra.test(g[0].type) && b.parentNode || b)) {
              g.splice(p, 1);
              a = d.length && r(g);
              if (!a) {
                ha.apply(f, d);
                t = f;
                break a
              }
              break
            }
          }
        }
        F(a, h)(d,
          b, !L, f, ra.test(a));
        t = f
      }
      return t
    }

    function f() {
      function a(e, f) {
        b.push(e += " ") > w.cacheLength && delete a[b.shift()];
        return a[e] = f
      }

      var b = [];
      return a
    }

    function d(a) {
      a[I] = !0;
      return a
    }

    function g(a) {
      var b = H.createElement("div");
      try {
        return!!a(b)
      } catch (e) {
        return!1
      } finally {
        b.parentNode && b.parentNode.removeChild(b)
      }
    }

    function h(a, b) {
      for (var e = a.split("|"), f = a.length; f--;)w.attrHandle[e[f]] = b
    }

    function m(a, b) {
      var e = b && a, f = e && 1 === a.nodeType && 1 === b.nodeType && (~b.sourceIndex || Ba) - (~a.sourceIndex || Ba);
      if (f)return f;
      if (e)for (; e =
                     e.nextSibling;)if (e === b)return-1;
      return a ? 1 : -1
    }

    function p(a) {
      return function (b) {
        return"input" === b.nodeName.toLowerCase() && b.type === a
      }
    }

    function k(a) {
      return function (b) {
        var e = b.nodeName.toLowerCase();
        return("input" === e || "button" === e) && b.type === a
      }
    }

    function l(a) {
      return d(function (b) {
        b = +b;
        return d(function (e, f) {
          for (var d, g = a([], e.length, b), h = g.length; h--;)e[d = g[h]] && (e[d] = !(f[d] = e[d]))
        })
      })
    }

    function t() {
    }

    function n(a, b) {
      var f, d, g, h, m, p, k;
      if (m = ja[a + " "])return b ? 0 : m.slice(0);
      m = a;
      p = [];
      for (k = w.preFilter; m;) {
        if (!f ||
          (d = Ka.exec(m)))d && (m = m.slice(d[0].length) || m), p.push(g = []);
        f = !1;
        if (d = ya.exec(m))f = d.shift(), g.push({value: f, type: d[0].replace(Q, " ")}), m = m.slice(f.length);
        for (h in w.filter)!(d = U[h].exec(m)) || k[h] && !(d = k[h](d)) || (f = d.shift(), g.push({value: f, type: h, matches: d}), m = m.slice(f.length));
        if (!f)break
      }
      return b ? m.length : m ? e.error(a) : ja(a, p).slice(0)
    }

    function r(a) {
      for (var b = 0, e = a.length, f = ""; b < e; b++)f += a[b].value;
      return f
    }

    function s(a, b, e) {
      var f = b.dir, d = e && "parentNode" === f, g = da++;
      return b.first ? function (b, e, g) {
        for (; b = b[f];)if (1 === b.nodeType || d)return a(b, e, g)
      } : function (b, e, h) {
        var m, p, k, l = ga + " " + g;
        if (h)for (; b = b[f];) {
          if ((1 === b.nodeType || d) && a(b, e, h))return!0
        } else for (; b = b[f];)if (1 === b.nodeType || d)if (k = b[I] || (b[I] = {}), (p = k[f]) && p[0] === l) {
          if (!0 === (m = p[1]) || m === y)return!0 === m
        } else if (p = k[f] = [l], p[1] = a(b, e, h) || y, !0 === p[1])return!0
      }
    }

    function v(a) {
      return 1 < a.length ? function (b, e, f) {
        for (var d = a.length; d--;)if (!a[d](b, e, f))return!1;
        return!0
      } : a[0]
    }

    function B(a, b, e, f, d) {
      for (var g, h = [], m = 0, p = a.length, k = null != b; m <
        p; m++)if (g = a[m])if (!e || e(g, f, d))h.push(g), k && b.push(m);
      return h
    }

    function x(a, b, f, g, h, m) {
      g && !g[I] && (g = x(g));
      h && !h[I] && (h = x(h, m));
      return d(function (d, m, p, k) {
        var l, t, n = [], r = [], s = m.length, v;
        if (!(v = d)) {
          v = b || "*";
          for (var x = p.nodeType ? [p] : p, u = [], C = 0, A = x.length; C < A; C++)e(v, x[C], u);
          v = u
        }
        v = !a || !d && b ? v : B(v, n, a, p, k);
        x = f ? h || (d ? a : s || g) ? [] : m : v;
        f && f(v, x, p, k);
        if (g)for (l = B(x, r), g(l, [], p, k), p = l.length; p--;)if (t = l[p])x[r[p]] = !(v[r[p]] = t);
        if (d) {
          if (h || a) {
            if (h) {
              l = [];
              for (p = x.length; p--;)(t = x[p]) && l.push(v[p] = t);
              h(null, x = [],
                l, k)
            }
            for (p = x.length; p--;)(t = x[p]) && -1 < (l = h ? va.call(d, t) : n[p]) && (d[l] = !(m[l] = t))
          }
        } else x = B(x === m ? x.splice(s, x.length) : x), h ? h(null, m, x, k) : ha.apply(m, x)
      })
    }

    function u(a) {
      var b, e, f, d = a.length, g = w.relative[a[0].type];
      e = g || w.relative[" "];
      for (var h = g ? 1 : 0, m = s(function (a) {
        return a === b
      }, e, !0), p = s(function (a) {
        return-1 < va.call(b, a)
      }, e, !0), k = [function (a, e, f) {
        return!g && (f || e !== E) || ((b = e).nodeType ? m(a, e, f) : p(a, e, f))
      }]; h < d; h++)if (e = w.relative[a[h].type])k = [s(v(k), e)]; else {
        e = w.filter[a[h].type].apply(null, a[h].matches);
        if (e[I]) {
          for (f = ++h; f < d && !w.relative[a[f].type]; f++);
          return x(1 < h && v(k), 1 < h && r(a.slice(0, h - 1).concat({value: " " === a[h - 2].type ? "*" : ""})).replace(Q, "$1"), e, h < f && u(a.slice(h, f)), f < d && u(a = a.slice(f)), f < d && r(a))
        }
        k.push(e)
      }
      return v(k)
    }

    function C(a, b) {
      var f = 0, g = 0 < b.length, h = 0 < a.length, m = function (d, m, p, k, l) {
        var t, n, r = [], s = 0, v = "0", x = d && [], u = null != l, C = E, A = d || h && w.find.TAG("*", l && m.parentNode || m), z = ga += null == C ? 1 : Math.random() || 0.1;
        u && (E = m !== H && m, y = f);
        for (; null != (l = A[v]); v++) {
          if (h && l) {
            for (t = 0; n = a[t++];)if (n(l,
              m, p)) {
              k.push(l);
              break
            }
            u && (ga = z, y = ++f)
          }
          g && ((l = !n && l) && s--, d && x.push(l))
        }
        s += v;
        if (g && v !== s) {
          for (t = 0; n = b[t++];)n(x, r, m, p);
          if (d) {
            if (0 < s)for (; v--;)x[v] || r[v] || (r[v] = Wa.call(k));
            r = B(r)
          }
          ha.apply(k, r);
          u && !d && 0 < r.length && 1 < s + b.length && e.uniqueSort(k)
        }
        u && (ga = z, E = C);
        return x
      };
      return g ? d(m) : m
    }

    var A, z, y, w, J, R, F, E, S, M, H, V, L, N, O, D, T, I = "sizzle" + -new Date, oa = a.document, ga = 0, da = 0, K = f(), ja = f(), Y = f(), Z = !1, Oa = function (a, b) {
        a === b && (Z = !0);
        return 0
      }, ea = typeof b, Ba = -2147483648, G = {}.hasOwnProperty, qa = [], Wa = qa.pop, X = qa.push,
      ha = qa.push, P = qa.slice, va = qa.indexOf || function (a) {
        for (var b = 0, e = this.length; b < e; b++)if (this[b] === a)return b;
        return-1
      }, ia = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w", "w#"), Ea = "\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|(" + ia + ")|)|)[\\x20\\t\\r\\n\\f]*\\]", ba = ":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|" + Ea.replace(3, 8) + ")*)|.*)\\)|)", Q = RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$",
        "g"), Ka = /^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/, ya = /^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/, ra = /[\x20\t\r\n\f]*[+~]/, wa = RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*)[\\x20\\t\\r\\n\\f]*\\]", "g"), aa = RegExp(ba), W = RegExp("^" + ia + "$"), U = {ID: /^#((?:\\.|[\w-]|[^\x00-\xa0])+)/, CLASS: /^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/, TAG: RegExp("^(" + "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w", "w*") + ")"), ATTR: RegExp("^" + Ea), PSEUDO: RegExp("^" + ba), CHILD: RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)",
        "i"), bool: RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$", "i"), needsContext: RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)", "i")}, ua = /^[^{]+\{\s*\[native \w/, ka = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/, fa = /^(?:input|select|textarea|button)$/i, Fa = /^h\d$/i, Ga = /'|\\/g, la = RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)",
        "ig"), ma = function (a, b, e) {
        a = "0x" + b - 65536;
        return a !== a || e ? b : 0 > a ? String.fromCharCode(a + 65536) : String.fromCharCode(a >> 10 | 55296, a & 1023 | 56320)
      };
    try {
      ha.apply(qa = P.call(oa.childNodes), oa.childNodes), qa[oa.childNodes.length].nodeType
    } catch (ca) {
      ha = {apply: qa.length ? function (a, b) {
        X.apply(a, P.call(b))
      } : function (a, b) {
        for (var e = a.length, f = 0; a[e++] = b[f++];);
        a.length = e - 1
      }}
    }
    R = e.isXML = function (a) {
      return(a = a && (a.ownerDocument || a).documentElement) ? "HTML" !== a.nodeName : !1
    };
    z = e.support = {};
    M = e.setDocument = function (a) {
      var b =
        a ? a.ownerDocument || a : oa;
      a = b.defaultView;
      if (b === H || 9 !== b.nodeType || !b.documentElement)return H;
      H = b;
      V = b.documentElement;
      L = !R(b);
      a && a.attachEvent && a !== a.top && a.attachEvent("onbeforeunload", function () {
        M()
      });
      z.attributes = g(function (a) {
        a.className = "i";
        return!a.getAttribute("className")
      });
      z.getElementsByTagName = g(function (a) {
        a.appendChild(b.createComment(""));
        return!a.getElementsByTagName("*").length
      });
      z.getElementsByClassName = g(function (a) {
        a.innerHTML = "<div class='a'></div><div class='a i'></div>";
        a.firstChild.className =
          "i";
        return 2 === a.getElementsByClassName("i").length
      });
      z.getById = g(function (a) {
        V.appendChild(a).id = I;
        return!b.getElementsByName || !b.getElementsByName(I).length
      });
      z.getById ? (w.find.ID = function (a, b) {
        if (typeof b.getElementById !== ea && L) {
          var e = b.getElementById(a);
          return e && e.parentNode ? [e] : []
        }
      }, w.filter.ID = function (a) {
        var b = a.replace(la, ma);
        return function (a) {
          return a.getAttribute("id") === b
        }
      }) : (delete w.find.ID, w.filter.ID = function (a) {
        var b = a.replace(la, ma);
        return function (a) {
          return(a = typeof a.getAttributeNode !==
            ea && a.getAttributeNode("id")) && a.value === b
        }
      });
      w.find.TAG = z.getElementsByTagName ? function (a, b) {
        if (typeof b.getElementsByTagName !== ea)return b.getElementsByTagName(a)
      } : function (a, b) {
        var e, f = [], d = 0, g = b.getElementsByTagName(a);
        if ("*" === a) {
          for (; e = g[d++];)1 === e.nodeType && f.push(e);
          return f
        }
        return g
      };
      w.find.CLASS = z.getElementsByClassName && function (a, b) {
        if (typeof b.getElementsByClassName !== ea && L)return b.getElementsByClassName(a)
      };
      O = [];
      N = [];
      if (z.qsa = ua.test(b.querySelectorAll))g(function (a) {
        a.innerHTML = "<select><option selected=''></option></select>";
        a.querySelectorAll("[selected]").length || N.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");
        a.querySelectorAll(":checked").length || N.push(":checked")
      }), g(function (a) {
        var e = b.createElement("input");
        e.setAttribute("type", "hidden");
        a.appendChild(e).setAttribute("t", "");
        a.querySelectorAll("[t^='']").length && N.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");
        a.querySelectorAll(":enabled").length ||
        N.push(":enabled", ":disabled");
        a.querySelectorAll("*,:x");
        N.push(",.*:")
      });
      (z.matchesSelector = ua.test(D = V.webkitMatchesSelector || V.mozMatchesSelector || V.oMatchesSelector || V.msMatchesSelector)) && g(function (a) {
        z.disconnectedMatch = D.call(a, "div");
        D.call(a, "[s!='']:x");
        O.push("!=", ba)
      });
      N = N.length && RegExp(N.join("|"));
      O = O.length && RegExp(O.join("|"));
      T = ua.test(V.contains) || V.compareDocumentPosition ? function (a, b) {
        var e = 9 === a.nodeType ? a.documentElement : a, f = b && b.parentNode;
        return a === f || !!(f && 1 === f.nodeType &&
          (e.contains ? e.contains(f) : a.compareDocumentPosition && a.compareDocumentPosition(f) & 16))
      } : function (a, b) {
        if (b)for (; b = b.parentNode;)if (b === a)return!0;
        return!1
      };
      Oa = V.compareDocumentPosition ? function (a, e) {
        if (a === e)return Z = !0, 0;
        var f = e.compareDocumentPosition && a.compareDocumentPosition && a.compareDocumentPosition(e);
        return f ? f & 1 || !z.sortDetached && e.compareDocumentPosition(a) === f ? a === b || T(oa, a) ? -1 : e === b || T(oa, e) ? 1 : S ? va.call(S, a) - va.call(S, e) : 0 : f & 4 ? -1 : 1 : a.compareDocumentPosition ? -1 : 1
      } : function (a, e) {
        var f,
          d = 0;
        f = a.parentNode;
        var g = e.parentNode, h = [a], p = [e];
        if (a === e)return Z = !0, 0;
        if (!f || !g)return a === b ? -1 : e === b ? 1 : f ? -1 : g ? 1 : S ? va.call(S, a) - va.call(S, e) : 0;
        if (f === g)return m(a, e);
        for (f = a; f = f.parentNode;)h.unshift(f);
        for (f = e; f = f.parentNode;)p.unshift(f);
        for (; h[d] === p[d];)d++;
        return d ? m(h[d], p[d]) : h[d] === oa ? -1 : p[d] === oa ? 1 : 0
      };
      return b
    };
    e.matches = function (a, b) {
      return e(a, null, null, b)
    };
    e.matchesSelector = function (a, b) {
      (a.ownerDocument || a) !== H && M(a);
      b = b.replace(wa, "='$1']");
      if (z.matchesSelector && L && !(O && O.test(b) ||
        N && N.test(b)))try {
        var f = D.call(a, b);
        if (f || z.disconnectedMatch || a.document && 11 !== a.document.nodeType)return f
      } catch (d) {
      }
      return 0 < e(b, H, null, [a]).length
    };
    e.contains = function (a, b) {
      (a.ownerDocument || a) !== H && M(a);
      return T(a, b)
    };
    e.attr = function (a, e) {
      (a.ownerDocument || a) !== H && M(a);
      var f = w.attrHandle[e.toLowerCase()], f = f && G.call(w.attrHandle, e.toLowerCase()) ? f(a, e, !L) : b;
      return f === b ? z.attributes || !L ? a.getAttribute(e) : (f = a.getAttributeNode(e)) && f.specified ? f.value : null : f
    };
    e.error = function (a) {
      throw Error("Syntax error, unrecognized expression: " +
        a);
    };
    e.uniqueSort = function (a) {
      var b, e = [], f = 0, d = 0;
      Z = !z.detectDuplicates;
      S = !z.sortStable && a.slice(0);
      a.sort(Oa);
      if (Z) {
        for (; b = a[d++];)b === a[d] && (f = e.push(d));
        for (; f--;)a.splice(e[f], 1)
      }
      return a
    };
    J = e.getText = function (a) {
      var b, e = "", f = 0;
      b = a.nodeType;
      if (!b)for (; b = a[f]; f++)e += J(b); else if (1 === b || 9 === b || 11 === b) {
        if ("string" === typeof a.textContent)return a.textContent;
        for (a = a.firstChild; a; a = a.nextSibling)e += J(a)
      } else if (3 === b || 4 === b)return a.nodeValue;
      return e
    };
    w = e.selectors = {cacheLength: 50, createPseudo: d, match: U,
      attrHandle: {}, find: {}, relative: {">": {dir: "parentNode", first: !0}, " ": {dir: "parentNode"}, "+": {dir: "previousSibling", first: !0}, "~": {dir: "previousSibling"}}, preFilter: {ATTR: function (a) {
        a[1] = a[1].replace(la, ma);
        a[3] = (a[4] || a[5] || "").replace(la, ma);
        "~=" === a[2] && (a[3] = " " + a[3] + " ");
        return a.slice(0, 4)
      }, CHILD: function (a) {
        a[1] = a[1].toLowerCase();
        "nth" === a[1].slice(0, 3) ? (a[3] || e.error(a[0]), a[4] = +(a[4] ? a[5] + (a[6] || 1) : 2 * ("even" === a[3] || "odd" === a[3])), a[5] = +(a[7] + a[8] || "odd" === a[3])) : a[3] && e.error(a[0]);
        return a
      },
        PSEUDO: function (a) {
          var e, f = !a[5] && a[2];
          if (U.CHILD.test(a[0]))return null;
          a[3] && a[4] !== b ? a[2] = a[4] : f && aa.test(f) && (e = n(f, !0)) && (e = f.indexOf(")", f.length - e) - f.length) && (a[0] = a[0].slice(0, e), a[2] = f.slice(0, e));
          return a.slice(0, 3)
        }}, filter: {TAG: function (a) {
        var b = a.replace(la, ma).toLowerCase();
        return"*" === a ? function () {
          return!0
        } : function (a) {
          return a.nodeName && a.nodeName.toLowerCase() === b
        }
      }, CLASS: function (a) {
        var b = K[a + " "];
        return b || (b = RegExp("(^|[\\x20\\t\\r\\n\\f])" + a + "([\\x20\\t\\r\\n\\f]|$)")) && K(a,
          function (a) {
            return b.test("string" === typeof a.className && a.className || typeof a.getAttribute !== ea && a.getAttribute("class") || "")
          })
      }, ATTR: function (a, b, f) {
        return function (d) {
          d = e.attr(d, a);
          if (null == d)return"!=" === b;
          if (!b)return!0;
          d += "";
          return"=" === b ? d === f : "!=" === b ? d !== f : "^=" === b ? f && 0 === d.indexOf(f) : "*=" === b ? f && -1 < d.indexOf(f) : "$=" === b ? f && d.slice(-f.length) === f : "~=" === b ? -1 < (" " + d + " ").indexOf(f) : "|=" === b ? d === f || d.slice(0, f.length + 1) === f + "-" : !1
        }
      }, CHILD: function (a, b, e, f, d) {
        var g = "nth" !== a.slice(0, 3), h = "last" !==
          a.slice(-4), m = "of-type" === b;
        return 1 === f && 0 === d ? function (a) {
          return!!a.parentNode
        } : function (b, e, p) {
          var k, l, t, n, r;
          e = g !== h ? "nextSibling" : "previousSibling";
          var s = b.parentNode, v = m && b.nodeName.toLowerCase();
          p = !p && !m;
          if (s) {
            if (g) {
              for (; e;) {
                for (l = b; l = l[e];)if (m ? l.nodeName.toLowerCase() === v : 1 === l.nodeType)return!1;
                r = e = "only" === a && !r && "nextSibling"
              }
              return!0
            }
            r = [h ? s.firstChild : s.lastChild];
            if (h && p)for (p = s[I] || (s[I] = {}), k = p[a] || [], n = k[0] === ga && k[1], t = k[0] === ga && k[2], l = n && s.childNodes[n]; l = ++n && l && l[e] || (t = n = 0) ||
              r.pop();) {
              if (1 === l.nodeType && ++t && l === b) {
                p[a] = [ga, n, t];
                break
              }
            } else if (p && (k = (b[I] || (b[I] = {}))[a]) && k[0] === ga)t = k[1]; else for (; (l = ++n && l && l[e] || (t = n = 0) || r.pop()) && ((m ? l.nodeName.toLowerCase() !== v : 1 !== l.nodeType) || !++t || (p && ((l[I] || (l[I] = {}))[a] = [ga, t]), l !== b)););
            t -= d;
            return t === f || 0 === t % f && 0 <= t / f
          }
        }
      }, PSEUDO: function (a, b) {
        var f, g = w.pseudos[a] || w.setFilters[a.toLowerCase()] || e.error("unsupported pseudo: " + a);
        return g[I] ? g(b) : 1 < g.length ? (f = [a, a, "", b], w.setFilters.hasOwnProperty(a.toLowerCase()) ? d(function (a, e) {
          for (var f, d = g(a, b), h = d.length; h--;)f = va.call(a, d[h]), a[f] = !(e[f] = d[h])
        }) : function (a) {
          return g(a, 0, f)
        }) : g
      }}, pseudos: {not: d(function (a) {
        var b = [], e = [], f = F(a.replace(Q, "$1"));
        return f[I] ? d(function (a, b, e, d) {
          d = f(a, null, d, []);
          for (var g = a.length; g--;)if (e = d[g])a[g] = !(b[g] = e)
        }) : function (a, d, g) {
          b[0] = a;
          f(b, null, g, e);
          return!e.pop()
        }
      }), has: d(function (a) {
        return function (b) {
          return 0 < e(a, b).length
        }
      }), contains: d(function (a) {
        return function (b) {
          return-1 < (b.textContent || b.innerText || J(b)).indexOf(a)
        }
      }), lang: d(function (a) {
        W.test(a ||
          "") || e.error("unsupported lang: " + a);
        a = a.replace(la, ma).toLowerCase();
        return function (b) {
          var e;
          do if (e = L ? b.lang : b.getAttribute("xml:lang") || b.getAttribute("lang"))return e = e.toLowerCase(), e === a || 0 === e.indexOf(a + "-"); while ((b = b.parentNode) && 1 === b.nodeType);
          return!1
        }
      }), target: function (b) {
        var e = a.location && a.location.hash;
        return e && e.slice(1) === b.id
      }, root: function (a) {
        return a === V
      }, focus: function (a) {
        return a === H.activeElement && (!H.hasFocus || H.hasFocus()) && !!(a.type || a.href || ~a.tabIndex)
      }, enabled: function (a) {
        return!1 ===
          a.disabled
      }, disabled: function (a) {
        return!0 === a.disabled
      }, checked: function (a) {
        var b = a.nodeName.toLowerCase();
        return"input" === b && !!a.checked || "option" === b && !!a.selected
      }, selected: function (a) {
        a.parentNode && a.parentNode.selectedIndex;
        return!0 === a.selected
      }, empty: function (a) {
        for (a = a.firstChild; a; a = a.nextSibling)if ("@" < a.nodeName || 3 === a.nodeType || 4 === a.nodeType)return!1;
        return!0
      }, parent: function (a) {
        return!w.pseudos.empty(a)
      }, header: function (a) {
        return Fa.test(a.nodeName)
      }, input: function (a) {
        return fa.test(a.nodeName)
      },
        button: function (a) {
          var b = a.nodeName.toLowerCase();
          return"input" === b && "button" === a.type || "button" === b
        }, text: function (a) {
          var b;
          return"input" === a.nodeName.toLowerCase() && "text" === a.type && (null == (b = a.getAttribute("type")) || b.toLowerCase() === a.type)
        }, first: l(function () {
          return[0]
        }), last: l(function (a, b) {
          return[b - 1]
        }), eq: l(function (a, b, e) {
          return[0 > e ? e + b : e]
        }), even: l(function (a, b) {
          for (var e = 0; e < b; e += 2)a.push(e);
          return a
        }), odd: l(function (a, b) {
          for (var e = 1; e < b; e += 2)a.push(e);
          return a
        }), lt: l(function (a, b, e) {
          for (b =
                 0 > e ? e + b : e; 0 <= --b;)a.push(b);
          return a
        }), gt: l(function (a, b, e) {
          for (e = 0 > e ? e + b : e; ++e < b;)a.push(e);
          return a
        })}};
    w.pseudos.nth = w.pseudos.eq;
    for (A in{radio: !0, checkbox: !0, file: !0, password: !0, image: !0})w.pseudos[A] = p(A);
    for (A in{submit: !0, reset: !0})w.pseudos[A] = k(A);
    t.prototype = w.filters = w.pseudos;
    w.setFilters = new t;
    F = e.compile = function (a, b) {
      var e, f = [], d = [], g = Y[a + " "];
      if (!g) {
        b || (b = n(a));
        for (e = b.length; e--;)g = u(b[e]), g[I] ? f.push(g) : d.push(g);
        g = Y(a, C(d, f))
      }
      return g
    };
    z.sortStable = I.split("").sort(Oa).join("") ===
      I;
    z.detectDuplicates = Z;
    M();
    z.sortDetached = g(function (a) {
      return a.compareDocumentPosition(H.createElement("div")) & 1
    });
    g(function (a) {
      a.innerHTML = "<a href='#'></a>";
      return"#" === a.firstChild.getAttribute("href")
    }) || h("type|href|height|width", function (a, b, e) {
      if (!e)return a.getAttribute(b, "type" === b.toLowerCase() ? 1 : 2)
    });
    z.attributes && g(function (a) {
      a.innerHTML = "<input/>";
      a.firstChild.setAttribute("value", "");
      return"" === a.firstChild.getAttribute("value")
    }) || h("value", function (a, b, e) {
      if (!e && "input" === a.nodeName.toLowerCase())return a.defaultValue
    });
    g(function (a) {
      return null == a.getAttribute("disabled")
    }) || h("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped", function (a, b, e) {
      var f;
      if (!e)return(f = a.getAttributeNode(b)) && f.specified ? f.value : !0 === a[b] ? b.toLowerCase() : null
    });
    q.find = e;
    q.expr = e.selectors;
    q.expr[":"] = q.expr.pseudos;
    q.unique = e.uniqueSort;
    q.text = e.getText;
    q.isXMLDoc = e.isXML;
    q.contains = e.contains
  })(d);
  var la = {};
  q.Callbacks = function (e) {
    e = "string" === typeof e ? la[e] ||
      b(e) : q.extend({}, e);
    var f, d, g, h, m, p, l = [], k = !e.once && [], t = function (a) {
      f = e.memory && a;
      d = !0;
      p = h || 0;
      h = 0;
      m = l.length;
      for (g = !0; l && p < m; p++)if (!1 === l[p].apply(a[0], a[1]) && e.stopOnFalse) {
        f = !1;
        break
      }
      g = !1;
      l && (k ? k.length && t(k.shift()) : f ? l = [] : n.disable())
    }, n = {add: function () {
      if (l) {
        var a = l.length;
        (function sb(a) {
          q.each(a, function (a, b) {
            var f = q.type(b);
            "function" === f ? e.unique && n.has(b) || l.push(b) : b && b.length && "string" !== f && sb(b)
          })
        })(arguments);
        g ? m = l.length : f && (h = a, t(f))
      }
      return this
    }, remove: function () {
      l && q.each(arguments,
        function (a, b) {
          for (var e; -1 < (e = q.inArray(b, l, e));)l.splice(e, 1), g && (e <= m && m--, e <= p && p--)
        });
      return this
    }, has: function (a) {
      return a ? -1 < q.inArray(a, l) : !(!l || !l.length)
    }, empty: function () {
      l = [];
      m = 0;
      return this
    }, disable: function () {
      l = k = f = a;
      return this
    }, disabled: function () {
      return!l
    }, lock: function () {
      k = a;
      f || n.disable();
      return this
    }, locked: function () {
      return!k
    }, fireWith: function (a, b) {
      !l || d && !k || (b = b || [], b = [a, b.slice ? b.slice() : b], g ? k.push(b) : t(b));
      return this
    }, fire: function () {
      n.fireWith(this, arguments);
      return this
    },
      fired: function () {
        return!!d
      }};
    return n
  };
  q.extend({Deferred: function (a) {
    var b = [
      ["resolve", "done", q.Callbacks("once memory"), "resolved"],
      ["reject", "fail", q.Callbacks("once memory"), "rejected"],
      ["notify", "progress", q.Callbacks("memory")]
    ], e = "pending", f = {state: function () {
      return e
    }, always: function () {
      d.done(arguments).fail(arguments);
      return this
    }, then: function () {
      var a = arguments;
      return q.Deferred(function (e) {
        q.each(b, function (b, g) {
          var h = g[0], m = q.isFunction(a[b]) && a[b];
          d[g[1]](function () {
            var a = m && m.apply(this,
              arguments);
            if (a && q.isFunction(a.promise))a.promise().done(e.resolve).fail(e.reject).progress(e.notify); else e[h + "With"](this === f ? e.promise() : this, m ? [a] : arguments)
          })
        });
        a = null
      }).promise()
    }, promise: function (a) {
      return null != a ? q.extend(a, f) : f
    }}, d = {};
    f.pipe = f.then;
    q.each(b, function (a, g) {
      var h = g[2], m = g[3];
      f[g[1]] = h.add;
      m && h.add(function () {
        e = m
      }, b[a ^ 1][2].disable, b[2][2].lock);
      d[g[0]] = function () {
        d[g[0] + "With"](this === d ? f : this, arguments);
        return this
      };
      d[g[0] + "With"] = h.fireWith
    });
    f.promise(d);
    a && a.call(d, d);
    return d
  }, when: function (a) {
    var b = 0, e = U.call(arguments), f = e.length, d = 1 !== f || a && q.isFunction(a.promise) ? f : 0, g = 1 === d ? a : q.Deferred(), h = function (a, b, e) {
      return function (f) {
        b[a] = this;
        e[a] = 1 < arguments.length ? U.call(arguments) : f;
        e === m ? g.notifyWith(b, e) : --d || g.resolveWith(b, e)
      }
    }, m, p, l;
    if (1 < f)for (m = Array(f), p = Array(f), l = Array(f); b < f; b++)e[b] && q.isFunction(e[b].promise) ? e[b].promise().done(h(b, l, e)).fail(g.reject).progress(h(b, p, m)) : --d;
    d || g.resolveWith(l, e);
    return g.promise()
  }});
  q.support = function (a) {
    var b =
      O.createElement("input"), e = O.createDocumentFragment(), f = O.createElement("div"), g = O.createElement("select"), h = g.appendChild(O.createElement("option"));
    if (!b.type)return a;
    b.type = "checkbox";
    a.checkOn = "" !== b.value;
    a.optSelected = h.selected;
    a.reliableMarginRight = !0;
    a.boxSizingReliable = !0;
    a.pixelPosition = !1;
    b.checked = !0;
    a.noCloneChecked = b.cloneNode(!0).checked;
    g.disabled = !0;
    a.optDisabled = !h.disabled;
    b = O.createElement("input");
    b.value = "t";
    b.type = "radio";
    a.radioValue = "t" === b.value;
    b.setAttribute("checked",
      "t");
    b.setAttribute("name", "t");
    e.appendChild(b);
    a.checkClone = e.cloneNode(!0).cloneNode(!0).lastChild.checked;
    a.focusinBubbles = "onfocusin"in d;
    f.style.backgroundClip = "content-box";
    f.cloneNode(!0).style.backgroundClip = "";
    a.clearCloneStyle = "content-box" === f.style.backgroundClip;
    q(function () {
      var b, e, g = O.getElementsByTagName("body")[0];
      g && (b = O.createElement("div"), b.style.cssText = "border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px", g.appendChild(b).appendChild(f), f.innerHTML =
        "", f.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%", q.swap(g, null != g.style.zoom ? {zoom: 1} : {}, function () {
        a.boxSizing = 4 === f.offsetWidth
      }), d.getComputedStyle && (a.pixelPosition = "1%" !== (d.getComputedStyle(f, null) || {}).top, a.boxSizingReliable = "4px" === (d.getComputedStyle(f, null) || {width: "4px"}).width, e = f.appendChild(O.createElement("div")), e.style.cssText = f.style.cssText = "padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",
        e.style.marginRight = e.style.width = "0", f.style.width = "1px", a.reliableMarginRight = !parseFloat((d.getComputedStyle(e, null) || {}).marginRight)), g.removeChild(b))
    });
    return a
  }({});
  var X, P, Ka = /(?:\{[\s\S]*\}|\[[\s\S]*\])$/, ya = /([A-Z])/g;
  e.uid = 1;
  e.accepts = function (a) {
    return a.nodeType ? 1 === a.nodeType || 9 === a.nodeType : !0
  };
  e.prototype = {key: function (a) {
    if (!e.accepts(a))return 0;
    var b = {}, f = a[this.expando];
    if (!f) {
      f = e.uid++;
      try {
        b[this.expando] = {value: f}, Object.defineProperties(a, b)
      } catch (d) {
        b[this.expando] = f, q.extend(a,
          b)
      }
    }
    this.cache[f] || (this.cache[f] = {});
    return f
  }, set: function (a, b, e) {
    var f;
    a = this.key(a);
    var d = this.cache[a];
    if ("string" === typeof b)d[b] = e; else if (q.isEmptyObject(d))q.extend(this.cache[a], b); else for (f in b)d[f] = b[f];
    return d
  }, get: function (b, e) {
    var f = this.cache[this.key(b)];
    return e === a ? f : f[e]
  }, access: function (b, e, f) {
    if (e === a || e && "string" === typeof e && f === a)return f = this.get(b, e), f !== a ? f : this.get(b, q.camelCase(e));
    this.set(b, e, f);
    return f !== a ? f : e
  }, remove: function (b, e) {
    var f, d;
    f = this.key(b);
    var g = this.cache[f];
    if (e === a)this.cache[f] = {}; else for (q.isArray(e) ? d = e.concat(e.map(q.camelCase)) : (f = q.camelCase(e), e in g ? d = [e, f] : (d = f, d = d in g ? [d] : d.match(ca) || [])), f = d.length; f--;)delete g[d[f]]
  }, hasData: function (a) {
    return!q.isEmptyObject(this.cache[a[this.expando]] || {})
  }, discard: function (a) {
    a[this.expando] && delete this.cache[a[this.expando]]
  }};
  X = new e;
  P = new e;
  q.extend({acceptData: e.accepts, hasData: function (a) {
    return X.hasData(a) || P.hasData(a)
  }, data: function (a, b, e) {
    return X.access(a, b, e)
  }, removeData: function (a, b) {
    X.remove(a,
      b)
  }, _data: function (a, b, e) {
    return P.access(a, b, e)
  }, _removeData: function (a, b) {
    P.remove(a, b)
  }});
  q.fn.extend({data: function (b, e) {
    var f, d, h = this[0], m = 0, p = null;
    if (b === a) {
      if (this.length && (p = X.get(h), 1 === h.nodeType && !P.get(h, "hasDataAttrs"))) {
        for (f = h.attributes; m < f.length; m++)d = f[m].name, 0 === d.indexOf("data-") && (d = q.camelCase(d.slice(5)), g(h, d, p[d]));
        P.set(h, "hasDataAttrs", !0)
      }
      return p
    }
    return"object" === typeof b ? this.each(function () {
      X.set(this, b)
    }) : q.access(this, function (e) {
      var f, d = q.camelCase(b);
      if (h && e ===
        a) {
        f = X.get(h, b);
        if (f !== a)return f;
        f = X.get(h, d);
        if (f !== a)return f;
        f = g(h, d, a);
        if (f !== a)return f
      } else this.each(function () {
        var f = X.get(this, d);
        X.set(this, d, e);
        -1 !== b.indexOf("-") && f !== a && X.set(this, b, e)
      })
    }, null, e, 1 < arguments.length, null, !0)
  }, removeData: function (a) {
    return this.each(function () {
      X.remove(this, a)
    })
  }});
  q.extend({queue: function (a, b, e) {
    var f;
    if (a)return b = (b || "fx") + "queue", f = P.get(a, b), e && (!f || q.isArray(e) ? f = P.access(a, b, q.makeArray(e)) : f.push(e)), f || []
  }, dequeue: function (a, b) {
    b = b || "fx";
    var e =
      q.queue(a, b), f = e.length, d = e.shift(), g = q._queueHooks(a, b), h = function () {
      q.dequeue(a, b)
    };
    "inprogress" === d && (d = e.shift(), f--);
    d && ("fx" === b && e.unshift("inprogress"), delete g.stop, d.call(a, h, g));
    !f && g && g.empty.fire()
  }, _queueHooks: function (a, b) {
    var e = b + "queueHooks";
    return P.get(a, e) || P.access(a, e, {empty: q.Callbacks("once memory").add(function () {
      P.remove(a, [b + "queue", e])
    })})
  }});
  q.fn.extend({queue: function (b, e) {
    var f = 2;
    "string" !== typeof b && (e = b, b = "fx", f--);
    return arguments.length < f ? q.queue(this[0], b) : e ===
      a ? this : this.each(function () {
      var a = q.queue(this, b, e);
      q._queueHooks(this, b);
      "fx" === b && "inprogress" !== a[0] && q.dequeue(this, b)
    })
  }, dequeue: function (a) {
    return this.each(function () {
      q.dequeue(this, a)
    })
  }, delay: function (a, b) {
    a = q.fx ? q.fx.speeds[a] || a : a;
    return this.queue(b || "fx", function (b, e) {
      var f = setTimeout(b, a);
      e.stop = function () {
        clearTimeout(f)
      }
    })
  }, clearQueue: function (a) {
    return this.queue(a || "fx", [])
  }, promise: function (b, e) {
    var f, d = 1, g = q.Deferred(), h = this, m = this.length, p = function () {
      --d || g.resolveWith(h, [h])
    };
    "string" !== typeof b && (e = b, b = a);
    for (b = b || "fx"; m--;)(f = P.get(h[m], b + "queueHooks")) && f.empty && (d++, f.empty.add(p));
    p();
    return g.promise(e)
  }});
  var Fa, Ma = /[\t\r\n\f]/g, Za = /\r/g, ma = /^(?:input|select|textarea|button)$/i;
  q.fn.extend({attr: function (a, b) {
    return q.access(this, q.attr, a, b, 1 < arguments.length)
  }, removeAttr: function (a) {
    return this.each(function () {
      q.removeAttr(this, a)
    })
  }, prop: function (a, b) {
    return q.access(this, q.prop, a, b, 1 < arguments.length)
  }, removeProp: function (a) {
    return this.each(function () {
      delete this[q.propFix[a] ||
        a]
    })
  }, addClass: function (a) {
    var b, e, f, d, g, h = 0, m = this.length;
    b = "string" === typeof a && a;
    if (q.isFunction(a))return this.each(function (b) {
      q(this).addClass(a.call(this, b, this.className))
    });
    if (b)for (b = (a || "").match(ca) || []; h < m; h++)if (e = this[h], f = 1 === e.nodeType && (e.className ? (" " + e.className + " ").replace(Ma, " ") : " ")) {
      for (g = 0; d = b[g++];)0 > f.indexOf(" " + d + " ") && (f += d + " ");
      e.className = q.trim(f)
    }
    return this
  }, removeClass: function (a) {
    var b, e, f, d, g, h = 0, m = this.length;
    b = 0 === arguments.length || "string" === typeof a && a;
    if (q.isFunction(a))return this.each(function (b) {
      q(this).removeClass(a.call(this, b, this.className))
    });
    if (b)for (b = (a || "").match(ca) || []; h < m; h++)if (e = this[h], f = 1 === e.nodeType && (e.className ? (" " + e.className + " ").replace(Ma, " ") : "")) {
      for (g = 0; d = b[g++];)for (; 0 <= f.indexOf(" " + d + " ");)f = f.replace(" " + d + " ", " ");
      e.className = a ? q.trim(f) : ""
    }
    return this
  }, toggleClass: function (a, b) {
    var e = typeof a;
    return"boolean" === typeof b && "string" === e ? b ? this.addClass(a) : this.removeClass(a) : q.isFunction(a) ? this.each(function (e) {
      q(this).toggleClass(a.call(this,
        e, this.className, b), b)
    }) : this.each(function () {
      if ("string" === e)for (var b, f = 0, d = q(this), g = a.match(ca) || []; b = g[f++];)d.hasClass(b) ? d.removeClass(b) : d.addClass(b); else if (e === da || "boolean" === e)this.className && P.set(this, "__className__", this.className), this.className = this.className || !1 === a ? "" : P.get(this, "__className__") || ""
    })
  }, hasClass: function (a) {
    a = " " + a + " ";
    for (var b = 0, e = this.length; b < e; b++)if (1 === this[b].nodeType && 0 <= (" " + this[b].className + " ").replace(Ma, " ").indexOf(a))return!0;
    return!1
  }, val: function (b) {
    var e,
      f, d, g = this[0];
    if (arguments.length)return d = q.isFunction(b), this.each(function (f) {
      1 === this.nodeType && (f = d ? b.call(this, f, q(this).val()) : b, null == f ? f = "" : "number" === typeof f ? f += "" : q.isArray(f) && (f = q.map(f, function (a) {
        return null == a ? "" : a + ""
      })), e = q.valHooks[this.type] || q.valHooks[this.nodeName.toLowerCase()], e && "set"in e && e.set(this, f, "value") !== a || (this.value = f))
    });
    if (g) {
      if ((e = q.valHooks[g.type] || q.valHooks[g.nodeName.toLowerCase()]) && "get"in e && (f = e.get(g, "value")) !== a)return f;
      f = g.value;
      return"string" === typeof f ? f.replace(Za, "") : null == f ? "" : f
    }
  }});
  q.extend({valHooks: {option: {get: function (a) {
    var b = a.attributes.value;
    return!b || b.specified ? a.value : a.text
  }}, select: {get: function (a) {
    for (var b, e = a.options, f = a.selectedIndex, d = (a = "select-one" === a.type || 0 > f) ? null : [], g = a ? f + 1 : e.length, h = 0 > f ? g : a ? f : 0; h < g; h++)if (b = e[h], !(!b.selected && h !== f || (q.support.optDisabled ? b.disabled : null !== b.getAttribute("disabled")) || b.parentNode.disabled && q.nodeName(b.parentNode, "optgroup"))) {
      b = q(b).val();
      if (a)return b;
      d.push(b)
    }
    return d
  },
    set: function (a, b) {
      for (var e, f, d = a.options, g = q.makeArray(b), h = d.length; h--;)if (f = d[h], f.selected = 0 <= q.inArray(q(f).val(), g))e = !0;
      e || (a.selectedIndex = -1);
      return g
    }}}, attr: function (b, e, f) {
    var d, g, h = b.nodeType;
    if (b && 3 !== h && 8 !== h && 2 !== h) {
      if (typeof b.getAttribute === da)return q.prop(b, e, f);
      1 === h && q.isXMLDoc(b) || (e = e.toLowerCase(), d = q.attrHooks[e] || (q.expr.match.bool.test(e) ? Fa : void 0));
      if (f !== a)if (null === f)q.removeAttr(b, e); else {
        if (d && "set"in d && (g = d.set(b, f, e)) !== a)return g;
        b.setAttribute(e, f + "");
        return f
      } else {
        if (d &&
          "get"in d && null !== (g = d.get(b, e)))return g;
        g = q.find.attr(b, e);
        return null == g ? a : g
      }
    }
  }, removeAttr: function (a, b) {
    var e, f, d = 0, g = b && b.match(ca);
    if (g && 1 === a.nodeType)for (; e = g[d++];)f = q.propFix[e] || e, q.expr.match.bool.test(e) && (a[f] = !1), a.removeAttribute(e)
  }, attrHooks: {type: {set: function (a, b) {
    if (!q.support.radioValue && "radio" === b && q.nodeName(a, "input")) {
      var e = a.value;
      a.setAttribute("type", b);
      e && (a.value = e);
      return b
    }
  }}}, propFix: {"for": "htmlFor", "class": "className"}, prop: function (b, e, f) {
    var d, g, h;
    h = b.nodeType;
    if (b && 3 !== h && 8 !== h && 2 !== h) {
      if (h = 1 !== h || !q.isXMLDoc(b))e = q.propFix[e] || e, g = q.propHooks[e];
      return f !== a ? g && "set"in g && (d = g.set(b, f, e)) !== a ? d : b[e] = f : g && "get"in g && null !== (d = g.get(b, e)) ? d : b[e]
    }
  }, propHooks: {tabIndex: {get: function (a) {
    return a.hasAttribute("tabindex") || ma.test(a.nodeName) || a.href ? a.tabIndex : -1
  }}}});
  Fa = {set: function (a, b, e) {
    !1 === b ? q.removeAttr(a, e) : a.setAttribute(e, e);
    return e
  }};
  q.each(q.expr.match.bool.source.match(/\w+/g), function (b, e) {
    var f = q.expr.attrHandle[e] || q.find.attr;
    q.expr.attrHandle[e] =
      function (b, e, d) {
        var g = q.expr.attrHandle[e];
        b = d ? a : (q.expr.attrHandle[e] = a) != f(b, e, d) ? e.toLowerCase() : null;
        q.expr.attrHandle[e] = g;
        return b
      }
  });
  q.support.optSelected || (q.propHooks.selected = {get: function (a) {
    (a = a.parentNode) && a.parentNode && a.parentNode.selectedIndex;
    return null
  }});
  q.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "), function () {
    q.propFix[this.toLowerCase()] = this
  });
  q.each(["radio", "checkbox"], function () {
    q.valHooks[this] =
    {set: function (a, b) {
      if (q.isArray(b))return a.checked = 0 <= q.inArray(q(a).val(), b)
    }};
    q.support.checkOn || (q.valHooks[this].get = function (a) {
      return null === a.getAttribute("value") ? "on" : a.value
    })
  });
  var Ga = /^key/, $a = /^(?:mouse|contextmenu)|click/, Ha = /^(?:focusinfocus|focusoutblur)$/, Ia = /^([^.]*)(?:\.(.+)|)$/;
  q.event = {global: {}, add: function (b, e, f, d, g) {
    var h, m, p, l, k, t, n, r, s;
    if (k = P.get(b)) {
      f.handler && (h = f, f = h.handler, g = h.selector);
      f.guid || (f.guid = q.guid++);
      (l = k.events) || (l = k.events = {});
      (m = k.handle) || (m = k.handle =
        function (b) {
          return typeof q === da || b && q.event.triggered === b.type ? a : q.event.dispatch.apply(m.elem, arguments)
        }, m.elem = b);
      e = (e || "").match(ca) || [""];
      for (k = e.length; k--;)p = Ia.exec(e[k]) || [], r = t = p[1], s = (p[2] || "").split(".").sort(), r && (p = q.event.special[r] || {}, r = (g ? p.delegateType : p.bindType) || r, p = q.event.special[r] || {}, t = q.extend({type: r, origType: t, data: d, handler: f, guid: f.guid, selector: g, needsContext: g && q.expr.match.needsContext.test(g), namespace: s.join(".")}, h), (n = l[r]) || (n = l[r] = [], n.delegateCount = 0, p.setup &&
        !1 !== p.setup.call(b, d, s, m) || b.addEventListener && b.addEventListener(r, m, !1)), p.add && (p.add.call(b, t), t.handler.guid || (t.handler.guid = f.guid)), g ? n.splice(n.delegateCount++, 0, t) : n.push(t), q.event.global[r] = !0);
      b = null
    }
  }, remove: function (a, b, e, f, d) {
    var g, h, m, p, l, k, t, n, r, s, v, B = P.hasData(a) && P.get(a);
    if (B && (p = B.events)) {
      b = (b || "").match(ca) || [""];
      for (l = b.length; l--;)if (m = Ia.exec(b[l]) || [], r = v = m[1], s = (m[2] || "").split(".").sort(), r) {
        t = q.event.special[r] || {};
        r = (f ? t.delegateType : t.bindType) || r;
        n = p[r] || [];
        m = m[2] &&
          RegExp("(^|\\.)" + s.join("\\.(?:.*\\.|)") + "(\\.|$)");
        for (h = g = n.length; g--;)k = n[g], !d && v !== k.origType || e && e.guid !== k.guid || m && !m.test(k.namespace) || f && !(f === k.selector || "**" === f && k.selector) || (n.splice(g, 1), k.selector && n.delegateCount--, t.remove && t.remove.call(a, k));
        h && !n.length && (t.teardown && !1 !== t.teardown.call(a, s, B.handle) || q.removeEvent(a, r, B.handle), delete p[r])
      } else for (r in p)q.event.remove(a, r + b[l], e, f, !0);
      q.isEmptyObject(p) && (delete B.handle, P.remove(a, "events"))
    }
  }, trigger: function (b, e, f, g) {
    var h, m, p, l, k, t, n = [f || O], r = pa.call(b, "type") ? b.type : b;
    t = pa.call(b, "namespace") ? b.namespace.split(".") : [];
    m = h = f = f || O;
    if (3 !== f.nodeType && 8 !== f.nodeType && !Ha.test(r + q.event.triggered) && (0 <= r.indexOf(".") && (t = r.split("."), r = t.shift(), t.sort()), l = 0 > r.indexOf(":") && "on" + r, b = b[q.expando] ? b : new q.Event(r, "object" === typeof b && b), b.isTrigger = g ? 2 : 3, b.namespace = t.join("."), b.namespace_re = b.namespace ? RegExp("(^|\\.)" + t.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, b.result = a, b.target || (b.target = f), e = null == e ? [b] : q.makeArray(e,
      [b]), t = q.event.special[r] || {}, g || !t.trigger || !1 !== t.trigger.apply(f, e))) {
      if (!g && !t.noBubble && !q.isWindow(f)) {
        p = t.delegateType || r;
        Ha.test(p + r) || (m = m.parentNode);
        for (; m; m = m.parentNode)n.push(m), h = m;
        h === (f.ownerDocument || O) && n.push(h.defaultView || h.parentWindow || d)
      }
      for (h = 0; (m = n[h++]) && !b.isPropagationStopped();)b.type = 1 < h ? p : t.bindType || r, (k = (P.get(m, "events") || {})[b.type] && P.get(m, "handle")) && k.apply(m, e), (k = l && m[l]) && q.acceptData(m) && k.apply && !1 === k.apply(m, e) && b.preventDefault();
      b.type = r;
      g || b.isDefaultPrevented() ||
        t._default && !1 !== t._default.apply(n.pop(), e) || !q.acceptData(f) || !l || !q.isFunction(f[r]) || q.isWindow(f) || ((h = f[l]) && (f[l] = null), q.event.triggered = r, f[r](), q.event.triggered = a, h && (f[l] = h));
      return b.result
    }
  }, dispatch: function (b) {
    b = q.event.fix(b);
    var e, f, d, g, h = [], m = U.call(arguments);
    e = (P.get(this, "events") || {})[b.type] || [];
    var p = q.event.special[b.type] || {};
    m[0] = b;
    b.delegateTarget = this;
    if (!p.preDispatch || !1 !== p.preDispatch.call(this, b)) {
      h = q.event.handlers.call(this, b, e);
      for (e = 0; (g = h[e++]) && !b.isPropagationStopped();)for (b.currentTarget =
                                                                    g.elem, f = 0; (d = g.handlers[f++]) && !b.isImmediatePropagationStopped();)if (!b.namespace_re || b.namespace_re.test(d.namespace))b.handleObj = d, b.data = d.data, d = ((q.event.special[d.origType] || {}).handle || d.handler).apply(g.elem, m), d !== a && !1 === (b.result = d) && (b.preventDefault(), b.stopPropagation());
      p.postDispatch && p.postDispatch.call(this, b);
      return b.result
    }
  }, handlers: function (b, e) {
    var f, d, g, h, m = [], p = e.delegateCount, l = b.target;
    if (p && l.nodeType && (!b.button || "click" !== b.type))for (; l !== this; l = l.parentNode || this)if (!0 !==
      l.disabled || "click" !== b.type) {
      d = [];
      for (f = 0; f < p; f++)h = e[f], g = h.selector + " ", d[g] === a && (d[g] = h.needsContext ? 0 <= q(g, this).index(l) : q.find(g, this, null, [l]).length), d[g] && d.push(h);
      d.length && m.push({elem: l, handlers: d})
    }
    p < e.length && m.push({elem: this, handlers: e.slice(p)});
    return m
  }, props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "), fixHooks: {}, keyHooks: {props: ["char", "charCode", "key", "keyCode"], filter: function (a, b) {
    null ==
      a.which && (a.which = null != b.charCode ? b.charCode : b.keyCode);
    return a
  }}, mouseHooks: {props: "button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "), filter: function (b, e) {
    var f, d, g = e.button;
    null == b.pageX && null != e.clientX && (f = b.target.ownerDocument || O, d = f.documentElement, f = f.body, b.pageX = e.clientX + (d && d.scrollLeft || f && f.scrollLeft || 0) - (d && d.clientLeft || f && f.clientLeft || 0), b.pageY = e.clientY + (d && d.scrollTop || f && f.scrollTop || 0) - (d && d.clientTop || f && f.clientTop || 0));
    b.which ||
      g === a || (b.which = g & 1 ? 1 : g & 2 ? 3 : g & 4 ? 2 : 0);
    return b
  }}, fix: function (a) {
    if (a[q.expando])return a;
    var b, e, f;
    b = a.type;
    var d = a, g = this.fixHooks[b];
    g || (this.fixHooks[b] = g = $a.test(b) ? this.mouseHooks : Ga.test(b) ? this.keyHooks : {});
    f = g.props ? this.props.concat(g.props) : this.props;
    a = new q.Event(d);
    for (b = f.length; b--;)e = f[b], a[e] = d[e];
    a.target || (a.target = O);
    3 === a.target.nodeType && (a.target = a.target.parentNode);
    return g.filter ? g.filter(a, d) : a
  }, special: {load: {noBubble: !0}, focus: {trigger: function () {
    if (this !== l() && this.focus)return this.focus(),
      !1
  }, delegateType: "focusin"}, blur: {trigger: function () {
    if (this === l() && this.blur)return this.blur(), !1
  }, delegateType: "focusout"}, click: {trigger: function () {
    if ("checkbox" === this.type && this.click && q.nodeName(this, "input"))return this.click(), !1
  }, _default: function (a) {
    return q.nodeName(a.target, "a")
  }}, beforeunload: {postDispatch: function (b) {
    b.result !== a && (b.originalEvent.returnValue = b.result)
  }}}, simulate: function (a, b, e, f) {
    a = q.extend(new q.Event, e, {type: a, isSimulated: !0, originalEvent: {}});
    f ? q.event.trigger(a,
      null, b) : q.event.dispatch.call(b, a);
    a.isDefaultPrevented() && e.preventDefault()
  }};
  q.removeEvent = function (a, b, e) {
    a.removeEventListener && a.removeEventListener(b, e, !1)
  };
  q.Event = function (a, b) {
    if (!(this instanceof q.Event))return new q.Event(a, b);
    a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || a.getPreventDefault && a.getPreventDefault() ? k : h) : this.type = a;
    b && q.extend(this, b);
    this.timeStamp = a && a.timeStamp || q.now();
    this[q.expando] = !0
  };
  q.Event.prototype = {isDefaultPrevented: h,
    isPropagationStopped: h, isImmediatePropagationStopped: h, preventDefault: function () {
      var a = this.originalEvent;
      this.isDefaultPrevented = k;
      a && a.preventDefault && a.preventDefault()
    }, stopPropagation: function () {
      var a = this.originalEvent;
      this.isPropagationStopped = k;
      a && a.stopPropagation && a.stopPropagation()
    }, stopImmediatePropagation: function () {
      this.isImmediatePropagationStopped = k;
      this.stopPropagation()
    }};
  q.each({mouseenter: "mouseover", mouseleave: "mouseout"}, function (a, b) {
    q.event.special[a] = {delegateType: b, bindType: b,
      handle: function (a) {
        var e, f = a.relatedTarget, d = a.handleObj;
        if (!f || f !== this && !q.contains(this, f))a.type = d.origType, e = d.handler.apply(this, arguments), a.type = b;
        return e
      }}
  });
  q.support.focusinBubbles || q.each({focus: "focusin", blur: "focusout"}, function (a, b) {
    var e = 0, f = function (a) {
      q.event.simulate(b, a.target, q.event.fix(a), !0)
    };
    q.event.special[b] = {setup: function () {
      0 === e++ && O.addEventListener(a, f, !0)
    }, teardown: function () {
      0 === --e && O.removeEventListener(a, f, !0)
    }}
  });
  q.fn.extend({on: function (b, e, f, d, g) {
    var m, p;
    if ("object" === typeof b) {
      "string" !== typeof e && (f = f || e, e = a);
      for (p in b)this.on(p, e, f, b[p], g);
      return this
    }
    null == f && null == d ? (d = e, f = e = a) : null == d && ("string" === typeof e ? (d = f, f = a) : (d = f, f = e, e = a));
    if (!1 === d)d = h; else if (!d)return this;
    1 === g && (m = d, d = function (a) {
      q().off(a);
      return m.apply(this, arguments)
    }, d.guid = m.guid || (m.guid = q.guid++));
    return this.each(function () {
      q.event.add(this, b, d, f, e)
    })
  }, one: function (a, b, e, f) {
    return this.on(a, b, e, f, 1)
  }, off: function (b, e, f) {
    var d;
    if (b && b.preventDefault && b.handleObj)return d = b.handleObj,
      q(b.delegateTarget).off(d.namespace ? d.origType + "." + d.namespace : d.origType, d.selector, d.handler), this;
    if ("object" === typeof b) {
      for (d in b)this.off(d, e, b[d]);
      return this
    }
    if (!1 === e || "function" === typeof e)f = e, e = a;
    !1 === f && (f = h);
    return this.each(function () {
      q.event.remove(this, b, f, e)
    })
  }, trigger: function (a, b) {
    return this.each(function () {
      q.event.trigger(a, b, this)
    })
  }, triggerHandler: function (a, b) {
    var e = this[0];
    if (e)return q.event.trigger(a, b, e, !0)
  }});
  var Va = /^.[^:#\[\.,]*$/, ab = /^(?:parents|prev(?:Until|All))/,
    Ja = q.expr.match.needsContext, Sa = {children: !0, contents: !0, next: !0, prev: !0};
  q.fn.extend({find: function (a) {
    var b, e = [], f = this, d = f.length;
    if ("string" !== typeof a)return this.pushStack(q(a).filter(function () {
      for (b = 0; b < d; b++)if (q.contains(f[b], this))return!0
    }));
    for (b = 0; b < d; b++)q.find(a, f[b], e);
    e = this.pushStack(1 < d ? q.unique(e) : e);
    e.selector = this.selector ? this.selector + " " + a : a;
    return e
  }, has: function (a) {
    var b = q(a, this), e = b.length;
    return this.filter(function () {
      for (var a = 0; a < e; a++)if (q.contains(this, b[a]))return!0
    })
  },
    not: function (a) {
      return this.pushStack(m(this, a || [], !0))
    }, filter: function (a) {
      return this.pushStack(m(this, a || [], !1))
    }, is: function (a) {
      return!!m(this, "string" === typeof a && Ja.test(a) ? q(a) : a || [], !1).length
    }, closest: function (a, b) {
      for (var e, f = 0, d = this.length, g = [], h = Ja.test(a) || "string" !== typeof a ? q(a, b || this.context) : 0; f < d; f++)for (e = this[f]; e && e !== b; e = e.parentNode)if (11 > e.nodeType && (h ? -1 < h.index(e) : 1 === e.nodeType && q.find.matchesSelector(e, a))) {
        g.push(e);
        break
      }
      return this.pushStack(1 < g.length ? q.unique(g) :
        g)
    }, index: function (a) {
      return a ? "string" === typeof a ? W.call(q(a), this[0]) : W.call(this, a.jquery ? a[0] : a) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1
    }, add: function (a, b) {
      var e = "string" === typeof a ? q(a, b) : q.makeArray(a && a.nodeType ? [a] : a), e = q.merge(this.get(), e);
      return this.pushStack(q.unique(e))
    }, addBack: function (a) {
      return this.add(null == a ? this.prevObject : this.prevObject.filter(a))
    }});
  q.each({parent: function (a) {
    return(a = a.parentNode) && 11 !== a.nodeType ? a : null
  }, parents: function (a) {
    return q.dir(a,
      "parentNode")
  }, parentsUntil: function (a, b, e) {
    return q.dir(a, "parentNode", e)
  }, next: function (a) {
    return n(a, "nextSibling")
  }, prev: function (a) {
    return n(a, "previousSibling")
  }, nextAll: function (a) {
    return q.dir(a, "nextSibling")
  }, prevAll: function (a) {
    return q.dir(a, "previousSibling")
  }, nextUntil: function (a, b, e) {
    return q.dir(a, "nextSibling", e)
  }, prevUntil: function (a, b, e) {
    return q.dir(a, "previousSibling", e)
  }, siblings: function (a) {
    return q.sibling((a.parentNode || {}).firstChild, a)
  }, children: function (a) {
    return q.sibling(a.firstChild)
  },
    contents: function (a) {
      return a.contentDocument || q.merge([], a.childNodes)
    }}, function (a, b) {
    q.fn[a] = function (e, f) {
      var d = q.map(this, b, e);
      "Until" !== a.slice(-5) && (f = e);
      f && "string" === typeof f && (d = q.filter(f, d));
      1 < this.length && (Sa[a] || q.unique(d), ab.test(a) && d.reverse());
      return this.pushStack(d)
    }
  });
  q.extend({filter: function (a, b, e) {
    var f = b[0];
    e && (a = ":not(" + a + ")");
    return 1 === b.length && 1 === f.nodeType ? q.find.matchesSelector(f, a) ? [f] : [] : q.find.matches(a, q.grep(b, function (a) {
      return 1 === a.nodeType
    }))
  }, dir: function (b, e, f) {
    for (var d = [], g = f !== a; (b = b[e]) && 9 !== b.nodeType;)if (1 === b.nodeType) {
      if (g && q(b).is(f))break;
      d.push(b)
    }
    return d
  }, sibling: function (a, b) {
    for (var e = []; a; a = a.nextSibling)1 === a.nodeType && a !== b && e.push(a);
    return e
  }});
  var Na = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi, na = /<([\w:]+)/, Ta = /<|&#?\w+;/, V = /<(?:script|style|link)/i, oa = /^(?:checkbox|radio)$/i, Oa = /checked\s*(?:[^=]|=\s*.checked.)/i, qa = /^$|\/(?:java|ecma)script/i, Wa = /^true\/(.*)/, va = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
    ia = {option: [1, "<select multiple='multiple'>", "</select>"], thead: [1, "<table>", "</table>"], col: [2, "<table><colgroup>", "</colgroup></table>"], tr: [2, "<table><tbody>", "</tbody></table>"], td: [3, "<table><tbody><tr>", "</tr></tbody></table>"], _default: [0, "", ""]};
  ia.optgroup = ia.option;
  ia.tbody = ia.tfoot = ia.colgroup = ia.caption = ia.thead;
  ia.th = ia.td;
  q.fn.extend({text: function (b) {
    return q.access(this, function (b) {
        return b === a ? q.text(this) : this.empty().append((this[0] && this[0].ownerDocument || O).createTextNode(b))
      },
      null, b, arguments.length)
  }, append: function () {
    return this.domManip(arguments, function (a) {
      1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType || s(this, a).appendChild(a)
    })
  }, prepend: function () {
    return this.domManip(arguments, function (a) {
      if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
        var b = s(this, a);
        b.insertBefore(a, b.firstChild)
      }
    })
  }, before: function () {
    return this.domManip(arguments, function (a) {
      this.parentNode && this.parentNode.insertBefore(a, this)
    })
  }, after: function () {
    return this.domManip(arguments,
      function (a) {
        this.parentNode && this.parentNode.insertBefore(a, this.nextSibling)
      })
  }, remove: function (a, b) {
    for (var e, f = a ? q.filter(a, this) : this, d = 0; null != (e = f[d]); d++)b || 1 !== e.nodeType || q.cleanData(x(e)), e.parentNode && (b && q.contains(e.ownerDocument, e) && v(x(e, "script")), e.parentNode.removeChild(e));
    return this
  }, empty: function () {
    for (var a, b = 0; null != (a = this[b]); b++)1 === a.nodeType && (q.cleanData(x(a, !1)), a.textContent = "");
    return this
  }, clone: function (a, b) {
    a = null == a ? !1 : a;
    b = null == b ? a : b;
    return this.map(function () {
      return q.clone(this,
        a, b)
    })
  }, html: function (b) {
    return q.access(this, function (b) {
      var e = this[0] || {}, f = 0, d = this.length;
      if (b === a && 1 === e.nodeType)return e.innerHTML;
      if ("string" === typeof b && !V.test(b) && !ia[(na.exec(b) || ["", ""])[1].toLowerCase()]) {
        b = b.replace(Na, "<$1></$2>");
        try {
          for (; f < d; f++)e = this[f] || {}, 1 === e.nodeType && (q.cleanData(x(e, !1)), e.innerHTML = b);
          e = 0
        } catch (g) {
        }
      }
      e && this.empty().append(b)
    }, null, b, arguments.length)
  }, replaceWith: function () {
    var a = q.map(this, function (a) {
      return[a.nextSibling, a.parentNode]
    }), b = 0;
    this.domManip(arguments,
      function (e) {
        var f = a[b++], d = a[b++];
        d && (f && f.parentNode !== d && (f = this.nextSibling), q(this).remove(), d.insertBefore(e, f))
      }, !0);
    return b ? this : this.remove()
  }, detach: function (a) {
    return this.remove(a, !0)
  }, domManip: function (a, b, e) {
    a = aa.apply([], a);
    var f, d, g, h, m = 0, p = this.length, l = this, k = p - 1, n = a[0], s = q.isFunction(n);
    if (s || !(1 >= p || "string" !== typeof n || q.support.checkClone) && Oa.test(n))return this.each(function (f) {
      var d = l.eq(f);
      s && (a[0] = n.call(this, f, d.html()));
      d.domManip(a, b, e)
    });
    if (p && (f = q.buildFragment(a, this[0].ownerDocument,
      !1, !e && this), d = f.firstChild, 1 === f.childNodes.length && (f = d), d)) {
      d = q.map(x(f, "script"), r);
      for (g = d.length; m < p; m++)h = f, m !== k && (h = q.clone(h, !0, !0), g && q.merge(d, x(h, "script"))), b.call(this[m], h, m);
      if (g)for (f = d[d.length - 1].ownerDocument, q.map(d, t), m = 0; m < g; m++)h = d[m], qa.test(h.type || "") && !P.access(h, "globalEval") && q.contains(f, h) && (h.src ? q._evalUrl(h.src) : q.globalEval(h.textContent.replace(va, "")))
    }
    return this
  }});
  q.each({appendTo: "append", prependTo: "prepend", insertBefore: "before", insertAfter: "after", replaceAll: "replaceWith"},
    function (a, b) {
      q.fn[a] = function (a) {
        for (var e = [], f = q(a), d = f.length - 1, g = 0; g <= d; g++)a = g === d ? this : this.clone(!0), q(f[g])[b](a), fa.apply(e, a.get());
        return this.pushStack(e)
      }
    });
  q.extend({clone: function (a, b, e) {
    var f, d, g, h, m = a.cloneNode(!0), l = q.contains(a.ownerDocument, a);
    if (!(q.support.noCloneChecked || 1 !== a.nodeType && 11 !== a.nodeType || q.isXMLDoc(a)))for (h = x(m), g = x(a), f = 0, d = g.length; f < d; f++) {
      var k = g[f], t = h[f], r = t.nodeName.toLowerCase();
      if ("input" === r && oa.test(k.type))t.checked = k.checked; else if ("input" === r ||
        "textarea" === r)t.defaultValue = k.defaultValue
    }
    if (b)if (e)for (g = g || x(a), h = h || x(m), f = 0, d = g.length; f < d; f++)p(g[f], h[f]); else p(a, m);
    h = x(m, "script");
    0 < h.length && v(h, !l && x(a, "script"));
    return m
  }, buildFragment: function (a, b, e, f) {
    for (var d, g, h, m = 0, p = a.length, l = b.createDocumentFragment(), k = []; m < p; m++)if ((d = a[m]) || 0 === d)if ("object" === q.type(d))q.merge(k, d.nodeType ? [d] : d); else if (Ta.test(d)) {
      g = g || l.appendChild(b.createElement("div"));
      h = (na.exec(d) || ["", ""])[1].toLowerCase();
      h = ia[h] || ia._default;
      g.innerHTML = h[1] +
        d.replace(Na, "<$1></$2>") + h[2];
      for (h = h[0]; h--;)g = g.lastChild;
      q.merge(k, g.childNodes);
      g = l.firstChild;
      g.textContent = ""
    } else k.push(b.createTextNode(d));
    l.textContent = "";
    for (m = 0; d = k[m++];)if (!f || -1 === q.inArray(d, f))if (a = q.contains(d.ownerDocument, d), g = x(l.appendChild(d), "script"), a && v(g), e)for (h = 0; d = g[h++];)qa.test(d.type || "") && e.push(d);
    return l
  }, cleanData: function (b) {
    for (var f, d, g, h, m, p, l = q.event.special, k = 0; (d = b[k]) !== a; k++) {
      if (e.accepts(d) && (m = d[P.expando]) && (f = P.cache[m])) {
        g = Object.keys(f.events ||
        {});
        if (g.length)for (p = 0; (h = g[p]) !== a; p++)l[h] ? q.event.remove(d, h) : q.removeEvent(d, h, f.handle);
        P.cache[m] && delete P.cache[m]
      }
      delete X.cache[d[X.expando]]
    }
  }, _evalUrl: function (a) {
    return q.ajax({url: a, type: "GET", dataType: "script", async: !1, global: !1, "throws": !0})
  }});
  q.fn.extend({wrapAll: function (a) {
    var b;
    if (q.isFunction(a))return this.each(function (b) {
      q(this).wrapAll(a.call(this, b))
    });
    this[0] && (b = q(a, this[0].ownerDocument).eq(0).clone(!0), this[0].parentNode && b.insertBefore(this[0]), b.map(function () {
      for (var a =
        this; a.firstElementChild;)a = a.firstElementChild;
      return a
    }).append(this));
    return this
  }, wrapInner: function (a) {
    return q.isFunction(a) ? this.each(function (b) {
      q(this).wrapInner(a.call(this, b))
    }) : this.each(function () {
      var b = q(this), e = b.contents();
      e.length ? e.wrapAll(a) : b.append(a)
    })
  }, wrap: function (a) {
    var b = q.isFunction(a);
    return this.each(function (e) {
      q(this).wrapAll(b ? a.call(this, e) : a)
    })
  }, unwrap: function () {
    return this.parent().each(function () {
      q.nodeName(this, "body") || q(this).replaceWith(this.childNodes)
    }).end()
  }});
  var ra, ua, tb = /^(none|table(?!-c[ea]).+)/, gb = /^margin/, qb = RegExp("^(" + ta + ")(.*)$", "i"), Xa = RegExp("^(" + ta + ")(?!px)[a-z%]+$", "i"), ub = RegExp("^([+-])=(" + ta + ")", "i"), fb = {BODY: "block"}, vb = {position: "absolute", visibility: "hidden", display: "block"}, hb = {letterSpacing: 0, fontWeight: 400}, za = ["Top", "Right", "Bottom", "Left"], eb = ["Webkit", "O", "Moz", "ms"];
  q.fn.extend({css: function (b, e) {
    return q.access(this, function (b, e, f) {
      var g, h = {}, m = 0;
      if (q.isArray(e)) {
        f = d.getComputedStyle(b, null);
        for (g = e.length; m < g; m++)h[e[m]] = q.css(b,
          e[m], !1, f);
        return h
      }
      return f !== a ? q.style(b, e, f) : q.css(b, e)
    }, b, e, 1 < arguments.length)
  }, show: function () {
    return z(this, !0)
  }, hide: function () {
    return z(this)
  }, toggle: function (a) {
    return"boolean" === typeof a ? a ? this.show() : this.hide() : this.each(function () {
      C(this) ? q(this).show() : q(this).hide()
    })
  }});
  q.extend({cssHooks: {opacity: {get: function (a, b) {
    if (b) {
      var e = ra(a, "opacity");
      return"" === e ? "1" : e
    }
  }}}, cssNumber: {columnCount: !0, fillOpacity: !0, fontWeight: !0, lineHeight: !0, opacity: !0, order: !0, orphans: !0, widows: !0, zIndex: !0,
    zoom: !0}, cssProps: {"float": "cssFloat"}, style: function (b, e, f, d) {
    if (b && 3 !== b.nodeType && 8 !== b.nodeType && b.style) {
      var g, h, m, p = q.camelCase(e), l = b.style;
      e = q.cssProps[p] || (q.cssProps[p] = B(l, p));
      m = q.cssHooks[e] || q.cssHooks[p];
      if (f !== a)h = typeof f, "string" === h && (g = ub.exec(f)) && (f = (g[1] + 1) * g[2] + parseFloat(q.css(b, e)), h = "number"), null == f || "number" === h && isNaN(f) || ("number" !== h || q.cssNumber[p] || (f += "px"), q.support.clearCloneStyle || "" !== f || 0 !== e.indexOf("background") || (l[e] = "inherit"), m && "set"in m && (f = m.set(b, f,
        d)) === a || (l[e] = f)); else return m && "get"in m && (g = m.get(b, !1, d)) !== a ? g : l[e]
    }
  }, css: function (b, e, f, d) {
    var g, h;
    h = q.camelCase(e);
    e = q.cssProps[h] || (q.cssProps[h] = B(b.style, h));
    (h = q.cssHooks[e] || q.cssHooks[h]) && "get"in h && (g = h.get(b, !0, f));
    g === a && (g = ra(b, e, d));
    "normal" === g && e in hb && (g = hb[e]);
    return"" === f || f ? (b = parseFloat(g), !0 === f || q.isNumeric(b) ? b || 0 : g) : g
  }});
  ra = function (b, e, f) {
    var g, h = (f = f || d.getComputedStyle(b, null)) ? f.getPropertyValue(e) || f[e] : a, m = b.style;
    f && ("" !== h || q.contains(b.ownerDocument, b) || (h =
      q.style(b, e)), Xa.test(h) && gb.test(e) && (b = m.width, e = m.minWidth, g = m.maxWidth, m.minWidth = m.maxWidth = m.width = h, h = f.width, m.width = b, m.minWidth = e, m.maxWidth = g));
    return h
  };
  q.each(["height", "width"], function (a, b) {
    q.cssHooks[b] = {get: function (a, e, f) {
      if (e)return 0 === a.offsetWidth && tb.test(q.css(a, "display")) ? q.swap(a, vb, function () {
        return w(a, b, f)
      }) : w(a, b, f)
    }, set: function (a, e, f) {
      var g = f && d.getComputedStyle(a, null);
      return A(a, e, f ? u(a, b, f, q.support.boxSizing && "border-box" === q.css(a, "boxSizing", !1, g), g) : 0)
    }}
  });
  q(function () {
    q.support.reliableMarginRight || (q.cssHooks.marginRight = {get: function (a, b) {
      if (b)return q.swap(a, {display: "inline-block"}, ra, [a, "marginRight"])
    }});
    !q.support.pixelPosition && q.fn.position && q.each(["top", "left"], function (a, b) {
      q.cssHooks[b] = {get: function (a, e) {
        if (e)return e = ra(a, b), Xa.test(e) ? q(a).position()[b] + "px" : e
      }}
    })
  });
  q.expr && q.expr.filters && (q.expr.filters.hidden = function (a) {
    return 0 >= a.offsetWidth && 0 >= a.offsetHeight
  }, q.expr.filters.visible = function (a) {
    return!q.expr.filters.hidden(a)
  });
  q.each({margin: "", padding: "", border: "Width"}, function (a, b) {
    q.cssHooks[a + b] = {expand: function (e) {
      var f = 0, d = {};
      for (e = "string" === typeof e ? e.split(" ") : [e]; 4 > f; f++)d[a + za[f] + b] = e[f] || e[f - 2] || e[0];
      return d
    }};
    gb.test(a) || (q.cssHooks[a + b].set = A)
  });
  var wb = /%20/g, rb = /\[\]$/, ib = /\r?\n/g, xb = /^(?:submit|button|image|reset|file)$/i, yb = /^(?:input|select|textarea|keygen)/i;
  q.fn.extend({serialize: function () {
    return q.param(this.serializeArray())
  }, serializeArray: function () {
    return this.map(function () {
      var a = q.prop(this,
        "elements");
      return a ? q.makeArray(a) : this
    }).filter(function () {
        var a = this.type;
        return this.name && !q(this).is(":disabled") && yb.test(this.nodeName) && !xb.test(a) && (this.checked || !oa.test(a))
      }).map(function (a, b) {
        var e = q(this).val();
        return null == e ? null : q.isArray(e) ? q.map(e, function (a) {
          return{name: b.name, value: a.replace(ib, "\r\n")}
        }) : {name: b.name, value: e.replace(ib, "\r\n")}
      }).get()
  }});
  q.param = function (b, e) {
    var f, d = [], g = function (a, b) {
      b = q.isFunction(b) ? b() : null == b ? "" : b;
      d[d.length] = encodeURIComponent(a) + "=" +
        encodeURIComponent(b)
    };
    e === a && (e = q.ajaxSettings && q.ajaxSettings.traditional);
    if (q.isArray(b) || b.jquery && !q.isPlainObject(b))q.each(b, function () {
      g(this.name, this.value)
    }); else for (f in b)F(f, b[f], e, g);
    return d.join("&").replace(wb, "+")
  };
  q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function (a, b) {
    q.fn[b] = function (a, e) {
      return 0 <
        arguments.length ? this.on(b, null, a, e) : this.trigger(b)
    }
  });
  q.fn.extend({hover: function (a, b) {
    return this.mouseenter(a).mouseleave(b || a)
  }, bind: function (a, b, e) {
    return this.on(a, null, b, e)
  }, unbind: function (a, b) {
    return this.off(a, null, b)
  }, delegate: function (a, b, e, f) {
    return this.on(b, a, e, f)
  }, undelegate: function (a, b, e) {
    return 1 === arguments.length ? this.off(a, "**") : this.off(b, a || "**", e)
  }});
  var Ca, xa, bb = q.now(), cb = /\?/, zb = /#.*$/, jb = /([?&])_=[^&]*/, Ab = /^(.*?):[ \t]*([^\r\n]*)$/mg, Bb = /^(?:GET|HEAD)$/, Cb = /^\/\//, kb =
    /^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/, lb = q.fn.load, mb = {}, Ya = {}, nb = "*/".concat("*");
  try {
    xa = Z.href
  } catch (Hb) {
    xa = O.createElement("a"), xa.href = "", xa = xa.href
  }
  Ca = kb.exec(xa.toLowerCase()) || [];
  q.fn.load = function (b, e, f) {
    if ("string" !== typeof b && lb)return lb.apply(this, arguments);
    var d, g, h, m = this, p = b.indexOf(" ");
    0 <= p && (d = b.slice(p), b = b.slice(0, p));
    q.isFunction(e) ? (f = e, e = a) : e && "object" === typeof e && (g = "POST");
    0 < m.length && q.ajax({url: b, type: g, dataType: "html", data: e}).done(function (a) {
      h = arguments;
      m.html(d ?
        q("<div>").append(q.parseHTML(a)).find(d) : a)
    }).complete(f && function (a, b) {
        m.each(f, h || [a.responseText, b, a])
      });
    return this
  };
  q.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "), function (a, b) {
    q.fn[b] = function (a) {
      return this.on(b, a)
    }
  });
  q.extend({active: 0, lastModified: {}, etag: {}, ajaxSettings: {url: xa, type: "GET", isLocal: /^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ca[1]), global: !0, processData: !0, async: !0, contentType: "application/x-www-form-urlencoded; charset=UTF-8",
    accepts: {"*": nb, text: "text/plain", html: "text/html", xml: "application/xml, text/xml", json: "application/json, text/javascript"}, contents: {xml: /xml/, html: /html/, json: /json/}, responseFields: {xml: "responseXML", text: "responseText", json: "responseJSON"}, converters: {"* text": String, "text html": !0, "text json": q.parseJSON, "text xml": q.parseXML}, flatOptions: {url: !0, context: !0}}, ajaxSetup: function (a, b) {
    return b ? I(I(a, q.ajaxSettings), b) : I(q.ajaxSettings, a)
  }, ajaxPrefilter: H(mb), ajaxTransport: H(Ya), ajax: function (b, e) {
    function f(b, e, m, l) {
      var t, u, C, z;
      z = e;
      if (2 !== A) {
        A = 2;
        p && clearTimeout(p);
        d = a;
        h = l || "";
        y.readyState = 0 < b ? 4 : 0;
        l = 200 <= b && 300 > b || 304 === b;
        if (m) {
          C = r;
          for (var w = y, J, R, F, E, S = C.contents, H = C.dataTypes; "*" === H[0];)H.shift(), J === a && (J = C.mimeType || w.getResponseHeader("Content-Type"));
          if (J)for (R in S)if (S[R] && S[R].test(J)) {
            H.unshift(R);
            break
          }
          if (H[0]in m)F = H[0]; else {
            for (R in m) {
              if (!H[0] || C.converters[R + " " + H[0]]) {
                F = R;
                break
              }
              E || (E = R)
            }
            F = F || E
          }
          F ? (F !== H[0] && H.unshift(F), C = m[F]) : C = void 0
        }
        a:{
          m = r;
          J = C;
          R = y;
          F = l;
          var M, V, N, w = {},
            S = m.dataTypes.slice();
          if (S[1])for (V in m.converters)w[V.toLowerCase()] = m.converters[V];
          for (E = S.shift(); E;)if (m.responseFields[E] && (R[m.responseFields[E]] = J), !N && F && m.dataFilter && (J = m.dataFilter(J, m.dataType)), N = E, E = S.shift())if ("*" === E)E = N; else if ("*" !== N && N !== E) {
            V = w[N + " " + E] || w["* " + E];
            if (!V)for (M in w)if (C = M.split(" "), C[1] === E && (V = w[N + " " + C[0]] || w["* " + C[0]])) {
              !0 === V ? V = w[M] : !0 !== w[M] && (E = C[0], S.unshift(C[1]));
              break
            }
            if (!0 !== V)if (V && m["throws"])J = V(J); else try {
              J = V(J)
            } catch (L) {
              C = {state: "parsererror",
                error: V ? L : "No conversion from " + N + " to " + E};
              break a
            }
          }
          C = {state: "success", data: J}
        }
        if (l)r.ifModified && ((z = y.getResponseHeader("Last-Modified")) && (q.lastModified[g] = z), (z = y.getResponseHeader("etag")) && (q.etag[g] = z)), 204 === b || "HEAD" === r.type ? z = "nocontent" : 304 === b ? z = "notmodified" : (z = C.state, t = C.data, u = C.error, l = !u); else if (u = z, b || !z)z = "error", 0 > b && (b = 0);
        y.status = b;
        y.statusText = (e || z) + "";
        l ? v.resolveWith(n, [t, z, y]) : v.rejectWith(n, [y, z, u]);
        y.statusCode(x);
        x = a;
        k && s.trigger(l ? "ajaxSuccess" : "ajaxError", [y, r,
          l ? t : u]);
        B.fireWith(n, [y, z]);
        k && (s.trigger("ajaxComplete", [y, r]), --q.active || q.event.trigger("ajaxStop"))
      }
    }

    "object" === typeof b && (e = b, b = a);
    e = e || {};
    var d, g, h, m, p, l, k, t, r = q.ajaxSetup({}, e), n = r.context || r, s = r.context && (n.nodeType || n.jquery) ? q(n) : q.event, v = q.Deferred(), B = q.Callbacks("once memory"), x = r.statusCode || {}, u = {}, C = {}, A = 0, z = "canceled", y = {readyState: 0, getResponseHeader: function (a) {
      var b;
      if (2 === A) {
        if (!m)for (m = {}; b = Ab.exec(h);)m[b[1].toLowerCase()] = b[2];
        b = m[a.toLowerCase()]
      }
      return null == b ? null : b
    },
      getAllResponseHeaders: function () {
        return 2 === A ? h : null
      }, setRequestHeader: function (a, b) {
        var e = a.toLowerCase();
        A || (a = C[e] = C[e] || a, u[a] = b);
        return this
      }, overrideMimeType: function (a) {
        A || (r.mimeType = a);
        return this
      }, statusCode: function (a) {
        var b;
        if (a)if (2 > A)for (b in a)x[b] = [x[b], a[b]]; else y.always(a[y.status]);
        return this
      }, abort: function (a) {
        a = a || z;
        d && d.abort(a);
        f(0, a);
        return this
      }};
    v.promise(y).complete = B.add;
    y.success = y.done;
    y.error = y.fail;
    r.url = ((b || r.url || xa) + "").replace(zb, "").replace(Cb, Ca[1] + "//");
    r.type =
      e.method || e.type || r.method || r.type;
    r.dataTypes = q.trim(r.dataType || "*").toLowerCase().match(ca) || [""];
    null == r.crossDomain && (l = kb.exec(r.url.toLowerCase()), r.crossDomain = !(!l || l[1] === Ca[1] && l[2] === Ca[2] && (l[3] || ("http:" === l[1] ? "80" : "443")) === (Ca[3] || ("http:" === Ca[1] ? "80" : "443"))));
    r.data && r.processData && "string" !== typeof r.data && (r.data = q.param(r.data, r.traditional));
    E(mb, r, e, y);
    if (2 === A)return y;
    (k = r.global) && 0 === q.active++ && q.event.trigger("ajaxStart");
    r.type = r.type.toUpperCase();
    r.hasContent = !Bb.test(r.type);
    g = r.url;
    r.hasContent || (r.data && (g = r.url += (cb.test(g) ? "&" : "?") + r.data, delete r.data), !1 === r.cache && (r.url = jb.test(g) ? g.replace(jb, "$1_=" + bb++) : g + (cb.test(g) ? "&" : "?") + "_=" + bb++));
    r.ifModified && (q.lastModified[g] && y.setRequestHeader("If-Modified-Since", q.lastModified[g]), q.etag[g] && y.setRequestHeader("If-None-Match", q.etag[g]));
    (r.data && r.hasContent && !1 !== r.contentType || e.contentType) && y.setRequestHeader("Content-Type", r.contentType);
    y.setRequestHeader("Accept", r.dataTypes[0] && r.accepts[r.dataTypes[0]] ?
      r.accepts[r.dataTypes[0]] + ("*" !== r.dataTypes[0] ? ", " + nb + "; q=0.01" : "") : r.accepts["*"]);
    for (t in r.headers)y.setRequestHeader(t, r.headers[t]);
    if (r.beforeSend && (!1 === r.beforeSend.call(n, y, r) || 2 === A))return y.abort();
    z = "abort";
    for (t in{success: 1, error: 1, complete: 1})y[t](r[t]);
    if (d = E(Ya, r, e, y)) {
      y.readyState = 1;
      k && s.trigger("ajaxSend", [y, r]);
      r.async && 0 < r.timeout && (p = setTimeout(function () {
        y.abort("timeout")
      }, r.timeout));
      try {
        A = 1, d.send(u, f)
      } catch (w) {
        if (2 > A)f(-1, w); else throw w;
      }
    } else f(-1, "No Transport");
    return y
  }, getJSON: function (a, b, e) {
    return q.get(a, b, e, "json")
  }, getScript: function (b, e) {
    return q.get(b, a, e, "script")
  }});
  q.each(["get", "post"], function (b, e) {
    q[e] = function (b, f, d, g) {
      q.isFunction(f) && (g = g || d, d = f, f = a);
      return q.ajax({url: b, type: e, dataType: g, data: f, success: d})
    }
  });
  q.ajaxSetup({accepts: {script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"}, contents: {script: /(?:java|ecma)script/}, converters: {"text script": function (a) {
    q.globalEval(a);
    return a
  }}});
  q.ajaxPrefilter("script", function (b) {
    b.cache === a && (b.cache = !1);
    b.crossDomain && (b.type = "GET")
  });
  q.ajaxTransport("script", function (a) {
    if (a.crossDomain) {
      var b, e;
      return{send: function (f, d) {
        b = q("<script>").prop({async: !0, charset: a.scriptCharset, src: a.url}).on("load error", e = function (a) {
          b.remove();
          e = null;
          a && d("error" === a.type ? 404 : 200, a.type)
        });
        O.head.appendChild(b[0])
      }, abort: function () {
        e && e()
      }}
    }
  });
  var ob = [], db = /(=)\?(?=&|$)|\?\?/;
  q.ajaxSetup({jsonp: "callback", jsonpCallback: function () {
    var a = ob.pop() || q.expando +
      "_" + bb++;
    this[a] = !0;
    return a
  }});
  q.ajaxPrefilter("json jsonp", function (b, e, f) {
    var g, h, m, p = !1 !== b.jsonp && (db.test(b.url) ? "url" : "string" === typeof b.data && !(b.contentType || "").indexOf("application/x-www-form-urlencoded") && db.test(b.data) && "data");
    if (p || "jsonp" === b.dataTypes[0])return g = b.jsonpCallback = q.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback, p ? b[p] = b[p].replace(db, "$1" + g) : !1 !== b.jsonp && (b.url += (cb.test(b.url) ? "&" : "?") + b.jsonp + "=" + g), b.converters["script json"] = function () {
      m || q.error(g +
        " was not called");
      return m[0]
    }, b.dataTypes[0] = "json", h = d[g], d[g] = function () {
      m = arguments
    }, f.always(function () {
      d[g] = h;
      b[g] && (b.jsonpCallback = e.jsonpCallback, ob.push(g));
      m && q.isFunction(h) && h(m[0]);
      m = h = a
    }), "script"
  });
  q.ajaxSettings.xhr = function () {
    try {
      return new XMLHttpRequest
    } catch (a) {
    }
  };
  var Pa = q.ajaxSettings.xhr(), Db = {0: 200, 1223: 204}, Eb = 0, Qa = {};
  if (d.ActiveXObject)q(d).on("unload", function () {
    for (var b in Qa)Qa[b]();
    Qa = a
  });
  q.support.cors = !!Pa && "withCredentials"in Pa;
  q.support.ajax = Pa = !!Pa;
  q.ajaxTransport(function (b) {
    var e;
    if (q.support.cors || Pa && !b.crossDomain)return{send: function (f, d) {
      var g, h, m = b.xhr();
      m.open(b.type, b.url, b.async, b.username, b.password);
      if (b.xhrFields)for (g in b.xhrFields)m[g] = b.xhrFields[g];
      b.mimeType && m.overrideMimeType && m.overrideMimeType(b.mimeType);
      b.crossDomain || f["X-Requested-With"] || (f["X-Requested-With"] = "XMLHttpRequest");
      for (g in f)m.setRequestHeader(g, f[g]);
      e = function (b) {
        return function () {
          e && (delete Qa[h], e = m.onload = m.onerror = null, "abort" === b ? m.abort() : "error" === b ? d(m.status || 404, m.statusText) :
            d(Db[m.status] || m.status, m.statusText, "string" === typeof m.responseText ? {text: m.responseText} : a, m.getAllResponseHeaders()))
        }
      };
      m.onload = e();
      m.onerror = e("error");
      e = Qa[h = Eb++] = e("abort");
      m.send(b.hasContent && b.data || null)
    }, abort: function () {
      e && e()
    }}
  });
  var Da, Ua, Fb = /^(?:toggle|show|hide)$/, pb = RegExp("^(?:([+-])=|)(" + ta + ")([a-z%]*)$", "i"), Gb = /queueHooks$/, Ra = [function (b, e, f) {
    var d, g, h, m, p, l = this, k = {}, t = b.style, r = b.nodeType && C(b), n = P.get(b, "fxshow");
    f.queue || (m = q._queueHooks(b, "fx"), null == m.unqueued && (m.unqueued =
      0, p = m.empty.fire, m.empty.fire = function () {
      m.unqueued || p()
    }), m.unqueued++, l.always(function () {
      l.always(function () {
        m.unqueued--;
        q.queue(b, "fx").length || m.empty.fire()
      })
    }));
    1 === b.nodeType && ("height"in e || "width"in e) && (f.overflow = [t.overflow, t.overflowX, t.overflowY], "inline" === q.css(b, "display") && "none" === q.css(b, "float") && (t.display = "inline-block"));
    f.overflow && (t.overflow = "hidden", l.always(function () {
      t.overflow = f.overflow[0];
      t.overflowX = f.overflow[1];
      t.overflowY = f.overflow[2]
    }));
    for (d in e)if (g = e[d],
      Fb.exec(g)) {
      delete e[d];
      h = h || "toggle" === g;
      if (g === (r ? "hide" : "show"))if ("show" === g && n && n[d] !== a)r = !0; else continue;
      k[d] = n && n[d] || q.style(b, d)
    }
    if (!q.isEmptyObject(k))for (d in n ? "hidden"in n && (r = n.hidden) : n = P.access(b, "fxshow", {}), h && (n.hidden = !r), r ? q(b).show() : l.done(function () {
      q(b).hide()
    }), l.done(function () {
      var a;
      P.remove(b, "fxshow");
      for (a in k)q.style(b, a, k[a])
    }), k)e = N(r ? n[d] : 0, d, l), d in n || (n[d] = e.start, r && (e.end = e.start, e.start = "width" === d || "height" === d ? 1 : 0))
  }], La = {"*": [function (a, b) {
    var e = this.createTween(a,
      b), f = e.cur(), d = pb.exec(b), g = d && d[3] || (q.cssNumber[a] ? "" : "px"), h = (q.cssNumber[a] || "px" !== g && +f) && pb.exec(q.css(e.elem, a)), m = 1, p = 20;
    if (h && h[3] !== g) {
      g = g || h[3];
      d = d || [];
      h = +f || 1;
      do m = m || ".5", h /= m, q.style(e.elem, a, h + g); while (m !== (m = e.cur() / f) && 1 !== m && --p)
    }
    d && (h = e.start = +h || +f || 0, e.unit = g, e.end = d[1] ? h + (d[1] + 1) * d[2] : +d[2]);
    return e
  }]};
  q.Animation = q.extend(R, {tweener: function (a, b) {
    q.isFunction(a) ? (b = a, a = ["*"]) : a = a.split(" ");
    for (var e, f = 0, d = a.length; f < d; f++)e = a[f], La[e] = La[e] || [], La[e].unshift(b)
  }, prefilter: function (a, b) {
    b ? Ra.unshift(a) : Ra.push(a)
  }});
  q.Tween = L;
  L.prototype = {constructor: L, init: function (a, b, e, f, d, g) {
    this.elem = a;
    this.prop = e;
    this.easing = d || "swing";
    this.options = b;
    this.start = this.now = this.cur();
    this.end = f;
    this.unit = g || (q.cssNumber[e] ? "" : "px")
  }, cur: function () {
    var a = L.propHooks[this.prop];
    return a && a.get ? a.get(this) : L.propHooks._default.get(this)
  }, run: function (a) {
    var b, e = L.propHooks[this.prop];
    this.pos = this.options.duration ? b = q.easing[this.easing](a, this.options.duration * a, 0, 1, this.options.duration) : b =
      a;
    this.now = (this.end - this.start) * b + this.start;
    this.options.step && this.options.step.call(this.elem, this.now, this);
    e && e.set ? e.set(this) : L.propHooks._default.set(this);
    return this
  }};
  L.prototype.init.prototype = L.prototype;
  L.propHooks = {_default: {get: function (a) {
    return null == a.elem[a.prop] || a.elem.style && null != a.elem.style[a.prop] ? (a = q.css(a.elem, a.prop, "")) && "auto" !== a ? a : 0 : a.elem[a.prop]
  }, set: function (a) {
    if (q.fx.step[a.prop])q.fx.step[a.prop](a); else a.elem.style && (null != a.elem.style[q.cssProps[a.prop]] ||
      q.cssHooks[a.prop]) ? q.style(a.elem, a.prop, a.now + a.unit) : a.elem[a.prop] = a.now
  }}};
  L.propHooks.scrollTop = L.propHooks.scrollLeft = {set: function (a) {
    a.elem.nodeType && a.elem.parentNode && (a.elem[a.prop] = a.now)
  }};
  q.each(["toggle", "show", "hide"], function (a, b) {
    var e = q.fn[b];
    q.fn[b] = function (a, f, d) {
      return null == a || "boolean" === typeof a ? e.apply(this, arguments) : this.animate(D(b, !0), a, f, d)
    }
  });
  q.fn.extend({fadeTo: function (a, b, e, f) {
    return this.filter(C).css("opacity", 0).show().end().animate({opacity: b}, a, e, f)
  }, animate: function (a, b, e, f) {
    var d = q.isEmptyObject(a), g = q.speed(b, e, f);
    b = function () {
      var b = R(this, q.extend({}, a), g);
      (d || P.get(this, "finish")) && b.stop(!0)
    };
    b.finish = b;
    return d || !1 === g.queue ? this.each(b) : this.queue(g.queue, b)
  }, stop: function (b, e, f) {
    var d = function (a) {
      var b = a.stop;
      delete a.stop;
      b(f)
    };
    "string" !== typeof b && (f = e, e = b, b = a);
    e && !1 !== b && this.queue(b || "fx", []);
    return this.each(function () {
      var a = !0, e = null != b && b + "queueHooks", g = q.timers, h = P.get(this);
      if (e)h[e] && h[e].stop && d(h[e]); else for (e in h)h[e] && h[e].stop && Gb.test(e) &&
      d(h[e]);
      for (e = g.length; e--;)g[e].elem !== this || null != b && g[e].queue !== b || (g[e].anim.stop(f), a = !1, g.splice(e, 1));
      !a && f || q.dequeue(this, b)
    })
  }, finish: function (a) {
    !1 !== a && (a = a || "fx");
    return this.each(function () {
      var b, e = P.get(this), f = e[a + "queue"];
      b = e[a + "queueHooks"];
      var d = q.timers, g = f ? f.length : 0;
      e.finish = !0;
      q.queue(this, a, []);
      b && b.stop && b.stop.call(this, !0);
      for (b = d.length; b--;)d[b].elem === this && d[b].queue === a && (d[b].anim.stop(!0), d.splice(b, 1));
      for (b = 0; b < g; b++)f[b] && f[b].finish && f[b].finish.call(this);
      delete e.finish
    })
  }});
  q.each({slideDown: D("show"), slideUp: D("hide"), slideToggle: D("toggle"), fadeIn: {opacity: "show"}, fadeOut: {opacity: "hide"}, fadeToggle: {opacity: "toggle"}}, function (a, b) {
    q.fn[a] = function (a, e, f) {
      return this.animate(b, a, e, f)
    }
  });
  q.speed = function (a, b, e) {
    var f = a && "object" === typeof a ? q.extend({}, a) : {complete: e || !e && b || q.isFunction(a) && a, duration: a, easing: e && b || b && !q.isFunction(b) && b};
    f.duration = q.fx.off ? 0 : "number" === typeof f.duration ? f.duration : f.duration in q.fx.speeds ? q.fx.speeds[f.duration] : q.fx.speeds._default;
    if (null == f.queue || !0 === f.queue)f.queue = "fx";
    f.old = f.complete;
    f.complete = function () {
      q.isFunction(f.old) && f.old.call(this);
      f.queue && q.dequeue(this, f.queue)
    };
    return f
  };
  q.easing = {linear: function (a) {
    return a
  }, swing: function (a) {
    return 0.5 - Math.cos(a * Math.PI) / 2
  }};
  q.timers = [];
  q.fx = L.prototype.init;
  q.fx.tick = function () {
    var b, e = q.timers, f = 0;
    for (Da = q.now(); f < e.length; f++)b = e[f], b() || e[f] !== b || e.splice(f--, 1);
    e.length || q.fx.stop();
    Da = a
  };
  q.fx.timer = function (a) {
    a() && q.timers.push(a) && q.fx.start()
  };
  q.fx.interval =
    13;
  q.fx.start = function () {
    Ua || (Ua = setInterval(q.fx.tick, q.fx.interval))
  };
  q.fx.stop = function () {
    clearInterval(Ua);
    Ua = null
  };
  q.fx.speeds = {slow: 600, fast: 200, _default: 400};
  q.fx.step = {};
  q.expr && q.expr.filters && (q.expr.filters.animated = function (a) {
    return q.grep(q.timers,function (b) {
      return a === b.elem
    }).length
  });
  q.fn.offset = function (b) {
    if (arguments.length)return b === a ? this : this.each(function (a) {
      q.offset.setOffset(this, b, a)
    });
    var e, f;
    f = this[0];
    var d = {top: 0, left: 0}, g = f && f.ownerDocument;
    if (g) {
      e = g.documentElement;
      if (!q.contains(e, f))return d;
      typeof f.getBoundingClientRect !== da && (d = f.getBoundingClientRect());
      f = Y(g);
      return{top: d.top + f.pageYOffset - e.clientTop, left: d.left + f.pageXOffset - e.clientLeft}
    }
  };
  q.offset = {setOffset: function (a, b, e) {
    var f, d, g, h = q.css(a, "position"), m = q(a), p = {};
    "static" === h && (a.style.position = "relative");
    g = m.offset();
    d = q.css(a, "top");
    f = q.css(a, "left");
    ("absolute" === h || "fixed" === h) && -1 < (d + f).indexOf("auto") ? (f = m.position(), d = f.top, f = f.left) : (d = parseFloat(d) || 0, f = parseFloat(f) || 0);
    q.isFunction(b) &&
    (b = b.call(a, e, g));
    null != b.top && (p.top = b.top - g.top + d);
    null != b.left && (p.left = b.left - g.left + f);
    "using"in b ? b.using.call(a, p) : m.css(p)
  }};
  q.fn.extend({position: function () {
    if (this[0]) {
      var a, b, e = this[0], f = {top: 0, left: 0};
      "fixed" === q.css(e, "position") ? b = e.getBoundingClientRect() : (a = this.offsetParent(), b = this.offset(), q.nodeName(a[0], "html") || (f = a.offset()), f.top += q.css(a[0], "borderTopWidth", !0), f.left += q.css(a[0], "borderLeftWidth", !0));
      return{top: b.top - f.top - q.css(e, "marginTop", !0), left: b.left - f.left - q.css(e,
        "marginLeft", !0)}
    }
  }, offsetParent: function () {
    return this.map(function () {
      for (var a = this.offsetParent || ja; a && !q.nodeName(a, "html") && "static" === q.css(a, "position");)a = a.offsetParent;
      return a || ja
    })
  }});
  q.each({scrollLeft: "pageXOffset", scrollTop: "pageYOffset"}, function (b, e) {
    var f = "pageYOffset" === e;
    q.fn[b] = function (g) {
      return q.access(this, function (b, g, h) {
        var m = Y(b);
        if (h === a)return m ? m[e] : b[g];
        m ? m.scrollTo(f ? d.pageXOffset : h, f ? h : d.pageYOffset) : b[g] = h
      }, b, g, arguments.length, null)
    }
  });
  q.each({Height: "height", Width: "width"},
    function (b, e) {
      q.each({padding: "inner" + b, content: e, "": "outer" + b}, function (f, d) {
        q.fn[d] = function (d, g) {
          var h = arguments.length && (f || "boolean" !== typeof d), m = f || (!0 === d || !0 === g ? "margin" : "border");
          return q.access(this, function (e, f, d) {
            return q.isWindow(e) ? e.document.documentElement["client" + b] : 9 === e.nodeType ? (f = e.documentElement, Math.max(e.body["scroll" + b], f["scroll" + b], e.body["offset" + b], f["offset" + b], f["client" + b])) : d === a ? q.css(e, f, m) : q.style(e, f, d, m)
          }, e, h ? d : a, h, null)
        }
      })
    });
  q.fn.size = function () {
    return this.length
  };
  q.fn.andSelf = q.fn.addBack;
  "object" === typeof module && module && "object" === typeof module.exports ? module.exports = q : "function" === typeof define && define.amd && define("jquery", [], function () {
    return q
  });
  "object" === typeof d && "object" === typeof d.document && (d.jQuery = d.$ = q)
})(window);
(function () {
  var d = this, a = d._, f = {}, b = Array.prototype, e = Object.prototype, g = b.push, k = b.slice, h = b.concat, l = e.toString, n = e.hasOwnProperty, m = b.forEach, s = b.map, r = b.reduce, t = b.reduceRight, v = b.filter, p = b.every, x = b.some, B = b.indexOf, C = b.lastIndexOf, e = Array.isArray, z = Object.keys, A = Function.prototype.bind, u = function (a) {
    if (a instanceof u)return a;
    if (!(this instanceof u))return new u(a);
    this._wrapped = a
  };
  "undefined" !== typeof exports ? ("undefined" !== typeof module && module.exports && (exports = module.exports = u), exports._ =
    u) : d._ = u;
  u.VERSION = "1.6.0";
  var w = u.each = u.forEach = function (a, b, e) {
    if (null == a)return a;
    if (m && a.forEach === m)a.forEach(b, e); else if (a.length === +a.length)for (var d = 0, g = a.length; d < g; d++) {
      if (b.call(e, a[d], d, a) === f)return
    } else for (var h = u.keys(a), d = 0, g = h.length; d < g; d++)if (b.call(e, a[h[d]], h[d], a) === f)return;
    return a
  };
  u.map = u.collect = function (a, b, e) {
    var f = [];
    if (null == a)return f;
    if (s && a.map === s)return a.map(b, e);
    w(a, function (a, d, g) {
      f.push(b.call(e, a, d, g))
    });
    return f
  };
  u.reduce = u.foldl = u.inject = function (a, b, e, f) {
    var d = 2 < arguments.length;
    null == a && (a = []);
    if (r && a.reduce === r)return f && (b = u.bind(b, f)), d ? a.reduce(b, e) : a.reduce(b);
    w(a, function (a, g, h) {
      d ? e = b.call(f, e, a, g, h) : (e = a, d = !0)
    });
    if (!d)throw new TypeError("Reduce of empty array with no initial value");
    return e
  };
  u.reduceRight = u.foldr = function (a, b, e, f) {
    var d = 2 < arguments.length;
    null == a && (a = []);
    if (t && a.reduceRight === t)return f && (b = u.bind(b, f)), d ? a.reduceRight(b, e) : a.reduceRight(b);
    var g = a.length;
    if (g !== +g)var h = u.keys(a), g = h.length;
    w(a, function (m, p, l) {
      p = h ?
        h[--g] : --g;
      d ? e = b.call(f, e, a[p], p, l) : (e = a[p], d = !0)
    });
    if (!d)throw new TypeError("Reduce of empty array with no initial value");
    return e
  };
  u.find = u.detect = function (a, b, e) {
    var f;
    y(a, function (a, d, g) {
      if (b.call(e, a, d, g))return f = a, !0
    });
    return f
  };
  u.filter = u.select = function (a, b, e) {
    var f = [];
    if (null == a)return f;
    if (v && a.filter === v)return a.filter(b, e);
    w(a, function (a, d, g) {
      b.call(e, a, d, g) && f.push(a)
    });
    return f
  };
  u.reject = function (a, b, e) {
    return u.filter(a, function (a, f, d) {
      return!b.call(e, a, f, d)
    }, e)
  };
  u.every = u.all =
    function (a, b, e) {
      b || (b = u.identity);
      var d = !0;
      if (null == a)return d;
      if (p && a.every === p)return a.every(b, e);
      w(a, function (a, g, h) {
        if (!(d = d && b.call(e, a, g, h)))return f
      });
      return!!d
    };
  var y = u.some = u.any = function (a, b, e) {
    b || (b = u.identity);
    var d = !1;
    if (null == a)return d;
    if (x && a.some === x)return a.some(b, e);
    w(a, function (a, g, h) {
      if (d || (d = b.call(e, a, g, h)))return f
    });
    return!!d
  };
  u.contains = u.include = function (a, b) {
    return null == a ? !1 : B && a.indexOf === B ? -1 != a.indexOf(b) : y(a, function (a) {
      return a === b
    })
  };
  u.invoke = function (a, b) {
    var e =
      k.call(arguments, 2), f = u.isFunction(b);
    return u.map(a, function (a) {
      return(f ? b : a[b]).apply(a, e)
    })
  };
  u.pluck = function (a, b) {
    return u.map(a, u.property(b))
  };
  u.where = function (a, b) {
    return u.filter(a, u.matches(b))
  };
  u.findWhere = function (a, b) {
    return u.find(a, u.matches(b))
  };
  u.max = function (a, b, e) {
    if (!b && u.isArray(a) && a[0] === +a[0] && 65535 > a.length)return Math.max.apply(Math, a);
    var f = -Infinity, d = -Infinity;
    w(a, function (a, g, h) {
      g = b ? b.call(e, a, g, h) : a;
      g > d && (f = a, d = g)
    });
    return f
  };
  u.min = function (a, b, e) {
    if (!b && u.isArray(a) &&
      a[0] === +a[0] && 65535 > a.length)return Math.min.apply(Math, a);
    var f = Infinity, d = Infinity;
    w(a, function (a, g, h) {
      g = b ? b.call(e, a, g, h) : a;
      g < d && (f = a, d = g)
    });
    return f
  };
  u.shuffle = function (a) {
    var b, e = 0, f = [];
    w(a, function (a) {
      b = u.random(e++);
      f[e - 1] = f[b];
      f[b] = a
    });
    return f
  };
  u.sample = function (a, b, e) {
    return null == b || e ? (a.length !== +a.length && (a = u.values(a)), a[u.random(a.length - 1)]) : u.shuffle(a).slice(0, Math.max(0, b))
  };
  var J = function (a) {
    return null == a ? u.identity : u.isFunction(a) ? a : u.property(a)
  };
  u.sortBy = function (a, b, e) {
    b =
      J(b);
    return u.pluck(u.map(a,function (a, f, d) {
      return{value: a, index: f, criteria: b.call(e, a, f, d)}
    }).sort(function (a, b) {
      var e = a.criteria, f = b.criteria;
      if (e !== f) {
        if (e > f || void 0 === e)return 1;
        if (e < f || void 0 === f)return-1
      }
      return a.index - b.index
    }), "value")
  };
  var F = function (a) {
    return function (b, e, f) {
      var d = {};
      e = J(e);
      w(b, function (g, h) {
        var m = e.call(f, g, h, b);
        a(d, m, g)
      });
      return d
    }
  };
  u.groupBy = F(function (a, b, e) {
    u.has(a, b) ? a[b].push(e) : a[b] = [e]
  });
  u.indexBy = F(function (a, b, e) {
    a[b] = e
  });
  u.countBy = F(function (a, b) {
    u.has(a, b) ?
      a[b]++ : a[b] = 1
  });
  u.sortedIndex = function (a, b, e, f) {
    e = J(e);
    b = e.call(f, b);
    for (var d = 0, g = a.length; d < g;) {
      var h = d + g >>> 1;
      e.call(f, a[h]) < b ? d = h + 1 : g = h
    }
    return d
  };
  u.toArray = function (a) {
    return a ? u.isArray(a) ? k.call(a) : a.length === +a.length ? u.map(a, u.identity) : u.values(a) : []
  };
  u.size = function (a) {
    return null == a ? 0 : a.length === +a.length ? a.length : u.keys(a).length
  };
  u.first = u.head = u.take = function (a, b, e) {
    return null == a ? void 0 : null == b || e ? a[0] : 0 > b ? [] : k.call(a, 0, b)
  };
  u.initial = function (a, b, e) {
    return k.call(a, 0, a.length - (null ==
      b || e ? 1 : b))
  };
  u.last = function (a, b, e) {
    return null == a ? void 0 : null == b || e ? a[a.length - 1] : k.call(a, Math.max(a.length - b, 0))
  };
  u.rest = u.tail = u.drop = function (a, b, e) {
    return k.call(a, null == b || e ? 1 : b)
  };
  u.compact = function (a) {
    return u.filter(a, u.identity)
  };
  var H = function (a, b, e) {
    if (b && u.every(a, u.isArray))return h.apply(e, a);
    w(a, function (a) {
      u.isArray(a) || u.isArguments(a) ? b ? g.apply(e, a) : H(a, b, e) : e.push(a)
    });
    return e
  };
  u.flatten = function (a, b) {
    return H(a, b, [])
  };
  u.without = function (a) {
    return u.difference(a, k.call(arguments,
      1))
  };
  u.partition = function (a, b) {
    var e = [], f = [];
    w(a, function (a) {
      (b(a) ? e : f).push(a)
    });
    return[e, f]
  };
  u.uniq = u.unique = function (a, b, e, f) {
    u.isFunction(b) && (f = e, e = b, b = !1);
    e = e ? u.map(a, e, f) : a;
    var d = [], g = [];
    w(e, function (e, f) {
      (b ? f && g[g.length - 1] === e : u.contains(g, e)) || (g.push(e), d.push(a[f]))
    });
    return d
  };
  u.union = function () {
    return u.uniq(u.flatten(arguments, !0))
  };
  u.intersection = function (a) {
    var b = k.call(arguments, 1);
    return u.filter(u.uniq(a), function (a) {
      return u.every(b, function (b) {
        return u.contains(b, a)
      })
    })
  };
  u.difference =
    function (a) {
      var e = h.apply(b, k.call(arguments, 1));
      return u.filter(a, function (a) {
        return!u.contains(e, a)
      })
    };
  u.zip = function () {
    for (var a = u.max(u.pluck(arguments, "length").concat(0)), b = Array(a), e = 0; e < a; e++)b[e] = u.pluck(arguments, "" + e);
    return b
  };
  u.object = function (a, b) {
    if (null == a)return{};
    for (var e = {}, f = 0, d = a.length; f < d; f++)b ? e[a[f]] = b[f] : e[a[f][0]] = a[f][1];
    return e
  };
  u.indexOf = function (a, b, e) {
    if (null == a)return-1;
    var f = 0, d = a.length;
    if (e)if ("number" == typeof e)f = 0 > e ? Math.max(0, d + e) : e; else return f = u.sortedIndex(a,
      b), a[f] === b ? f : -1;
    if (B && a.indexOf === B)return a.indexOf(b, e);
    for (; f < d; f++)if (a[f] === b)return f;
    return-1
  };
  u.lastIndexOf = function (a, b, e) {
    if (null == a)return-1;
    var f = null != e;
    if (C && a.lastIndexOf === C)return f ? a.lastIndexOf(b, e) : a.lastIndexOf(b);
    for (e = f ? e : a.length; e--;)if (a[e] === b)return e;
    return-1
  };
  u.range = function (a, b, e) {
    1 >= arguments.length && (b = a || 0, a = 0);
    e = arguments[2] || 1;
    for (var f = Math.max(Math.ceil((b - a) / e), 0), d = 0, g = Array(f); d < f;)g[d++] = a, a += e;
    return g
  };
  var E = function () {
  };
  u.bind = function (a, b) {
    var e, f;
    if (A &&
      a.bind === A)return A.apply(a, k.call(arguments, 1));
    if (!u.isFunction(a))throw new TypeError;
    e = k.call(arguments, 2);
    return f = function () {
      if (!(this instanceof f))return a.apply(b, e.concat(k.call(arguments)));
      E.prototype = a.prototype;
      var d = new E;
      E.prototype = null;
      var g = a.apply(d, e.concat(k.call(arguments)));
      return Object(g) === g ? g : d
    }
  };
  u.partial = function (a) {
    var b = k.call(arguments, 1);
    return function () {
      for (var e = 0, f = b.slice(), d = 0, g = f.length; d < g; d++)f[d] === u && (f[d] = arguments[e++]);
      for (; e < arguments.length;)f.push(arguments[e++]);
      return a.apply(this, f)
    }
  };
  u.bindAll = function (a) {
    var b = k.call(arguments, 1);
    if (0 === b.length)throw Error("bindAll must be passed function names");
    w(b, function (b) {
      a[b] = u.bind(a[b], a)
    });
    return a
  };
  u.memoize = function (a, b) {
    var e = {};
    b || (b = u.identity);
    return function () {
      var f = b.apply(this, arguments);
      return u.has(e, f) ? e[f] : e[f] = a.apply(this, arguments)
    }
  };
  u.delay = function (a, b) {
    var e = k.call(arguments, 2);
    return setTimeout(function () {
      return a.apply(null, e)
    }, b)
  };
  u.defer = function (a) {
    return u.delay.apply(u, [a, 1].concat(k.call(arguments,
      1)))
  };
  u.throttle = function (a, b, e) {
    var f, d, g, h = null, m = 0;
    e || (e = {});
    var p = function () {
      m = !1 === e.leading ? 0 : u.now();
      h = null;
      g = a.apply(f, d);
      f = d = null
    };
    return function () {
      var l = u.now();
      m || !1 !== e.leading || (m = l);
      var k = b - (l - m);
      f = this;
      d = arguments;
      0 >= k ? (clearTimeout(h), h = null, m = l, g = a.apply(f, d), f = d = null) : h || !1 === e.trailing || (h = setTimeout(p, k));
      return g
    }
  };
  u.debounce = function (a, b, e) {
    var f, d, g, h, m, p = function () {
      var l = u.now() - h;
      l < b ? f = setTimeout(p, b - l) : (f = null, e || (m = a.apply(g, d), g = d = null))
    };
    return function () {
      g = this;
      d = arguments;
      h = u.now();
      var l = e && !f;
      f || (f = setTimeout(p, b));
      l && (m = a.apply(g, d), g = d = null);
      return m
    }
  };
  u.once = function (a) {
    var b = !1, e;
    return function () {
      if (b)return e;
      b = !0;
      e = a.apply(this, arguments);
      a = null;
      return e
    }
  };
  u.wrap = function (a, b) {
    return u.partial(b, a)
  };
  u.compose = function () {
    var a = arguments;
    return function () {
      for (var b = arguments, e = a.length - 1; 0 <= e; e--)b = [a[e].apply(this, b)];
      return b[0]
    }
  };
  u.after = function (a, b) {
    return function () {
      if (1 > --a)return b.apply(this, arguments)
    }
  };
  u.keys = function (a) {
    if (!u.isObject(a))return[];
    if (z)return z(a);
    var b = [], e;
    for (e in a)u.has(a, e) && b.push(e);
    return b
  };
  u.values = function (a) {
    for (var b = u.keys(a), e = b.length, f = Array(e), d = 0; d < e; d++)f[d] = a[b[d]];
    return f
  };
  u.pairs = function (a) {
    for (var b = u.keys(a), e = b.length, f = Array(e), d = 0; d < e; d++)f[d] = [b[d], a[b[d]]];
    return f
  };
  u.invert = function (a) {
    for (var b = {}, e = u.keys(a), f = 0, d = e.length; f < d; f++)b[a[e[f]]] = e[f];
    return b
  };
  u.functions = u.methods = function (a) {
    var b = [], e;
    for (e in a)u.isFunction(a[e]) && b.push(e);
    return b.sort()
  };
  u.extend = function (a) {
    w(k.call(arguments,
      1), function (b) {
      if (b)for (var e in b)a[e] = b[e]
    });
    return a
  };
  u.pick = function (a) {
    var e = {}, f = h.apply(b, k.call(arguments, 1));
    w(f, function (b) {
      b in a && (e[b] = a[b])
    });
    return e
  };
  u.omit = function (a) {
    var e = {}, f = h.apply(b, k.call(arguments, 1)), d;
    for (d in a)u.contains(f, d) || (e[d] = a[d]);
    return e
  };
  u.defaults = function (a) {
    w(k.call(arguments, 1), function (b) {
      if (b)for (var e in b)void 0 === a[e] && (a[e] = b[e])
    });
    return a
  };
  u.clone = function (a) {
    return u.isObject(a) ? u.isArray(a) ? a.slice() : u.extend({}, a) : a
  };
  u.tap = function (a, b) {
    b(a);
    return a
  };
  var I = function (a, b, e, f) {
    if (a === b)return 0 !== a || 1 / a == 1 / b;
    if (null == a || null == b)return a === b;
    a instanceof u && (a = a._wrapped);
    b instanceof u && (b = b._wrapped);
    var d = l.call(a);
    if (d != l.call(b))return!1;
    switch (d) {
      case "[object String]":
        return a == String(b);
      case "[object Number]":
        return a != +a ? b != +b : 0 == a ? 1 / a == 1 / b : a == +b;
      case "[object Date]":
      case "[object Boolean]":
        return+a == +b;
      case "[object RegExp]":
        return a.source == b.source && a.global == b.global && a.multiline == b.multiline && a.ignoreCase == b.ignoreCase
    }
    if ("object" != typeof a || "object" != typeof b)return!1;
    for (var g = e.length; g--;)if (e[g] == a)return f[g] == b;
    var g = a.constructor, h = b.constructor;
    if (g !== h && !(u.isFunction(g) && g instanceof g && u.isFunction(h) && h instanceof h) && "constructor"in a && "constructor"in b)return!1;
    e.push(a);
    f.push(b);
    g = 0;
    h = !0;
    if ("[object Array]" == d) {
      if (g = a.length, h = g == b.length)for (; g-- && (h = I(a[g], b[g], e, f)););
    } else {
      for (var m in a)if (u.has(a, m) && (g++, !(h = u.has(b, m) && I(a[m], b[m], e, f))))break;
      if (h) {
        for (m in b)if (u.has(b, m) && !g--)break;
        h = !g
      }
    }
    e.pop();
    f.pop();
    return h
  };
  u.isEqual = function (a, b) {
    return I(a, b, [], [])
  };
  u.isEmpty = function (a) {
    if (null == a)return!0;
    if (u.isArray(a) || u.isString(a))return 0 === a.length;
    for (var b in a)if (u.has(a, b))return!1;
    return!0
  };
  u.isElement = function (a) {
    return!(!a || 1 !== a.nodeType)
  };
  u.isArray = e || function (a) {
    return"[object Array]" == l.call(a)
  };
  u.isObject = function (a) {
    return a === Object(a)
  };
  w("Arguments Function String Number Date RegExp".split(" "), function (a) {
    u["is" + a] = function (b) {
      return l.call(b) == "[object " + a + "]"
    }
  });
  u.isArguments(arguments) ||
  (u.isArguments = function (a) {
    return!(!a || !u.has(a, "callee"))
  });
  "function" !== typeof/./ && (u.isFunction = function (a) {
    return"function" === typeof a
  });
  u.isFinite = function (a) {
    return isFinite(a) && !isNaN(parseFloat(a))
  };
  u.isNaN = function (a) {
    return u.isNumber(a) && a != +a
  };
  u.isBoolean = function (a) {
    return!0 === a || !1 === a || "[object Boolean]" == l.call(a)
  };
  u.isNull = function (a) {
    return null === a
  };
  u.isUndefined = function (a) {
    return void 0 === a
  };
  u.has = function (a, b) {
    return n.call(a, b)
  };
  u.noConflict = function () {
    d._ = a;
    return this
  };
  u.identity =
    function (a) {
      return a
    };
  u.constant = function (a) {
    return function () {
      return a
    }
  };
  u.property = function (a) {
    return function (b) {
      return b[a]
    }
  };
  u.matches = function (a) {
    return function (b) {
      if (b === a)return!0;
      for (var e in a)if (a[e] !== b[e])return!1;
      return!0
    }
  };
  u.times = function (a, b, e) {
    for (var f = Array(Math.max(0, a)), d = 0; d < a; d++)f[d] = b.call(e, d);
    return f
  };
  u.random = function (a, b) {
    null == b && (b = a, a = 0);
    return a + Math.floor(Math.random() * (b - a + 1))
  };
  u.now = Date.now || function () {
    return(new Date).getTime()
  };
  var K = {escape: {"&": "&amp;",
    "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#x27;"}};
  K.unescape = u.invert(K.escape);
  var N = {escape: RegExp("[" + u.keys(K.escape).join("") + "]", "g"), unescape: RegExp("(" + u.keys(K.unescape).join("|") + ")", "g")};
  u.each(["escape", "unescape"], function (a) {
    u[a] = function (b) {
      return null == b ? "" : ("" + b).replace(N[a], function (b) {
        return K[a][b]
      })
    }
  });
  u.result = function (a, b) {
    if (null != a) {
      var e = a[b];
      return u.isFunction(e) ? e.call(a) : e
    }
  };
  u.mixin = function (a) {
    w(u.functions(a), function (b) {
      var e = u[b] = a[b];
      u.prototype[b] = function () {
        var a =
          [this._wrapped];
        g.apply(a, arguments);
        return Y.call(this, e.apply(u, a))
      }
    })
  };
  var R = 0;
  u.uniqueId = function (a) {
    var b = ++R + "";
    return a ? a + b : b
  };
  u.templateSettings = {evaluate: /<%([\s\S]+?)%>/g, interpolate: /<%=([\s\S]+?)%>/g, escape: /<%-([\s\S]+?)%>/g};
  var S = /(.)^/, L = {"'": "'", "\\": "\\", "\r": "r", "\n": "n", "\t": "t", "\u2028": "u2028", "\u2029": "u2029"}, D = /\\|'|\r|\n|\t|\u2028|\u2029/g;
  u.template = function (a, b, e) {
    var f;
    e = u.defaults({}, e, u.templateSettings);
    var d = RegExp([(e.escape || S).source, (e.interpolate || S).source, (e.evaluate ||
      S).source].join("|") + "|$", "g"), g = 0, h = "__p+='";
    a.replace(d, function (b, e, f, d, m) {
      h += a.slice(g, m).replace(D, function (a) {
        return"\\" + L[a]
      });
      e && (h += "'+\n((__t=(" + e + "))==null?'':_.escape(__t))+\n'");
      f && (h += "'+\n((__t=(" + f + "))==null?'':__t)+\n'");
      d && (h += "';\n" + d + "\n__p+='");
      g = m + b.length;
      return b
    });
    h += "';\n";
    e.variable || (h = "with(obj||{}){\n" + h + "}\n");
    h = "var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n" + h + "return __p;\n";
    try {
      f = new Function(e.variable || "obj", "_", h)
    } catch (m) {
      throw m.source =
        h, m;
    }
    if (b)return f(b, u);
    b = function (a) {
      return f.call(this, a, u)
    };
    b.source = "function(" + (e.variable || "obj") + "){\n" + h + "}";
    return b
  };
  u.chain = function (a) {
    return u(a).chain()
  };
  var Y = function (a) {
    return this._chain ? u(a).chain() : a
  };
  u.mixin(u);
  w("pop push reverse shift sort splice unshift".split(" "), function (a) {
    var e = b[a];
    u.prototype[a] = function () {
      var b = this._wrapped;
      e.apply(b, arguments);
      "shift" != a && "splice" != a || 0 !== b.length || delete b[0];
      return Y.call(this, b)
    }
  });
  w(["concat", "join", "slice"], function (a) {
    var e =
      b[a];
    u.prototype[a] = function () {
      return Y.call(this, e.apply(this._wrapped, arguments))
    }
  });
  u.extend(u.prototype, {chain: function () {
    this._chain = !0;
    return this
  }, value: function () {
    return this._wrapped
  }});
  "function" === typeof define && define.amd && define("underscore", [], function () {
    return u
  })
}).call(this);
(function (d, a) {
  if ("function" === typeof define && define.amd)define("backbone", ["underscore", "jquery", "exports"], function (b, e, f) {
    d.Backbone = a(d, f, b, e)
  }); else if ("undefined" !== typeof exports) {
    var f = require("underscore");
    a(d, exports, f)
  } else d.Backbone = a(d, {}, d._, d.jQuery || d.Zepto || d.ender || d.$)
})(this, function (d, a, f, b) {
  var e = d.Backbone, g = [].slice;
  a.VERSION = "1.1.2";
  a.$ = b;
  a.noConflict = function () {
    d.Backbone = e;
    return this
  };
  a.emulateHTTP = !1;
  a.emulateJSON = !1;
  var k = a.Events = {on: function (a, b, e) {
    if (!l(this, "on",
      a, [b, e]) || !b)return this;
    this._events || (this._events = {});
    (this._events[a] || (this._events[a] = [])).push({callback: b, context: e, ctx: e || this});
    return this
  }, once: function (a, b, e) {
    if (!l(this, "once", a, [b, e]) || !b)return this;
    var d = this, g = f.once(function () {
      d.off(a, g);
      b.apply(this, arguments)
    });
    g._callback = b;
    return this.on(a, g, e)
  }, off: function (a, b, e) {
    var d, g, h, m, p, k, t, r;
    if (!this._events || !l(this, "off", a, [b, e]))return this;
    if (!a && !b && !e)return this._events = void 0, this;
    m = a ? [a] : f.keys(this._events);
    p = 0;
    for (k = m.length; p <
      k; p++)if (a = m[p], h = this._events[a]) {
      this._events[a] = d = [];
      if (b || e)for (t = 0, r = h.length; t < r; t++)g = h[t], (b && b !== g.callback && b !== g.callback._callback || e && e !== g.context) && d.push(g);
      d.length || delete this._events[a]
    }
    return this
  }, trigger: function (a) {
    if (!this._events)return this;
    var b = g.call(arguments, 1);
    if (!l(this, "trigger", a, b))return this;
    var e = this._events[a], f = this._events.all;
    e && n(e, b);
    f && n(f, arguments);
    return this
  }, stopListening: function (a, b, e) {
    var d = this._listeningTo;
    if (!d)return this;
    var g = !b && !e;
    e ||
      "object" !== typeof b || (e = this);
    a && ((d = {})[a._listenId] = a);
    for (var h in d)a = d[h], a.off(b, e, this), (g || f.isEmpty(a._events)) && delete this._listeningTo[h];
    return this
  }}, h = /\s+/, l = function (a, b, e, f) {
    if (!e)return!0;
    if ("object" === typeof e) {
      for (var d in e)a[b].apply(a, [d, e[d]].concat(f));
      return!1
    }
    if (h.test(e)) {
      e = e.split(h);
      d = 0;
      for (var g = e.length; d < g; d++)a[b].apply(a, [e[d]].concat(f));
      return!1
    }
    return!0
  }, n = function (a, b) {
    var e, f = -1, d = a.length, g = b[0], h = b[1], m = b[2];
    switch (b.length) {
      case 0:
        for (; ++f < d;)(e = a[f]).callback.call(e.ctx);
        break;
      case 1:
        for (; ++f < d;)(e = a[f]).callback.call(e.ctx, g);
        break;
      case 2:
        for (; ++f < d;)(e = a[f]).callback.call(e.ctx, g, h);
        break;
      case 3:
        for (; ++f < d;)(e = a[f]).callback.call(e.ctx, g, h, m);
        break;
      default:
        for (; ++f < d;)(e = a[f]).callback.apply(e.ctx, b)
    }
  };
  f.each({listenTo: "on", listenToOnce: "once"}, function (a, b) {
    k[b] = function (b, e, d) {
      var g = this._listeningTo || (this._listeningTo = {}), h = b._listenId || (b._listenId = f.uniqueId("l"));
      g[h] = b;
      d || "object" !== typeof e || (d = this);
      b[a](e, d, this);
      return this
    }
  });
  k.bind = k.on;
  k.unbind = k.off;
  f.extend(a, k);
  var m = a.Model = function (a, b) {
    var e = a || {};
    b || (b = {});
    this.cid = f.uniqueId("c");
    this.attributes = {};
    b.collection && (this.collection = b.collection);
    b.parse && (e = this.parse(e, b) || {});
    e = f.defaults({}, e, f.result(this, "defaults"));
    this.set(e, b);
    this.changed = {};
    this.initialize.apply(this, arguments)
  };
  f.extend(m.prototype, k, {changed: null, validationError: null, idAttribute: "id", initialize: function () {
  }, toJSON: function (a) {
    return f.clone(this.attributes)
  }, sync: function () {
    return a.sync.apply(this, arguments)
  },
    get: function (a) {
      return this.attributes[a]
    }, escape: function (a) {
      return f.escape(this.get(a))
    }, has: function (a) {
      return null != this.get(a)
    }, set: function (a, b, e) {
      var d, g, h, m, p, l, k;
      if (null == a)return this;
      "object" === typeof a ? (g = a, e = b) : (g = {})[a] = b;
      e || (e = {});
      if (!this._validate(g, e))return!1;
      h = e.unset;
      m = e.silent;
      a = [];
      p = this._changing;
      this._changing = !0;
      p || (this._previousAttributes = f.clone(this.attributes), this.changed = {});
      k = this.attributes;
      l = this._previousAttributes;
      this.idAttribute in g && (this.id = g[this.idAttribute]);
      for (d in g)b = g[d], f.isEqual(k[d], b) || a.push(d), f.isEqual(l[d], b) ? delete this.changed[d] : this.changed[d] = b, h ? delete k[d] : k[d] = b;
      if (!m)for (a.length && (this._pending = e), b = 0, d = a.length; b < d; b++)this.trigger("change:" + a[b], this, k[a[b]], e);
      if (p)return this;
      if (!m)for (; this._pending;)e = this._pending, this._pending = !1, this.trigger("change", this, e);
      this._changing = this._pending = !1;
      return this
    }, unset: function (a, b) {
      return this.set(a, void 0, f.extend({}, b, {unset: !0}))
    }, clear: function (a) {
      var b = {}, e;
      for (e in this.attributes)b[e] = void 0;
      return this.set(b, f.extend({}, a, {unset: !0}))
    }, hasChanged: function (a) {
      return null == a ? !f.isEmpty(this.changed) : f.has(this.changed, a)
    }, changedAttributes: function (a) {
      if (!a)return this.hasChanged() ? f.clone(this.changed) : !1;
      var b, e = !1, d = this._changing ? this._previousAttributes : this.attributes, g;
      for (g in a)f.isEqual(d[g], b = a[g]) || ((e || (e = {}))[g] = b);
      return e
    }, previous: function (a) {
      return null != a && this._previousAttributes ? this._previousAttributes[a] : null
    }, previousAttributes: function () {
      return f.clone(this._previousAttributes)
    },
    fetch: function (a) {
      a = a ? f.clone(a) : {};
      void 0 === a.parse && (a.parse = !0);
      var b = this, e = a.success;
      a.success = function (f) {
        if (!b.set(b.parse(f, a), a))return!1;
        e && e(b, f, a);
        b.trigger("sync", b, f, a)
      };
      N(this, a);
      return this.sync("read", this, a)
    }, save: function (a, b, e) {
      var d, g = this.attributes;
      null == a || "object" === typeof a ? (d = a, e = b) : (d = {})[a] = b;
      e = f.extend({validate: !0}, e);
      if (d && !e.wait) {
        if (!this.set(d, e))return!1
      } else if (!this._validate(d, e))return!1;
      d && e.wait && (this.attributes = f.extend({}, g, d));
      void 0 === e.parse && (e.parse = !0);
      var h = this, m = e.success;
      e.success = function (a) {
        h.attributes = g;
        var b = h.parse(a, e);
        e.wait && (b = f.extend(d || {}, b));
        if (f.isObject(b) && !h.set(b, e))return!1;
        m && m(h, a, e);
        h.trigger("sync", h, a, e)
      };
      N(this, e);
      a = this.isNew() ? "create" : e.patch ? "patch" : "update";
      "patch" === a && (e.attrs = d);
      a = this.sync(a, this, e);
      d && e.wait && (this.attributes = g);
      return a
    }, destroy: function (a) {
      a = a ? f.clone(a) : {};
      var b = this, e = a.success, d = function () {
        b.trigger("destroy", b, b.collection, a)
      };
      a.success = function (f) {
        (a.wait || b.isNew()) && d();
        e && e(b,
          f, a);
        b.isNew() || b.trigger("sync", b, f, a)
      };
      if (this.isNew())return a.success(), !1;
      N(this, a);
      var g = this.sync("delete", this, a);
      a.wait || d();
      return g
    }, url: function () {
      var a = f.result(this, "urlRoot") || f.result(this.collection, "url") || K();
      return this.isNew() ? a : a.replace(/([^\/])$/, "$1/") + encodeURIComponent(this.id)
    }, parse: function (a, b) {
      return a
    }, clone: function () {
      return new this.constructor(this.attributes)
    }, isNew: function () {
      return!this.has(this.idAttribute)
    }, isValid: function (a) {
      return this._validate({}, f.extend(a ||
      {}, {validate: !0}))
    }, _validate: function (a, b) {
      if (!b.validate || !this.validate)return!0;
      a = f.extend({}, this.attributes, a);
      var e = this.validationError = this.validate(a, b) || null;
      if (!e)return!0;
      this.trigger("invalid", this, e, f.extend(b, {validationError: e}));
      return!1
    }});
  f.each("keys values pairs invert pick omit".split(" "), function (a) {
    m.prototype[a] = function () {
      var b = g.call(arguments);
      b.unshift(this.attributes);
      return f[a].apply(f, b)
    }
  });
  var s = a.Collection = function (a, b) {
    b || (b = {});
    b.model && (this.model = b.model);
    void 0 !== b.comparator && (this.comparator = b.comparator);
    this._reset();
    this.initialize.apply(this, arguments);
    a && this.reset(a, f.extend({silent: !0}, b))
  }, r = {add: !0, remove: !0, merge: !0}, t = {add: !0, remove: !1};
  f.extend(s.prototype, k, {model: m, initialize: function () {
  }, toJSON: function (a) {
    return this.map(function (b) {
      return b.toJSON(a)
    })
  }, sync: function () {
    return a.sync.apply(this, arguments)
  }, add: function (a, b) {
    return this.set(a, f.extend({merge: !1}, b, t))
  }, remove: function (a, b) {
    var e = !f.isArray(a);
    a = e ? [a] : f.clone(a);
    b ||
    (b = {});
    var d, g, h, m;
    d = 0;
    for (g = a.length; d < g; d++)if (m = a[d] = this.get(a[d]))delete this._byId[m.id], delete this._byId[m.cid], h = this.indexOf(m), this.models.splice(h, 1), this.length--, b.silent || (b.index = h, m.trigger("remove", m, this, b)), this._removeReference(m, b);
    return e ? a[0] : a
  }, set: function (a, b) {
    b = f.defaults({}, b, r);
    b.parse && (a = this.parse(a, b));
    var e = !f.isArray(a);
    a = e ? a ? [a] : [] : f.clone(a);
    var d, g, h, p, l, k, t = b.at, n = this.model, s = this.comparator && null == t && !1 !== b.sort, v = f.isString(this.comparator) ? this.comparator :
      null, B = [], x = [], u = {}, C = b.add, A = b.merge, z = b.remove, y = !s && C && z ? [] : !1;
    d = 0;
    for (g = a.length; d < g; d++) {
      l = a[d] || {};
      h = l instanceof m ? p = l : l[n.prototype.idAttribute || "id"];
      if (h = this.get(h))z && (u[h.cid] = !0), A && (l = l === p ? p.attributes : l, b.parse && (l = h.parse(l, b)), h.set(l, b), s && !k && h.hasChanged(v) && (k = !0)), a[d] = h; else if (C) {
        p = a[d] = this._prepareModel(l, b);
        if (!p)continue;
        B.push(p);
        this._addReference(p, b)
      }
      p = h || p;
      !y || !p.isNew() && u[p.id] || y.push(p);
      u[p.id] = !0
    }
    if (z) {
      d = 0;
      for (g = this.length; d < g; ++d)u[(p = this.models[d]).cid] ||
      x.push(p);
      x.length && this.remove(x, b)
    }
    if (B.length || y && y.length)if (s && (k = !0), this.length += B.length, null != t)for (d = 0, g = B.length; d < g; d++)this.models.splice(t + d, 0, B[d]); else for (y && (this.models.length = 0), l = y || B, d = 0, g = l.length; d < g; d++)this.models.push(l[d]);
    k && this.sort({silent: !0});
    if (!b.silent) {
      d = 0;
      for (g = B.length; d < g; d++)(p = B[d]).trigger("add", p, this, b);
      (k || y && y.length) && this.trigger("sort", this, b)
    }
    return e ? a[0] : a
  }, reset: function (a, b) {
    b || (b = {});
    for (var e = 0, d = this.models.length; e < d; e++)this._removeReference(this.models[e],
      b);
    b.previousModels = this.models;
    this._reset();
    a = this.add(a, f.extend({silent: !0}, b));
    b.silent || this.trigger("reset", this, b);
    return a
  }, push: function (a, b) {
    return this.add(a, f.extend({at: this.length}, b))
  }, pop: function (a) {
    var b = this.at(this.length - 1);
    this.remove(b, a);
    return b
  }, unshift: function (a, b) {
    return this.add(a, f.extend({at: 0}, b))
  }, shift: function (a) {
    var b = this.at(0);
    this.remove(b, a);
    return b
  }, slice: function () {
    return g.apply(this.models, arguments)
  }, get: function (a) {
    return null == a ? void 0 : this._byId[a] ||
      this._byId[a.id] || this._byId[a.cid]
  }, at: function (a) {
    return this.models[a]
  }, where: function (a, b) {
    return f.isEmpty(a) ? b ? void 0 : [] : this[b ? "find" : "filter"](function (b) {
      for (var e in a)if (a[e] !== b.get(e))return!1;
      return!0
    })
  }, findWhere: function (a) {
    return this.where(a, !0)
  }, sort: function (a) {
    if (!this.comparator)throw Error("Cannot sort a set without a comparator");
    a || (a = {});
    f.isString(this.comparator) || 1 === this.comparator.length ? this.models = this.sortBy(this.comparator, this) : this.models.sort(f.bind(this.comparator,
      this));
    a.silent || this.trigger("sort", this, a);
    return this
  }, pluck: function (a) {
    return f.invoke(this.models, "get", a)
  }, fetch: function (a) {
    a = a ? f.clone(a) : {};
    void 0 === a.parse && (a.parse = !0);
    var b = a.success, e = this;
    a.success = function (f) {
      e[a.reset ? "reset" : "set"](f, a);
      b && b(e, f, a);
      e.trigger("sync", e, f, a)
    };
    N(this, a);
    return this.sync("read", this, a)
  }, create: function (a, b) {
    b = b ? f.clone(b) : {};
    if (!(a = this._prepareModel(a, b)))return!1;
    b.wait || this.add(a, b);
    var e = this, d = b.success;
    b.success = function (a, f) {
      b.wait && e.add(a,
        b);
      d && d(a, f, b)
    };
    a.save(null, b);
    return a
  }, parse: function (a, b) {
    return a
  }, clone: function () {
    return new this.constructor(this.models)
  }, _reset: function () {
    this.length = 0;
    this.models = [];
    this._byId = {}
  }, _prepareModel: function (a, b) {
    if (a instanceof m)return a;
    b = b ? f.clone(b) : {};
    b.collection = this;
    var e = new this.model(a, b);
    if (!e.validationError)return e;
    this.trigger("invalid", this, e.validationError, b);
    return!1
  }, _addReference: function (a, b) {
    this._byId[a.cid] = a;
    null != a.id && (this._byId[a.id] = a);
    a.collection || (a.collection =
      this);
    a.on("all", this._onModelEvent, this)
  }, _removeReference: function (a, b) {
    this === a.collection && delete a.collection;
    a.off("all", this._onModelEvent, this)
  }, _onModelEvent: function (a, b, e, f) {
    if ("add" !== a && "remove" !== a || e === this)"destroy" === a && this.remove(b, f), b && a === "change:" + b.idAttribute && (delete this._byId[b.previous(b.idAttribute)], null != b.id && (this._byId[b.id] = b)), this.trigger.apply(this, arguments)
  }});
  f.each("forEach each map collect reduce foldl inject reduceRight foldr find detect filter select reject every all some any include contains invoke max min toArray size first head take initial rest tail drop last without difference indexOf shuffle lastIndexOf isEmpty chain sample".split(" "),
    function (a) {
      s.prototype[a] = function () {
        var b = g.call(arguments);
        b.unshift(this.models);
        return f[a].apply(f, b)
      }
    });
  f.each(["groupBy", "countBy", "sortBy", "indexBy"], function (a) {
    s.prototype[a] = function (b, e) {
      var d = f.isFunction(b) ? b : function (a) {
        return a.get(b)
      };
      return f[a](this.models, d, e)
    }
  });
  b = a.View = function (a) {
    this.cid = f.uniqueId("view");
    a || (a = {});
    f.extend(this, f.pick(a, p));
    this._ensureElement();
    this.initialize.apply(this, arguments);
    this.delegateEvents()
  };
  var v = /^(\S+)\s*(.*)$/, p = "model collection el id attributes className tagName events".split(" ");
  f.extend(b.prototype, k, {tagName: "div", $: function (a) {
    return this.$el.find(a)
  }, initialize: function () {
  }, render: function () {
    return this
  }, remove: function () {
    this.$el.remove();
    this.stopListening();
    return this
  }, setElement: function (b, e) {
    this.$el && this.undelegateEvents();
    this.$el = b instanceof a.$ ? b : a.$(b);
    this.el = this.$el[0];
    !1 !== e && this.delegateEvents();
    return this
  }, delegateEvents: function (a) {
    if (!a && !(a = f.result(this, "events")))return this;
    this.undelegateEvents();
    for (var b in a) {
      var e = a[b];
      f.isFunction(e) ||
      (e = this[a[b]]);
      if (e) {
        var d = b.match(v), g = d[1], d = d[2], e = f.bind(e, this), g = g + (".delegateEvents" + this.cid);
        if ("" === d)this.$el.on(g, e); else this.$el.on(g, d, e)
      }
    }
    return this
  }, undelegateEvents: function () {
    this.$el.off(".delegateEvents" + this.cid);
    return this
  }, _ensureElement: function () {
    if (this.el)this.setElement(f.result(this, "el"), !1); else {
      var b = f.extend({}, f.result(this, "attributes"));
      this.id && (b.id = f.result(this, "id"));
      this.className && (b["class"] = f.result(this, "className"));
      b = a.$("<" + f.result(this, "tagName") +
        ">").attr(b);
      this.setElement(b, !1)
    }
  }});
  a.sync = function (b, e, d) {
    var g = B[b];
    f.defaults(d || (d = {}), {emulateHTTP: a.emulateHTTP, emulateJSON: a.emulateJSON});
    var h = {type: g, dataType: "json"};
    d.url || (h.url = f.result(e, "url") || K());
    null != d.data || !e || "create" !== b && "update" !== b && "patch" !== b || (h.contentType = "application/json", h.data = JSON.stringify(d.attrs || e.toJSON(d)));
    d.emulateJSON && (h.contentType = "application/x-www-form-urlencoded", h.data = h.data ? {model: h.data} : {});
    if (d.emulateHTTP && ("PUT" === g || "DELETE" === g || "PATCH" ===
      g)) {
      h.type = "POST";
      d.emulateJSON && (h.data._method = g);
      var m = d.beforeSend;
      d.beforeSend = function (a) {
        a.setRequestHeader("X-HTTP-Method-Override", g);
        if (m)return m.apply(this, arguments)
      }
    }
    "GET" === h.type || d.emulateJSON || (h.processData = !1);
    "PATCH" === h.type && x && (h.xhr = function () {
      return new ActiveXObject("Microsoft.XMLHTTP")
    });
    b = d.xhr = a.ajax(f.extend(h, d));
    e.trigger("request", e, b, d);
    return b
  };
  var x = "undefined" !== typeof window && !!window.ActiveXObject && !(window.XMLHttpRequest && (new XMLHttpRequest).dispatchEvent),
    B = {create: "POST", update: "PUT", patch: "PATCH", "delete": "DELETE", read: "GET"};
  a.ajax = function () {
    return a.$.ajax.apply(a.$, arguments)
  };
  var C = a.Router = function (a) {
    a || (a = {});
    a.routes && (this.routes = a.routes);
    this._bindRoutes();
    this.initialize.apply(this, arguments)
  }, z = /\((.*?)\)/g, A = /(\(\?)?:\w+/g, u = /\*\w+/g, w = /[\-{}\[\]+?.,\\\^$|#\s]/g;
  f.extend(C.prototype, k, {initialize: function () {
  }, route: function (b, e, d) {
    f.isRegExp(b) || (b = this._routeToRegExp(b));
    f.isFunction(e) && (d = e, e = "");
    d || (d = this[e]);
    var g = this;
    a.history.route(b,
      function (f) {
        f = g._extractParameters(b, f);
        g.execute(d, f);
        g.trigger.apply(g, ["route:" + e].concat(f));
        g.trigger("route", e, f);
        a.history.trigger("route", g, e, f)
      });
    return this
  }, execute: function (a, b) {
    a && a.apply(this, b)
  }, navigate: function (b, e) {
    a.history.navigate(b, e);
    return this
  }, _bindRoutes: function () {
    if (this.routes) {
      this.routes = f.result(this, "routes");
      for (var a, b = f.keys(this.routes); null != (a = b.pop());)this.route(a, this.routes[a])
    }
  }, _routeToRegExp: function (a) {
    a = a.replace(w, "\\$&").replace(z, "(?:$1)?").replace(A,
      function (a, b) {
        return b ? a : "([^/?]+)"
      }).replace(u, "([^?]*?)");
    return RegExp("^" + a + "(?:\\?([\\s\\S]*))?$")
  }, _extractParameters: function (a, b) {
    var e = a.exec(b).slice(1);
    return f.map(e, function (a, b) {
      return b === e.length - 1 ? a || null : a ? decodeURIComponent(a) : null
    })
  }});
  var y = a.History = function () {
    this.handlers = [];
    f.bindAll(this, "checkUrl");
    "undefined" !== typeof window && (this.location = window.location, this.history = window.history)
  }, J = /^[#\/]|\s+$/g, F = /^\/+|\/+$/g, H = /msie [\w.]+/, E = /\/$/, I = /#.*$/;
  y.started = !1;
  f.extend(y.prototype,
    k, {interval: 50, atRoot: function () {
      return this.location.pathname.replace(/[^\/]$/, "$&/") === this.root
    }, getHash: function (a) {
      return(a = (a || this).location.href.match(/#(.*)$/)) ? a[1] : ""
    }, getFragment: function (a, b) {
      if (null == a)if (this._hasPushState || !this._wantsHashChange || b) {
        a = decodeURI(this.location.pathname + this.location.search);
        var e = this.root.replace(E, "");
        a.indexOf(e) || (a = a.slice(e.length))
      } else a = this.getHash();
      return a.replace(J, "")
    }, start: function (b) {
      if (y.started)throw Error("Backbone.history has already been started");
      y.started = !0;
      this.options = f.extend({root: "/"}, this.options, b);
      this.root = this.options.root;
      this._wantsHashChange = !1 !== this.options.hashChange;
      this._wantsPushState = !!this.options.pushState;
      this._hasPushState = !!(this.options.pushState && this.history && this.history.pushState);
      b = this.getFragment();
      var e = document.documentMode, e = H.exec(navigator.userAgent.toLowerCase()) && (!e || 7 >= e);
      this.root = ("/" + this.root + "/").replace(F, "/");
      e && this._wantsHashChange && (this.iframe = a.$('<iframe src="javascript:0" tabindex="-1">').hide().appendTo("body")[0].contentWindow,
        this.navigate(b));
      if (this._hasPushState)a.$(window).on("popstate", this.checkUrl); else if (this._wantsHashChange && "onhashchange"in window && !e)a.$(window).on("hashchange", this.checkUrl); else this._wantsHashChange && (this._checkUrlInterval = setInterval(this.checkUrl, this.interval));
      this.fragment = b;
      b = this.location;
      if (this._wantsHashChange && this._wantsPushState) {
        if (!this._hasPushState && !this.atRoot())return this.fragment = this.getFragment(null, !0), this.location.replace(this.root + "#" + this.fragment), !0;
        this._hasPushState &&
          this.atRoot() && b.hash && (this.fragment = this.getHash().replace(J, ""), this.history.replaceState({}, document.title, this.root + this.fragment))
      }
      if (!this.options.silent)return this.loadUrl()
    }, stop: function () {
      a.$(window).off("popstate", this.checkUrl).off("hashchange", this.checkUrl);
      this._checkUrlInterval && clearInterval(this._checkUrlInterval);
      y.started = !1
    }, route: function (a, b) {
      this.handlers.unshift({route: a, callback: b})
    }, checkUrl: function (a) {
      a = this.getFragment();
      a === this.fragment && this.iframe && (a = this.getFragment(this.getHash(this.iframe)));
      if (a === this.fragment)return!1;
      this.iframe && this.navigate(a);
      this.loadUrl()
    }, loadUrl: function (a) {
      a = this.fragment = this.getFragment(a);
      return f.any(this.handlers, function (b) {
        if (b.route.test(a))return b.callback(a), !0
      })
    }, navigate: function (a, b) {
      if (!y.started)return!1;
      b && !0 !== b || (b = {trigger: !!b});
      var e = this.root + (a = this.getFragment(a || ""));
      a = a.replace(I, "");
      if (this.fragment !== a) {
        this.fragment = a;
        "" === a && "/" !== e && (e = e.slice(0, -1));
        if (this._hasPushState)this.history[b.replace ? "replaceState" : "pushState"]({},
          document.title, e); else if (this._wantsHashChange)this._updateHash(this.location, a, b.replace), this.iframe && a !== this.getFragment(this.getHash(this.iframe)) && (b.replace || this.iframe.document.open().close(), this._updateHash(this.iframe.location, a, b.replace)); else return this.location.assign(e);
        if (b.trigger)return this.loadUrl(a)
      }
    }, _updateHash: function (a, b, e) {
      e ? (e = a.href.replace(/(javascript:|#).*$/, ""), a.replace(e + "#" + b)) : a.hash = "#" + b
    }});
  a.history = new y;
  m.extend = s.extend = C.extend = b.extend = y.extend = function (a, b) {
    var e = this, d;
    d = a && f.has(a, "constructor") ? a.constructor : function () {
      return e.apply(this, arguments)
    };
    f.extend(d, e, b);
    var g = function () {
      this.constructor = d
    };
    g.prototype = e.prototype;
    d.prototype = new g;
    a && f.extend(d.prototype, a);
    d.__super__ = e.prototype;
    return d
  };
  var K = function () {
    throw Error('A "url" property or function must be specified');
  }, N = function (a, b) {
    var e = b.error;
    b.error = function (f) {
      e && e(a, f, b);
      a.trigger("error", a, f, b)
    }
  };
  return a
});
(function () {
  var d = function (a) {
    var f, b, e, d;

    function k(a) {
      if (a.paused || a.ended || u)return!1;
      try {
        p.clearRect(0, 0, t, r), p.drawImage(a, 0, 0, t, r)
      } catch (b) {
      }
      y = setTimeout(k, K.duration, a);
      I.setIcon(v)
    }

    function h(a) {
      a = a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i, function (a, b, e, f) {
        return b + b + e + e + f + f
      });
      return(a = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a)) ? {r: parseInt(a[1], 16), g: parseInt(a[2], 16), b: parseInt(a[3], 16)} : !1
    }

    function l(a, b) {
      var e = {}, f;
      for (f in a)e[f] = a[f];
      for (f in b)e[f] = b[f];
      return e
    }

    a = a ? a : {};
    var n = {bgColor: "#d00", textColor: "#fff", fontFamily: "sans-serif", fontStyle: "bold", type: "circle", position: "down", animation: "slide", elementId: !1}, m, s, r, t, v, p, x, B, C, z, A, u, w, y;
    d = e = b = f = void 0;
    f = /firefox/i.test(navigator.userAgent.toLowerCase());
    b = /chrome/i.test(navigator.userAgent.toLowerCase());
    e = /opera/i.test(navigator.userAgent.toLowerCase());
    /msie/i.test(navigator.userAgent.toLowerCase()) || /trident/i.test(navigator.userAgent.toLowerCase());
    d = b || f || e;
    var J = [];
    A = function () {
    };
    B = u = !1;
    var F = {ready: function () {
      B = !0;
      F.reset();
      A()
    }, reset: function () {
      B && (J = [], C = !1, p.clearRect(0, 0, t, r), p.drawImage(x, 0, 0, t, r), I.setIcon(v), window.clearTimeout(w), window.clearTimeout(y))
    }, start: function () {
      if (B && !z && 0 < J.length) {
        z = !0;
        var a = function () {
          "type animation bgColor textColor fontFamily fontStyle".split(" ").forEach(function (a) {
            a in J[0].options && (m[a] = J[0].options[a])
          });
          K.run(J[0].options, function () {
            C = J[0];
            z = !1;
            0 < J.length && (J.shift(), F.start())
          }, !1)
        };
        C ? K.run(C.options, function () {
          a()
        }, !0) : a()
      }
    }}, H = {}, E = function (a) {
      a.n = "number" === typeof a.n ? Math.abs(a.n | 0) : a.n;
      a.x *= t;
      a.y *= r;
      a.w *= t;
      a.h *= r;
      a.len = ("" + a.n).length;
      return a
    };
    H.circle = function (a) {
      a = E(a);
      var b = !1;
      2 === a.len ? (a.x -= 0.4 * a.w, a.w *= 1.4, b = !0) : 3 <= a.len && (a.x -= 0.65 * a.w, a.w *= 1.65, b = !0);
      p.clearRect(0, 0, t, r);
      p.drawImage(x, 0, 0, t, r);
      p.beginPath();
      p.font = m.fontStyle + " " + Math.floor(a.h * (99 < a.n ? 0.85 : 1)) + "px " + m.fontFamily;
      p.textAlign = "center";
      b ? (p.moveTo(a.x + a.w / 2, a.y), p.lineTo(a.x + a.w - a.h / 2, a.y), p.quadraticCurveTo(a.x + a.w, a.y, a.x + a.w, a.y + a.h / 2), p.lineTo(a.x + a.w, a.y + a.h - a.h / 2), p.quadraticCurveTo(a.x +
        a.w, a.y + a.h, a.x + a.w - a.h / 2, a.y + a.h), p.lineTo(a.x + a.h / 2, a.y + a.h), p.quadraticCurveTo(a.x, a.y + a.h, a.x, a.y + a.h - a.h / 2), p.lineTo(a.x, a.y + a.h / 2), p.quadraticCurveTo(a.x, a.y, a.x + a.h / 2, a.y)) : p.arc(a.x + a.w / 2, a.y + a.h / 2, a.h / 2, 0, 2 * Math.PI);
      p.fillStyle = "rgba(" + m.bgColor.r + "," + m.bgColor.g + "," + m.bgColor.b + "," + a.o + ")";
      p.fill();
      p.closePath();
      p.beginPath();
      p.stroke();
      p.fillStyle = "rgba(" + m.textColor.r + "," + m.textColor.g + "," + m.textColor.b + "," + a.o + ")";
      "number" === typeof a.n && 999 < a.n ? p.fillText((9999 < a.n ? 9 : Math.floor(a.n / 1E3)) +
        "k+", Math.floor(a.x + a.w / 2), Math.floor(a.y + a.h - 0.2 * a.h)) : p.fillText(a.n, Math.floor(a.x + a.w / 2), Math.floor(a.y + a.h - 0.15 * a.h));
      p.closePath()
    };
    H.rectangle = function (a) {
      a = E(a);
      2 === a.len ? (a.x -= 0.4 * a.w, a.w *= 1.4) : 3 <= a.len && (a.x -= 0.65 * a.w, a.w *= 1.65);
      p.clearRect(0, 0, t, r);
      p.drawImage(x, 0, 0, t, r);
      p.beginPath();
      p.font = "bold " + Math.floor(a.h * (99 < a.n ? 0.9 : 1)) + "px sans-serif";
      p.textAlign = "center";
      p.fillStyle = "rgba(" + m.bgColor.r + "," + m.bgColor.g + "," + m.bgColor.b + "," + a.o + ")";
      p.fillRect(a.x, a.y, a.w, a.h);
      p.fillStyle = "rgba(" +
        m.textColor.r + "," + m.textColor.g + "," + m.textColor.b + "," + a.o + ")";
      "number" === typeof a.n && 3 < a.len ? p.fillText((9999 < a.n ? 9 : Math.floor(a.n / 1E3)) + "k+", Math.floor(a.x + a.w / 2), Math.floor(a.y + a.h - 0.2 * a.h)) : p.fillText(a.n, Math.floor(a.x + a.w / 2), Math.floor(a.y + a.h - 0.15 * a.h));
      p.closePath()
    };
    var I = {getIcon: function () {
      var a = !1, b = "";
      if (m.elementId)a = document.getElementById(m.elementId), a.setAttribute("href", a.getAttribute("src")); else {
        a:{
          a = document.getElementsByTagName("head")[0].getElementsByTagName("link");
          for (b = a.length -
            1; 0 <= b; b--)if (/(^|\s)icon(\s|$)/i.test(a[b].getAttribute("rel"))) {
            a = a[b];
            break a
          }
          a = !1
        }
        !1 === a && (a = document.createElement("link"), a.setAttribute("rel", "icon"), document.getElementsByTagName("head")[0].appendChild(a))
      }
      b = m.elementId ? a.src : a.href;
      if (-1 === b.indexOf(document.location.hostname))throw Error("Error setting favicon. Favicon image is on different domain (Icon: " + b + ", Domain: " + document.location.hostname + ")");
      a.setAttribute("type", "image/png");
      return a
    }, setIcon: function (a) {
      a = a.toDataURL("image/png");
      if (m.elementId)document.getElementById(m.elementId).setAttribute("src", a); else if (f || e) {
        var b = s;
        s = document.createElement("link");
        e && s.setAttribute("rel", "icon");
        s.setAttribute("rel", "icon");
        s.setAttribute("type", "image/png");
        document.getElementsByTagName("head")[0].appendChild(s);
        s.setAttribute("href", a);
        b.parentNode && b.parentNode.removeChild(b)
      } else s.setAttribute("href", a)
    }}, K = {duration: 40, types: {}};
    K.types.fade = [
      {x: 0.4, y: 0.4, w: 0.6, h: 0.6, o: 0},
      {x: 0.4, y: 0.4, w: 0.6, h: 0.6, o: 0.1},
      {x: 0.4, y: 0.4, w: 0.6, h: 0.6,
        o: 0.2},
      {x: 0.4, y: 0.4, w: 0.6, h: 0.6, o: 0.3},
      {x: 0.4, y: 0.4, w: 0.6, h: 0.6, o: 0.4},
      {x: 0.4, y: 0.4, w: 0.6, h: 0.6, o: 0.5},
      {x: 0.4, y: 0.4, w: 0.6, h: 0.6, o: 0.6},
      {x: 0.4, y: 0.4, w: 0.6, h: 0.6, o: 0.7},
      {x: 0.4, y: 0.4, w: 0.6, h: 0.6, o: 0.8},
      {x: 0.4, y: 0.4, w: 0.6, h: 0.6, o: 0.9},
      {x: 0.4, y: 0.4, w: 0.6, h: 0.6, o: 1}
    ];
    K.types.none = [
      {x: 0.4, y: 0.4, w: 0.6, h: 0.6, o: 1}
    ];
    K.types.pop = [
      {x: 1, y: 1, w: 0, h: 0, o: 1},
      {x: 0.9, y: 0.9, w: 0.1, h: 0.1, o: 1},
      {x: 0.8, y: 0.8, w: 0.2, h: 0.2, o: 1},
      {x: 0.7, y: 0.7, w: 0.3, h: 0.3, o: 1},
      {x: 0.6, y: 0.6, w: 0.4, h: 0.4, o: 1},
      {x: 0.5, y: 0.5, w: 0.5, h: 0.5, o: 1},
      {x: 0.4, y: 0.4,
        w: 0.6, h: 0.6, o: 1}
    ];
    K.types.popFade = [
      {x: 0.75, y: 0.75, w: 0, h: 0, o: 0},
      {x: 0.65, y: 0.65, w: 0.1, h: 0.1, o: 0.2},
      {x: 0.6, y: 0.6, w: 0.2, h: 0.2, o: 0.4},
      {x: 0.55, y: 0.55, w: 0.3, h: 0.3, o: 0.6},
      {x: 0.5, y: 0.5, w: 0.4, h: 0.4, o: 0.8},
      {x: 0.45, y: 0.45, w: 0.5, h: 0.5, o: 0.9},
      {x: 0.4, y: 0.4, w: 0.6, h: 0.6, o: 1}
    ];
    K.types.slide = [
      {x: 0.4, y: 1, w: 0.6, h: 0.6, o: 1},
      {x: 0.4, y: 0.9, w: 0.6, h: 0.6, o: 1},
      {x: 0.4, y: 0.9, w: 0.6, h: 0.6, o: 1},
      {x: 0.4, y: 0.8, w: 0.6, h: 0.6, o: 1},
      {x: 0.4, y: 0.7, w: 0.6, h: 0.6, o: 1},
      {x: 0.4, y: 0.6, w: 0.6, h: 0.6, o: 1},
      {x: 0.4, y: 0.5, w: 0.6, h: 0.6, o: 1},
      {x: 0.4, y: 0.4, w: 0.6,
        h: 0.6, o: 1}
    ];
    K.run = function (a, b, e, f) {
      var d = K.types[document.hidden || document.msHidden || document.webkitHidden || document.mozHidden ? "none" : m.animation];
      f = !0 === e ? "undefined" !== typeof f ? f : d.length - 1 : "undefined" !== typeof f ? f : 0;
      b = b ? b : function () {
      };
      f < d.length && 0 <= f ? (H[m.type](l(a, d[f])), w = setTimeout(function () {
        f = e ? f - 1 : f + 1;
        K.run(a, b, e, f)
      }, K.duration), I.setIcon(v)) : b()
    };
    (function () {
      m = l(n, a);
      m.bgColor = h(m.bgColor);
      m.textColor = h(m.textColor);
      m.position = m.position.toLowerCase();
      m.animation = K.types["" + m.animation] ?
        m.animation : n.animation;
      var b = -1 < m.position.indexOf("up"), e = -1 < m.position.indexOf("left");
      if (b || e)for (var f = 0; f < K.types["" + m.animation].length; f++) {
        var d = K.types["" + m.animation][f];
        b && (d.y = 0.6 > d.y ? d.y - 0.4 : d.y - 2 * d.y + (1 - d.w));
        e && (d.x = 0.6 > d.x ? d.x - 0.4 : d.x - 2 * d.x + (1 - d.h));
        K.types["" + m.animation][f] = d
      }
      m.type = H["" + m.type] ? m.type : n.type;
      try {
        s = I.getIcon(), v = document.createElement("canvas"), x = document.createElement("img"), s.hasAttribute("href") ? (x.setAttribute("src", s.getAttribute("href")), x.onload = function () {
          r =
            0 < x.height ? x.height : 32;
          t = 0 < x.width ? x.width : 32;
          v.height = r;
          v.width = t;
          p = v.getContext("2d");
          F.ready()
        }) : (x.setAttribute("src", ""), t = r = 32, x.height = r, x.width = t, v.height = r, v.width = t, p = v.getContext("2d"), F.ready())
      } catch (g) {
        throw"Error initializing favico. Message: " + g.message;
      }
    })();
    return{badge: function (a, b) {
      b = ("string" === typeof b ? {animation: b} : b) || {};
      A = function () {
        try {
          if ("number" === typeof a ? 0 < a : "" !== a) {
            var e = {type: "badge", options: {n: a}};
            "animation"in b && K.types["" + b.animation] && (e.options.animation = "" + b.animation);
            "type"in b && H["" + b.type] && (e.options.type = "" + b.type);
            ["bgColor", "textColor"].forEach(function (a) {
              a in b && (e.options[a] = h(b[a]))
            });
            ["fontStyle", "fontFamily"].forEach(function (a) {
              a in b && (e.options[a] = b[a])
            });
            J.push(e);
            if (100 < J.length)throw"Too many badges requests in queue.";
            F.start()
          } else F.reset()
        } catch (f) {
          throw"Error setting badge. Message: " + f.message;
        }
      };
      B && A()
    }, video: function (a) {
      A = function () {
        try {
          "stop" === a ? (u = !0, F.reset(), u = !1) : a.addEventListener("play", function () {
            k(this)
          }, !1)
        } catch (b) {
          throw"Error setting video. Message: " +
            b.message;
        }
      };
      B && A()
    }, image: function (a) {
      A = function () {
        try {
          var b = a.width, e = a.height, f = document.createElement("img"), d = b / t < e / r ? b / t : e / r;
          f.setAttribute("src", a.getAttribute("src"));
          f.height = e / d;
          f.width = b / d;
          p.clearRect(0, 0, t, r);
          p.drawImage(f, 0, 0, t, r);
          I.setIcon(v)
        } catch (g) {
          throw"Error setting image. Message: " + g.message;
        }
      };
      B && A()
    }, webcam: function (a) {
      window.URL && window.URL.createObjectURL || (window.URL = window.URL || {}, window.URL.createObjectURL = function (a) {
        return a
      });
      if (d) {
        var b = !1;
        navigator.getUserMedia = navigator.getUserMedia ||
          navigator.oGetUserMedia || navigator.msGetUserMedia || navigator.mozGetUserMedia || navigator.webkitGetUserMedia;
        A = function () {
          try {
            "stop" === a ? (u = !0, F.reset(), u = !1) : (b = document.createElement("video"), b.width = t, b.height = r, navigator.getUserMedia({video: !0, audio: !1}, function (a) {
              b.src = URL.createObjectURL(a);
              b.play();
              k(b)
            }, function () {
            }))
          } catch (e) {
            throw"Error setting webcam. Message: " + e.message;
          }
        };
        B && A()
      }
    }, reset: F.reset}
  };
  "undefined" !== typeof define && define.amd ? define("favico", [], function () {
    return d
  }) : "undefined" !== typeof module && module.exports ? module.exports = d : this.Favico = d
})();
(function () {
  define("warehouse", [], function () {
    var d, a;
    teambition.Data = d = {models: {}, collections: {}, others: {}};
    a = 0;
    return{getAll: function () {
      return d
    }, createModel: function (a, b, e) {
      a || console.error(a);
      return new a(b || {}, _.extend({parse: !0}, e))
    }, createCollection: function (a, b, e) {
      a || console.error(a);
      return new a(b || [], _.extend({parse: !0, _boundToObjectId: 0}, e))
    }, get: function (a, b, e, d) {
      b || (b = 0);
      a = this._findOrCreate(a, b, d);
      return e ? a.get(e) : a
    }, set: function (a, b, e) {
      a = this.get(a, b, null, {synced: !0, _boundToObjectId: b});
      a.set(e, {parse: !0});
      return a
    }, one: function (a, b) {
      var e, g;
      a = a["export"] || a;
      return(e = d.models)[g = a.prototype.name] || (e[g] = this.createModel(a, b))
    }, findCollection: function (a, b) {
      var e;
      a = a["export"] || a;
      return null != (e = d.collections[a.prototype.name]) ? e[b] : void 0
    }, _findOrCreate: function (a, b, e) {
      var g, k;
      e || (e = {});
      a = a["export"] || a;
      g = a.prototype.name;
      (k = d.collections)[g] || (k[g] = {});
      g = d.collections[g];
      g[b] || (e._boundToObjectId = b, g[b] = this.createCollection(a, [], e));
      return g[b]
    }, request: function (a, b, e, d) {
      var k,
        h, l, n, m, s;
      if ("object" === typeof arguments[arguments.length - 1])l = arguments[arguments.length - 1]; else return this.get(a, b, e, d);
      if (4 === arguments.length)k = arguments[0], m = arguments[1] || 0, s = arguments[2]; else if (3 === arguments.length)k = arguments[0], m = arguments[1] || 0; else return l.error({message: "arguments error"}, null);
      h = this._findOrCreate(k, m, l);
      if (s)return(k = h.get(s)) ? null != l ? "function" === typeof l.success ? l.success(k, !0) : void 0 : void 0 : h.fetchOne(s, l);
      if (h.synced)return"function" === typeof l.beforeSend && l.beforeSend(h),
        l.success(h, !0);
      n = l.success;
      l.success = function (a, b) {
        return n(h)
      };
      return h.fetch(l)
    }, fetchOne: function (a, b, e) {
      var d, k = this;
      "function" === typeof e.beforeSend && e.beforeSend();
      a = a["export"] || a;
      d = a.prototype.name;
      this.socket.emit("read:" + d, {_id: b});
      return this.socket.once("read:" + d + "/" + b, function (b) {
        if (b.errorCode)return"function" === typeof e.error ? e.error(b.errorCode) : void 0;
        b = k.createModel(a, b[d], {parse: !0});
        return"function" === typeof e.success ? e.success(b) : void 0
      })
    }, fetch: function (a, b, e) {
      var g;
      e || (e = {});
      "function" === typeof e.beforeSend && e.beforeSend();
      (g = d.others)[a] || (g[a] = {});
      if ((g = d.others[a][b]) && g.expires > Date.now())return"function" === typeof e.success ? e.success(g) : void 0;
      this.socket.emit("read:" + a, e.params);
      return this.socket.once("read:" + a + "/" + b, function (g) {
        if (g.errorCode)return"function" === typeof e.error ? e.error(g.errorCode) : void 0;
        g.expires || (g.expires = e.expires + Date.now());
        d.others[a][b] = g;
        return"function" === typeof e.success ? e.success(g) : void 0
      })
    }, connect: function (f, b) {
      if (!f || !window.io)return!1;
      b = _.extend({onConnect: function () {
      }, onReconnect: function () {
      }, onDisconnect: function () {
      }, onError: function () {
      }}, b);
      window.socket = this.socket = window.io.connect(f, {"connect timeout": 6E3, "try multiple transports": !1});
      this.socket.on("connect", function () {
        a++;
        return 1 === a ? b.onConnect(a) : b.onReconnect(a)
      });
      this.socket.on("disconnect", function () {
        if (0 < a)return b.onDisconnect()
      });
      this.socket.on("error", function (a) {
        return b.onError(a)
      });
      return this
    }, disconnect: function () {
      var f;
      a = 0;
      null != (f = this.socket) && f.disconnect();
      window.io.sockets = {};
      return this
    }}
  })
}).call(this);
(function (d) {
  function a(a, b) {
    return function (e) {
      return l(a.call(this, e), b)
    }
  }

  function f(a, b) {
    return function (e) {
      return this.lang().ordinal(a.call(this, e), b)
    }
  }

  function b() {
  }

  function e(a) {
    B(a);
    k(this, a)
  }

  function g(a) {
    var b = t(a), e = b.year || 0, f = b.month || 0, d = b.week || 0, g = b.day || 0, h = b.hour || 0, m = b.minute || 0, p = b.second || 0, b = b.millisecond || 0;
    this._input = a;
    this._milliseconds = +b + 1E3 * p + 6E4 * m + 36E5 * h;
    this._days = +g + 7 * d;
    this._months = +f + 12 * e;
    this._data = {};
    this._bubble()
  }

  function k(a, b) {
    for (var e in b)b.hasOwnProperty(e) &&
    (a[e] = b[e]);
    b.hasOwnProperty("toString") && (a.toString = b.toString);
    b.hasOwnProperty("valueOf") && (a.valueOf = b.valueOf);
    return a
  }

  function h(a) {
    return 0 > a ? Math.ceil(a) : Math.floor(a)
  }

  function l(a, b) {
    for (var e = a + ""; e.length < b;)e = "0" + e;
    return e
  }

  function n(a, b, e, f) {
    var d = b._milliseconds, g = b._days;
    b = b._months;
    var h, m;
    d && a._d.setTime(+a._d + d * e);
    if (g || b)h = a.minute(), m = a.hour();
    g && a.date(a.date() + g * e);
    b && a.month(a.month() + b * e);
    d && !f && G.updateOffset(a);
    if (g || b)a.minute(h), a.hour(m)
  }

  function m(a) {
    return"[object Array]" ===
      Object.prototype.toString.call(a)
  }

  function s(a, b, e) {
    var f = Math.min(a.length, b.length), d = Math.abs(a.length - b.length), g = 0, h;
    for (h = 0; h < f; h++)(e && a[h] !== b[h] || !e && p(a[h]) !== p(b[h])) && g++;
    return g + d
  }

  function r(a) {
    if (a) {
      var b = a.toLowerCase().replace(/(.)s$/, "$1");
      a = Va[a] || ab[b] || b
    }
    return a
  }

  function t(a) {
    var b = {}, e, f;
    for (f in a)a.hasOwnProperty(f) && (e = r(f)) && (b[e] = a[f]);
    return b
  }

  function v(a) {
    var b, e;
    if (0 === a.indexOf("week"))b = 7, e = "day"; else if (0 === a.indexOf("month"))b = 12, e = "month"; else return;
    G[a] = function (f, g) {
      var h, m, p = G.fn._lang[a], l = [];
      "number" === typeof f && (g = f, f = d);
      m = function (a) {
        a = G().utc().set(e, a);
        return p.call(G.fn._lang, a, f || "")
      };
      if (null != g)return m(g);
      for (h = 0; h < b; h++)l.push(m(h));
      return l
    }
  }

  function p(a) {
    a = +a;
    var b = 0;
    0 !== a && isFinite(a) && (b = 0 <= a ? Math.floor(a) : Math.ceil(a));
    return b
  }

  function x(a) {
    return 0 === a % 4 && 0 !== a % 100 || 0 === a % 400
  }

  function B(a) {
    var b;
    a._a && -2 === a._pf.overflow && (b = 0 > a._a[fa] || 11 < a._a[fa] ? fa : 1 > a._a[U] || a._a[U] > (new Date(Date.UTC(a._a[aa], a._a[fa] + 1, 0))).getUTCDate() ? U : 0 > a._a[W] ||
      23 < a._a[W] ? W : 0 > a._a[ka] || 59 < a._a[ka] ? ka : 0 > a._a[pa] || 59 < a._a[pa] ? pa : 0 > a._a[sa] || 999 < a._a[sa] ? sa : -1, a._pf._overflowDayOfYear && (b < aa || b > U) && (b = U), a._pf.overflow = b)
  }

  function C(a) {
    a._pf = {empty: !1, unusedTokens: [], unusedInput: [], overflow: -2, charsLeftOver: 0, nullInput: !1, invalidMonth: null, invalidFormat: !1, userInvalidated: !1}
  }

  function z(a) {
    null == a._isValid && (a._isValid = !isNaN(a._d.getTime()) && 0 > a._pf.overflow && !a._pf.empty && !a._pf.invalidMonth && !a._pf.nullInput && !a._pf.invalidFormat && !a._pf.userInvalidated,
      a._strict && (a._isValid = a._isValid && 0 === a._pf.charsLeftOver && 0 === a._pf.unusedTokens.length));
    return a._isValid
  }

  function A(a) {
    return a ? a.toLowerCase().replace("_", "-") : a
  }

  function u(a) {
    var b = 0, e, f, d, g, h = function (a) {
      if (!q[a] && ta)try {
        require("./lang/" + a)
      } catch (b) {
      }
      return q[a]
    };
    if (!a)return G.fn._lang;
    if (!m(a)) {
      if (f = h(a))return f;
      a = [a]
    }
    for (; b < a.length;) {
      g = A(a[b]).split("-");
      e = g.length;
      for (d = (d = A(a[b + 1])) ? d.split("-") : null; 0 < e;) {
        if (f = h(g.slice(0, e).join("-")))return f;
        if (d && d.length >= e && s(g, d, !0) >= e - 1)break;
        e--
      }
      b++
    }
    return G.fn._lang
  }

  function w(a) {
    return a.match(/\[[\s\S]/) ? a.replace(/^\[|\]$/g, "") : a.replace(/\\/g, "")
  }

  function y(a) {
    var b = a.match(Ba), e, f;
    e = 0;
    for (f = b.length; e < f; e++)b[e] = na[b[e]] ? na[b[e]] : w(b[e]);
    return function (d) {
      var g = "";
      for (e = 0; e < f; e++)g += b[e]instanceof Function ? b[e].call(d, a) : b[e];
      return g
    }
  }

  function J(a, b) {
    if (!a.isValid())return a.lang().invalidDate();
    b = F(b, a.lang());
    Ja[b] || (Ja[b] = y(b));
    return Ja[b](a)
  }

  function F(a, b) {
    function e(a) {
      return b.longDateFormat(a) || a
    }

    var f = 5;
    for (ha.lastIndex =
           0; 0 <= f && ha.test(a);)a = a.replace(ha, e), ha.lastIndex = 0, f -= 1;
    return a
  }

  function H(a, b) {
    switch (a) {
      case "DDDD":
        return la;
      case "YYYY":
      case "GGGG":
      case "gggg":
        return X;
      case "YYYYY":
      case "GGGGG":
      case "ggggg":
        return P;
      case "S":
      case "SS":
      case "SSS":
      case "DDD":
        return wa;
      case "MMM":
      case "MMMM":
      case "dd":
      case "ddd":
      case "dddd":
        return Ka;
      case "a":
      case "A":
        return u(b._l)._meridiemParse;
      case "X":
        return Ma;
      case "Z":
      case "ZZ":
        return ya;
      case "T":
        return Fa;
      case "MM":
      case "DD":
      case "YY":
      case "GG":
      case "gg":
      case "HH":
      case "hh":
      case "mm":
      case "ss":
      case "M":
      case "D":
      case "d":
      case "H":
      case "h":
      case "m":
      case "s":
      case "w":
      case "ww":
      case "W":
      case "WW":
      case "e":
      case "E":
        return Ea;
      default:
        var e = RegExp, f;
        f = R(a.replace("\\", "")).replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&");
        return new e(f)
    }
  }

  function E(a) {
    a = ((ya.exec(a) || [])[0] + "").match($a) || ["-", 0, 0];
    var b = +(60 * a[1]) + p(a[2]);
    return"+" === a[0] ? -b : b
  }

  function I(a) {
    var b, e = [], f, d, g, h, m;
    if (!a._d) {
      f = K(a);
      a._w && null == a._a[U] && null == a._a[fa] && (b = function (b) {
        return b ? 3 > b.length ? 68 < parseInt(b, 10) ? "19" + b : "20" + b : b : null == a._a[aa] ? G().weekYear() : a._a[aa]
      }, d = a._w, null != d.GG || null != d.W || null != d.E ? b = T(b(d.GG), d.W || 1, d.E, 4, 1) : (g = u(a._l), h = null != d.d ?
        D(d.d, g) : null != d.e ? parseInt(d.e, 10) + g._week.dow : 0, m = parseInt(d.w, 10) || 1, null != d.d && h < g._week.dow && m++, b = T(b(d.gg), m, h, g._week.doy, g._week.dow)), a._a[aa] = b.year, a._dayOfYear = b.dayOfYear);
      a._dayOfYear && (b = null == a._a[aa] ? f[aa] : a._a[aa], a._dayOfYear > (x(b) ? 366 : 365) && (a._pf._overflowDayOfYear = !0), b = L(b, 0, a._dayOfYear), a._a[fa] = b.getUTCMonth(), a._a[U] = b.getUTCDate());
      for (b = 0; 3 > b && null == a._a[b]; ++b)a._a[b] = e[b] = f[b];
      for (; 7 > b; b++)a._a[b] = e[b] = null == a._a[b] ? 2 === b ? 1 : 0 : a._a[b];
      e[W] += p((a._tzm || 0) / 60);
      e[ka] +=
        p((a._tzm || 0) % 60);
      a._d = (a._useUTC ? L : S).apply(null, e)
    }
  }

  function K(a) {
    var b = new Date;
    return a._useUTC ? [b.getUTCFullYear(), b.getUTCMonth(), b.getUTCDate()] : [b.getFullYear(), b.getMonth(), b.getDate()]
  }

  function N(a) {
    a._a = [];
    a._pf.empty = !0;
    var b = u(a._l), e = "" + a._i, f, d, g, h, m = e.length, l = 0;
    d = F(a._f, b).match(Ba) || [];
    for (b = 0; b < d.length; b++) {
      g = d[b];
      if (f = (H(g, a).exec(e) || [])[0])h = e.substr(0, e.indexOf(f)), 0 < h.length && a._pf.unusedInput.push(h), e = e.slice(e.indexOf(f) + f.length), l += f.length;
      if (na[g]) {
        f ? a._pf.empty = !1 :
          a._pf.unusedTokens.push(g);
        h = a;
        var k = void 0, t = h._a;
        switch (g) {
          case "M":
          case "MM":
            null != f && (t[fa] = p(f) - 1);
            break;
          case "MMM":
          case "MMMM":
            k = u(h._l).monthsParse(f);
            null != k ? t[fa] = k : h._pf.invalidMonth = f;
            break;
          case "D":
          case "DD":
            null != f && (t[U] = p(f));
            break;
          case "DDD":
          case "DDDD":
            null != f && (h._dayOfYear = p(f));
            break;
          case "YY":
            t[aa] = p(f) + (68 < p(f) ? 1900 : 2E3);
            break;
          case "YYYY":
          case "YYYYY":
            t[aa] = p(f);
            break;
          case "a":
          case "A":
            h._isPm = u(h._l).isPM(f);
            break;
          case "H":
          case "HH":
          case "h":
          case "hh":
            t[W] = p(f);
            break;
          case "m":
          case "mm":
            t[ka] =
              p(f);
            break;
          case "s":
          case "ss":
            t[pa] = p(f);
            break;
          case "S":
          case "SS":
          case "SSS":
            t[sa] = p(1E3 * ("0." + f));
            break;
          case "X":
            h._d = new Date(1E3 * parseFloat(f));
            break;
          case "Z":
          case "ZZ":
            h._useUTC = !0;
            h._tzm = E(f);
            break;
          case "w":
          case "ww":
          case "W":
          case "WW":
          case "d":
          case "dd":
          case "ddd":
          case "dddd":
          case "e":
          case "E":
            g = g.substr(0, 1);
          case "gg":
          case "gggg":
          case "GG":
          case "GGGG":
          case "GGGGG":
            g = g.substr(0, 2), f && (h._w = h._w || {}, h._w[g] = f)
        }
      } else a._strict && !f && a._pf.unusedTokens.push(g)
    }
    a._pf.charsLeftOver = m - l;
    0 < e.length &&
    a._pf.unusedInput.push(e);
    a._isPm && 12 > a._a[W] && (a._a[W] += 12);
    !1 === a._isPm && 12 === a._a[W] && (a._a[W] = 0);
    I(a);
    B(a)
  }

  function R(a) {
    return a.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function (a, b, e, f, d) {
      return b || e || f || d
    })
  }

  function S(a, b, e, f, d, g, h) {
    b = new Date(a, b, e, f, d, g, h);
    1970 > a && b.setFullYear(a);
    return b
  }

  function L(a) {
    var b = new Date(Date.UTC.apply(null, arguments));
    1970 > a && b.setUTCFullYear(a);
    return b
  }

  function D(a, b) {
    if ("string" === typeof a)if (isNaN(a)) {
      if (a = b.weekdaysParse(a), "number" !== typeof a)return null
    } else a =
      parseInt(a, 10);
    return a
  }

  function Y(a, b, e, f, d) {
    return d.relativeTime(b || 1, !!e, a, f)
  }

  function M(a, b, e) {
    b = e - b;
    e -= a.day();
    e > b && (e -= 7);
    e < b - 7 && (e += 7);
    a = G(a).add("d", e);
    return{week: Math.ceil(a.dayOfYear() / 7), year: a.year()}
  }

  function T(a, b, e, f, d) {
    var g = (new Date(Date.UTC(a, 0))).getUTCDay();
    b = 7 * (b - 1) + ((null != e ? e : d) - d) + (d - g + (g > f ? 7 : 0)) + 1;
    return{year: 0 < b ? a : a - 1, dayOfYear: 0 < b ? b : (x(a - 1) ? 366 : 365) + b}
  }

  function da(a) {
    var b = a._i, f = a._f;
    "undefined" === typeof a._pf && C(a);
    if (null === b)return G.invalid({nullInput: !0});
    "string" === typeof b && (a._i = b = u().preparse(b));
    if (G.isMoment(b))a = k({}, b), a._d = new Date(+b._d); else if (f)if (m(f)) {
      var b = a, g, h, p, l;
      if (0 === b._f.length)b._pf.invalidFormat = !0, b._d = new Date(NaN); else {
        for (f = 0; f < b._f.length; f++)if (l = 0, g = k({}, b), C(g), g._f = b._f[f], N(g), z(g) && (l += g._pf.charsLeftOver, l += 10 * g._pf.unusedTokens.length, g._pf.score = l, null == p || l < p))p = l, h = g;
        k(b, h || g)
      }
    } else N(a); else if (g = a, h = g._i, p = ca.exec(h), h === d)g._d = new Date; else if (p)g._d = new Date(+p[1]); else if ("string" === typeof h)if (p = g._i, b = Za.exec(p)) {
      for (h =
             4; 0 < h; h--)if (b[h]) {
        g._f = ma[h - 1] + (b[6] || " ");
        break
      }
      for (h = 0; 4 > h; h++)if (Ga[h][1].exec(p)) {
        g._f += Ga[h][0];
        break
      }
      ya.exec(p) && (g._f += " Z");
      N(g)
    } else g._d = new Date(p); else m(h) ? (g._a = h.slice(0), I(g)) : "[object Date]" === Object.prototype.toString.call(h) ? g._d = new Date(+h) : "object" === typeof h ? g._d || (h = t(g._i), g._a = [h.year, h.month, h.day, h.hour, h.minute, h.second, h.millisecond], I(g)) : g._d = new Date(h);
    return new e(a)
  }

  function Z(a, b) {
    G.fn[a] = G.fn[a + "s"] = function (a) {
      var e = this._isUTC ? "UTC" : "";
      return null != a ? (this._d["set" +
        e + b](a), G.updateOffset(this), this) : this._d["get" + e + b]()
    }
  }

  function O(a) {
    G.duration.fn[a] = function () {
      return this._data[a]
    }
  }

  function ja(a, b) {
    G.duration.fn["as" + a] = function () {
      return+this / b
    }
  }

  function ea() {
    "undefined" === typeof ender && (this.moment = G)
  }

  for (var G, ba = Math.round, Q, aa = 0, fa = 1, U = 2, W = 3, ka = 4, pa = 5, sa = 6, q = {}, ta = "undefined" !== typeof module && module.exports, ca = /^\/?Date\((\-?\d+)/i, Aa = /(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/, ga = /^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,
         Ba = /(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g, ha = /(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g, Ea = /\d\d?/, wa = /\d{1,3}/, la = /\d{3}/, X = /\d{1,4}/, P = /[+\-]?\d{1,6}/, Ka = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i, ya = /Z|[\+\-]\d\d:?\d\d/i, Fa = /T/i, Ma = /[\+\-]?\d+(\.\d{1,3})?/, Za = /^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?$/,
         ma = ["YYYY-MM-DD", "GGGG-[W]WW", "GGGG-[W]WW-E", "YYYY-DDD"], Ga = [
      ["HH:mm:ss.S", /(T| )\d\d:\d\d:\d\d\.\d{1,3}/],
      ["HH:mm:ss", /(T| )\d\d:\d\d:\d\d/],
      ["HH:mm", /(T| )\d\d:\d\d/],
      ["HH", /(T| )\d\d/]
    ], $a = /([\+\-]|\d\d)/gi, Ha = ["Date", "Hours", "Minutes", "Seconds", "Milliseconds"], Ia = {Milliseconds: 1, Seconds: 1E3, Minutes: 6E4, Hours: 36E5, Days: 864E5, Months: 2592E6, Years: 31536E6}, Va = {ms: "millisecond", s: "second", m: "minute", h: "hour", d: "day", D: "date", w: "week", W: "isoWeek", M: "month", y: "year", DDD: "dayOfYear", e: "weekday", E: "isoWeekday",
      gg: "weekYear", GG: "isoWeekYear"}, ab = {dayofyear: "dayOfYear", isoweekday: "isoWeekday", isoweek: "isoWeek", weekyear: "weekYear", isoweekyear: "isoWeekYear"}, Ja = {}, Sa = "DDD w W M D d".split(" "), Na = "MDHhmswW".split(""), na = {M: function () {
      return this.month() + 1
    }, MMM: function (a) {
      return this.lang().monthsShort(this, a)
    }, MMMM: function (a) {
      return this.lang().months(this, a)
    }, D: function () {
      return this.date()
    }, DDD: function () {
      return this.dayOfYear()
    }, d: function () {
      return this.day()
    }, dd: function (a) {
      return this.lang().weekdaysMin(this,
        a)
    }, ddd: function (a) {
      return this.lang().weekdaysShort(this, a)
    }, dddd: function (a) {
      return this.lang().weekdays(this, a)
    }, w: function () {
      return this.week()
    }, W: function () {
      return this.isoWeek()
    }, YY: function () {
      return l(this.year() % 100, 2)
    }, YYYY: function () {
      return l(this.year(), 4)
    }, YYYYY: function () {
      return l(this.year(), 5)
    }, gg: function () {
      return l(this.weekYear() % 100, 2)
    }, gggg: function () {
      return this.weekYear()
    }, ggggg: function () {
      return l(this.weekYear(), 5)
    }, GG: function () {
      return l(this.isoWeekYear() % 100, 2)
    }, GGGG: function () {
      return this.isoWeekYear()
    },
      GGGGG: function () {
        return l(this.isoWeekYear(), 5)
      }, e: function () {
        return this.weekday()
      }, E: function () {
        return this.isoWeekday()
      }, a: function () {
        return this.lang().meridiem(this.hours(), this.minutes(), !0)
      }, A: function () {
        return this.lang().meridiem(this.hours(), this.minutes(), !1)
      }, H: function () {
        return this.hours()
      }, h: function () {
        return this.hours() % 12 || 12
      }, m: function () {
        return this.minutes()
      }, s: function () {
        return this.seconds()
      }, S: function () {
        return p(this.milliseconds() / 100)
      }, SS: function () {
        return l(p(this.milliseconds() /
          10), 2)
      }, SSS: function () {
        return l(this.milliseconds(), 3)
      }, Z: function () {
        var a = -this.zone(), b = "+";
        0 > a && (a = -a, b = "-");
        return b + l(p(a / 60), 2) + ":" + l(p(a) % 60, 2)
      }, ZZ: function () {
        var a = -this.zone(), b = "+";
        0 > a && (a = -a, b = "-");
        return b + l(p(10 * a / 6), 4)
      }, z: function () {
        return this.zoneAbbr()
      }, zz: function () {
        return this.zoneName()
      }, X: function () {
        return this.unix()
      }}, Ta = ["months", "monthsShort", "weekdays", "weekdaysShort", "weekdaysMin"]; Sa.length;)Q = Sa.pop(), na[Q + "o"] = f(na[Q], Q);
  for (; Na.length;)Q = Na.pop(), na[Q + Q] = a(na[Q], 2);
  na.DDDD = a(na.DDD, 3);
  k(b.prototype, {set: function (a) {
    var b, e;
    for (e in a)b = a[e], "function" === typeof b ? this[e] = b : this["_" + e] = b
  }, _months: "January February March April May June July August September October November December".split(" "), months: function (a) {
    return this._months[a.month()]
  }, _monthsShort: "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "), monthsShort: function (a) {
    return this._monthsShort[a.month()]
  }, monthsParse: function (a) {
    var b, e;
    this._monthsParse || (this._monthsParse = []);
    for (b = 0; 12 >
      b; b++)if (this._monthsParse[b] || (e = G.utc([2E3, b]), e = "^" + this.months(e, "") + "|^" + this.monthsShort(e, ""), this._monthsParse[b] = RegExp(e.replace(".", ""), "i")), this._monthsParse[b].test(a))return b
  }, _weekdays: "Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "), weekdays: function (a) {
    return this._weekdays[a.day()]
  }, _weekdaysShort: "Sun Mon Tue Wed Thu Fri Sat".split(" "), weekdaysShort: function (a) {
    return this._weekdaysShort[a.day()]
  }, _weekdaysMin: "Su Mo Tu We Th Fr Sa".split(" "), weekdaysMin: function (a) {
    return this._weekdaysMin[a.day()]
  },
    weekdaysParse: function (a) {
      var b, e;
      this._weekdaysParse || (this._weekdaysParse = []);
      for (b = 0; 7 > b; b++)if (this._weekdaysParse[b] || (e = G([2E3, 1]).day(b), e = "^" + this.weekdays(e, "") + "|^" + this.weekdaysShort(e, "") + "|^" + this.weekdaysMin(e, ""), this._weekdaysParse[b] = RegExp(e.replace(".", ""), "i")), this._weekdaysParse[b].test(a))return b
    }, _longDateFormat: {LT: "h:mm A", L: "MM/DD/YYYY", LL: "MMMM D YYYY", LLL: "MMMM D YYYY LT", LLLL: "dddd, MMMM D YYYY LT"}, longDateFormat: function (a) {
      var b = this._longDateFormat[a];
      !b && this._longDateFormat[a.toUpperCase()] &&
      (b = this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g, function (a) {
        return a.slice(1)
      }), this._longDateFormat[a] = b);
      return b
    }, isPM: function (a) {
      return"p" === (a + "").toLowerCase().charAt(0)
    }, _meridiemParse: /[ap]\.?m?\.?/i, meridiem: function (a, b, e) {
      return 11 < a ? e ? "pm" : "PM" : e ? "am" : "AM"
    }, _calendar: {sameDay: "[Today at] LT", nextDay: "[Tomorrow at] LT", nextWeek: "dddd [at] LT", lastDay: "[Yesterday at] LT", lastWeek: "[Last] dddd [at] LT", sameElse: "L"}, calendar: function (a, b) {
      var e = this._calendar[a];
      return"function" === typeof e ? e.apply(b) : e
    }, _relativeTime: {future: "in %s", past: "%s ago", s: "a few seconds", m: "a minute", mm: "%d minutes", h: "an hour", hh: "%d hours", d: "a day", dd: "%d days", M: "a month", MM: "%d months", y: "a year", yy: "%d years"}, relativeTime: function (a, b, e, f) {
      var d = this._relativeTime[e];
      return"function" === typeof d ? d(a, b, e, f) : d.replace(/%d/i, a)
    }, pastFuture: function (a, b) {
      var e = this._relativeTime[0 < a ? "future" : "past"];
      return"function" === typeof e ? e(b) : e.replace(/%s/i, b)
    }, ordinal: function (a) {
      return this._ordinal.replace("%d",
        a)
    }, _ordinal: "%d", preparse: function (a) {
      return a
    }, postformat: function (a) {
      return a
    }, week: function (a) {
      return M(a, this._week.dow, this._week.doy).week
    }, _week: {dow: 0, doy: 6}, _invalidDate: "Invalid date", invalidDate: function () {
      return this._invalidDate
    }});
  G = function (a, b, e, f) {
    "boolean" === typeof e && (f = e, e = d);
    return da({_i: a, _f: b, _l: e, _strict: f, _isUTC: !1})
  };
  G.utc = function (a, b, e, f) {
    "boolean" === typeof e && (f = e, e = d);
    return da({_useUTC: !0, _isUTC: !0, _l: e, _i: a, _f: b, _strict: f}).utc()
  };
  G.unix = function (a) {
    return G(1E3 *
      a)
  };
  G.duration = function (a, b) {
    var e = G.isDuration(a), f = "number" === typeof a, d = e ? a._input : f ? {} : a, h = null, m;
    if (f)b ? d[b] = a : d.milliseconds = a; else if (h = Aa.exec(a))m = "-" === h[1] ? -1 : 1, d = {y: 0, d: p(h[U]) * m, h: p(h[W]) * m, m: p(h[ka]) * m, s: p(h[pa]) * m, ms: p(h[sa]) * m}; else if (h = ga.exec(a))m = "-" === h[1] ? -1 : 1, f = function (a) {
      a = a && parseFloat(a.replace(",", "."));
      return(isNaN(a) ? 0 : a) * m
    }, d = {y: f(h[2]), M: f(h[3]), d: f(h[4]), h: f(h[5]), m: f(h[6]), s: f(h[7]), w: f(h[8])};
    h = new g(d);
    e && a.hasOwnProperty("_lang") && (h._lang = a._lang);
    return h
  };
  G.version =
    "2.3.1";
  G.defaultFormat = "YYYY-MM-DDTHH:mm:ssZ";
  G.updateOffset = function () {
  };
  G.lang = function (a, e) {
    if (!a)return G.fn._lang._abbr;
    if (e) {
      var f = A(a);
      e.abbr = f;
      q[f] || (q[f] = new b);
      q[f].set(e)
    } else null === e ? (delete q[a], a = "en") : q[a] || u(a);
    return(G.duration.fn._lang = G.fn._lang = u(a))._abbr
  };
  G.langData = function (a) {
    a && a._lang && a._lang._abbr && (a = a._lang._abbr);
    return u(a)
  };
  G.isMoment = function (a) {
    return a instanceof e
  };
  G.isDuration = function (a) {
    return a instanceof g
  };
  for (Q = Ta.length - 1; 0 <= Q; --Q)v(Ta[Q]);
  G.normalizeUnits =
    function (a) {
      return r(a)
    };
  G.invalid = function (a) {
    var b = G.utc(NaN);
    null != a ? k(b._pf, a) : b._pf.userInvalidated = !0;
    return b
  };
  G.parseZone = function (a) {
    return G(a).parseZone()
  };
  k(G.fn = e.prototype, {clone: function () {
    return G(this)
  }, valueOf: function () {
    return+this._d + 6E4 * (this._offset || 0)
  }, unix: function () {
    return Math.floor(+this / 1E3)
  }, toString: function () {
    return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")
  }, toDate: function () {
    return this._offset ? new Date(+this) : this._d
  }, toISOString: function () {
    return J(G(this).utc(),
      "YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")
  }, toArray: function () {
    return[this.year(), this.month(), this.date(), this.hours(), this.minutes(), this.seconds(), this.milliseconds()]
  }, isValid: function () {
    return z(this)
  }, isDSTShifted: function () {
    return this._a ? this.isValid() && 0 < s(this._a, (this._isUTC ? G.utc(this._a) : G(this._a)).toArray()) : !1
  }, parsingFlags: function () {
    return k({}, this._pf)
  }, invalidAt: function () {
    return this._pf.overflow
  }, utc: function () {
    return this.zone(0)
  }, local: function () {
    this.zone(0);
    this._isUTC = !1;
    return this
  },
    format: function (a) {
      a = J(this, a || G.defaultFormat);
      return this.lang().postformat(a)
    }, add: function (a, b) {
      var e;
      e = "string" === typeof a ? G.duration(+b, a) : G.duration(a, b);
      n(this, e, 1);
      return this
    }, subtract: function (a, b) {
      var e;
      e = "string" === typeof a ? G.duration(+b, a) : G.duration(a, b);
      n(this, e, -1);
      return this
    }, diff: function (a, b, e) {
      a = this._isUTC ? G(a).zone(this._offset || 0) : G(a).local();
      var f = 6E4 * (this.zone() - a.zone()), d;
      b = r(b);
      "year" === b || "month" === b ? (d = 432E5 * (this.daysInMonth() + a.daysInMonth()), f = 12 * (this.year() -
        a.year()) + (this.month() - a.month()), f += (this - G(this).startOf("month") - (a - G(a).startOf("month"))) / d, f -= 6E4 * (this.zone() - G(this).startOf("month").zone() - (a.zone() - G(a).startOf("month").zone())) / d, "year" === b && (f /= 12)) : (d = this - a, f = "second" === b ? d / 1E3 : "minute" === b ? d / 6E4 : "hour" === b ? d / 36E5 : "day" === b ? (d - f) / 864E5 : "week" === b ? (d - f) / 6048E5 : d);
      return e ? f : h(f)
    }, from: function (a, b) {
      return G.duration(this.diff(a)).lang(this.lang()._abbr).humanize(!b)
    }, fromNow: function (a) {
      return this.from(G(), a)
    }, calendar: function () {
      var a =
        this.diff(G().zone(this.zone()).startOf("day"), "days", !0), a = -6 > a ? "sameElse" : -1 > a ? "lastWeek" : 0 > a ? "lastDay" : 1 > a ? "sameDay" : 2 > a ? "nextDay" : 7 > a ? "nextWeek" : "sameElse";
      return this.format(this.lang().calendar(a, this))
    }, isLeapYear: function () {
      return x(this.year())
    }, isDST: function () {
      return this.zone() < this.clone().month(0).zone() || this.zone() < this.clone().month(5).zone()
    }, day: function (a) {
      var b = this._isUTC ? this._d.getUTCDay() : this._d.getDay();
      return null != a ? (a = D(a, this.lang()), this.add({d: a - b})) : b
    }, month: function (a) {
      var b =
        this._isUTC ? "UTC" : "", e;
      if (null != a) {
        if ("string" === typeof a && (a = this.lang().monthsParse(a), "number" !== typeof a))return this;
        e = this.date();
        this.date(1);
        this._d["set" + b + "Month"](a);
        this.date(Math.min(e, this.daysInMonth()));
        G.updateOffset(this);
        return this
      }
      return this._d["get" + b + "Month"]()
    }, startOf: function (a) {
      a = r(a);
      switch (a) {
        case "year":
          this.month(0);
        case "month":
          this.date(1);
        case "week":
        case "isoWeek":
        case "day":
          this.hours(0);
        case "hour":
          this.minutes(0);
        case "minute":
          this.seconds(0);
        case "second":
          this.milliseconds(0)
      }
      "week" ===
        a ? this.weekday(0) : "isoWeek" === a && this.isoWeekday(1);
      return this
    }, endOf: function (a) {
      a = r(a);
      return this.startOf(a).add("isoWeek" === a ? "week" : a, 1).subtract("ms", 1)
    }, isAfter: function (a, b) {
      b = "undefined" !== typeof b ? b : "millisecond";
      return+this.clone().startOf(b) > +G(a).startOf(b)
    }, isBefore: function (a, b) {
      b = "undefined" !== typeof b ? b : "millisecond";
      return+this.clone().startOf(b) < +G(a).startOf(b)
    }, isSame: function (a, b) {
      b = "undefined" !== typeof b ? b : "millisecond";
      return+this.clone().startOf(b) === +G(a).startOf(b)
    }, min: function (a) {
      a =
        G.apply(null, arguments);
      return a < this ? this : a
    }, max: function (a) {
      a = G.apply(null, arguments);
      return a > this ? this : a
    }, zone: function (a) {
      var b = this._offset || 0;
      if (null != a)"string" === typeof a && (a = E(a)), 16 > Math.abs(a) && (a *= 60), this._offset = a, this._isUTC = !0, b !== a && n(this, G.duration(b - a, "m"), 1, !0); else return this._isUTC ? b : this._d.getTimezoneOffset();
      return this
    }, zoneAbbr: function () {
      return this._isUTC ? "UTC" : ""
    }, zoneName: function () {
      return this._isUTC ? "Coordinated Universal Time" : ""
    }, parseZone: function () {
      "string" === typeof this._i && this.zone(this._i);
      return this
    }, hasAlignedHourOffset: function (a) {
      a = a ? G(a).zone() : 0;
      return 0 === (this.zone() - a) % 60
    }, daysInMonth: function () {
      var a = this.year(), b = this.month();
      return(new Date(Date.UTC(a, b + 1, 0))).getUTCDate()
    }, dayOfYear: function (a) {
      var b = ba((G(this).startOf("day") - G(this).startOf("year")) / 864E5) + 1;
      return null == a ? b : this.add("d", a - b)
    }, weekYear: function (a) {
      var b = M(this, this.lang()._week.dow, this.lang()._week.doy).year;
      return null == a ? b : this.add("y", a - b)
    }, isoWeekYear: function (a) {
      var b =
        M(this, 1, 4).year;
      return null == a ? b : this.add("y", a - b)
    }, week: function (a) {
      var b = this.lang().week(this);
      return null == a ? b : this.add("d", 7 * (a - b))
    }, isoWeek: function (a) {
      var b = M(this, 1, 4).week;
      return null == a ? b : this.add("d", 7 * (a - b))
    }, weekday: function (a) {
      var b = (this.day() + 7 - this.lang()._week.dow) % 7;
      return null == a ? b : this.add("d", a - b)
    }, isoWeekday: function (a) {
      return null == a ? this.day() || 7 : this.day(this.day() % 7 ? a : a - 7)
    }, get: function (a) {
      a = r(a);
      return this[a]()
    }, set: function (a, b) {
      a = r(a);
      if ("function" === typeof this[a])this[a](b);
      return this
    }, lang: function (a) {
      if (a === d)return this._lang;
      this._lang = u(a);
      return this
    }});
  for (Q = 0; Q < Ha.length; Q++)Z(Ha[Q].toLowerCase().replace(/s$/, ""), Ha[Q]);
  Z("year", "FullYear");
  G.fn.days = G.fn.day;
  G.fn.months = G.fn.month;
  G.fn.weeks = G.fn.week;
  G.fn.isoWeeks = G.fn.isoWeek;
  G.fn.toJSON = G.fn.toISOString;
  k(G.duration.fn = g.prototype, {_bubble: function () {
    var a = this._milliseconds, b = this._days, e = this._months, f = this._data;
    f.milliseconds = a % 1E3;
    a = h(a / 1E3);
    f.seconds = a % 60;
    a = h(a / 60);
    f.minutes = a % 60;
    a = h(a / 60);
    f.hours =
      a % 24;
    b += h(a / 24);
    f.days = b % 30;
    e += h(b / 30);
    f.months = e % 12;
    b = h(e / 12);
    f.years = b
  }, weeks: function () {
    return h(this.days() / 7)
  }, valueOf: function () {
    return this._milliseconds + 864E5 * this._days + this._months % 12 * 2592E6 + 31536E6 * p(this._months / 12)
  }, humanize: function (a) {
    var b = +this, e;
    e = !a;
    var f = this.lang(), d = ba(Math.abs(b) / 1E3), g = ba(d / 60), h = ba(g / 60), m = ba(h / 24), p = ba(m / 365), d = 45 > d && ["s", d] || 1 === g && ["m"] || 45 > g && ["mm", g] || 1 === h && ["h"] || 22 > h && ["hh", h] || 1 === m && ["d"] || 25 >= m && ["dd", m] || 45 >= m && ["M"] || 345 > m && ["MM", ba(m / 30)] || 1 ===
      p && ["y"] || ["yy", p];
    d[2] = e;
    d[3] = 0 < b;
    d[4] = f;
    e = Y.apply({}, d);
    a && (e = this.lang().pastFuture(b, e));
    return this.lang().postformat(e)
  }, add: function (a, b) {
    var e = G.duration(a, b);
    this._milliseconds += e._milliseconds;
    this._days += e._days;
    this._months += e._months;
    this._bubble();
    return this
  }, subtract: function (a, b) {
    var e = G.duration(a, b);
    this._milliseconds -= e._milliseconds;
    this._days -= e._days;
    this._months -= e._months;
    this._bubble();
    return this
  }, get: function (a) {
    a = r(a);
    return this[a.toLowerCase() + "s"]()
  }, as: function (a) {
    a =
      r(a);
    return this["as" + a.charAt(0).toUpperCase() + a.slice(1) + "s"]()
  }, lang: G.fn.lang, toIsoString: function () {
    var a = Math.abs(this.years()), b = Math.abs(this.months()), e = Math.abs(this.days()), f = Math.abs(this.hours()), d = Math.abs(this.minutes()), g = Math.abs(this.seconds() + this.milliseconds() / 1E3);
    return this.asSeconds() ? (0 > this.asSeconds() ? "-" : "") + "P" + (a ? a + "Y" : "") + (b ? b + "M" : "") + (e ? e + "D" : "") + (f || d || g ? "T" : "") + (f ? f + "H" : "") + (d ? d + "M" : "") + (g ? g + "S" : "") : "P0D"
  }});
  for (Q in Ia)Ia.hasOwnProperty(Q) && (ja(Q, Ia[Q]), O(Q.toLowerCase()));
  ja("Weeks", 6048E5);
  G.duration.fn.asMonths = function () {
    return(+this - 31536E6 * this.years()) / 2592E6 + 12 * this.years()
  };
  G.lang("en", {ordinal: function (a) {
    var b = a % 10, b = 1 === p(a % 100 / 10) ? "th" : 1 === b ? "st" : 2 === b ? "nd" : 3 === b ? "rd" : "th";
    return a + b
  }});
  ta ? (module.exports = G, ea()) : "function" === typeof define && define.amd ? define("moment", ["require", "exports", "module"], function (a, b, e) {
    !0 !== e.config().noGlobal && ea();
    return G
  }) : ea()
}).call(this);
(function () {
  function d(a) {
    this.tokens = [];
    this.tokens.links = {};
    this.options = a || h.defaults;
    this.rules = l.normal;
    this.options.gfm && (this.rules = this.options.tables ? l.tables : l.gfm)
  }

  function a(a, b) {
    this.options = b || h.defaults;
    this.links = a;
    this.rules = n.normal;
    if (!this.links)throw Error("Tokens array requires a `links` property.");
    this.options.gfm ? this.rules = this.options.breaks ? n.breaks : n.gfm : this.options.pedantic && (this.rules = n.pedantic)
  }

  function f(a) {
    this.tokens = [];
    this.token = null;
    this.options = a || h.defaults
  }

  function b(a, b) {
    return a.replace(b ? /&/g : /&(?!#?\w+;)/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#39;")
  }

  function e(a, b) {
    a = a.source;
    b = b || "";
    return function t(e, f) {
      if (!e)return RegExp(a, b);
      f = f.source || f;
      f = f.replace(/(^|[^\[])\^/g, "$1");
      a = a.replace(e, f);
      return t
    }
  }

  function g() {
  }

  function k(a) {
    for (var b = 1, e, f; b < arguments.length; b++)for (f in e = arguments[b], e)Object.prototype.hasOwnProperty.call(e, f) && (a[f] = e[f]);
    return a
  }

  function h(a, e, g) {
    if (g || "function" === typeof e) {
      g || (g = e, e = null);
      e && (e = k({}, h.defaults, e));
      var l = d.lex(l, e), n = e.highlight, p = 0;
      a = l.length;
      var x = 0;
      if (!n || 3 > n.length)return g(null, f.parse(l, e));
      for (var B = function () {
        delete e.highlight;
        var a = f.parse(l, e);
        e.highlight = n;
        return g(null, a)
      }; x < a; x++)(function (a) {
        if ("code" === a.type)return p++, n(a.text, a.lang, function (b, e) {
          if (null == e || e === a.text)return--p || B();
          a.text = e;
          a.escaped = !0;
          --p || B()
        })
      })(l[x])
    } else try {
      return e && (e = k({}, h.defaults, e)), f.parse(d.lex(a, e), e)
    } catch (C) {
      C.message += "\nPlease report this to https://github.com/chjj/marked.";
      if ((e || h.defaults).silent)return"<p>An error occured:</p><pre>" + b(C.message + "", !0) + "</pre>";
      throw C;
    }
  }

  var l = {newline: /^\n+/, code: /^( {4}[^\n]+\n*)+/, fences: g, hr: /^( *[-*_]){3,} *(?:\n+|$)/, heading: /^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/, nptable: g, lheading: /^([^\n]+)\n *(=|-){3,} *\n*/, blockquote: /^( *>[^\n]+(\n[^\n]+)*\n*)+/, list: /^( *)(bull) [\s\S]+?(?:hr|\n{2,}(?! )(?!\1bull )\n*|\s*$)/, html: /^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/, def: /^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,
    table: g, paragraph: /^((?:[^\n]+(?=\n?)(?!hr|heading|lheading|blockquote|tag|def))+)/, text: /^[^\n]+/, bullet: /(?:[*+-]|\d+\.)/, item: /^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/};
  l.item = e(l.item, "gm")(/bull/g, l.bullet)();
  l.list = e(l.list)(/bull/g, l.bullet)("hr", /\n+(?=(?: *[-*_]){3,} *(?:\n+|$))/)();
  l._tag = "(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|@)\\b";
  l.html = e(l.html)("comment", /\x3c!--[\s\S]*?--\x3e/)("closed",
    /<(tag)[\s\S]+?<\/\1>/)("closing", /<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g, l._tag)();
  l.paragraph = e(l.paragraph)("hr", l.hr)("heading", l.heading)("lheading", l.lheading)("blockquote", l.blockquote)("tag", "<" + l._tag)("def", l.def)();
  l.normal = k({}, l);
  l.gfm = k({}, l.normal, {fences: /^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/, paragraph: /^/});
  l.gfm.paragraph = e(l.paragraph)("(?!", "(?!" + l.gfm.fences.source.replace("\\1", "\\2") + "|")();
  l.tables = k({}, l.gfm, {nptable: /^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,
    table: /^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/});
  d.rules = l;
  d.lex = function (a, b) {
    return(new d(b)).lex(a)
  };
  d.prototype.lex = function (a) {
    a = a.replace(/\r\n|\r/g, "\n").replace(/\t/g, "    ").replace(/\u00a0/g, " ").replace(/\u2424/g, "\n");
    return this.token(a, !0)
  };
  d.prototype.token = function (a, b) {
    a = a.replace(/^ +$/gm, "");
    for (var e, f, d, g, h, k, n; a;) {
      if (d = this.rules.newline.exec(a))if (a = a.substring(d[0].length), this.options.keepBreaks)for (e = Math.floor(d[0].length / 2); e--;)this.tokens.push({type: "paragraph",
        text: "&nbsp;"}); else 1 < d[0].length && this.tokens.push({type: "space"});
      if (d = this.rules.code.exec(a))a = a.substring(d[0].length), d = d[0].replace(/^ {4}/gm, ""), this.tokens.push({type: "code", text: this.options.pedantic ? d : d.replace(/\n+$/, "")}); else if (d = this.rules.fences.exec(a))a = a.substring(d[0].length), this.tokens.push({type: "code", lang: d[2], text: d[3]}); else if (d = this.rules.heading.exec(a))a = a.substring(d[0].length), this.tokens.push({type: "heading", depth: d[1].length, text: d[2]}); else if (b && (d = this.rules.nptable.exec(a))) {
        a =
          a.substring(d[0].length);
        h = {type: "table", header: d[1].replace(/^ *| *\| *$/g, "").split(/ *\| */), align: d[2].replace(/^ *|\| *$/g, "").split(/ *\| */), cells: d[3].replace(/\n$/, "").split("\n")};
        for (k = 0; k < h.align.length; k++)/^ *-+: *$/.test(h.align[k]) ? h.align[k] = "right" : /^ *:-+: *$/.test(h.align[k]) ? h.align[k] = "center" : /^ *:-+ *$/.test(h.align[k]) ? h.align[k] = "left" : h.align[k] = null;
        for (k = 0; k < h.cells.length; k++)h.cells[k] = h.cells[k].split(/ *\| */);
        this.tokens.push(h)
      } else if (d = this.rules.lheading.exec(a))a =
        a.substring(d[0].length), this.tokens.push({type: "heading", depth: "=" === d[2] ? 1 : 2, text: d[1]}); else if (d = this.rules.hr.exec(a))a = a.substring(d[0].length), this.tokens.push({type: "hr"}); else if (d = this.rules.blockquote.exec(a))a = a.substring(d[0].length), this.tokens.push({type: "blockquote_start"}), d = d[0].replace(/^ *> ?/gm, ""), this.token(d, b), this.tokens.push({type: "blockquote_end"}); else if (d = this.rules.list.exec(a)) {
        a = a.substring(d[0].length);
        g = d[2];
        this.tokens.push({type: "list_start", ordered: 1 < g.length});
        d = d[0].match(this.rules.item);
        e = !1;
        n = d.length;
        for (k = 0; k < n; k++)h = d[k], f = h.length, h = h.replace(/^ *([*+-]|\d+\.) +/, ""), ~h.indexOf("\n ") && (f -= h.length, h = this.options.pedantic ? h.replace(/^ {1,4}/gm, "") : h.replace(RegExp("^ {1," + f + "}", "gm"), "")), this.options.smartLists && k !== n - 1 && (f = l.bullet.exec(d[k + 1])[0], g === f || 1 < g.length && 1 < f.length || (a = d.slice(k + 1).join("\n") + a, k = n - 1)), f = e || /\n\n(?!\s*$)/.test(h), k !== n - 1 && (e = "\n" === h[h.length - 1], f || (f = e)), this.tokens.push({type: f ? "loose_item_start" : "list_item_start"}),
          this.token(h, !1), this.tokens.push({type: "list_item_end"});
        this.tokens.push({type: "list_end"})
      } else if (d = this.rules.html.exec(a))a = a.substring(d[0].length), this.tokens.push({type: this.options.sanitize ? "paragraph" : "html", pre: "pre" === d[1] || "script" === d[1], text: d[0]}); else if (b && (d = this.rules.def.exec(a)))a = a.substring(d[0].length), this.tokens.links[d[1].toLowerCase()] = {href: d[2], title: d[3]}; else if (b && (d = this.rules.table.exec(a))) {
        a = a.substring(d[0].length);
        h = {type: "table", header: d[1].replace(/^ *| *\| *$/g,
          "").split(/ *\| */), align: d[2].replace(/^ *|\| *$/g, "").split(/ *\| */), cells: d[3].replace(/(?: *\| *)?\n$/, "").split("\n")};
        for (k = 0; k < h.align.length; k++)/^ *-+: *$/.test(h.align[k]) ? h.align[k] = "right" : /^ *:-+: *$/.test(h.align[k]) ? h.align[k] = "center" : /^ *:-+ *$/.test(h.align[k]) ? h.align[k] = "left" : h.align[k] = null;
        for (k = 0; k < h.cells.length; k++)h.cells[k] = h.cells[k].replace(/^ *\| *| *\| *$/g, "").split(/ *\| */);
        this.tokens.push(h)
      } else if (b && (d = this.rules.paragraph.exec(a)))a = a.substring(d[0].length),
        this.tokens.push({type: "paragraph", text: "\n" === d[1][d[1].length - 1] ? d[1].slice(0, -1) : d[1]}); else if (d = this.rules.text.exec(a))a = a.substring(d[0].length), this.tokens.push({type: "text", text: d[0]}); else if (a)throw Error("Infinite loop on byte: " + a.charCodeAt(0));
    }
    return this.tokens
  };
  var n = {escape: /^\\([\\`*{}\[\]()#+\-.!_>])/, autolink: /^<([^ >]+(@|:\/)[^ >]+)>/, url: g, tag: /^\x3c!--[\s\S]*?--\x3e|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/, link: /^!?\[(inside)\]\(href\)/, reflink: /^!?\[(inside)\]\s*\[([^\]]*)\]/,
    nolink: /^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/, strong: /^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/, em: /^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/, code: /^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/, br: /^ {2,}\n(?!\s*$)/, del: g, text: /^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/, _inside: /(?:\[[^\]]*\]|[^\]]|\](?=[^\[]*\]))*/, _href: /\s*<?([^\s]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/};
  n.link = e(n.link)("inside", n._inside)("href", n._href)();
  n.reflink = e(n.reflink)("inside", n._inside)();
  n.normal = k({}, n);
  n.pedantic = k({},
    n.normal, {strong: /^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/, em: /^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/});
  n.gfm = k({}, n.normal, {escape: e(n.escape)("])", "~|])")(), url: /^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/, del: /^~~(?=\S)([\s\S]*?\S)~~/, text: e(n.text)("]|", "~]|")("|", "|https?://|")()});
  n.breaks = k({}, n.gfm, {br: e(n.br)("{2,}", "*")(), text: e(n.gfm.text)("{2,}", "*")()});
  a.rules = n;
  a.output = function (b, e, f) {
    return(new a(e, f)).output(b)
  };
  a.prototype.output = function (a) {
    for (var e =
      "", f, d; a;)if (d = this.rules.escape.exec(a))a = a.substring(d[0].length), e += d[1]; else if (d = this.rules.autolink.exec(a))a = a.substring(d[0].length), "@" === d[2] ? (f = ":" === d[1][6] ? this.mangle(d[1].substring(7)) : this.mangle(d[1]), d = this.mangle("mailto:") + f) : d = f = b(d[1]), e += '<a href="' + d + '" target="_blank">' + f + "</a>"; else if (d = this.rules.url.exec(a))a = a.substring(d[0].length), d = f = b(d[1]), e += '<a href="' + d + '" target="_blank">' + f + "</a>"; else if (d = this.rules.tag.exec(a))a = a.substring(d[0].length), e += this.options.sanitize ?
      b(d[0]) : d[0]; else if (d = this.rules.link.exec(a))a = a.substring(d[0].length), e += this.outputLink(d, {href: d[2], title: d[3]}); else if ((d = this.rules.reflink.exec(a)) || (d = this.rules.nolink.exec(a)))a = a.substring(d[0].length), f = (d[2] || d[1]).replace(/\s+/g, " "), (f = this.links[f.toLowerCase()]) && f.href ? e += this.outputLink(d, f) : (e += d[0][0], a = d[0].substring(1) + a); else if (d = this.rules.strong.exec(a))a = a.substring(d[0].length), e += "<strong>" + this.output(d[2] || d[1]) + "</strong>"; else if (d = this.rules.em.exec(a))a = a.substring(d[0].length),
      e += "<em>" + this.output(d[2] || d[1]) + "</em>"; else if (d = this.rules.code.exec(a))a = a.substring(d[0].length), e += "<code>" + b(d[2], !0) + "</code>"; else if (d = this.rules.br.exec(a))a = a.substring(d[0].length), e += "<br>"; else if (d = this.rules.del.exec(a))a = a.substring(d[0].length), e += "<del>" + this.output(d[1]) + "</del>"; else if (d = this.rules.text.exec(a))a = a.substring(d[0].length), e += b(d[0]); else if (a)throw Error("Infinite loop on byte: " + a.charCodeAt(0));
    return e
  };
  a.prototype.outputLink = function (a, e) {
    return"!" !== a[0][0] ?
      '<a href="' + b(e.href) + '"' + (e.title ? ' title="' + b(e.title) + '"' : "") + ' target="_blank">' + this.output(a[1]) + "</a>" : '<img src="' + b(e.href) + '" alt="' + b(a[1]) + '"' + (e.title ? ' title="' + b(e.title) + '"' : "") + ">"
  };
  a.prototype.smartypants = function (a) {
    return this.options.smartypants ? a.replace(/--/g, "").replace(/'([^']*)'/g, "$1").replace(/"([^"]*)"/g, "$1").replace(/\.{3}/g, "") : a
  };
  a.prototype.mangle = function (a) {
    for (var b = "", e = a.length, f = 0, d; f < e; f++)d = a.charCodeAt(f), 0.5 < Math.random() && (d = "x" + d.toString(16)), b +=
      "&#" + d + ";";
    return b
  };
  f.parse = function (a, b) {
    return(new f(b)).parse(a)
  };
  f.prototype.parse = function (b) {
    this.inline = new a(b.links, this.options);
    this.tokens = b.reverse();
    for (b = ""; this.next();)b += this.tok();
    return b
  };
  f.prototype.next = function () {
    return this.token = this.tokens.pop()
  };
  f.prototype.peek = function () {
    return this.tokens[this.tokens.length - 1] || 0
  };
  f.prototype.parseText = function () {
    for (var a = this.token.text; "text" === this.peek().type;)a += "\n" + this.next().text;
    return this.inline.output(a)
  };
  f.prototype.tok =
    function () {
      switch (this.token.type) {
        case "space":
          return"";
        case "hr":
          return"<hr>\n";
        case "heading":
          return"<h" + this.token.depth + ">" + this.inline.output(this.token.text) + "</h" + this.token.depth + ">\n";
        case "code":
          if (this.options.highlight) {
            var a = this.options.highlight(this.token.text, this.token.lang);
            null != a && a !== this.token.text && (this.token.escaped = !0, this.token.text = a)
          }
          this.token.escaped || (this.token.text = b(this.token.text, !0));
          return"<pre><code" + (this.token.lang ? ' class="' + this.options.langPrefix + this.token.lang +
            '"' : "") + ">" + this.token.text + "</code></pre>\n";
        case "table":
          var e, f, d, g, a = "<thead>\n<tr>\n";
          for (f = 0; f < this.token.header.length; f++)e = this.inline.output(this.token.header[f]), a += this.token.align[f] ? '<th align="' + this.token.align[f] + '">' + e + "</th>\n" : "<th>" + e + "</th>\n";
          a += "</tr>\n</thead>\n<tbody>\n";
          for (f = 0; f < this.token.cells.length; f++) {
            e = this.token.cells[f];
            a += "<tr>\n";
            for (g = 0; g < e.length; g++)d = this.inline.output(e[g]), a += this.token.align[g] ? '<td align="' + this.token.align[g] + '">' + d + "</td>\n" : "<td>" +
              d + "</td>\n";
            a += "</tr>\n"
          }
          a += "</tbody>\n";
          return"<table>\n" + a + "</table>\n";
        case "blockquote_start":
          for (a = ""; "blockquote_end" !== this.next().type;)a += this.tok();
          return"<blockquote>\n" + a + "</blockquote>\n";
        case "list_start":
          f = this.token.ordered ? "ol" : "ul";
          for (a = ""; "list_end" !== this.next().type;)a += this.tok();
          return"<" + f + ">\n" + a + "</" + f + ">\n";
        case "list_item_start":
          for (a = ""; "list_item_end" !== this.next().type;)a += "text" === this.token.type ? this.parseText() : this.tok();
          return"<li>" + a + "</li>\n";
        case "loose_item_start":
          for (a =
                 ""; "list_item_end" !== this.next().type;)a += this.tok();
          return"<li>" + a + "</li>\n";
        case "html":
          return this.token.pre || this.options.pedantic ? this.token.text : this.inline.output(this.token.text);
        case "paragraph":
          return"<p>" + this.inline.output(this.token.text) + "</p>\n";
        case "text":
          return"<p>" + this.parseText() + "</p>\n"
      }
    };
  g.exec = g;
  h.options = h.setOptions = function (a) {
    k(h.defaults, a);
    return h
  };
  h.defaults = {gfm: !0, tables: !0, breaks: !1, keepBreaks: !1, pedantic: !1, sanitize: !1, smartLists: !1, silent: !1, highlight: null, langPrefix: "lang-"};
  h.Parser = f;
  h.parser = f.parse;
  h.Lexer = d;
  h.lexer = d.lex;
  h.InlineLexer = a;
  h.inlineLexer = a.output;
  h.parse = h;
  "object" === typeof exports ? module.exports = h : "function" === typeof define && define.amd ? define("markdown", [], function () {
    return h
  }) : this.marked = h
}).call(function () {
    return this || ("undefined" !== typeof window ? window : global)
  }());
(function () {
  define("util", ["underscore", "jquery", "moment", "markdown"], function (d, a, f, b) {
    var e, g, k, h, l, n;
    e = a(document);
    g = /^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/;
    k = {escape: {"&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#x27;", "/": "&#x2f;"}};
    k.unescape = d.invert(k.escape);
    h = {escape: RegExp("[" + d.keys(k.escape).join("") + "]", "g"), unescape: RegExp("(" + d.keys(k.unescape).join("|") + ")", "g")};
    l = function (a) {
      return function (b) {
        return null != b ? ("" + b).replace(h[a], function (b) {
          return k[a][b]
        }) : ""
      }
    };
    n = function (a) {
      return"string" === typeof a
    };
    String.prototype.formatStringForEmail = function () {
      var a, b, e;
      e = this;
      if (!n(e))if (e && n(b = "function" === typeof e.toString ? e.toString() : void 0))e = b; else return e;
      a = [];
      e.replace(/[a-zA-Z0-9.@_-]/g, function (b) {
        return a.push(b)
      });
      return a.join("")
    };
    Array.prototype.queue = function (a) {
      this.shift();
      return this.push(a)
    };
    return{initialize: function () {
      var b;
      f.lang("zh", {months: "           ".split(" "), monthsShort: "1 2 3 4 5 6 7 8 9 10 11 12".split(" "), weekdays: "      ".split(" "), weekdaysShort: "      ".split(" "), weekdaysMin: "".split(""), longDateFormat: {LT: "Ahmm", L: "YYYYMMMD", LL: "YYYYMMMD", LLL: "YYYYMMMDLT", LLLL: "YYYYMMMDddddLT", l: "YYYYMMMD", ll: "YYYYMMMD",
        lll: "YYYYMMMDLT", llll: "YYYYMMMDddddLT"}, relativeTime: {future: "%s", past: "%s", s: "", m: "1", mm: "%d", h: "1", hh: "%d", d: "1", dd: "%d", M: "1", MM: "%d", y: "1", yy: "%d"}, week: {dow: 1}, calendar: {sameDay: "[]", nextDay: "[]", lastDay: "[]", lastWeek: function () {
        var a;
        a = moment().startOf("week");
        return(this.unix() < a.unix() ? "[]" : "") + "dddd"
      }, nextWeek: function () {
        var a;
        a = moment().startOf("week");
        return(604800 <= this.unix() - a.unix() ? "[]" : "") + "dddd"
      }, sameElse: function () {
        return this.year() === f().year() ?
          "MMMD" : "LL"
      }}, meridiem: function (a, b, e) {
        a = 100 * a + b;
        return 100 > a ? "" : 500 > a ? "" : 900 > a ? "" : 1130 > a ? "" : 1230 > a ? "" : 1800 > a ? "" : ""
      }, ordinal: function (a, b) {
        switch (b) {
          case "d":
          case "D":
          case "DDD":
            return a + "";
          case "M":
            return a + "";
          case "w":
          case "W":
            return a + "";
          default:
            return a
        }
      }});
      a.fn.redraw = function () {
        return this.each(function (b, e) {
          a(e).hide().height();
          return a(e).show()
        })
      };
      a.fn.isVisible = function () {
        var a;
        a = this.get(0).getBoundingClientRect();
        return!!(a.bottom - a.top)
      };
      a.fn.selectRange = function (a, b) {
        return this.each(function () {
          var e;
          if (this.setSelectionRange)return this.focus(), this.setSelectionRange(a, b);
          if (this.createTextRange)return e = this.createTextRange(), e.collapse(!0), e.moveEnd("character", b), e.moveStart("character", a), e.select()
        })
      };
      b = function (a) {
        return a.replace(/-+(.)?/g, function (a, b) {
          return b ? b.toUpperCase() : ""
        })
      };
      a.fn.computedStyle = function (a) {
        var e, f;
        if (0 < !this.length)return!1;
        null == a && (a = !1);
        e = this.first();
        return(null != (null != (f = document.defaultView) ? f.getComputedStyle : void 0) ?
          document.defaultView.getComputedStyle(e.get(0), null) : e.currentStyle)[b(a)]
      };
      return a.fn.timesince = function (a) {
        var b, e, g, h = this;
        this.attr("datetime") && 0 === this.attr("datetime").length ? "" : (a || (a = {}), a = d.defaults(a, {silent: !1}), b = this.attr("datetime"), e = f(b), g = function () {
          return h.text(e.fromNow())
        }, g(), a.silent || setInterval(function () {
          return g()
        }, 6E4));
        return this
      }
    }, clearDate: function (a) {
      a.setHours(0, 0, 0, 0);
      return data
    }, formatDate: function (a) {
      var b, e;
      b = f(a);
      if (!b.isValid())return{dateString: ""};
      e = f();
      a = {dateString: b.calendar(), dateClass: "normal"};
      b.year() < e.year() ? a.dateClass = "overdue" : b.year() === e.year() && (b = b.diff(e, "days"), 0 > b ? a.dateClass = "overdue" : 1 > b ? a.dateClass = "today" : 7 > b && (a.dateClass = "upcoming"));
      return a
    }, escape: l("escape"), unescape: l("unescape"), emphasis: function (a) {
      return setTimeout(function () {
        a.addClass("pop-out");
        return setTimeout(function () {
          a.removeClass("pop-out").addClass("pop-back");
          return setTimeout(function () {
            return a.removeClass("pop-back")
          }, 218)
        }, 218)
      }, 218)
    }, getDay: function (a) {
      a ||
      (a = new Date);
      return new Date(a.getFullYear(), a.getMonth(), a.getDate())
    }, getPriorityDisplay: function (a) {
      return{0: "", 1: "", 2: ""}[a || 0]
    }, getDateByTimeZone: function (a, b) {
      var e;
      if (!a)return a;
      a = new Date(a);
      e = a.getHours();
      a.setHours(e + b);
      return a
    }, removeItem: function (a, b) {
      var e, f, g, h;
      f = 0;
      if (d.isArray(a))for (e = h = a.length - 1; 0 <= h; e = h += -1)g = a[e], g === b && (a.splice(e, 1), f += 1); else d.each(a, function (e, d) {
        if (e === b)return delete a[d], f += 1
      });
      return f
    }, formatFileSize: function (a) {
      var b;
      if ("string" === typeof a &&
        (-1 !== a.indexOf("K") || -1 !== a.indexOf("M")))return a;
      b = -1;
      a /= 1024;
      for (b++; 99 < a;)a /= 1024, b++;
      return Math.max(a, 0.1).toFixed(1) + "kB MB GB TB PB EB".split(" ")[b]
    }, pickFromCollection: function (a, b) {
      var e, f, d, g, h, l;
      d = [];
      h = 0;
      for (l = a.length; h < l; h++) {
        f = a[h];
        e = !0;
        for (g in b)f.get(g) !== b[g] && (e = !1);
        e && d.push(f)
      }
      return d
    }, handleClickOutside: function (b, f, g, h) {
      var l, p = this;
      null == g && (g = "mousedown");
      l = ".datepicker";
      h && (l += "," + h);
      return d.defer(function () {
        return e.one(g, function (e) {
          var d;
          if (b && b.parent().length)return d =
            a(e.target), d.closest(b).length || d.closest(l).length ? p.handleClickOutside(b, f, g, h) : f(e)
        })
      })
    }, transition: function (b, e, f) {
      b.one(a.support.transition.end, f);
      return e()
    }, applyStyleRule: function (b, f) {
      var d;
      if (d = e.data(b))a(d.ownerNode).remove(), e.removeData(b);
      if (f)return d = a("<style>").appendTo(a("head")).get(0), d = d.sheet || d.styleSheet, e.data(b, d), d.insertRule(b + "{" + f + "}", d.cssRules.length)
    }, maybeEmail: function (a) {
      return n(a) && -1 !== a.indexOf("@") ? !0 : !1
    }, isEmail: function (a) {
      return g.test(a)
    }, isId: function (a) {
      return n(a) &&
        /^[a-zA-Z0-9]{24}$/.test(a) ? !0 : !1
    }, isEmpty: function (a) {
      var b;
      if (a)for (b in a)return!Object.prototype.hasOwnProperty.call(a, b);
      return!0
    }, lengthOf: function (a) {
      var b;
      b = 0;
      "string" === typeof a && (a = a.replace(/[\u4e00-\u9fa5]/g, function () {
        b += 2;
        return""
      }), b += a.length);
      return b
    }, cutString: function (a, b, e) {
      var f, d, g, h;
      if ("string" !== typeof a)return"";
      if (this.lengthOf(a) <= b)return a;
      d = g = 0;
      for (h = ""; d < b;)f = a.charAt(g), /[\u4e00-\u9fa5]/.test(f) ? d += 2 : d++, h += f, g++;
      return h + e
    }, calcuGrid: function (a, b, e, f) {
      var d, g, h;
      f ||
      (f = 1);
      e = 4 * ~~e || 4;
      d = e + 1;
      g = 0;
      h = a * b;
      for (f = a * a * e / f; g < h && 1 <= d;)d -= 1, g = f / (d * d || 1);
      d = ~~((d + 1) / 2);
      e = Math.ceil(e / 4 / d);
      return{rows: d, columns: e, width: a / d, height: b / e}
    }, loadImage: function (a, b) {
      var e;
      e = new Image;
      e.onload = function () {
        e.onload = null;
        return b(null, e.naturalWidth || e.width, e.naturalHeight || e.height, a)
      };
      e.onerror = function (a) {
        return b(a)
      };
      e.abort = function () {
        e.onload = null;
        return e.onerror = null
      };
      e.src = a;
      return e
    }, parseJSON: function (a) {
      try {
        return JSON.parse(a)
      } catch (b) {
        "undefined" !== typeof console && null !==
          console && console.error(b)
      }
      return null
    }, parsePost: function (e) {
      var f, g;
      if (!d.isObject(e))return{};
      e.html && "html" === e.postMode && (e.content = e.html);
      e.description || (e.description = e.title);
      e.description || (g = d.unescape(e.content), "html" !== e.postMode && (g = b(g)), f = a("<div>" + g + "</div>"), g = f.text().trim(), g || (f = f.find("img:first"), g = f.attr("title") || f.attr("alt") || f.attr("src")), e.description = this.cutString(g, 60, "...") || "");
      return e
    }, http: function (b, e) {
      var f;
      f = d.extend({method: "GET", cache: !0, error: function (a) {
        return Essage.show({message: a.responseJSON.message ||
          a.responseJSON.error, status: "error"}, 2E3)
      }, success: function () {
      }}, e);
      return a.ajax(b, f)
    }, mousewheel: function (b, e) {
      var f, d;
      b.stopPropagation();
      f = a(b.currentTarget);
      d = f.scrollTop();
      if (0 < e && 0 === d || 0 > e && d === f[0].scrollHeight - f.innerHeight())return!1
    }}
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("model", ["backbone", "util", "warehouse"], function (f, b, e) {
    var d;
    return function (b) {
      function f() {
        return d = f.__super__.constructor.apply(this, arguments)
      }

      a(f, b);
      f.prototype.idAttribute = "_id";
      f.prototype.initialize = function () {
        this.id && this.listen();
        return this
      };
      f.prototype.sync = function (a, b, f) {
        var d,
          g = this;
        "function" === typeof f.beforeSend && f.beforeSend(b);
        switch (a) {
          case "create":
            a = this.getParams && null != (d = this.getParams(a, f)) && "function" === typeof d.instanceOf && d.instanceOf(Object) ? "function" === typeof this.getParams ? this.getParams(a, f) : void 0 : this.toJSON();
            a.cid = this.cid;
            f._projectId && (a._projectId = f._projectId);
            f._organizationId && (a._organizationId = f._organizationId);
            e.socket.emit("create:" + this.name, a);
            e.socket.once("create:" + this.name + "/" + this.cid, function (a) {
              if (a.errorCode)return"function" === typeof f.error && f.error(a.errorCode), !1;
              "function" === typeof f.success && f.success(a[g.name]);
              return g.listen()
            });
            break;
          case "update":
          case "patch":
            (d = "function" === typeof this.getParams ? this.getParams(a, f) : void 0) || (d = "patch" === a ? f.attrs : this.changed);
            if (_.isEmpty(d))if (f.wait)d = b.toJSON(); else return"function" === typeof f.success ? f.success() : void 0;
            d._id = b.id;
            if (!d._id)return;
            e.socket.emit("update:" + this.name, d);
            e.socket.once("update:" + this.name + "/" + this.id, function (a) {
              return a.errorCode ? "function" === typeof f.error ? f.error(a.errorCode) : void 0 : "function" === typeof f.success ? f.success(a[g.name]) : void 0
            });
            break;
          case "delete":
            if (!this.id)return;
            e.socket.emit("delete:" + this.name, {_id: this.id});
            e.socket.once("delete:" + this.name + "/" + b.id, function (a) {
              return a.errorCode ? "function" === typeof f.error ? f.error(a.errorCode) : void 0 : "function" === typeof f.success ? f.success(a[g.name]) : void 0
            })
        }
        return this
      };
      f.prototype.listen = function () {
        var a = this;
        e.socket.on(":change:" + this.name + "/" + this.id, function (b) {
          return a.set(b,
            {parse: !0})
        });
        return this
      };
      return f
    }(f.Model)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collection", ["backbone", "warehouse"], function (f, b) {
    var e;
    return function (f) {
      function d() {
        return e = d.__super__.constructor.apply(this, arguments)
      }

      a(d, f);
      d.prototype.synced = !1;
      d.prototype.orderBy = "latest-created";
      d.prototype.initialize = function (a, b) {
        this.model = this.model["export"] || this.model;
        this.pageIndex =
          0;
        this._boundToObjectId = null != b ? b._boundToObjectId : void 0;
        null != (null != b ? b.boundToObjectType : void 0) && (this.boundToObjectType = b.boundToObjectType);
        if ("activities" === this.name)return this.listen()
      };
      d.prototype.sync = function (a, e, f) {
        var d, g, k = this;
        "function" === typeof f.beforeSend && f.beforeSend(e);
        switch (a) {
          case "read":
            return a = ("function" === typeof this.getParams ? this.getParams(a, f) : void 0) || {}, this.pageNum && (a.count = this.pageNum), a.page = ++this.pageIndex, this.boundToObjectType ? (a[d = "_" + this.boundToObjectType +
              "Id"] || (a[d] = a._boundToObjectId || this._boundToObjectId), d = "" + this.name + "/" + a["_" + this.boundToObjectType + "Id"]) : d = "" + this.name, "tasks" === this.name && (a.all = !0), b.socket.emit("read:" + this.name, a), b.socket.once("read:" + d, function (a) {
              if (a.errorCode)return console.error("error reading collection: " + k.name + " with error code: " + a.errorCode), "function" === typeof f.error ? f.error(a.errorCode) : void 0;
              k.synced = !0;
              k.pageNum && (k.hasMore = a[k.name].length === k.pageNum);
              "function" === typeof f.success && f.success(a[k.name]);
              return k.listen()
            });
          case "one":
            return g = this.model.prototype.name, b.socket.emit("read:" + g, {_id: f._modelId}), b.socket.once("read:" + g + "/" + f._modelId, function (a) {
              if (a.errorCode)return"function" === typeof f.error ? f.error(a.errorCode) : void 0;
              k.update(a[g]);
              return"function" === typeof f.success ? f.success(k.get(a[g]._id)) : void 0
            })
        }
      };
      d.prototype.listen = function () {
        var a, e = this;
        a = this.name;
        a = this._boundToObjectId ? "" + a + "/" + this._boundToObjectId : "" + a;
        b.socket.on(":new:" + a, function (a) {
          return e.add(a, {parse: !0})
        });
        b.socket.on(":change:" + a, function (a) {
          return e.set(a, {parse: !0})
        });
        b.socket.on(":remove:" + a, function (a) {
          if (a = e.get(a))return e.remove(a)
        });
        return this
      };
      d.prototype.last = function () {
        return 0 === this.length ? {} : this.at(this.length - 1)
      };
      d.prototype.comparator = function (a) {
        if ("latest-created" === this.orderBy)return-(new Date(a.get("created"))).getTime();
        if ("earliest-created" === this.orderBy)return(new Date(a.get("created"))).getTime();
        if ("latest-updated" === this.orderBy)return-(new Date(a.get("updated"))).getTime();
        if ("earliest-updated" === this.orderBy)return(new Date(a.get("updated"))).getTime();
        if (this.orderBy)return a.get(this.orderBy)
      };
      d.prototype.update = function (a, b) {
        b || (b = {});
        b.remove = !1;
        b.parse = !0;
        return this.set(a, b)
      };
      d.prototype.loadMore = function (a) {
        var b, e = this;
        a || (a = {});
        a.remove = !1;
        a.parse = !0;
        b = a.error || function () {
        };
        a.error = function () {
          return b.apply(e, arguments)
        };
        return this.fetch(a)
      };
      d.prototype.fetchOne = function (a, b) {
        b._modelId = a;
        return this.sync("one", this, b)
      };
      d.prototype.reset = function () {
        this.pageIndex =
          0;
        this.hasMore = this.synced = !1;
        return d.__super__.reset.apply(this, arguments)
      };
      return d
    }(f.Collection)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/project", ["exports", "warehouse", "model", "collection"], function (f, b, e, d) {
    var k;
    e = function (e) {
      function f() {
        return k = f.__super__.constructor.apply(this, arguments)
      }

      a(f, e);
      f.prototype.name = "project";
      f.prototype.defaults = {_organizationId: null, objectType: "project", category: "media", description: "...",
        postsCount: 0, tasksCount: 0, worksCount: 0};
      f.prototype.inviteMember = function (a, e, f) {
        var d = this;
        a = {_projectId: this.id, emails: a, message: e};
        f.beforeSend();
        b.socket.emit("invite:project", a);
        b.socket.once("invite:project/" + this.id, function (a) {
          if (a.errorCode)return f.error(a.errorCode);
          d.membercollection.add(a.membersData);
          return"function" === typeof f.success ? f.success(a.membersData) : void 0
        });
        return this
      };
      f.prototype.resendInviteEmail = function (a) {
        var e;
        e = _.extend({_boundToObjectId: this.id, boundToObjectType: "project"},
          a);
        b.socket.emit("resendinviteemail:member", e);
        b.socket.once("resendinviteemail:member/" + a._userId, function (a) {
          return a.errorCode ? "function" === typeof e.error ? e.error(a.errorCode) : void 0 : e.success(a)
        });
        return this
      };
      f.prototype.transfer = function (a, e) {
        var f, d, g = this;
        d = _.extend({}, e);
        d.success = function (a) {
          g.set(a);
          return"function" === typeof e.success ? e.success(a) : void 0
        };
        "function" === typeof d.beforeSend && d.beforeSend();
        f = {_id: this.id};
        a !== teambition.user.id && (f._organizationId = a);
        b.socket.emit("transfer:project",
          f);
        b.socket.once("transfer:project/" + this.id, function (a) {
          return a.errorCode ? "function" === typeof d.error ? d.error(a.errorCode) : void 0 : d.success(a)
        });
        return this
      };
      f.prototype.quit = function (a) {
        var e;
        e = _.extend({}, a);
        "function" === typeof e.beforeSend && e.beforeSend();
        b.socket.emit("quit:project", {_id: this.id});
        return b.socket.once("quit:project/" + this.id, function (a) {
          return a.errorCode ? "function" === typeof e.error ? e.error(a.errorCode) : void 0 : "function" === typeof e.success ? e.success(a) : void 0
        })
      };
      return f
    }(e);
    return f["export"] = e
  })
}).call(this);
(function () {
  var d = function (a, e) {
    return function () {
      return a.apply(e, arguments)
    }
  }, a = {}.hasOwnProperty, f = function (b, e) {
    function f() {
      this.constructor = b
    }

    for (var d in e)a.call(e, d) && (b[d] = e[d]);
    f.prototype = e.prototype;
    b.prototype = new f;
    b.__super__ = e.prototype;
    return b
  };
  define("collections/projects", ["exports", "warehouse", "collection", "models/project"], function (a, e, g, k) {
    var h, l;
    h = teambition.user;
    g = function (a) {
      function b() {
        this.getOrganizationProjects = d(this.getOrganizationProjects, this);
        return l = b.__super__.constructor.apply(this,
          arguments)
      }

      f(b, a);
      b.prototype.name = "projects";
      b.prototype.model = k;
      b.prototype.orderBy = "earliest-created";
      b.prototype.listen = function () {
        var a, b = this;
        a = this._boundToObjectId || h.id;
        e.socket.on(":new:projects/" + a, function (a) {
          return b.add(a)
        });
        return e.socket.on(":remove:projects/" + a, function (a) {
          return b.remove(b.get(a))
        })
      };
      b.prototype.getOrganizationProjects = function (a) {
        return this.where({_organizationId: a})
      };
      b.prototype.getByOrganizationIdJSON = function (a) {
        var b, e, f, d, g;
        e = [];
        g = this.models;
        f = 0;
        for (d = g.length; f <
          d; f++)b = g[f], b.get("_organizationId") === a && e.push(b.toJSON());
        return e
      };
      b.prototype.getSelfProjectCount = function () {
        return this.where({_organizationId: null}).length
      };
      b.prototype.getStarProjects = function () {
        var a;
        a = this.filter(function (a) {
          return a.get("isStar")
        });
        return _.sortBy(a, function (a) {
          return new Date(a.get("starDate"))
        })
      };
      return b
    }(g);
    return a["export"] = g
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("router", ["backbone", "warehouse", "models/project", "collections/projects"], function (f, b, e, d) {
    var k, h;
    k = teambition.APP;
    return function (l) {
      function n() {
        return h = n.__super__.constructor.apply(this, arguments)
      }

      a(n, l);
      n.prototype.routes = {"projects(/*paramString)": "enterPortal", "project/:_projectId/:appName(/*paramString)": "enterProjectApp",
        "*paramString": "home"};
      n.prototype.home = function () {
        return this.navigate("projects", {trigger: !0})
      };
      n.prototype.enterPortal = function (a) {
        a = this.splitParamString(a);
        this.paramString = a.paramString;
        a = {params: this._analyzeParams(a.paramString), routeString: a.routeString};
        k.enter("portal", a);
        teambition.gta.pageview({page: "/projects", title: "portal"});
        return this
      };
      n.prototype.enterProjectApp = function (a, e, f) {
        return b.get(d, null, a) ? (f = this.splitParamString(f), this.paramString = f.paramString, f = {_projectId: a, routeString: f.routeString,
          params: this._analyzeParams(f.paramString)}, k.enter(e, f), teambition.gta.pageview({page: "project/" + a + "/" + e, title: e})) : this.home()
      };
      n.prototype.splitParamString = function (a) {
        var b;
        b = {routeString: "", paramString: ""};
        if (!a)return b;
        ~a.indexOf("?") ? (a = a.split("?"), b.routeString = a[0], b.paramString = a[1]) : ~a.indexOf("=") ? (b.routeString = "", b.paramString = a) : (b.routeString = a, b.paramString = "");
        return b
      };
      n.prototype.setupLinkEvents = function () {
        var a = this;
        return $(document).on("click", ".url", function (b) {
          a.navigate($(b.currentTarget).data("url"),
            {trigger: !0});
          return!1
        })
      };
      n.prototype._analyzeParams = function (a) {
        var b, e, f, d;
        if (!a)return{};
        b = {};
        a = a.split(",");
        if (a.length)for (f = 0, d = a.length; f < d; f++)e = a[f], ~e.indexOf("=") && (e = e.split("="), b[e[0]] = e[1]);
        return b
      };
      n.prototype.start = function () {
        this.setupLinkEvents();
        f.history.start({pushState: !0});
        return this
      };
      n.prototype.clearWhenExit = function (a) {
        var f, d, g;
        f = b.get(e);
        d = f.get(a);
        f.remove(a);
        (g = d.get("_organizationId")) && b.get(e, g).remove(a);
        return k.switcher.updateUrl({_projectId: null}, {trigger: !0})
      };
      n.prototype.routeToHandler = function (a) {
        var b, e, f, d, g;
        b = function (a, b, e, f) {
          return function (d) {
            d = f._extractParameters(e, d);
            return b[a].apply(b, d)
          }
        };
        d = a.routes;
        a.handlers = [];
        g = [];
        for (f in d)e = d[f], f = this._routeToRegExp(f), g.push(a.handlers.push({route: f, callback: b(e, a, f, this)}));
        return g
      };
      n.prototype.checkRoute = function (a, b) {
        var e, f, d, g;
        null != k && k.dynamicTitle();
        this.routeToHandler(b);
        g = b.handlers;
        f = 0;
        for (d = g.length; f < d; f++)if (e = g[f], e.route.test(a))return e.callback(a)
      };
      n.prototype.getUrl = function () {
        return f.history.getFragment()
      };
      n.prototype.getPrefix = function () {
        var a, b;
        a = this.getUrl().split("/");
        switch (a[0]) {
          case "organizations":
            b = "organizations";
            break;
          case "projects":
            b = "projects";
            break;
          case "organization":
            "projects" === a[2] ? b = a.slice(0, 3).join("/") : "project" === a[2] && (b = a.slice(0, 4).join("/"));
            break;
          case "project":
            b = a.slice(0, 2).join("/")
        }
        return b
      };
      n.prototype.getByNum = function (a) {
        a = +a || 0;
        return this.getUrl.split("/")[a]
      };
      return n
    }(f.Router)
  })
}).call(this);
(function () {
  define("lib/hint/index", ["jquery"], function () {
    var d, a;
    d = $(document);
    a = function (a) {
      return"<div class='arrow'></div>\n<p class='message'>" + a + "</p>"
    };
    return{initialize: function () {
      var f = this;
      this.$el = $('<div class="hint"></div>');
      return d.on("mouseenter", ".hinted", function (b) {
        var e, g, k;
        e = $(b.currentTarget);
        g = setTimeout(function () {
          var g, l, k, m, s, r, t, v, p, x, B, C, z, A, u, w;
          e.off(".hint");
          s = e.data("title");
          k = e.offset().top;
          m = e.offset().left;
          g = e.height();
          l = e.width();
          if (e.hasClass("hint-content")) {
            if (!(e.get(0).scrollWidth >
              e.width()))return;
            s || (s = e.text())
          }
          f.$el.html(a(s));
          $("body").append(f.$el);
          r = f.$el.outerHeight();
          t = f.$el.outerWidth();
          x = p = v = void 0;
          s = window.innerWidth;
          A = function () {
            v = k + g + 10;
            p = m + 0.5 * l - 0.5 * t;
            return x = "top"
          };
          B = function () {
            v = k - r - 10;
            p = m + 0.5 * l - 0.5 * t;
            return x = "bottom"
          };
          C = function () {
            v = k + 0.5 * g - 0.5 * r;
            p = m + l + 10;
            return x = "left"
          };
          z = function () {
            v = k + 0.5 * g - 0.5 * r;
            p = m - t - 10;
            return x = "right"
          };
          u = $(b.currentTarget).data("derection");
          if (!u || "left" !== u && "right" !== u && "bottom" !== u && "top" !== u)B(), p + t > s && 0 < m - t - 10 ? z() : 0 > v ? m + l + t +
            10 < s ? C() : A() : 0 > p && C(); else switch (u) {
            case "left":
              C();
              break;
            case "right":
              z();
              break;
            case "top":
              A();
              break;
            case "bottom":
              B()
          }
          f.$el.css({top: "" + v + "px", left: "" + p + "px"});
          f.$el.children(".arrow").prop("class", "arrow " + x);
          f.$el.addClass("on");
          w = function () {
            f.$el.css({top: "50%", left: "50%"}).removeClass("on").remove();
            return e.off(".hint")
          };
          e.one("mouseleave click", w).on("mousedown.hint",function () {
            return d.one("mousemove.hint", w)
          }).on("mouseup.hint",function () {
            return d.off("mousemove.hint")
          }).on("remove.hint",
            w)
        }, 370);
        k = function () {
          clearTimeout(g);
          return e.off(".hint")
        };
        e.one("mouseleave click", k).on("mousedown.hint",function () {
          return d.one("mousemove.hint", k)
        }).on("mouseup.hint",function () {
          return d.off("mousemove.hint")
        }).on("remove.hint", k)
      })
    }}
  })
}).call(this);
(function (d, a, f) {
  function b(a, b, e) {
    a.addEventListener ? a.addEventListener(b, e, !1) : a.attachEvent("on" + b, e)
  }

  function e(a) {
    if ("keypress" == a.type) {
      var b = String.fromCharCode(a.which);
      a.shiftKey || (b = b.toLowerCase());
      return b
    }
    return v[a.which] ? v[a.which] : p[a.which] ? p[a.which] : String.fromCharCode(a.which).toLowerCase()
  }

  function g(a) {
    a = a || {};
    var b = !1, e;
    for (e in u)a[e] ? b = !0 : u[e] = 0;
    b || (F = !1)
  }

  function k(a, b, e, f, d, g) {
    var h, p, k = [], l = e.type;
    if (!z[a])return[];
    "keyup" == l && m(a) && (b = [a]);
    for (h = 0; h < z[a].length; ++h)if (p =
      z[a][h], (f || !p.seq || u[p.seq] == p.level) && l == p.action) {
      var n;
      (n = "keypress" == l && !e.metaKey && !e.ctrlKey) || (n = p.modifiers, n = b.sort().join(",") === n.sort().join(","));
      n && (n = f && p.seq == f && p.level == g, (!f && p.combo == d || n) && z[a].splice(h, 1), k.push(p))
    }
    return k
  }

  function h(a) {
    var b = [];
    a.shiftKey && b.push("shift");
    a.altKey && b.push("alt");
    a.ctrlKey && b.push("ctrl");
    a.metaKey && b.push("meta");
    return b
  }

  function l(a, b, e, f) {
    H.stopCallback(b, b.target || b.srcElement, e, f) || !1 !== a(b, e) || (b.preventDefault ? b.preventDefault() : b.returnValue = !1, b.stopPropagation ? b.stopPropagation() : b.cancelBubble = !0)
  }

  function n(a) {
    "number" !== typeof a.which && (a.which = a.keyCode);
    var b = e(a);
    b && ("keyup" == a.type && y === b ? y = !1 : H.handleKey(b, h(a), a))
  }

  function m(a) {
    return"shift" == a || "ctrl" == a || "alt" == a || "meta" == a
  }

  function s(a, b, f, d) {
    function h(b) {
      return function () {
        F = b;
        ++u[a];
        clearTimeout(w);
        w = setTimeout(g, 1E3)
      }
    }

    function p(b) {
      l(f, b, a);
      "keyup" !== d && (y = e(b));
      setTimeout(g, 10)
    }

    for (var k = u[a] = 0; k < b.length; ++k) {
      var m = k + 1 === b.length ? p : h(d || r(b[k + 1]).action);
      t(b[k], m, d,
        a, k)
    }
  }

  function r(a, b) {
    var e, f, d, g = [];
    e = "+" === a ? ["+"] : a.split("+");
    for (d = 0; d < e.length; ++d)f = e[d], B[f] && (f = B[f]), b && "keypress" != b && x[f] && (f = x[f], g.push("shift")), m(f) && g.push(f);
    e = f;
    d = b;
    if (!d) {
      if (!C) {
        C = {};
        for (var h in v)95 < h && 112 > h || v.hasOwnProperty(h) && (C[v[h]] = h)
      }
      d = C[e] ? "keydown" : "keypress"
    }
    "keypress" == d && g.length && (d = "keydown");
    return{key: f, modifiers: g, action: d}
  }

  function t(a, b, e, f, d) {
    A[a + ":" + e] = b;
    a = a.replace(/\s+/g, " ");
    var g = a.split(" ");
    1 < g.length ? s(a, g, b, e) : (e = r(a, e), z[e.key] = z[e.key] || [], k(e.key,
      e.modifiers, {type: e.action}, f, a, d), z[e.key][f ? "unshift" : "push"]({callback: b, modifiers: e.modifiers, action: e.action, seq: f, level: d, combo: a}))
  }

  var v = {8: "backspace", 9: "tab", 13: "enter", 16: "shift", 17: "ctrl", 18: "alt", 20: "capslock", 27: "esc", 32: "space", 33: "pageup", 34: "pagedown", 35: "end", 36: "home", 37: "left", 38: "up", 39: "right", 40: "down", 45: "ins", 46: "del", 91: "meta", 93: "meta", 224: "meta"}, p = {106: "*", 107: "+", 109: "-", 110: ".", 111: "/", 186: ";", 187: "=", 188: ",", 189: "-", 190: ".", 191: "/", 192: "`", 219: "[", 220: "\\", 221: "]",
    222: "'"}, x = {"~": "`", "!": "1", "@": "2", "#": "3", $: "4", "%": "5", "^": "6", "&": "7", "*": "8", "(": "9", ")": "0", _: "-", "+": "=", ":": ";", '"': "'", "<": ",", ">": ".", "?": "/", "|": "\\"}, B = {option: "alt", command: "meta", "return": "enter", escape: "esc", mod: /Mac|iPod|iPhone|iPad/.test(navigator.platform) ? "meta" : "ctrl"}, C, z = {}, A = {}, u = {}, w, y = !1, J = !1, F = !1;
  for (f = 1; 20 > f; ++f)v[111 + f] = "f" + f;
  for (f = 0; 9 >= f; ++f)v[f + 96] = f;
  b(a, "keypress", n);
  b(a, "keydown", n);
  b(a, "keyup", n);
  var H = {bind: function (a, b, e) {
    a = a instanceof Array ? a : [a];
    for (var f = 0; f <
      a.length; ++f)t(a[f], b, e);
    return this
  }, unbind: function (a, b) {
    return H.bind(a, function () {
    }, b)
  }, trigger: function (a, b) {
    if (A[a + ":" + b])A[a + ":" + b]({}, a);
    return this
  }, reset: function () {
    z = {};
    A = {};
    return this
  }, stopCallback: function (a, b) {
    return-1 < (" " + b.className + " ").indexOf(" mousetrap ") ? !1 : "INPUT" == b.tagName || "SELECT" == b.tagName || "TEXTAREA" == b.tagName || b.isContentEditable
  }, handleKey: function (a, b, e) {
    var f = k(a, b, e), d;
    b = {};
    var h = 0, p = !1;
    for (d = 0; d < f.length; ++d)f[d].seq && (h = Math.max(h, f[d].level));
    for (d = 0; d < f.length; ++d)f[d].seq ?
      f[d].level == h && (p = !0, b[f[d].seq] = 1, l(f[d].callback, e, f[d].combo, f[d].seq)) : p || l(f[d].callback, e, f[d].combo);
    f = "keypress" == e.type && J;
    e.type != F || m(a) || f || g(b);
    J = p && "keydown" == e.type
  }};
  d.Mousetrap = H;
  "function" === typeof define && define.amd && define("mousetrap", H)
})(window, document);
(function () {
  var d = [].slice;
  define("hotkey", ["underscore", "mousetrap"], function (a, f) {
    var b, e, g, k;
    b = $("body").data("hotkeys", {});
    g = {};
    k = function () {
    };
    f.stopCallback = function (a, b, e) {
      return"esc" === e ? !1 : "INPUT" === b.tagName || "SELECT" === b.tagName || "TEXTAREA" === b.tagName || b.contentEditable && "true" === b.contentEditable
    };
    e = function (a, e) {
      var d, k;
      for (d = g[e][0]; !d.data("hotkeys");)g[e].shift(), d = g[e][0];
      if (k = d.data("hotkeys")[e])return k(a, e);
      if (d === b)return f.unbind(e)
    };
    return{add: function (d) {
      var l, n;
      if (!d && !d.hotkeys)return this;
      n = a.clone(d.hotkeys);
      l = d.$el || b;
      a.each(d.preventHotkeys, function (a) {
        return n[a] = k
      });
      a.each(n, function (k, s) {
        var r, t;
        if (null == (r = d.currentView) || null == (t = r.hotkeys) || !t[s])return a.isFunction(k) || (k = d[k]), k && a.isFunction(k) ? (k = a.bind(k, d), s = s.split("|"), a.each(s, function (d) {
          n[d] = k;
          f.bind(d, e);
          g[d] || (g[d] = [b]);
          if (l !== b)return g[d] = a.without(g[d], l), g[d].unshift(l)
        })) : delete n[s]
      });
      l === b ? a.extend(b.data("hotkeys"), n) : l.data("hotkeys", n);
      return this
    }, remove: function () {
      var e, f, k, m, s;
      f = arguments[0];
      m = 2 <=
        arguments.length ? d.call(arguments, 1) : [];
      if (!f)return this;
      s = !m.length;
      e = f.$el || b;
      k = e.data("hotkeys");
      s && (m = a.keys(f.hotkeys || {}));
      k && a.each(m, function (f) {
        delete k[f];
        if (s && !e === b)return g[f] = a.without(g[f], e)
      });
      return this
    }, reset: function () {
      f.reset();
      b.data("hotkeys", {});
      g = {};
      return this
    }}
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, e) {
    function f() {
      this.constructor = a
    }

    for (var k in e)d.call(e, k) && (a[k] = e[k]);
    f.prototype = e.prototype;
    a.prototype = new f;
    a.__super__ = e.prototype;
    return a
  }, f = [].slice;
  define("view", ["backbone", "util", "hotkey"], function (b, e, d) {
    var k, h, l;
    k = teambition.APP;
    h = function () {
      return'<div class="loading-indicator">\n  <span class="loader-dot"></span>\n  <span class="loader-dot"></span>\n  <span class="loader-dot"></span>\n</div>'
    };
    return function (n) {
      function m() {
        return l =
          m.__super__.constructor.apply(this, arguments)
      }

      a(m, n);
      m.prototype.hotkeys = {};
      m.prototype.routes = {};
      m.prototype.setupHotKey = function () {
        d.add(this);
        return this
      };
      m.prototype.reset = function () {
        return this.dataModels = _.toArray(arguments)
      };
      m.prototype.requestSubView = function (a, b) {
        var e;
        b || (b = {});
        e = new (a.Constructor || a)(b);
        e.parentView = this;
        "function" === typeof e.setupHotKey && e.setupHotKey();
        teambition.guideView && "function" === typeof e.guideView && e.guideView();
        this.subViews || (this.subViews = []);
        this.subViews.push(e);
        return e
      };
      m.prototype.removeSubViews = function () {
        var a, b = this;
        a = 1 <= arguments.length ? f.call(arguments, 0) : [];
        if (this.subViews) {
          for (_.each(a, function (a) {
            return e.removeItem(b.subViews, a)
          }); 0 < this.subViews.length;)this.subViews.pop().remove();
          this.subViews = a
        }
        return this
      };
      m.prototype.remove = function (a) {
        var b, f, h = this;
        "function" === typeof this.removeSubViews && this.removeSubViews();
        a || (a = {});
        this.toolEvents && (this.undelegateEventsOnElement(this.$toolset), delete this.$toolset);
        d.remove(this);
        "function" === typeof this.deregisterAsResponsive &&
        this.deregisterAsResponsive();
        a.keepListen || this.stopListening();
        null != (b = this.$el) && b.remove();
        null != (f = this.parentView) && f.subViews && e.removeItem(this.parentView.subViews, this);
        _.each(this, function (a, b) {
          return h[b] = null
        });
        return this
      };
      m.prototype.registerAsResponsive = function () {
        k.responsiveViews[this.cid] = this;
        return this
      };
      m.prototype.deregisterAsResponsive = function () {
        delete k.responsiveViews[this.cid];
        return this
      };
      m.prototype.detached = function () {
        var a;
        a = this.$el.get(0);
        return a.id ? !document.getElementById(a.id) :
          !$.contains(document, a)
      };
      m.prototype.delegateEventsOnElement = function (a, e) {
        var f;
        e && (this.$el = e);
        f = b.View.prototype.delegateEvents.apply(this, arguments);
        e && (this.$el = $(this.el));
        return f
      };
      m.prototype.undelegateEventsOnElement = function (a) {
        var e;
        a && (this.$el = a);
        e = b.View.prototype.undelegateEvents.apply(this, arguments);
        a && (this.$el = $(this.el));
        return e
      };
      m.prototype.setupPlaceholder = function (a, b) {
        var e, f = this;
        e = function () {
          if (a.length) {
            if (f.$placeholder)return f.hidePlaceholder(b)
          } else return f.showPlaceholder(b)
        };
        this.listenTo(a, "add remove", e);
        return _.defer(function () {
          return e()
        })
      };
      m.prototype.showPlaceholder = function (a) {
        var b;
        this.$el.addClass("empty");
        null != (b = this.$placeholder) && b.remove();
        return this.$placeholder = $("<div class='no-" + a + "-placeholder placeholder'></div>").appendTo(this.$el)
      };
      m.prototype.hidePlaceholder = function () {
        var a;
        this.$el.removeClass("empty");
        null != (a = this.$placeholder) && a.remove();
        return delete this.$placeholder
      };
      m.prototype.showLoadingIndicator = function (a, b) {
        var e, f;
        null == a && (a =
          this.$el);
        e = null != b && b.isPrepend ? "prependTo" : "appendTo";
        null != (f = this.$loadingIcon) && f.remove();
        this.$loadingIcon = $(h())[e](a);
        return this
      };
      m.prototype.hideLoadingIndicator = function (a) {
        var b, e, f = this;
        null != a && a.animated ? null != (b = this.$loadingIcon) && b.animate({opacity: 0, height: 0}, function () {
          var a;
          return null != (a = f.$loadingIcon) ? a.remove() : void 0
        }) : (null != (e = this.$loadingIcon) && e.remove(), delete this.$loadingIcon);
        return this
      };
      return m
    }(b.View)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("lib/window/index", ["view", "util", "hotkey"], function (f, b, e) {
    var d, k, h;
    k = [];
    d = $("body");
    return function (f) {
      function n() {
        return h = n.__super__.constructor.apply(this, arguments)
      }

      a(n, f);
      n.prototype.viewName = "WindowView";
      n.prototype.className = "modal fade";
      n.prototype.hotkeys = {esc: function (a) {
        a.preventDefault();
        return this.remove()
      }};
      n.prototype.delegateModalEvents = function () {
        var a = this;
        this.$el.on("shown.bs.modal", function () {
          return a.onOpen()
        });
        this.$el.on("hidden.bs.modal", function () {
          return a.remove()
        });
        return this
      };
      n.prototype.open = function (a, b) {
        var f, h, l = this;
        f = k[0];
        k.unshift(this);
        this.$el.one("showing.bs.modal", function () {
          var a;
          l.$backdrop = l.$el.prev(".modal-backdrop:not(.backdrop-added)").addClass("backdrop-added");
          if (f)return a = parseInt(f.$el.css("z-index"), 10) + 1, l.$backdrop.css("z-index", a - 1), l.$el.css("z-index",
            a)
        });
        this.currentView = this.requestSubView(a, b);
        this.renderDialog ? this.renderDialog(this.currentView) : this.$el.html(this.currentView.$el);
        this.delegateModalEvents();
        d.addClass("modals-open");
        this.$el.modal({keyboard: !1, backdrop: null != (h = this.options) ? h.backdrop : void 0});
        e.add(this);
        return this
      };
      n.prototype.onOpen = function () {
        var a, b, e;
        if (null != (a = this.currentView) && "function" === typeof a.onOpen)a.onOpen();
        if (null != (b = this.currentView) && null != (e = b.options) && "function" === typeof e.onOpen)e.onOpen();
        return this
      };
      n.prototype.remove = function () {
        var a, f, h, l, v;
        null != (a = this.$el) && a.modal("hide");
        if (null != (f = this.currentView) && "function" === typeof f.onClose)f.onClose();
        if (null != (h = this.currentView) && null != (l = h.options) && "function" === typeof l.onClose)l.onClose();
        b.removeItem(k, this);
        e.remove(this);
        null != (v = this.$backdrop) && v.remove();
        k.length || ($(".modal-backdrop").remove(), d.removeClass("modals-open"));
        return n.__super__.remove.apply(this, arguments)
      };
      return n
    }(f)
  })
}).call(this);
(function (d) {
  var a = {version: "2.1.2", areas: {}, apis: {}, inherit: function (a, b) {
    for (var e in a)b.hasOwnProperty(e) || (b[e] = a[e]);
    return b
  }, stringify: function (a) {
    return void 0 === a || "function" === typeof a ? a + "" : JSON.stringify(a)
  }, parse: function (a) {
    try {
      return JSON.parse(a)
    } catch (b) {
      return a
    }
  }, fn: function (f, b) {
    a.storeAPI[f] = b;
    for (var e in a.apis)a.apis[e][f] = b
  }, get: function (a, b) {
    return a.getItem(b)
  }, set: function (a, b, e) {
    a.setItem(b, e)
  }, remove: function (a, b) {
    a.removeItem(b)
  }, key: function (a, b) {
    return a.key(b)
  }, length: function (a) {
    return a.length
  },
    clear: function (a) {
      a.clear()
    }, Store: function (f, b, e) {
      var d = a.inherit(a.storeAPI, function (a, b, e) {
        return 0 === arguments.length ? d.getAll() : void 0 !== b ? d.set(a, b, e) : "string" === typeof a ? d.get(a) : a ? d.setAll(a, b) : d.clear()
      });
      d._id = f;
      d._area = b || a.inherit(a.storageAPI, {items: {}, name: "fake"});
      d._ns = e || "";
      a.areas[f] || (a.areas[f] = d._area);
      a.apis[d._ns + d._id] || (a.apis[d._ns + d._id] = d);
      return d
    }, storeAPI: {area: function (f, b) {
      var e = this[f];
      e && e.area || (e = a.Store(f, b, this._ns), this[f] || (this[f] = e));
      return e
    }, namespace: function (f, b) {
      if (!f)return this._ns ? this._ns.substring(0, this._ns.length - 1) : "";
      var e = this[f];
      e && e.namespace || (e = a.Store(this._id, this._area, this._ns + f + "."), this[f] || (this[f] = e), b || e.area("session", a.areas.session));
      return e
    }, isFake: function () {
      return"fake" === this._area.name
    }, toString: function () {
      return"store" + (this._ns ? "." + this.namespace() : "") + "[" + this._id + "]"
    }, has: function (a) {
      return this._area.has ? this._area.has(this._in(a)) : !!(this._in(a)in this._area)
    }, size: function () {
      return this.keys().length
    }, each: function (f, b) {
      for (var e = 0, d = a.length(this._area); e < d; e++) {
        var k = this._out(a.key(this._area, e));
        if (void 0 !== k && !1 === f.call(this, k, b || this.get(k)))break;
        d > a.length(this._area) && (d--, e--)
      }
      return b || this
    }, keys: function () {
      return this.each(function (a, b) {
        b.push(a)
      }, [])
    }, get: function (f, b) {
      var e = a.get(this._area, this._in(f));
      return null !== e ? a.parse(e) : b || e
    }, getAll: function () {
      return this.each(function (a, b) {
        b[a] = this.get(a)
      }, {})
    }, set: function (f, b, e) {
      var d = this.get(f);
      return null != d && !1 === e ? b : a.set(this._area, this._in(f),
        a.stringify(b), e) || d
    }, setAll: function (a, b) {
      var e, d, k;
      for (k in a)d = a[k], this.set(k, d, b) !== d && (e = !0);
      return e
    }, remove: function (f) {
      var b = this.get(f);
      a.remove(this._area, this._in(f));
      return b
    }, clear: function () {
      this._ns ? this.each(function (f) {
        a.remove(this._area, this._in(f))
      }, 1) : a.clear(this._area);
      return this
    }, clearAll: function () {
      var f = this._area, b;
      for (b in a.areas)a.areas.hasOwnProperty(b) && (this._area = a.areas[b], this.clear());
      this._area = f;
      return this
    }, _in: function (f) {
      "string" !== typeof f && (f = a.stringify(f));
      return this._ns ? this._ns + f : f
    }, _out: function (a) {
      return this._ns ? a && 0 === a.indexOf(this._ns) ? a.substring(this._ns.length) : void 0 : a
    }}, storageAPI: {length: 0, has: function (a) {
      return this.items.hasOwnProperty(a)
    }, key: function (a) {
      var b = 0, e;
      for (e in this.items)if (this.has(e) && a === b++)return e
    }, setItem: function (a, b) {
      this.has(a) || this.length++;
      this.items[a] = b
    }, removeItem: function (a) {
      this.has(a) && (delete this.items[a], this.length--)
    }, getItem: function (a) {
      return this.has(a) ? this.items[a] : null
    }, clear: function () {
      for (var a in this.list)this.removeItem(a)
    },
      toString: function () {
        return this.length + " items in " + this.name + "Storage"
      }}};
  d.store && (a.conflict = d.store);
  d = d.store = a.Store("local", localStorage);
  d.local = d;
  d._ = a;
  d.area("session", sessionStorage);
  "undefined" !== typeof module && module.exports && (module.exports = d)
})(window);
define("store", function (d) {
  return function () {
    return d.store
  }
}(this));
define("lib/notification/templates/basic", [], function () {
  return function (d) {
    return'<div class="setup-browser-notification-modal modal"> <div class="modal-dialog card"> <a class="close-modal-btn pull-right" data-dismiss="modal"> <span class="icon icon-remove"></span> </a> <div class="card-header"> <p class="card-title"></p> </div> <div class="card-content"> <p class="description">, </p> <hr> <button class="request-permission-btn btn btn-primary btn-block"></button> <button class="cancel-setup-btn btn btn-block"></button> </div> </div></div><div class="modal-backdrop"></div>'
  }
});
(function () {
  define("lib/notification/index", ["store", "./templates/basic"], function (d, a) {
    var f, b, e, g, k;
    e = d.namespace("desktopNotification");
    f = window.webkitNotifications;
    k = function () {
      return!!f
    };
    b = function () {
      return 0 === f.checkPermission()
    };
    g = function (a) {
      return f.requestPermission(a)
    };
    return{support: function () {
      return k()
    }, hasPermission: function () {
      if (k())return e("disableDesktopNotification") ? !1 : b()
    }, setup: function (f) {
      var d;
      if (k())return d = $(a()).appendTo("body"), d.find(".request-permission-btn").one("click",
        function () {
          return g(function () {
            e("disableDesktopNotification", !b());
            null != d && d.remove();
            return"function" === typeof f ? f() : void 0
          })
        }), d.find(".cancel-setup-btn").one("click", function () {
        d.remove();
        return e("disableDesktopNotification", !0)
      }), d.find(".close-modal-btn").one("click", function () {
        return d.remove()
      })
    }, show: function (a, b) {
      var d = this;
      if (k()) {
        if (this.hasPermission())return _.delay(function () {
          var d;
          if (!a.notificationId || !e(a.notificationId))return d = f.createNotification(a.icon, a.title, a.content),
            d.onclick = function () {
              d.cancel();
              return"function" === typeof b ? b() : void 0
            }, d.show(), a.notificationId && e(a.notificationId, !0, 2)
        }, 3E3 * Math.random());
        if (null === e("disableDesktopNotification"))return this.setup(function () {
          return d.show(a, b)
        })
      }
    }}
  })
}).call(this);
(function () {
  function d() {
  }

  function a(a) {
    return"function" === typeof a
  }

  function f(a, b, e) {
    return Error("Argument " + (a && a.toString()) + ' in "' + b + '" function is not a ' + e + "!")
  }

  function b(b, e, d, g) {
    function h(a, e, f) {
      m -= 1;
      if (null == e) {
        if (r[a] = f, 0 >= m)return b(null, r)
      } else return b(e)
    }

    var k, l, m, n, r = [];
    if (p(e))if (a(d))if (m = l = e.length)for (k = 0; k < l; k++)n = h.bind(null, k), n.nextThenObject = t, d.call(g, n, e[k], k, e); else return b(null, r); else return b(f(d, "each", "function")); else return b(f(e, "each", "array"))
  }

  function e(b, e, d, g) {
    function h(a, f) {
      l += 1;
      if (null == a) {
        m[l - 1] = f;
        if (l < k)return d.call(g, h, e[l], l, e);
        delete m[-1];
        return b(null, m)
      }
      return b(a)
    }

    var k, l = -1, m = [];
    return p(e) ? a(d) ? (k = e.length) ? (h.nextThenObject = t, h()) : b(null, m) : b(f(d, "eachSeries", "function")) : b(f(e, "eachSeries", "array"))
  }

  function g(b, e, d) {
    function g(a, e, f) {
      l -= 1;
      if (null == e) {
        if (n[a] = f, 0 >= l)return b(null, n)
      } else return b(e)
    }

    var h, k, l, m, n = [];
    if (p(e))if (l = k = e.length)for (h = 0; h < k; h++)if (a(e[h]))m = g.bind(null, h), m.nextThenObject = t, e[h].call(d, m, h); else return b(f(e[h],
      "parallel", "function")); else return b(null, n); else return b(f(e, "parallel", "array"))
  }

  function k(b, e, d) {
    function g(p, m) {
      k += 1;
      if (null == p) {
        l[k - 1] = m;
        if (k < h)return a(e[k]) ? e[k].call(d, g, k) : b(f(e[k], "series", "function"));
        delete l[-1];
        return b(null, l)
      }
      return b(p)
    }

    var h, k = -1, l = [];
    return p(e) ? (h = e.length) ? (g.nextThenObject = t, g()) : b(null, l) : b(f(e, "series", "array"))
  }

  function h(a, b) {
    x(function () {
      try {
        b()
      } catch (e) {
        a(e)
      }
    })
  }

  function l(b, e) {
    return a(e) ? e.nextThenObject ? e : e.bind(null, b) : null
  }

  function n(f) {
    function h(a, b) {
      var e = new n, f = e.defer.bind(e);
      f.nextThenObject = e;
      a(f, b);
      return e
    }

    var p = [], m = 0, n = function () {
    }, t = n.prototype;
    t.debug = !f || a(f) ? f : "object" === typeof console && console.log && function () {
      console.log.apply(console, arguments)
    };
    t.all = function (a) {
      return h(function (b, e) {
        e._all = l(b, a)
      }, this)
    };
    t.then = function (a, b) {
      return h(function (e, f) {
        f._success = l(e, a);
        f._error = l(e, b)
      }, this)
    };
    t.fail = function (a) {
      return h(function (b, e) {
        e._fail = l(b, a);
        e._success = b.bind(b, null);
        e._fail && p.push(e._fail)
      }, this)
    };
    t.each = function (a, e, f) {
      return h(function (d, g) {
        g._each = function (g, h, p) {
          b(d, a || g, e || h, f || p)
        }
      }, this)
    };
    t.eachSeries = function (a, b, f) {
      return h(function (d, g) {
        g._eachSeries = function (g, h, p) {
          e(d, a || g, b || h, f || p)
        }
      }, this)
    };
    t.parallel = function (a, b) {
      return h(function (e, f) {
        f._parallel = function (f, d) {
          g(e, a || f, b || d)
        }
      }, this)
    };
    t.series = function (a, b) {
      return h(function (e, f) {
        f._series = function (f, d) {
          k(e, a || f, b || d)
        }
      }, this)
    };
    t.defer = function (a) {
      function b() {
        if (f.debug) {
          var e = v.call(g);
          e.unshift("\nResult of chain " + m + ":");
          f.debug.apply(f.debug,
            e)
        }
        if (f._all)f._all.apply(f._all.nextThenObject, v.call(g)); else if (null == a)f._success.apply(f._success.nextThenObject, v.call(g, 1)); else throw a;
      }

      function e(a) {
        a.stack = a.stack || a.description;
        if (f._error || p.length)f._error = f._error || p.shift(), f._error.call(f._error.nextThenObject, a); else throw a;
      }

      var f = this, g = arguments;
      m += 1;
      f._error = f._fail ? p.shift() : f._error;
      f._success = f._success || f._each || f._eachSeries || f._parallel || f._series || d;
      try {
        b()
      } catch (h) {
        e(h)
      } finally {
        f._all = d
      }
    };
    return h
  }

  function m(a) {
    return function (b, e, f, d) {
      return n(d)(function (d) {
        h(d, a.bind(null, d, b, e, f))
      })
    }
  }

  function s(a) {
    return function (b, e, f) {
      return n(f)(function (f) {
        h(f, a.bind(null, f, b, e))
      })
    }
  }

  function r(b, e, f) {
    return n(f)(function (f) {
      h(f, a(b) ? b.bind(e, f) : f)
    })
  }

  var t = {}, v = [].slice, p = Array.isArray, x = "object" === typeof process && process.nextTick ? process.nextTick : setTimeout;
  r.each = m(b);
  r.eachSeries = m(e);
  r.parallel = s(g);
  r.series = s(k);
  "undefined" !== typeof module && module.exports ? module.exports = r : "function" === typeof define && define("thenjs", [], function () {
    return r
  });
  "object" === typeof window && (window.then = r)
})();
(function (d) {
  function a(a, b) {
    var e = (a & 65535) + (b & 65535);
    return(a >> 16) + (b >> 16) + (e >> 16) << 16 | e & 65535
  }

  function f(b, e, f, d, g, h) {
    b = a(a(e, b), a(d, h));
    return a(b << g | b >>> 32 - g, f)
  }

  function b(a, b, e, d, g, h, k) {
    return f(b & e | ~b & d, a, b, g, h, k)
  }

  function e(a, b, e, d, g, h, k) {
    return f(b & d | e & ~d, a, b, g, h, k)
  }

  function g(a, b, e, d, g, h, k) {
    return f(e ^ (b | ~d), a, b, g, h, k)
  }

  function k(d, h) {
    d[h >> 5] |= 128 << h % 32;
    d[(h + 64 >>> 9 << 4) + 14] = h;
    var p, k, l, m, n, r = 1732584193, s = -271733879, w = -1732584194, y = 271733878;
    for (p = 0; p < d.length; p += 16)k = r, l = s, m = w, n = y, r = b(r,
      s, w, y, d[p], 7, -680876936), y = b(y, r, s, w, d[p + 1], 12, -389564586), w = b(w, y, r, s, d[p + 2], 17, 606105819), s = b(s, w, y, r, d[p + 3], 22, -1044525330), r = b(r, s, w, y, d[p + 4], 7, -176418897), y = b(y, r, s, w, d[p + 5], 12, 1200080426), w = b(w, y, r, s, d[p + 6], 17, -1473231341), s = b(s, w, y, r, d[p + 7], 22, -45705983), r = b(r, s, w, y, d[p + 8], 7, 1770035416), y = b(y, r, s, w, d[p + 9], 12, -1958414417), w = b(w, y, r, s, d[p + 10], 17, -42063), s = b(s, w, y, r, d[p + 11], 22, -1990404162), r = b(r, s, w, y, d[p + 12], 7, 1804603682), y = b(y, r, s, w, d[p + 13], 12, -40341101), w = b(w, y, r, s, d[p + 14], 17, -1502002290),
      s = b(s, w, y, r, d[p + 15], 22, 1236535329), r = e(r, s, w, y, d[p + 1], 5, -165796510), y = e(y, r, s, w, d[p + 6], 9, -1069501632), w = e(w, y, r, s, d[p + 11], 14, 643717713), s = e(s, w, y, r, d[p], 20, -373897302), r = e(r, s, w, y, d[p + 5], 5, -701558691), y = e(y, r, s, w, d[p + 10], 9, 38016083), w = e(w, y, r, s, d[p + 15], 14, -660478335), s = e(s, w, y, r, d[p + 4], 20, -405537848), r = e(r, s, w, y, d[p + 9], 5, 568446438), y = e(y, r, s, w, d[p + 14], 9, -1019803690), w = e(w, y, r, s, d[p + 3], 14, -187363961), s = e(s, w, y, r, d[p + 8], 20, 1163531501), r = e(r, s, w, y, d[p + 13], 5, -1444681467), y = e(y, r, s, w, d[p + 2], 9, -51403784),
      w = e(w, y, r, s, d[p + 7], 14, 1735328473), s = e(s, w, y, r, d[p + 12], 20, -1926607734), r = f(s ^ w ^ y, r, s, d[p + 5], 4, -378558), y = f(r ^ s ^ w, y, r, d[p + 8], 11, -2022574463), w = f(y ^ r ^ s, w, y, d[p + 11], 16, 1839030562), s = f(w ^ y ^ r, s, w, d[p + 14], 23, -35309556), r = f(s ^ w ^ y, r, s, d[p + 1], 4, -1530992060), y = f(r ^ s ^ w, y, r, d[p + 4], 11, 1272893353), w = f(y ^ r ^ s, w, y, d[p + 7], 16, -155497632), s = f(w ^ y ^ r, s, w, d[p + 10], 23, -1094730640), r = f(s ^ w ^ y, r, s, d[p + 13], 4, 681279174), y = f(r ^ s ^ w, y, r, d[p], 11, -358537222), w = f(y ^ r ^ s, w, y, d[p + 3], 16, -722521979), s = f(w ^ y ^ r, s, w, d[p + 6], 23, 76029189), r = f(s ^
      w ^ y, r, s, d[p + 9], 4, -640364487), y = f(r ^ s ^ w, y, r, d[p + 12], 11, -421815835), w = f(y ^ r ^ s, w, y, d[p + 15], 16, 530742520), s = f(w ^ y ^ r, s, w, d[p + 2], 23, -995338651), r = g(r, s, w, y, d[p], 6, -198630844), y = g(y, r, s, w, d[p + 7], 10, 1126891415), w = g(w, y, r, s, d[p + 14], 15, -1416354905), s = g(s, w, y, r, d[p + 5], 21, -57434055), r = g(r, s, w, y, d[p + 12], 6, 1700485571), y = g(y, r, s, w, d[p + 3], 10, -1894986606), w = g(w, y, r, s, d[p + 10], 15, -1051523), s = g(s, w, y, r, d[p + 1], 21, -2054922799), r = g(r, s, w, y, d[p + 8], 6, 1873313359), y = g(y, r, s, w, d[p + 15], 10, -30611744), w = g(w, y, r, s, d[p + 6], 15, -1560198380),
      s = g(s, w, y, r, d[p + 13], 21, 1309151649), r = g(r, s, w, y, d[p + 4], 6, -145523070), y = g(y, r, s, w, d[p + 11], 10, -1120210379), w = g(w, y, r, s, d[p + 2], 15, 718787259), s = g(s, w, y, r, d[p + 9], 21, -343485551), r = a(r, k), s = a(s, l), w = a(w, m), y = a(y, n);
    return[r, s, w, y]
  }

  function h(a) {
    var b, e = "";
    for (b = 0; b < 32 * a.length; b += 8)e += String.fromCharCode(a[b >> 5] >>> b % 32 & 255);
    return e
  }

  function l(a) {
    var b, e = [];
    e[(a.length >> 2) - 1] = void 0;
    for (b = 0; b < e.length; b += 1)e[b] = 0;
    for (b = 0; b < 8 * a.length; b += 8)e[b >> 5] |= (a.charCodeAt(b / 8) & 255) << b % 32;
    return e
  }

  function n(a, b) {
    var e,
      f = l(a), d = [], g = [];
    d[15] = g[15] = void 0;
    16 < f.length && (f = k(f, 8 * a.length));
    for (e = 0; 16 > e; e += 1)d[e] = f[e] ^ 909522486, g[e] = f[e] ^ 1549556828;
    e = k(d.concat(l(b)), 512 + 8 * b.length);
    return h(k(g.concat(e), 640))
  }

  function m(a) {
    var b = "", e, f;
    for (f = 0; f < a.length; f += 1)e = a.charCodeAt(f), b += "0123456789abcdef".charAt(e >>> 4 & 15) + "0123456789abcdef".charAt(e & 15);
    return b
  }

  function s(a) {
    a = unescape(encodeURIComponent(a));
    return h(k(l(a), 8 * a.length))
  }

  function r(a, b, e) {
    b ? e ? a = n(unescape(encodeURIComponent(b)), unescape(encodeURIComponent(a))) :
      (a = n(unescape(encodeURIComponent(b)), unescape(encodeURIComponent(a))), a = m(a)) : a = e ? s(a) : m(s(a));
    return a
  }

  "function" === typeof define && define.amd ? define("md5", [], function () {
    return r
  }) : d.md5 = r
})(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/works", ["exports", "warehouse", "collection", "models/work"], function (f, b, e, d) {
    var k;
    e = function (e) {
      function f() {
        return k = f.__super__.constructor.apply(this, arguments)
      }

      a(f, e);
      f.prototype.name = "works";
      f.prototype.boundToObjectType = "collection";
      f.prototype.model = d;
      f.prototype.pageNum = 20;
      f.prototype.listen = _.once(function () {
        var a = this;
        return b.socket.on(":new:works/" + this._boundToObjectId, function (b) {
          return a.add(b, {parse: !0})
        })
      });
      f.prototype.sync = function (a, e, d) {
        var g, h, k, p = this;
        d = _.extend({beforeSend: function () {
        }, error: function () {
        }, success: function () {
        }}, d);
        switch (a) {
          case "add":
            d.remove = !1;
            d.beforeSend(e);
            h = 0;
            for (k = e.length; h < k; h++)g = e[h], g["_" + this.boundToObjectType + "Id"] = this._boundToObjectId;
            g = {works: e, involveMembers: d.involveMembers};
            g["_" + this.boundToObjectType + "Id"] = this._boundToObjectId;
            b.socket.emit("create:works", g);
            b.socket.once("create:works/" + this._boundToObjectId, function (a) {
              if (a.errorCode)return d.error(a.errorCode);
              _.each(a.works, function (a) {
                var b;
                if (b = p.findWhere({fileKey: a.fileKey}))return b.set("_id", a._id)
              });
              p.set(a.works, {parse: !0, remove: !1});
              return d.success(a.works, d)
            })
        }
        return f.__super__.sync.apply(this, arguments)
      };
      f.prototype.addWorks = function (a, b) {
        var e, f = this;
        e = [];
        _.each(a, function (a) {
          if (!f.get(a._id))return e.push(a)
        });
        if (e.length)return this.sync("add", e, b)
      };
      f.prototype.getUploadingCount = function () {
        return this.where({completed: !1}).length
      };
      return f
    }(e);
    return f["export"] = e
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/work", ["exports", "model", "util", "warehouse", "collections/works"], function (f, b, e, d, k) {
    var h;
    b = function (b) {
      function e() {
        return h = e.__super__.constructor.apply(this, arguments)
      }

      a(e, b);
      e.prototype.name = "work";
      e.prototype.defaults = {objectType: "work", activitiesCount: 0, description: "", involveMembers: []};
      e.prototype.parse = function (a) {
        a || (a = {});
        a.fileSize || (a.fileSize = a.size);
        a.thumbnail || (a.thumbnail = a.thumbnailUrl);
        delete a.size;
        delete a.code;
        delete a.message;
        return a
      };
      e.prototype.moveToCollection = function (a, b) {
        var e, f = this;
        d = d["export"] || d;
        e = d.get(k, this.get("_collectionId")) || this.collection;
        return this.save({_collectionId: a}, {beforeSend: function () {
          return null != b ? "function" === typeof b.beforeSend ? b.beforeSend() : void 0 : void 0
        }, success: function (h) {
          e.remove(f);
          d.get(k, a).add(f);
          return null != b ? "function" === typeof b.success ? b.success(a, h) : void 0 : void 0
        }, error: function () {
          return null != b ? "function" === typeof b.error ? b.error() : void 0 : void 0
        }})
      };
      e.prototype.getParentId = function () {
        return this.get("_collectionId")
      };
      return e
    }(b);
    return f["export"] = b
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/tasklist", ["model", "warehouse", "collections/tasks"], function (f, b, e) {
    var d;
    return function (f) {
      function h() {
        return d = h.__super__.constructor.apply(this, arguments)
      }

      a(h, f);
      h.prototype.name = "tasklist";
      h.prototype.defaults = {objectType: "tasklist"};
      h.prototype.getParams = function (a, b) {
        if ("create" ===
          a)return{_projectId: this.attributes._projectId, title: this.attributes.title, description: this.attributes.description, stages: this.attributes.stages}
      };
      h.prototype.getTasks = function (a) {
        var f = this;
        return b.request(e, this.id, {error: function () {
          return console.error("tasks request failure from tasklist:", f.id)
        }, success: a})
      };
      h.prototype.getExecutors = function () {
        var a, b, e, f, d;
        a = [];
        d = this.taskcollection.models;
        e = 0;
        for (f = d.length; e < f; e++)b = d[e], a.push(b.attributes._executorId);
        return _.uniq(a)
      };
      return h
    }(f)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/tasklists", ["collection", "models/tasklist"], function (f, b) {
    var e;
    return function (f) {
      function d() {
        return e = d.__super__.constructor.apply(this, arguments)
      }

      a(d, f);
      d.prototype.name = "tasklists";
      d.prototype.model = b;
      d.prototype.boundToObjectType = "project";
      d.prototype.orderBy = "pos";
      return d
    }(f)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/task", "exports model warehouse moment collections/tasklists collections/projects collections/tasks".split(" "), function (f, b, e, d, k, h, l) {
    var n, m;
    n = teambition.user;
    b = function (b) {
      function f() {
        return m = f.__super__.constructor.apply(this, arguments)
      }

      a(f, b);
      f.prototype.name = "task";
      f.prototype.defaults =
      {objectType: "task", isDone: !1, isRedo: !1, content: "", priority: 0, note: "", involveMembers: []};
      f.prototype.getTasklist = function (a) {
        var b, f = this;
        b = this.get("_tasklistId");
        e.request(k, this.get("_projectId"), b, {error: function () {
          return console.error("tasklist request failure from task:", f.id)
        }, success: a});
        return this
      };
      f.prototype.markDone = function () {
        this.save({isDone: !0});
        return this
      };
      f.prototype.markUndo = function () {
        this.save({isDone: !1});
        return this
      };
      f.prototype.editDueDate = function (a, b) {
        var e;
        if (null == a)return this.save("dueDate",
          a, b);
        a instanceof Date || (a = new Date(a));
        if (a.getFullYear()) {
          e = this.get("dueDate");
          e instanceof Date || (e = new Date(e));
          if (e.toDateString() === a.toDateString())return!1;
          this.save("dueDate", a, b)
        }
        return this
      };
      f.prototype.updateContent = function (a) {
        this.save({content: a});
        return this
      };
      f.prototype.updateExecutor = function (a, b) {
        this.save({_executorId: a}, b);
        return this
      };
      f.prototype.ensureDeletePermission = function (a) {
        var b;
        null == a && (a = n.id);
        e = e["export"] || e;
        b = e.get(h, null, this.get("_projectId"));
        this.get("_creatorId") ===
          a && b.get("isAdmin");
        return this
      };
      f.prototype.assignToSelf = function () {
        this.save({_executorId: n.id, updated: Date()});
        return this
      };
      f.prototype.moveToCollection = function (a, b) {
        var f, d = this;
        e = e["export"] || e;
        f = e.get(l, this.get("_tasklistId")) || this.collection;
        this.save({_tasklistId: a}, {beforeSend: function () {
          return null != b ? "function" === typeof b.beforeSend ? b.beforeSend() : void 0 : void 0
        }, success: function (g) {
          f.remove(d);
          e.get(l, a).add(d);
          return null != b ? "function" === typeof b.success ? b.success(a, g) : void 0 : void 0
        },
          error: function () {
            return null != b ? "function" === typeof b.error ? b.error() : void 0 : void 0
          }});
        return this
      };
      f.prototype.getParentId = function () {
        return this.get("_tasklistId")
      };
      f.prototype.getScope = function () {
        var a;
        if (this.get("isDone"))return"past";
        a = d(this.get("dueDate"));
        return this.get("startOnToday") || this.get("dueDate") && a.valueOf() <= d().endOf("day").valueOf() ? "today" : "future"
      };
      return f
    }(b);
    return f["export"] = b
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/tasks", ["exports", "collection", "models/task"], function (f, b, e) {
    var d;
    b = function (b) {
      function f() {
        return d = f.__super__.constructor.apply(this, arguments)
      }

      a(f, b);
      f.prototype.name = "tasks";
      f.prototype.model = e;
      f.prototype.boundToObjectType = "tasklist";
      f.prototype.hasMemberTask = function (a) {
        return 0 <
          this.getMemberTasks(a).length
      };
      f.prototype.hasMemberDailyTask = function (a) {
        return 0 < this.getMemberDailyTasks(a).length
      };
      f.prototype.getParams = function (a, b) {
        if ("read" === a && _.isObject(b.params))return b.params
      };
      f.prototype.getMemberTasks = function (a) {
        return this.where({_executorId: a})
      };
      f.prototype.getMemberDailyTasks = function (a) {
        var b, e, f, d;
        b = [];
        e = this.getMemberTasks(a);
        f = 0;
        for (d = e.length; f < d; f++)a = e[f], a.attributes.isDone ? a.didAccomplishedOnToday() && b.push(a) : b.push(a);
        return b
      };
      f.prototype.getDoneTaskCount =
        function () {
          return this.where({isDone: !0}).length
        };
      f.prototype.getExecutorComplishStatus = function (a) {
        var b, e, f, d;
        d = this.toJSON();
        e = 0;
        for (f = d.length; e < f; e++)if (b = d[e], b._executorId === a && !b.isDone)return!1;
        return!0
      };
      f.prototype.getExecutors = function () {
        var a, b, e, f, d, g;
        b = {};
        g = this.models;
        f = 0;
        for (d = g.length; f < d; f++)a = g[f], e = a.get("_executorId"), a = a.get("isDone"), b[e] || (b[e] = {doneCount: 0, totalCount: 0}), b[e].totalCount++, a && b[e].doneCount++;
        return b
      };
      f.prototype.getByStage = function (a) {
        var b, e;
        b = this.where({_stageId: a});
        (e = teambition.PREFERENCE.tasksSortInStage(a)) && (b = _.sortBy(b, function (a) {
          a = e.indexOf(a.id);
          -1 === a && (a = e.length);
          return a
        }));
        return b
      };
      f.prototype.comparator = function (a, b) {
        var e, f, d, g;
        f = a.get("isDone") - b.get("isDone");
        a.get("isDone") && !f ? f = new Date(b.get("accomplished")) - new Date(a.get("accomplished")) : (f || (f = b.get("priority") - a.get("priority")), !f && (e = (new Date(a.get("dueDate"))).getTime() || Number.MAX_VALUE, g = (new Date(b.get("dueDate"))).getTime() || Number.MAX_VALUE, d = (new Date).getTime(), f = g - e, 0 <
          f && g > d || 0 > f && e > d) && (f = -f), f || (f = new Date(a.get("created")) - new Date(b.get("created"))));
        return f
      };
      return f
    }(b);
    return f["export"] = b
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/post", ["model", "markdown", "util"], function (f, b, e) {
    var d;
    return function (f) {
      function h() {
        return d = h.__super__.constructor.apply(this, arguments)
      }

      a(h, f);
      h.prototype.name = "post";
      h.prototype.defaults = {objectType: "post", involveMembers: [], links: []};
      h.prototype.getContent = function () {
        var a;
        a = _.unescape(this.get("content"));
        return"html" === this.get("postMode") ? a : b(a)
      };
      h.prototype.parse = function (a) {
        return e.parsePost(a)
      };
      return h
    }(f)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, e) {
    function f() {
      this.constructor = a
    }

    for (var k in e)d.call(e, k) && (a[k] = e[k]);
    f.prototype = e.prototype;
    a.prototype = new f;
    a.__super__ = e.prototype;
    return a
  }, f = [].indexOf || function (a) {
    for (var e = 0, f = this.length; e < f; e++)if (e in this && this[e] === a)return e;
    return-1
  };
  define("collections/posts", ["collection", "models/post"], function (b, e) {
    var d;
    return function (b) {
      function h() {
        return d = h.__super__.constructor.apply(this, arguments)
      }

      a(h, b);
      h.prototype.name = "posts";
      h.prototype.model =
        e;
      h.prototype.pageNum = 20;
      h.prototype.boundToObjectType = "project";
      h.prototype.getType = function (a) {
        var b;
        b = ["all", "my"];
        return 0 <= f.call(b, a) ? a : b[0]
      };
      h.prototype.getParams = function (a, b) {
        return{type: "read" === a ? null != b ? b.section : void 0 : void 0}
      };
      h.prototype.comparator = function (a, b) {
        var e;
        (e = (b.get("pin") || 0) - (a.get("pin") || 0)) || (e = new Date(b.get("created")) - new Date(a.get("created")));
        return e
      };
      return h
    }(b)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/member", ["warehouse", "model"], function (f, b) {
    var e;
    return function (b) {
      function d() {
        return e = d.__super__.constructor.apply(this, arguments)
      }

      a(d, b);
      d.prototype.name = "member";
      d.prototype.defaults = {objectType: "member", name: "", title: "", avatar: "", isOnline: !0, isAdmin: !1, isQuited: !1};
      d.prototype.parse =
        function (a) {
          var b;
          if (null == a || !a.website)return a;
          b = a.website;
          "string" === typeof b && "" !== b.replace(/\s/g, "") ? /^[http:|https:|ftp:]/.test(b) || (b = "http://" + b) : b = null;
          a.website = b;
          return a
        };
      d.prototype.sync = function (a, b, e) {
        var d;
        d = b.collection._boundToObjectId;
        b = b.collection.boundToObjectType || e.boundToObjectType;
        switch (a) {
          case "update":
            return a = this.changed, a._boundToObjectId = d, a.boundToObjectType = b, a._memberId = this.get("_memberId"), f.socket.emit("update:member", a), f.socket.once("update:member/" + d, function (a) {
              return a.errorCode ?
                "function" === typeof e.error ? e.error(a.errorCode) : void 0 : "function" === typeof e.success ? e.success(a.member) : void 0
            })
        }
      };
      d.prototype.getBirthdayString = function () {
        var a;
        if (a = this.get("birthday"))return a = new Date(a), "" + a.getFullYear() + ".\n" + (a.getMonth() + 1) + ".\n" + a.getDate()
      };
      return d
    }(b)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, e) {
    function f() {
      this.constructor = a
    }

    for (var k in e)d.call(e, k) && (a[k] = e[k]);
    f.prototype = e.prototype;
    a.prototype = new f;
    a.__super__ = e.prototype;
    return a
  }, f = [].indexOf || function (a) {
    for (var e = 0, f = this.length; e < f; e++)if (e in this && this[e] === a)return e;
    return-1
  };
  define("collections/members", ["warehouse", "collection", "models/member", "util"], function (b, e, d, k) {
    var h, l, n;
    l = teambition.user;
    h = teambition.router;
    return function (e) {
      function k() {
        return n = k.__super__.constructor.apply(this,
          arguments)
      }

      a(k, e);
      k.prototype.name = "members";
      k.prototype.model = d;
      k.prototype.boundToObjectType = "project";
      k.prototype.comparator = function (a) {
        return a.id === l.id ? 0 : (new Date(a.get("joined"))).getTime()
      };
      k.prototype.getParams = function (a, b) {
        if ("read" === a)return{boundToObjectType: b.boundToObjectType || this.boundToObjectType, _boundToObjectId: this._boundToObjectId}
      };
      k.prototype.sync = function (a, e, f) {
        var d, g = this;
        switch (a) {
          case "addmember":
            b.socket.emit("add:member", e);
            b.socket.once("add:member/" + this._boundToObjectId,
              function (a) {
                if (a.errorCode)return f.error(a.errorCode);
                g.update(a.member);
                return"function" === typeof f.success ? f.success(a.member, f) : void 0
              });
            break;
          case "search":
            null != f && "function" === typeof f.beforeSend && f.beforeSend(), d = e, b.socket.emit("search", d), b.socket.once("search:" + l.id, function (a) {
              return null != f ? "function" === typeof f.success ? f.success(a, d.q) : void 0 : void 0
            })
        }
        return k.__super__.sync.apply(this, arguments)
      };
      k.prototype.listen = function () {
        var a = this;
        b.socket.on(":new:members/" + this.boundToObjectType +
          "/" + this._boundToObjectId, function (b) {
          var e;
          return(e = a.get(b._id)) ? e.set(b) : a.add(b)
        });
        return b.socket.on(":remove:members/" + this.boundToObjectType + "/" + this._boundToObjectId, function (b) {
          var e;
          null != (e = a.get(b)) && e.set("isQuited", !0);
          if (b === l.id)return h.clearWhenExit(a._boundToObjectId)
        })
      };
      k.prototype.search = function (a, b, e, f) {
        a = {q: a, loc: b};
        e.context = f;
        return this.sync("search", a, e)
      };
      k.prototype.getActiveMembers = function () {
        return this.where({isQuited: !1})
      };
      k.prototype.getActiveMembersJSON = function () {
        var a,
          b, e, f, d;
        b = [];
        d = this.toJSON();
        e = 0;
        for (f = d.length; e < f; e++)a = d[e], a.isQuited || b.push(a);
        return b
      };
      k.prototype.getActiveMemberIds = function () {
        var a, b, e, f, d;
        b = [];
        d = this.models;
        e = 0;
        for (f = d.length; e < f; e++)a = d[e], a.get("isQuited") || b.push(a.id);
        return b
      };
      k.prototype.getQuitedMembers = function () {
        return this.where({isQuited: !0})
      };
      k.prototype.getQuitedMembersJSON = function () {
        var a, b, e, f, d;
        b = [];
        d = this.toJSON();
        e = 0;
        for (f = d.length; e < f; e++)a = d[e], a.isQuited && b.push(a);
        return b
      };
      k.prototype.hasMember = function (a) {
        var b;
        b = _.pluck(this.getActiveMembers(), "id");
        return 0 <= f.call(b, a)
      };
      k.prototype.addMember = function (a, b) {
        var e;
        e = _.extend({boundToObjectType: this.boundToObjectType}, b);
        a.boundToObjectType = e.boundToObjectType;
        a._boundToObjectId = this._boundToObjectId;
        this.sync("addmember", a, e);
        return this
      };
      k.prototype.removeMember = function (a, e) {
        var f, d, g, h;
        d = this.get(a);
        h = _.extend({success: function (a) {
          d.set({isQuited: !0});
          return"function" === typeof e.success ? e.success(a) : void 0
        }}, e);
        f = d.get("boundToObjectType");
        g = d.get("_boundToObjectId");
        "project" === f || "organization_project" === f ? f = "project" : "organization" === f && (f = "organization");
        f = {_memberId: d.get("_memberId"), _boundToObjectId: g, boundToObjectType: f};
        b.socket.emit("delete:member", f);
        b.socket.once("delete:member/" + g, function (a) {
          return a.errorCode ? "function" === typeof e.error ? e.error(a.errorCode) : void 0 : h.success(a)
        });
        return this
      };
      return k
    }(e)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/collection", ["model", "collections/works", "warehouse"], function (f, b, e) {
    var d;
    return function (b) {
      function f() {
        return d = f.__super__.constructor.apply(this, arguments)
      }

      a(f, b);
      f.prototype.name = "collection";
      f.prototype.defaults = {objectType: "collection", _projectId: "", _creatorId: "", _teamId: "", created: "",
        updated: "", title: "", color: "inverse", description: "", workCount: 0, collectionType: "", involveMembers: [], recentWorks: []};
      f.prototype.getParent = function (a) {
        return e.request("projects", null, this.get("_projectId"), {success: a})
      };
      f.prototype.getCollection = function (a) {
        return e.request("collections", this.get("_projectId"), {success: a})
      };
      f.prototype.getUrl = function () {
        return"(_collectionId=" + this.get("_id") + ")"
      };
      return f
    }(f)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/collections", ["collection", "models/collection"], function (f, b) {
    var e;
    return function (f) {
      function d() {
        return e = d.__super__.constructor.apply(this, arguments)
      }

      a(d, f);
      d.prototype.model = b;
      d.prototype.boundToObjectType = "project";
      d.prototype.name = "collections";
      d.prototype.orderBy = "earliest-created";
      d.prototype.getColor = function () {
        return["orange", "blue", "inverse", "red", "green"][parseInt(4 * Math.random())]
      };
      return d
    }(f)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/event", ["model", "moment"], function (f, b) {
    var e;
    return function (f) {
      function d() {
        return e = d.__super__.constructor.apply(this, arguments)
      }

      a(d, f);
      d.prototype.name = "event";
      d.prototype.defaults = {involveMembers: [], content: null};
      d.prototype.getScope = function () {
        var a, e, f, d;
        e = b(this.get("startDate"));
        a = b(this.get("endDate") || null);
        f = b().endOf("day");
        d = b().subtract("days", 1).endOf("day");
        return e.valueOf() > f.valueOf() ? "future" : e.valueOf() > d.valueOf() || a.valueOf() > d.valueOf() ? "today" : "past"
      };
      return d
    }(f)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/events", ["collection", "models/event"], function (f, b) {
    var e;
    return function (f) {
      function d() {
        return e = d.__super__.constructor.apply(this, arguments)
      }

      a(d, f);
      d.prototype.name = "events";
      d.prototype.model = b;
      d.prototype.boundToObjectType = "project";
      d.prototype.comparator = function (a, b) {
        a = new Date(a.get("startDate"));
        b = new Date(b.get("startDate"));
        return a.getTime() > b.getTime()
      };
      d.prototype.getParams = function (a, b) {
        if ("read" === a)return{boundToObjectType: b.boundToObjectType || this.boundToObjectType, _boundToObjectId: this._boundToObjectId}
      };
      return d
    }(f)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/message", "thenjs util markdown md5 model warehouse models/work collections/tasks collections/posts collections/members collections/tasklists collections/collections collections/events".split(" "), function (f, b, e, d, k, h, l, n, m, s, r, t, v) {
    var p;
    return function (k) {
      function B() {
        return p = B.__super__.constructor.apply(this,
          arguments)
      }

      a(B, k);
      B.prototype.name = "message";
      B.prototype.archive = function (a) {
        this.save({isArchived: !0, isRead: !0, unreadActivitiesCount: 0}, a);
        return this.collection.remove(this, {silent: !0})
      };
      B.prototype.recover = function (a) {
        return this.save({isArchived: !1}, a)
      };
      B.prototype.markRead = function (a) {
        if (!this.get("isRead"))return this.save({isRead: !0, unreadActivitiesCount: 0}, a)
      };
      B.prototype.requestBoundToObject = function (a) {
        var b = this;
        if (null == a || !a.success)return!1;
        "function" === typeof a.beforeSend && a.beforeSend();
        return f.parallel([function (a) {
          var e, d, g;
          switch (b.get("boundToObjectType")) {
            case "event":
              return d = b.get("event")._id, g = b.get("project")._id, h.request(v, g, d, {success: function (b) {
                return a(null, b)
              }, error: function (b) {
                return a(b)
              }});
            case "task":
              return g = b.get("task")._tasklistId, d = b.get("task")._id, h.request(n, g, d, {success: function (b) {
                return a(null, b)
              }, error: function (b) {
                return a(b)
              }});
            case "post":
              return e = b.get("post"), h.request(m, e._projectId, e._id, {success: function (b) {
                return a(null, b)
              }, error: function (b) {
                return a(b)
              }});
            case "work":
            case "works":
              return d = [], "works" === b.get("boundToObjectType") ? (e = b.get("post"), d = e.works) : d = [b.get("work")], f.each(d,function (a, b) {
                return h.fetchOne(l, b._id, {success: function (b) {
                  return a(null, b)
                }, error: function (e) {
                  b.isDeleted = !0;
                  b = h.createModel(l, b);
                  return a(null, b)
                }})
              }).all(function (a, b, f) {
                return e ? h.request(m, e._projectId, e._id, {success: function (b) {
                  return a(null, _.union(b, f))
                }, error: function (b) {
                  return a(null, f)
                }}) : a(null, f)
              }).all(function (b, e, f) {
                return a(null, _.compact(f || []))
              })
          }
        }, function (a) {
          return h.request(s,
            b.get("project")._id, {success: function (b) {
              return a(null, b)
            }, error: function (b) {
              return a(b)
            }})
        }, function (a) {
          var e, f;
          f = b.get("_projectId");
          switch (b.get("boundToObjectType")) {
            case "task":
              return e = b.get("task")._tasklistId, h.request(r, f, e, {success: function (b) {
                return a(null, b)
              }, error: function (b) {
                return a(b)
              }});
            case "work":
            case "works":
              return e = b.get("work") || b.get("post").works[0], e = e._collectionId, h.request(t, f, e, {success: function (b) {
                return a(null, b)
              }, error: function (b) {
                return a(b)
              }});
            case "post":
              return a(null,
                {});
            case "event":
              return a(null, {})
          }
        }]).all(function (b, e, f) {
            return e ? "function" === typeof a.error ? a.error(e) : void 0 : "function" === typeof a.success ? a.success(f[0], f[1], f[2]) : void 0
          })
      };
      B.prototype.polish = function () {
        var a, e;
        a = this.toJSON();
        e = a.boundToObjectType;
        switch (e) {
          case "event":
            a.objectClass = e;
            a.notificationContent = a.event.title;
            break;
          case "post":
            a.objectClass = e;
            a.notificationContent = b.parsePost(a.post).description;
            break;
          case "task":
            a.notificationContent = a.task.content;
            a.objectClass = a.task.isDone ?
              "task done" : "task";
            break;
          case "tasks":
            a.objectClass = "post";
            break;
          case "work":
            a.objectClass = e;
            a.notificationContent = a.work.fileName;
            break;
          case "works":
            a.objectClass = "work", a.notificationContent = "" + a.post.works[0].fileName.slice(0, 10) + "..." + ("" + a.post.works.length + "")
        }
        return a
      };
      B.prototype.genNotification = function () {
        var a, b, f, h;
        f = this.polish();
        a = f.latestActivity;
        h = {content: f.notificationContent};
        b = a ? a.creator : f.creator;
        h.creator = b;
        h.icon = b.avatarUrl;
        h.title = b.name;
        a && (h.title += " " + a.title, h.content =
          _.unescape(a.content || a.note) || h.content, "comment" === a.action && (h.content = e(h.content)));
        h.content = $("<div>" + h.content + "</div>").text();
        h.content || (h.content = "");
        h.notificationId = d(f._id + h.content + h.title + h.icon);
        return h
      };
      return B
    }(k)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/messages", ["collection", "models/message", "warehouse"], function (f, b, e) {
    var d;
    return function (f) {
      function h() {
        return d = h.__super__.constructor.apply(this, arguments)
      }

      a(h, f);
      h.prototype.name = "messages";
      h.prototype.model = b;
      h.prototype.sync = function (a, b, f) {
        var d = this;
        f || (f = {});
        switch (a) {
          case "delete":
            e.socket.emit("delete:" +
              this.name), e.socket.once("delete:" + this.name, function () {
              "function" === typeof f.success && f.success();
              return d.remove(d.getReaded())
            })
        }
        return h.__super__.sync.apply(this, arguments)
      };
      h.prototype.readAll = function () {
        return this.each(function (a) {
          return a.markRead()
        })
      };
      h.prototype.getUnreadCount = function () {
        return this.reduce(function (a, b) {
          return a + b.get("unreadActivitiesCount")
        }, 0)
      };
      h.prototype.getUnarchivedCount = function () {
        return this.where({isArchived: !1}).length
      };
      h.prototype.getUnarchived = function () {
        return this.where({isArchived: !1})
      };
      h.prototype.getUnread = function () {
        return this.where({isRead: !1})
      };
      h.prototype.getReaded = function () {
        return this.where({isRead: !0})
      };
      h.prototype.archiveRead = function (a) {
        this.sync("delete", this, a);
        return this
      };
      h.prototype.comparator = function (a, b) {
        var e;
        (e = a.get("isRead") - b.get("isRead")) || (e = new Date(b.get("updated")) - new Date(a.get("updated")));
        return e
      };
      return h
    }(f)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/activity", ["warehouse", "model", "util", "markdown"], function (f, b, e, d) {
    var k;
    return function (b) {
      function l() {
        return k = l.__super__.constructor.apply(this, arguments)
      }

      a(l, b);
      l.prototype.name = "activity";
      l.prototype.defaults = {objectType: "activitiy", action: "", _boundToObjectId: "", boundToObjectType: "",
        _creatorId: "", created: "", updated: "", content: "", attachments: [], involveMembers: []};
      l.prototype.sync = function (a, b, e) {
        var d;
        "function" === typeof e.beforeSend && e.beforeSend(b);
        return"create" === a && "comment" === b.attributes.action ? (d = b.toJSON(), d.cid = b.cid, d._boundToObjectId = this.collection._boundToObjectId, d.boundToObjectType = this.collection.boundToObjectType, f.socket.emit("create:comment", d), f.socket.once("create:comment/" + b.cid, function (a) {
          return a.errorCode ? "function" === typeof e.error ? e.error(a.errorCode) :
            void 0 : "function" === typeof e.success ? e.success(a.comment) : void 0
        })) : l.__super__.sync.apply(this, arguments)
      };
      l.prototype.getContent = function () {
        var a;
        a = _.unescape(this.get("content"));
        return"comment" === this.get("action") ? d(a) : a
      };
      l.prototype.genReviewContent = function () {
        var a, b;
        a = this.get("boundToObject");
        b = function () {
          switch (this.get("boundToObjectType")) {
            case "task":
              return a.content;
            case "event":
              return a.title;
            case "work":
              return a.fileName;
            case "post":
              return e.parsePost(a).description
          }
        }.call(this);
        this.set("reviewContent",
          b || "");
        return b
      };
      return l
    }(b)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/activities", ["collection", "models/activity"], function (f, b) {
    var e;
    return function (f) {
      function d() {
        return e = d.__super__.constructor.apply(this, arguments)
      }

      a(d, f);
      d.prototype.name = "activities";
      d.prototype.model = b;
      d.prototype.comparator = function (a) {
        return(new Date(a.get("created"))).getTime()
      };
      d.prototype.getParams =
        function (a, b) {
          if ("read" === a)return{boundToObjectType: this.boundToObjectType, _boundToObjectId: this._boundToObjectId}
        };
      return d
    }(f)
  })
}).call(this);
define("views/inbox/message/templates/message", [], function () {
  return function (d) {
    var a = '<div class="message-card-object-content ' + d.objectClass + '" data-gta="event" data-label="read message" data-action="click" data-category="div" data-value="d4"> ';
    if ("event" === d.boundToObjectType)a += ' <div class="post-content"> ' + d.notificationContent + " </div> "; else if ("post" === d.boundToObjectType)a += ' <div class="post-content"> ' + d.notificationContent + " </div> "; else if ("tasks" === d.boundToObjectType)a += ' <div class="post-content"> ' +
      d.creator.name + "" + d.post.tasks.length + " " + d.post.title + " </div> "; else if ("task" === d.boundToObjectType) {
      var f = d.task, a = a + '  <div class="check-box ';
      f._executorId !== teambition.user.id && (a += "non-checkable");
      a += '"> <span class="icon icon-tick"></span> </div> <div class="task-content-set"> ';
      a = f.executor ? a + (' <div class="avatar img-circle img-24" style="background-image:url(' + f.executor.avatarUrl + ')"></div> ') : a + ' <div class="avatar img-circle img-24" style="background-image:url(/v3.8.4/images/avatar/nobody-avator@2x.png)"></div> ';
      a += ' <div class="task-content-wrapper"> <div class="task-content">' + f.content + "</div> </div> </div> "
    } else if ("work" === d.boundToObjectType)a += " ", f = d.work, a += ' <div class="work-content"> <div class="work-title"> <div class="work-thumbnails"> ', a = "image" === f.fileCategory ? a + (' <div class="work-thumbnail" style="background-image: url(' + f.thumbnail + ');"> </div> ') : a + (' <div class="work-thumbnail ' + f.fileType + '">' + f.fileType + "</div> "), a += " </div> " + d.work.fileName.slice(0, 10) + " </div> </div> "; else if ("works" ===
      d.boundToObjectType) {
      a += " ";
      works = d.post.works;
      a += ' <div class="work-content"> <div class="work-title"> <div class="work-thumbnails multiple"> ';
      if (d = works.slice(0, 3))for (var b = -1, e = d.length - 1; b < e;)f = d[b += 1], a += " ", a = "image" === f.fileCategory ? a + (' <div class="work-thumbnail" style="background-image: url(' + f.thumbnail + ');"> </div> ') : a + (' <div class="work-thumbnail">' + f.fileType + "</div> "), a += " ";
      a += " </div> " + works[0].fileName.slice(0, 10) + "..." + works.length + " </div> </div> "
    }
    return a += '</div><div class="message-card-activity-content"></div><div class="message-card-handler-wrapper"> <a class="delete-message-card-handler icon icon-remove hinted" data-title="" href="javascript:void(0)" data-gta="event" data-label="delete message" data-action="click" data-category="a" data-value="d3"> </a></div>'
  }
});
define("views/inbox/message/templates/activity", [], function () {
  return function (d) {
    var a = '<div class="avatar img-circle img-24" style="background-image: url(' + d.latestActivity.creator.avatarUrl + ');"></div><div class="unread-activities-count">';
    0 < d.unreadActivitiesCount && (a += d.unreadActivitiesCount);
    a += '</div><div class="activity-content"> ' + d.latestActivity.creator.name + " ";
    a = "comment" === d.latestActivity.action ? a + (" " + (d.latestActivity.content || "") + " ") : a + (" " + (d.latestActivity.title || "") + " ");
    return a +
      "</div>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/inbox/message/index", "view warehouse collections/messages collections/activities ./templates/message ./templates/activity".split(" "), function (f, b, e, d, k, h) {
    var l, n;
    l = teambition.user;
    return function (e) {
      function f() {
        return n = f.__super__.constructor.apply(this, arguments)
      }

      a(f, e);
      f.prototype.viewName =
        "MessageView";
      f.prototype.tagName = "li";
      f.prototype.className = "message-card card";
      f.prototype.events = {click: "onClick"};
      f.prototype.initialize = function (a) {
        if (null != a && a.messageModel)return this.reset(a.messageModel).render(), this
      };
      f.prototype.reset = function (a) {
        var b = this;
        this.messageModel = a;
        this.listenTo(this.messageModel, "change:isArchived", function () {
          return b.archive()
        });
        this.listenTo(this.messageModel, "change:latestActivity", this.refreshActivity);
        this.listenTo(this.messageModel, "change:isRead", this.refreshRead);
        this.listenTo(this.messageModel, "remove", this.fadeOutMessage);
        return this
      };
      f.prototype.render = function () {
        var a;
        a = this.messageModel.polish();
        this.$el.html(k(a));
        this.$el[0].id = "message-card-" + a._id;
        this.$el.data("model", this.messageModel);
        this.messageModel.get("isRead") && this.$el.addClass("readed");
        this.$latestActivity = this.$(".message-card-activity-content");
        null == a.latestActivity && this.fakeActivity(a);
        this.$latestActivity.html(h(a));
        return this
      };
      f.prototype.fakeActivity = function (a) {
        a.latestActivity =
        {creator: a.creator, title: ""};
        return this
      };
      f.prototype.refreshActivity = function () {
        var a, e, f;
        f = this.messageModel.polish();
        (e = f.latestActivity) ? (a = b.findCollection(d, e._boundToObjectId), null != a && a.synced && !a.get(e._id) && a.fetchOne(e._id)) : this.fakeActivity(f);
        this.$latestActivity.html(h(f));
        this.refreshRead();
        return this
      };
      f.prototype.refreshRead = function () {
        this.$el.toggleClass("readed", this.messageModel.get("isRead"));
        this.$(".unread-activities-count").html(this.messageModel.get("unreadActivitiesCount") ||
          "");
        return this
      };
      f.prototype.onClick = function (a) {
        $(a.target).hasClass("delete-message-card-handler") ? this.deleteMessage(this.messageModel) : (this.$el.addClass("readed active").siblings(".message-card").removeClass("active"), this.parentView.showMessageDetail(this.messageModel));
        return this
      };
      f.prototype.deleteMessage = function (a) {
        a.archive();
        this.archive();
        return this
      };
      f.prototype.archive = function () {
        var a;
        if (null != (a = this.messageModel) && a.collection)return a = this.messageModel.collection.getUnreadCount(),
          l.set("inbox", a), this.messageModel.get("isArchived") && this.fadeOutMessage(), this
      };
      f.prototype.fadeOutMessage = function () {
        var a = this;
        return this.$el.slideUp(300, "swing", function () {
          return a.remove()
        })
      };
      return f
    }(f)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("popover-view", ["view", "util"], function (f, b) {
    var e;
    return function (f) {
      function d() {
        return e = d.__super__.constructor.apply(this, arguments)
      }

      a(d, f);
      d.prototype.viewName = "PopoverView";
      d.prototype.initialize = function (a) {
        if (a.$toggler && "function" === typeof this.render)return this.options = _.extend({title: this.popoverTitle},
          a), this.$toggler = $(a.$toggler), this.setup().delegatePopoverEvents(), this
      };
      d.prototype.setup = function () {
        this.$toggler.popover(_.extend({html: !0, placement: "auto bottom", trigger: "click", container: "body", animation: !1}, this.options));
        this.popover = this.$toggler.data("bs.popover");
        this.$popover = this.popover.tip();
        this.$title = this.$popover.find(".popover-title");
        this.$content = this.$popover.find(".popover-content");
        this.setElement(this.$content);
        this.width && this.$popover.width(this.width);
        this.className &&
        this.$popover.addClass(this.className);
        return this
      };
      d.prototype.delegatePopoverEvents = function () {
        var a = this;
        this.$popover.find(".popover-close-handler").click(function () {
          return a.hide()
        });
        this.$toggler.on("showing.bs.popover", function () {
          return a.onShown()
        });
        this.$toggler.on("hidden.bs.popover", function () {
          return a.onHidden()
        });
        return this
      };
      d.prototype.show = function () {
        this.popover.show();
        return this
      };
      d.prototype.onShown = function () {
        var a, e = this;
        "function" === typeof this.reset && this.reset();
        this.$toggler.addClass("open");
        this.returnMainMenu();
        this.delegateEvents();
        if ("function" === typeof(a = this.options).onShown)a.onShown();
        b.handleClickOutside(this.$popover, function () {
          return _.delay(function () {
            return e.hide()
          }, 218)
        });
        return this
      };
      d.prototype.hide = function () {
        var a, b, e;
        null != (a = this.$toggler) && a.removeClass("open");
        null != (b = this.popover) && b.hide();
        null != (e = this.$popover) && e.detach();
        return this
      };
      d.prototype.onHidden = function () {
        var a;
        if ("function" === typeof(a = this.options).onHidden)a.onHidden();
        return this
      };
      d.prototype.enterSubMenu =
        function (a, b) {
          var e = this;
          a = a.trim();
          this.$popover.addClass("in-submenu");
          a && this.$title.text(a);
          this.$popover.find(".popover-back-handler").one("click", function () {
            return e.returnMainMenu()
          });
          return b()
        };
      d.prototype.returnMainMenu = function (a) {
        var b;
        this.$popover.removeClass("in-submenu");
        null != (b = this.options.title) && b.trim() && this.$title.text(this.options.title);
        "function" === typeof this.render && this.render();
        return this
      };
      d.prototype.remove = function () {
        var a, b;
        null != (a = this.$popover) && a.remove();
        null !=
          (b = this.$toggler) && b.off(".popover").removeData("bs.popover");
        d.__super__.remove.apply(this, arguments);
        return this
      };
      return d
    }(f)
  })
}).call(this);
define("views/board/task/task-menu/templates/basic", [], function () {
  return function (d) {
    var a = "";
    0 < d.hasRight ? a += ' <form class="delete-form"> <p></p> <button class="btn btn-danger" type="submit"></button> </form>' : (a += ' <p class="muted"> . ', d.hasRightMembers && (a += "" + d.hasRightMembers + "."), a += " </p>");
    return a
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/task/task-menu/index", ["popover-view", "./templates/basic"], function (f, b) {
    var e;
    return function (f) {
      function d() {
        return e = d.__super__.constructor.apply(this, arguments)
      }

      a(d, f);
      d.prototype.viewName = "TaskMenuView";
      d.prototype.popoverTitle = "";
      d.prototype.events = {"submit .delete-form": "submitDeleteForm"};
      d.prototype.render = function () {
        var a;
        a = this.options.taskModel.toJSON();
        a.hasRight = this.options.taskModel.hasRight();
        this.$el.html(b(a));
        return this
      };
      d.prototype.submitDeleteForm = function (a) {
        var b = this;
        a.preventDefault();
        this.options.taskModel.destroy({success: function () {
          b.hide();
          return teambition.APP.hidePanel()
        }});
        return this
      };
      return d
    }(f)
  })
}).call(this);
define("views/board/subtask/subtask-menu/templates/basic", [], function () {
  return function (d) {
    return'<ul class="list"> <li> <a class="transform-handler" data-gta="event" data-label="task detail|transform subtask to task" data-action="click" data-category="a"> <span class="icon icon-convert"></span> </a> </li> <li> <a class="delete-handler" data-gta="event" data-label="task detail|delete subtask" data-action="click" data-category="a"> <span class="icon icon-trash"></span> </a> </li></ul>'
  }
});
define("views/board/subtask/subtask-menu/templates/delete", [], function () {
  return function (d) {
    return'<form class="delete-form"> <p>?</p> <button class="btn btn-danger" type="submit"></button></form>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/subtask/subtask-menu/index", ["popover-view", "./templates/basic", "./templates/delete"], function (f, b, e) {
    var d;
    return function (f) {
      function h() {
        return d = h.__super__.constructor.apply(this, arguments)
      }

      a(h, f);
      h.prototype.viewName = "SubtaskMenuView";
      h.prototype.popoverTitle = "";
      h.prototype.events =
      {"click .transform-handler": "transformSubtask", "click .delete-handler": "enterDeleteSubMenu", "submit .delete-form": "submitDeleteForm"};
      h.prototype.render = function () {
        this.$el.html(b(this.options.subtaskModel.toJSON()));
        return this
      };
      h.prototype.transformSubtask = function (a) {
        this.options.subtaskModel.transform();
        return this.hide()
      };
      h.prototype.enterDeleteSubMenu = function () {
        var a = this;
        this.enterSubMenu("", function () {
          return a.$el.html(e())
        });
        return this
      };
      h.prototype.submitDeleteForm = function (a) {
        var b =
          this;
        a.preventDefault();
        this.options.subtaskModel.destroy({wait: !0, beforeSend: function () {
          return b.$el.find(".delete-form").html("...")
        }, success: function () {
          return b.hide()
        }, error: function (a, e, f) {
          return b.$el.find(".delete-form").html("error " + e)
        }});
        return this
      };
      return h
    }(f)
  })
}).call(this);
define("views/board/subtask/subtask/templates/basic", [], function () {
  return function (d) {
    var a = "", a = d.isDone ? a + ' <div class="subtask-check-box pull-left done"> <a class="icon icon-tick"></a> </div>' : a + ' <div class="subtask-check-box pull-left" data-gta="event" data-label="task detail|finish subtask"></div>', a = a + '<a class="subtask-menu-toggler toggler icon icon-chevron-down pull-right"></a><div class="subtask-content-wrap ';
    d.isDone && (a += "done");
    return a += '"> <textarea class="subtask-input form-control">' +
      d.content + "</textarea></div>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/subtask/subtask/index", ["view", "views/board/subtask/subtask-menu/index", "./templates/basic"], function (f, b, e) {
    var d;
    return function (f) {
      function h() {
        return d = h.__super__.constructor.apply(this, arguments)
      }

      a(h, f);
      h.prototype.viewName = "SubtaskView";
      h.prototype.tagName = "li";
      h.prototype.className =
        "subtask toggler-parent clearfix";
      h.prototype.events = {"click .subtask-check-box": "toggleSubtaskStatus", "click .subtask-menu-toggler": "toggleSubtaskMenu", "focus .subtask-input": "editSubtask", "blur .subtask-input": "updateSubtask", "keydown .subtask-input": "quickUpdate"};
      h.prototype.initialize = function (a) {
        if (null == a || !a.subtaskModel)return!1;
        this.options = a;
        this.subtaskModel = a.subtaskModel;
        this.render().listen();
        return this
      };
      h.prototype.listen = function () {
        this.listenTo(this.subtaskModel, "remove", this.remove);
        this.listenTo(this.subtaskModel, "change", this.render);
        return this
      };
      h.prototype.render = function () {
        this.$el.html(e(this.subtaskModel.toJSON()));
        this.$subtaskInput = this.$(".subtask-input").flexText();
        return this
      };
      h.prototype.editSubtask = function () {
        this.$el.addClass("editing");
        return this
      };
      h.prototype.updateSubtask = function () {
        var a;
        a = this.$subtaskInput.val().trim();
        (a = a.replace(/\s+/g, " ").trim()) ? this.subtaskModel.save("content", a) : this.$subtaskInput.val(this.subtaskModel.get("content"));
        this.$el.removeClass("editing");
        return this
      };
      h.prototype.quickUpdate = function (a) {
        13 === a.keyCode && (a.preventDefault(), this.updateSubtask());
        return this
      };
      h.prototype.toggleSubtaskStatus = function () {
        var a, b = this;
        a = this.subtaskModel.get("isDone");
        this.subtaskModel.save({isDone: !a}, {error: function () {
          return b.subtaskModel.set({isDone: currentTarget})
        }});
        return this
      };
      h.prototype.toggleSubtaskMenu = function (a) {
        a = $(a.currentTarget);
        a.data("bs.popover") || this.requestSubView(b, {$toggler: a, subtaskModel: this.subtaskModel}).show();
        return this
      };
      return h
    }(f)
  })
}).call(this);
define("views/board/subtask/subtask-card/templates/basic", [], function () {
  return function (d) {
    return'<ul class="subtasks-list"></ul><div class="subtask-creator"> <span class="icon icon-plus muted"></span> <textarea class="create-subtask-input subtask-input form-control" placeholder=""></textarea></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/subtask/subtask-card/index", ["view", "views/board/subtask/subtask/index", "./templates/basic"], function (d, b, e) {
    var g;
    return function (d) {
      function f() {
        return g = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "SubtaskCardView";
      f.prototype.className = "subtask-card";
      f.prototype.events = {"focus .create-subtask-input": "focus", "blur .create-subtask-input": "blur", "keydown .create-subtask-input": "submit"};
      f.prototype.creating = !1;
      f.prototype.initialize = function (a) {
        if (null == a || !a.subtasksCollection || null == a || !a.taskModel)return!1;
        this.options = a;
        this.taskModel = a.taskModel;
        this.subtasksCollection = a.subtasksCollection;
        this.creating = !1;
        this.renderBasic();
        this.renderSubtasks();
        this.listen();
        return this
      };
      f.prototype.listen = function () {
        this.listenTo(this.subtasksCollection,
          "add", this.renderSubtask);
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(e());
        this.$list = this.$(".subtasks-list");
        this.$creator = this.$(".subtask-creator");
        this.$input = this.$(".create-subtask-input").flexText();
        return this
      };
      f.prototype.renderSubtasks = function () {
        var a = this;
        this.subtasksCollection.each(function (b) {
          return a.renderSubtask(b)
        });
        return this
      };
      f.prototype.renderSubtask = function (a) {
        this.requestSubView(b, {subtaskModel: a}).$el.appendTo(this.$list);
        return this
      };
      f.prototype.focus =
        function () {
          this.$creator.addClass("editing");
          this.$input.attr("placeholder", "");
          return this
        };
      f.prototype.blur = function () {
        this.$creator.removeClass("editing");
        this.$input.attr("placeholder", "");
        return this
      };
      f.prototype.submit = function (a) {
        var b = this;
        13 === a.keyCode && !this.creating && (a.preventDefault(), a = this.$input.val().trim(), a = a.replace(/\s+/g, " ").trim()) && (this.creating = !0, this.subtasksCollection.create({_taskId: this.taskModel.id, content: a}, {wait: !0, success: function () {
          b.$input.val("");
          return b.creating = !1
        }, error: function () {
          return b.creating = !1
        }}));
        return this
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("dropdown-view", ["view", "util"], function (f, b) {
    var e;
    return function (f) {
      function d() {
        return e = d.__super__.constructor.apply(this, arguments)
      }

      a(d, f);
      d.prototype.viewName = "DropdownView";
      d.prototype.tagName = "ul";
      d.prototype.setup = function (a, b) {
        var e = this;
        this.$el.addClass("dropdown-menu");
        this.$el.attr("role",
          "menu");
        this.$opener = $(a);
        this.$opener.data("dropdown") || (this.$opener.addClass("dropdown-toggle"), this.$opener.attr("data-toggle", "dropdown"), this.$el.insertAfter(this.$opener), this.dropdown = this.$opener.dropdown(b).data("dropdown"), this.onOpen(), this.$opener.click(function () {
          return e.onOpen()
        }));
        return this
      };
      d.prototype.onOpen = function () {
        var a = this;
        this.$el.on("mousewheel", b.mousewheel);
        b.handleClickOutside(this.$el, function () {
          return a.onClose()
        });
        return this
      };
      d.prototype.onClose = function () {
        var a,
          b;
        null != (b = this.$el) && b.off("mousewheel");
        "function" === typeof(a = this.options).close && a.close();
        return this
      };
      return d
    }(f)
  })
}).call(this);
define("views/member/member-menu/templates/basic", [], function () {
  return function (d) {
    var a = "", f = d.members;
    if (f)for (var b, e = -1, g = f.length - 1; e < g;)b = f[e += 1], a += ' <li class="member-item one ', b.selected && (a += "selected"), a += '" data-id="' + b._id + '" data-gta="event" data-label="involve member" data-action="click" data-category="a" ', "post" == d.type ? a += ' data-value="g14-1" ' : "taskDetail" == d.type ? a += ' data-value="g13-10-1" ' : "postCreator" == d.type ? a += ' data-value="g8-1" ' : "taskCreator" == d.type ? a += ' data-value="h24-1" ' :
      "previewer" == d.type && (a += ' data-value="i8-6-1" '), a += '> <a> <div class="avatar img-circle" style="background-image:url(' + b.avatarUrl + ');"></div> ' + b.name + " </a> </li>";
    d.all && (a += ' <li class="member-item all" data-gta="event" data-label="involve member" data-action="click" data-category="a" ', "post" == d.type ? a += ' data-value="g14-2" ' : "taskDetail" == d.type ? a += ' data-value="g13-10-2" ' : "postCreator" == d.type ? a += ' data-value="g8-2" ' : "taskCreator" == d.type ? a += ' data-value="h24-2" ' : "previewer" == d.type &&
      (a += ' data-value="i8-6-2" '), a += '> <a> <span class="icon icon-users icon-gray"></span>  </a> </li>');
    return a
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, e) {
    function f() {
      this.constructor = a
    }

    for (var k in e)d.call(e, k) && (a[k] = e[k]);
    f.prototype = e.prototype;
    a.prototype = new f;
    a.__super__ = e.prototype;
    return a
  }, f = [].indexOf || function (a) {
    for (var e = 0, d = this.length; e < d; e++)if (e in this && this[e] === a)return e;
    return-1
  };
  define("views/member/member-menu/index", ["dropdown-view", "./templates/basic"], function (b, e) {
    var d;
    return function (b) {
      function h() {
        return d = h.__super__.constructor.apply(this, arguments)
      }

      a(h, b);
      h.prototype.viewName =
        "MemberMenuView";
      h.prototype.className = "member-menu-wrapper";
      h.prototype.events = {"click .one": "selectedMember", "click .all": "selectedAllMember"};
      h.prototype.initialize = function (a) {
        if (null != a && a.membersCollection)return this.options = a, this.options.direction = "auto bottom", this.resident = this.options.resident || [], this.excludes = this.options.excludes || [], this.selected = this.options.selected || [], this.members = [], this.membersCollection = a.membersCollection, this.render().listen(), this
      };
      h.prototype.listen = function () {
        this.listenTo(this.membersCollection,
          "add change:isQuited remove", this.render);
        return this
      };
      h.prototype.assembleData = function () {
        var a, b, e, d, g, h, k;
        this.members = [];
        a = this.membersCollection.getActiveMembersJSON();
        e = 0;
        for (d = a.length; e < d; e++)if (b = a[e], g = b._id, 0 > f.call(this.excludes, g)) {
          if ((h = b._id, 0 <= f.call(this.selected, h)) || (k = b._id, 0 <= f.call(this.resident, k)))b.selected = !0;
          this.members.push(b)
        }
        return this
      };
      h.prototype.render = function () {
        this.assembleData();
        this.$el.html(e({members: this.members, all: this.options.multi, type: this.options.type}));
        return this
      };
      h.prototype.selectedMember = function (a) {
        var b, e, d;
        b = $(a.currentTarget);
        d = b.data("id");
        if (this.options.multi) {
          if (a.stopPropagation(), a = b.hasClass("selected") ? "unselect" : "select", !("unselect" === a && 0 <= f.call(this.resident, d)) && !1 !== ("function" === typeof(e = this.options)[a] ? e[a](d) : void 0))return b.toggleClass("selected"), "select" === a ? this.selected = _.union(this.selected, d) : this.selected = _.without(this.selected, d)
        } else return this.$(".selected").removeClass("selected"), b.addClass("selected"),
          this.options.select(d), this.selected = [d]
      };
      h.prototype.selectedAllMember = function () {
        var a;
        this.$(".one").addClass("selected");
        a = _.pluck(this.members, "_id");
        this.options.selectAll(a);
        return this.selected = a
      };
      return h
    }(b)
  })
}).call(this);
define("views/member/member-involve/templates/basic", [], function () {
  return function (d) {
    var a = '<a class="add-involvement-handler clearfix" data-gta="event" data-label="' + d.gta.involveMemberLabel + '" data-action="click"> <span class="icon icon-plus-sign ';
    d.showTitle || (a += 'hinted" data-title="');
    a += '"></span> ';
    d.showTitle && (a += '<span class="involvement-title"></span>');
    return a + "</a>"
  }
});
define("views/member/member-involve/templates/list", [], function () {
  return function (d) {
    var a = "";
    if (1 === d.asList) {
      if (a += " ", d = d.members)for (var f, b = -1, e = d.length - 1; b < e;)f = d[b += 1], a += ' <li class="involve-member"> <div class="avatar avatar' + f._id + ' img-circle hinted" data-title="' + f.name + '" style="background-image:url(' + f.avatarUrl + ');"></div> </li> '
    } else f = d.members[d.members.length - 1], a = a + " " + (' <div class="avatar img-circle" style="background-image:url(' + f.avatarUrl + ');"></div> <div class="involve-members-count">  ' +
      d.members.length + "</div>");
    return a
  }
});
define("jqueryui/core", ["jquery"], function (d) {
  (function (a, d) {
    function b(b, d) {
      var f, g;
      f = b.nodeName.toLowerCase();
      if ("area" === f) {
        f = b.parentNode;
        g = f.name;
        if (!b.href || !g || "map" !== f.nodeName.toLowerCase())return!1;
        f = a("img[usemap=#" + g + "]")[0];
        return!!f && e(f)
      }
      return(/input|select|textarea|button|object/.test(f) ? !b.disabled : "a" === f ? b.href || d : d) && e(b)
    }

    function e(b) {
      return a.expr.filters.visible(b) && !a(b).parents().addBack().filter(function () {
        return"hidden" === a.css(this, "visibility")
      }).length
    }

    var g = 0, k = /^ui-id-\d+$/;
    a.ui = a.ui || {};
    a.ui.version || (a.extend(a.ui, {version: "1.10.0", keyCode: {BACKSPACE: 8, COMMA: 188, DELETE: 46, DOWN: 40, END: 35, ENTER: 13, ESCAPE: 27, HOME: 36, LEFT: 37, NUMPAD_ADD: 107, NUMPAD_DECIMAL: 110, NUMPAD_DIVIDE: 111, NUMPAD_ENTER: 108, NUMPAD_MULTIPLY: 106, NUMPAD_SUBTRACT: 109, PAGE_DOWN: 34, PAGE_UP: 33, PERIOD: 190, RIGHT: 39, SPACE: 32, TAB: 9, UP: 38}}), a.fn.extend({_focus: a.fn.focus, focus: function (b, e) {
      return"number" === typeof b ? this.each(function () {
        var d = this;
        setTimeout(function () {
          a(d).focus();
          e && e.call(d)
        }, b)
      }) : this._focus.apply(this,
        arguments)
    }, scrollParent: function () {
      var b;
      b = a.ui.ie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? this.parents().filter(function () {
        return/(relative|absolute|fixed)/.test(a.css(this, "position")) && /(auto|scroll)/.test(a.css(this, "overflow") + a.css(this, "overflow-y") + a.css(this, "overflow-x"))
      }).eq(0) : this.parents().filter(function () {
        return/(auto|scroll)/.test(a.css(this, "overflow") + a.css(this, "overflow-y") + a.css(this, "overflow-x"))
      }).eq(0);
      return/fixed/.test(this.css("position")) || !b.length ? a(document) : b
    }, zIndex: function (b) {
      if (b !== d)return this.css("zIndex", b);
      if (this.length) {
        b = a(this[0]);
        for (var e; b.length && b[0] !== document;) {
          e = b.css("position");
          if ("absolute" === e || "relative" === e || "fixed" === e)if (e = parseInt(b.css("zIndex"), 10), !isNaN(e) && 0 !== e)return e;
          b = b.parent()
        }
      }
      return 0
    }, uniqueId: function () {
      return this.each(function () {
        this.id || (this.id = "ui-id-" + ++g)
      })
    }, removeUniqueId: function () {
      return this.each(function () {
        k.test(this.id) && a(this).removeAttr("id")
      })
    }}), a.extend(a.expr[":"],
      {data: a.expr.createPseudo ? a.expr.createPseudo(function (b) {
        return function (e) {
          return!!a.data(e, b)
        }
      }) : function (b, e, d) {
        return!!a.data(b, d[3])
      }, focusable: function (e) {
        return b(e, !isNaN(a.attr(e, "tabindex")))
      }, tabbable: function (e) {
        var d = a.attr(e, "tabindex"), f = isNaN(d);
        return(f || 0 <= d) && b(e, !f)
      }}), a("<a>").outerWidth(1).jquery || a.each(["Width", "Height"], function (b, e) {
      function g(b, e, d, f) {
        a.each(k, function () {
          e -= parseFloat(a.css(b, "padding" + this)) || 0;
          d && (e -= parseFloat(a.css(b, "border" + this + "Width")) || 0);
          f &&
          (e -= parseFloat(a.css(b, "margin" + this)) || 0)
        });
        return e
      }

      var k = "Width" === e ? ["Left", "Right"] : ["Top", "Bottom"], s = e.toLowerCase(), r = {innerWidth: a.fn.innerWidth, innerHeight: a.fn.innerHeight, outerWidth: a.fn.outerWidth, outerHeight: a.fn.outerHeight};
      a.fn["inner" + e] = function (b) {
        return b === d ? r["inner" + e].call(this) : this.each(function () {
          a(this).css(s, g(this, b) + "px")
        })
      };
      a.fn["outer" + e] = function (b, d) {
        return"number" !== typeof b ? r["outer" + e].call(this, b) : this.each(function () {
          a(this).css(s, g(this, b, !0, d) + "px")
        })
      }
    }),
      a.fn.addBack || (a.fn.addBack = function (a) {
        return this.add(null == a ? this.prevObject : this.prevObject.filter(a))
      }), a("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (a.fn.removeData = function (b) {
      return function (e) {
        return arguments.length ? b.call(this, a.camelCase(e)) : b.call(this)
      }
    }(a.fn.removeData)), a.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()), a.support.selectstart = "onselectstart"in document.createElement("div"), a.fn.extend({disableSelection: function () {
      return this.bind((a.support.selectstart ?
        "selectstart" : "mousedown") + ".ui-disableSelection", function (a) {
        a.preventDefault()
      })
    }, enableSelection: function () {
      return this.unbind(".ui-disableSelection")
    }}), a.extend(a.ui, {plugin: {add: function (b, e, d) {
      var f;
      b = a.ui[b].prototype;
      for (f in d)b.plugins[f] = b.plugins[f] || [], b.plugins[f].push([e, d[f]])
    }, call: function (a, b, e) {
      var d = a.plugins[b];
      if (d && a.element[0].parentNode && 11 !== a.element[0].parentNode.nodeType)for (b = 0; b < d.length; b++)a.options[d[b][0]] && d[b][1].apply(a.element, e)
    }}, hasScroll: function (b, e) {
      if ("hidden" ===
        a(b).css("overflow"))return!1;
      var d = e && "left" === e ? "scrollLeft" : "scrollTop", f = !1;
      if (0 < b[d])return!0;
      b[d] = 1;
      f = 0 < b[d];
      b[d] = 0;
      return f
    }}))
  })(d)
});
define("jqueryui/widget", ["jquery"], function (d) {
  (function (a, d) {
    var b = 0, e = Array.prototype.slice, g = a.cleanData;
    a.cleanData = function (b) {
      for (var e = 0, d; null != (d = b[e]); e++)try {
        a(d).triggerHandler("remove")
      } catch (f) {
      }
      g(b)
    };
    a.widget = function (b, e, d) {
      var f, g, s, r, t = {}, v = b.split(".")[0];
      b = b.split(".")[1];
      f = v + "-" + b;
      d || (d = e, e = a.Widget);
      a.expr[":"][f.toLowerCase()] = function (b) {
        return!!a.data(b, f)
      };
      a[v] = a[v] || {};
      g = a[v][b];
      s = a[v][b] = function (a, b) {
        if (!this._createWidget)return new s(a, b);
        arguments.length && this._createWidget(a,
          b)
      };
      a.extend(s, g, {version: d.version, _proto: a.extend({}, d), _childConstructors: []});
      r = new e;
      r.options = a.widget.extend({}, r.options);
      a.each(d, function (b, d) {
        a.isFunction(d) ? t[b] = function () {
          var a = function () {
            return e.prototype[b].apply(this, arguments)
          }, f = function (a) {
            return e.prototype[b].apply(this, a)
          };
          return function () {
            var b = this._super, e = this._superApply, g;
            this._super = a;
            this._superApply = f;
            g = d.apply(this, arguments);
            this._super = b;
            this._superApply = e;
            return g
          }
        }() : t[b] = d
      });
      s.prototype = a.widget.extend(r, {widgetEventPrefix: g ?
        r.widgetEventPrefix : b}, t, {constructor: s, namespace: v, widgetName: b, widgetFullName: f});
      g ? (a.each(g._childConstructors, function (b, e) {
        var d = e.prototype;
        a.widget(d.namespace + "." + d.widgetName, s, e._proto)
      }), delete g._childConstructors) : e._childConstructors.push(s);
      a.widget.bridge(b, s)
    };
    a.widget.extend = function (b) {
      for (var g = e.call(arguments, 1), l = 0, n = g.length, m, s; l < n; l++)for (m in g[l])s = g[l][m], g[l].hasOwnProperty(m) && s !== d && (a.isPlainObject(s) ? b[m] = a.isPlainObject(b[m]) ? a.widget.extend({}, b[m], s) : a.widget.extend({},
        s) : b[m] = s);
      return b
    };
    a.widget.bridge = function (b, g) {
      var l = g.prototype.widgetFullName || b;
      a.fn[b] = function (n) {
        var m = "string" === typeof n, s = e.call(arguments, 1), r = this;
        n = !m && s.length ? a.widget.extend.apply(null, [n].concat(s)) : n;
        m ? this.each(function () {
          var e, g = a.data(this, l);
          if (!g)return a.error("cannot call methods on " + b + " prior to initialization; attempted to call method '" + n + "'");
          if (!a.isFunction(g[n]) || "_" === n.charAt(0))return a.error("no such method '" + n + "' for " + b + " widget instance");
          e = g[n].apply(g,
            s);
          if (e !== g && e !== d)return r = e && e.jquery ? r.pushStack(e.get()) : e, !1
        }) : this.each(function () {
          var b = a.data(this, l);
          b ? b.option(n || {})._init() : a.data(this, l, new g(n, this))
        });
        return r
      }
    };
    a.Widget = function () {
    };
    a.Widget._childConstructors = [];
    a.Widget.prototype = {widgetName: "widget", widgetEventPrefix: "", defaultElement: "<div>", options: {disabled: !1, create: null}, _createWidget: function (e, d) {
      d = a(d || this.defaultElement || this)[0];
      this.element = a(d);
      this.uuid = b++;
      this.eventNamespace = "." + this.widgetName + this.uuid;
      this.options =
        a.widget.extend({}, this.options, this._getCreateOptions(), e);
      this.bindings = a();
      this.hoverable = a();
      this.focusable = a();
      d !== this && (a.data(d, this.widgetFullName, this), this._on(!0, this.element, {remove: function (a) {
        a.target === d && this.destroy()
      }}), this.document = a(d.style ? d.ownerDocument : d.document || d), this.window = a(this.document[0].defaultView || this.document[0].parentWindow));
      this._create();
      this._trigger("create", null, this._getCreateEventData());
      this._init()
    }, _getCreateOptions: a.noop, _getCreateEventData: a.noop,
      _create: a.noop, _init: a.noop, destroy: function () {
        this._destroy();
        this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName));
        this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled ui-state-disabled");
        this.bindings.unbind(this.eventNamespace);
        this.hoverable.removeClass("ui-state-hover");
        this.focusable.removeClass("ui-state-focus")
      }, _destroy: a.noop, widget: function () {
        return this.element
      },
      option: function (b, e) {
        var g = b, n, m, s;
        if (0 === arguments.length)return a.widget.extend({}, this.options);
        if ("string" === typeof b)if (g = {}, n = b.split("."), b = n.shift(), n.length) {
          m = g[b] = a.widget.extend({}, this.options[b]);
          for (s = 0; s < n.length - 1; s++)m[n[s]] = m[n[s]] || {}, m = m[n[s]];
          b = n.pop();
          if (e === d)return m[b] === d ? null : m[b];
          m[b] = e
        } else {
          if (e === d)return this.options[b] === d ? null : this.options[b];
          g[b] = e
        }
        this._setOptions(g);
        return this
      }, _setOptions: function (a) {
        for (var b in a)this._setOption(b, a[b]);
        return this
      }, _setOption: function (a, b) {
        this.options[a] = b;
        "disabled" === a && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!b).attr("aria-disabled", b), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus"));
        return this
      }, enable: function () {
        return this._setOption("disabled", !1)
      }, disable: function () {
        return this._setOption("disabled", !0)
      }, _on: function (b, e, d) {
        var f, g = this;
        "boolean" !== typeof b && (d = e, e = b, b = !1);
        d ? (e = f = a(e), this.bindings = this.bindings.add(e)) : (d = e, e = this.element, f =
          this.widget());
        a.each(d, function (d, l) {
          function t() {
            if (b || !0 !== g.options.disabled && !a(this).hasClass("ui-state-disabled"))return("string" === typeof l ? g[l] : l).apply(g, arguments)
          }

          "string" !== typeof l && (t.guid = l.guid = l.guid || t.guid || a.guid++);
          var v = d.match(/^(\w+)\s*(.*)$/), p = v[1] + g.eventNamespace;
          (v = v[2]) ? f.delegate(v, p, t) : e.bind(p, t)
        })
      }, _off: function (a, b) {
        b = (b || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace;
        a.unbind(b).undelegate(b)
      }, _delay: function (a, b) {
        var e = this;
        return setTimeout(function () {
          return("string" === typeof a ? e[a] : a).apply(e, arguments)
        }, b || 0)
      }, _hoverable: function (b) {
        this.hoverable = this.hoverable.add(b);
        this._on(b, {mouseenter: function (b) {
          a(b.currentTarget).addClass("ui-state-hover")
        }, mouseleave: function (b) {
          a(b.currentTarget).removeClass("ui-state-hover")
        }})
      }, _focusable: function (b) {
        this.focusable = this.focusable.add(b);
        this._on(b, {focusin: function (b) {
          a(b.currentTarget).addClass("ui-state-focus")
        }, focusout: function (b) {
          a(b.currentTarget).removeClass("ui-state-focus")
        }})
      }, _trigger: function (b, e, d) {
        var f,
          g = this.options[b];
        d = d || {};
        e = a.Event(e);
        e.type = (b === this.widgetEventPrefix ? b : this.widgetEventPrefix + b).toLowerCase();
        e.target = this.element[0];
        if (b = e.originalEvent)for (f in b)f in e || (e[f] = b[f]);
        this.element.trigger(e, d);
        return!(a.isFunction(g) && !1 === g.apply(this.element[0], [e].concat(d)) || e.isDefaultPrevented())
      }};
    a.each({show: "fadeIn", hide: "fadeOut"}, function (b, e) {
      a.Widget.prototype["_" + b] = function (d, f, g) {
        "string" === typeof f && (f = {effect: f});
        var s, r = f ? !0 === f || "number" === typeof f ? e : f.effect || e : b;
        f =
          f || {};
        "number" === typeof f && (f = {duration: f});
        s = !a.isEmptyObject(f);
        f.complete = g;
        f.delay && d.delay(f.delay);
        if (s && a.effects && a.effects.effect[r])d[b](f); else if (r !== b && d[r])d[r](f.duration, f.easing, g); else d.queue(function (e) {
          a(this)[b]();
          g && g.call(d[0]);
          e()
        })
      }
    })
  })(d)
});
define("jqueryui/mouse", ["jquery", "./widget"], function (d) {
  (function (a, d) {
    var b = !1;
    a(document).mouseup(function () {
      b = !1
    });
    a.widget("ui.mouse", {version: "1.10.0", options: {cancel: "input,textarea,button,select,option", distance: 1, delay: 0}, _mouseInit: function () {
      var b = this;
      this.element.bind("mousedown." + this.widgetName,function (a) {
        return b._mouseDown(a)
      }).bind("click." + this.widgetName, function (d) {
        if (!0 === a.data(d.target, b.widgetName + ".preventClickEvent"))return a.removeData(d.target, b.widgetName + ".preventClickEvent"),
          d.stopImmediatePropagation(), !1
      });
      this.started = !1
    }, _mouseDestroy: function () {
      this.element.unbind("." + this.widgetName);
      this._mouseMoveDelegate && a(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
    }, _mouseDown: function (e) {
      if (!b) {
        this._mouseStarted && this._mouseUp(e);
        this._mouseDownEvent = e;
        var d = this, f = 1 === e.which, h = "string" === typeof this.options.cancel && e.target.nodeName ? a(e.target).closest(this.options.cancel).length : !1;
        if (!f ||
          h || !this._mouseCapture(e))return!0;
        this.mouseDelayMet = !this.options.delay;
        this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function () {
          d.mouseDelayMet = !0
        }, this.options.delay));
        if (this._mouseDistanceMet(e) && this._mouseDelayMet(e) && (this._mouseStarted = !1 !== this._mouseStart(e), !this._mouseStarted))return e.preventDefault(), !0;
        !0 === a.data(e.target, this.widgetName + ".preventClickEvent") && a.removeData(e.target, this.widgetName + ".preventClickEvent");
        this._mouseMoveDelegate = function (a) {
          return d._mouseMove(a)
        };
        this._mouseUpDelegate = function (a) {
          return d._mouseUp(a)
        };
        a(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate);
        e.preventDefault();
        return b = !0
      }
    }, _mouseMove: function (b) {
      if (a.ui.ie && (!document.documentMode || 9 > document.documentMode) && !b.button)return this._mouseUp(b);
      if (this._mouseStarted)return this._mouseDrag(b), b.preventDefault();
      this._mouseDistanceMet(b) && this._mouseDelayMet(b) && ((this._mouseStarted = !1 !== this._mouseStart(this._mouseDownEvent,
        b)) ? this._mouseDrag(b) : this._mouseUp(b));
      return!this._mouseStarted
    }, _mouseUp: function (b) {
      a(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate);
      this._mouseStarted && (this._mouseStarted = !1, b.target === this._mouseDownEvent.target && a.data(b.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(b));
      return!1
    }, _mouseDistanceMet: function (a) {
      return Math.max(Math.abs(this._mouseDownEvent.pageX - a.pageX), Math.abs(this._mouseDownEvent.pageY -
        a.pageY)) >= this.options.distance
    }, _mouseDelayMet: function () {
      return this.mouseDelayMet
    }, _mouseStart: function () {
    }, _mouseDrag: function () {
    }, _mouseStop: function () {
    }, _mouseCapture: function () {
      return!0
    }})
  })(d)
});
define("jqueryui/draggable", ["jquery", "./core", "./mouse", "./widget"], function (d) {
  (function (a, d) {
    a.widget("ui.draggable", a.ui.mouse, {version: "1.10.0", widgetEventPrefix: "drag", options: {addClasses: !0, appendTo: "parent", axis: !1, connectToSortable: !1, containment: !1, cursor: "auto", cursorAt: !1, grid: !1, handle: !1, helper: "original", iframeFix: !1, opacity: !1, refreshPositions: !1, revert: !1, revertDuration: 500, scope: "default", scroll: !0, scrollSensitivity: 20, scrollSpeed: 20, snap: !1, snapMode: "both", snapTolerance: 20, stack: !1,
      zIndex: !1, drag: null, start: null, stop: null}, _create: function () {
      "original" !== this.options.helper || /^(?:r|a|f)/.test(this.element.css("position")) || (this.element[0].style.position = "relative");
      this.options.addClasses && this.element.addClass("ui-draggable");
      this.options.disabled && this.element.addClass("ui-draggable-disabled");
      this._mouseInit()
    }, _destroy: function () {
      this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");
      this._mouseDestroy()
    }, _mouseCapture: function (b) {
      var e = this.options;
      if (this.dbHelper || e.disabled || 0 < a(b.target).closest(".ui-resizable-handle").length)return!1;
      this.handle = this._getHandle(b);
      if (!this.handle)return!1;
      a(!0 === e.iframeFix ? "iframe" : e.iframeFix).each(function () {
        a("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width: this.offsetWidth + "px", height: this.offsetHeight + "px", position: "absolute", opacity: "0.001", zIndex: 1E3}).css(a(this).offset()).appendTo("body")
      });
      return!0
    }, _mouseStart: function (b) {
      var e = this.options;
      this.dbHelper = this._createHelper(b);
      this.dbHelper.addClass("ui-draggable-dragging");
      this._cacheHelperProportions();
      a.ui.ddmanager && (a.ui.ddmanager.current = this);
      this._cacheMargins();
      this.cssPosition = this.dbHelper.css("position");
      this.scrollParent = this.dbHelper.scrollParent();
      this.offset = this.positionAbs = this.element.offset();
      this.offset = {top: this.offset.top - this.margins.top, left: this.offset.left - this.margins.left};
      a.extend(this.offset, {click: {left: b.pageX - this.offset.left, top: b.pageY - this.offset.top}, parent: this._getParentOffset(), relative: this._getRelativeOffset()});
      this.originalPosition = this.position = this._generatePosition(b);
      this.originalPageX = b.pageX;
      this.originalPageY = b.pageY;
      e.cursorAt && this._adjustOffsetFromHelper(e.cursorAt);
      e.containment && this._setContainment();
      if (!1 === this._trigger("start", b))return this._clear(), !1;
      this._cacheHelperProportions();
      a.ui.ddmanager && !e.dropBehaviour && a.ui.ddmanager.prepareOffsets(this, b);
      this._mouseDrag(b, !0);
      a.ui.ddmanager && a.ui.ddmanager.dragStart(this, b);
      return!0
    }, _mouseDrag: function (b, e) {
      this.position = this._generatePosition(b);
      this.positionAbs = this._convertPositionTo("absolute");
      if (!e) {
        var d = this._uiHash();
        if (!1 === this._trigger("drag", b, d))return this._mouseUp({}), !1;
        this.position = d.position
      }
      this.options.axis && "y" === this.options.axis || (this.dbHelper[0].style.left = this.position.left + "px");
      this.options.axis && "x" === this.options.axis || (this.dbHelper[0].style.top = this.position.top + "px");
      a.ui.ddmanager && a.ui.ddmanager.drag(this, b);
      return!1
    }, _mouseStop: function (b) {
      var e, d = this, f = !1, h = !1;
      a.ui.ddmanager && !this.options.dropBehaviour &&
      (h = a.ui.ddmanager.drop(this, b));
      this.dropped && (h = this.dropped, this.dropped = !1);
      for (e = this.element[0]; e && (e = e.parentNode);)e === document && (f = !0);
      if (!f && "original" === this.options.helper)return!1;
      "invalid" === this.options.revert && !h || "valid" === this.options.revert && h || !0 === this.options.revert || a.isFunction(this.options.revert) && this.options.revert.call(this.element, h) ? a(this.dbHelper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function () {
        !1 !== d._trigger("stop", b) && d._clear()
      }) :
        !1 !== this._trigger("stop", b) && this._clear();
      return!1
    }, _mouseUp: function (b) {
      a("div.ui-draggable-iframeFix").each(function () {
        this.parentNode.removeChild(this)
      });
      a.ui.ddmanager && a.ui.ddmanager.dragStop(this, b);
      return a.ui.mouse.prototype._mouseUp.call(this, b)
    }, cancel: function () {
      this.dbHelper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear();
      return this
    }, _getHandle: function (b) {
      var e = this.options.handle && a(this.options.handle, this.element).length ? !1 : !0;
      a(this.options.handle, this.element).find("*").addBack().each(function () {
        this ===
          b.target && (e = !0)
      });
      return e
    }, _createHelper: function (b) {
      var e = this.options;
      b = a.isFunction(e.helper) ? a(e.helper.apply(this.element[0], [b])) : "clone" === e.helper ? this.element.clone().removeAttr("id") : this.element;
      b.parents("body").length || b.appendTo("parent" === e.appendTo ? this.element[0].parentNode : e.appendTo);
      b[0] === this.element[0] || /(fixed|absolute)/.test(b.css("position")) || b.css("position", "absolute");
      return b
    }, _adjustOffsetFromHelper: function (b) {
      "string" === typeof b && (b = b.split(" "));
      a.isArray(b) &&
      (b = {left: +b[0], top: +b[1] || 0});
      "left"in b && (this.offset.click.left = b.left + this.margins.left);
      "right"in b && (this.offset.click.left = this.helperProportions.width - b.right + this.margins.left);
      "top"in b && (this.offset.click.top = b.top + this.margins.top);
      "bottom"in b && (this.offset.click.top = this.helperProportions.height - b.bottom + this.margins.top)
    }, _getParentOffset: function () {
      this.offsetParent = this.dbHelper.offsetParent();
      var b = this.offsetParent.offset();
      "absolute" === this.cssPosition && this.scrollParent[0] !== document &&
        a.contains(this.scrollParent[0], this.offsetParent[0]) && (b.left += this.scrollParent.scrollLeft(), b.top += this.scrollParent.scrollTop());
      if (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && "html" === this.offsetParent[0].tagName.toLowerCase() && a.ui.ie)b = {top: 0, left: 0};
      return{top: b.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left: b.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
    }, _getRelativeOffset: function () {
      if ("relative" === this.cssPosition) {
        var a = this.element.position();
        return{top: a.top - (parseInt(this.dbHelper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left: a.left - (parseInt(this.dbHelper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
      }
      return{top: 0, left: 0}
    }, _cacheMargins: function () {
      this.margins = {left: parseInt(this.element.css("marginLeft"), 10) || 0, top: parseInt(this.element.css("marginTop"), 10) || 0, right: parseInt(this.element.css("marginRight"), 10) || 0, bottom: parseInt(this.element.css("marginBottom"), 10) || 0}
    }, _cacheHelperProportions: function () {
      this.helperProportions =
      {width: this.dbHelper.outerWidth(), height: this.dbHelper.outerHeight()}
    }, _setContainment: function () {
      var b, e, d;
      b = this.options;
      "parent" === b.containment && (b.containment = this.dbHelper[0].parentNode);
      if ("document" === b.containment || "window" === b.containment)this.containment = ["document" === b.containment ? 0 : a(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, "document" === b.containment ? 0 : a(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, ("document" === b.containment ? 0 : a(window).scrollLeft()) +
        a("document" === b.containment ? document : window).width() - this.helperProportions.width - this.margins.left, ("document" === b.containment ? 0 : a(window).scrollTop()) + (a("document" === b.containment ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top];
      if (/^(document|window|parent)$/.test(b.containment) || b.containment.constructor === Array)b.containment.constructor === Array && (this.containment = b.containment); else if (e = a(b.containment), d = e[0])b = "hidden" !== a(d).css("overflow"),
        this.containment = [(parseInt(a(d).css("borderLeftWidth"), 10) || 0) + (parseInt(a(d).css("paddingLeft"), 10) || 0), (parseInt(a(d).css("borderTopWidth"), 10) || 0) + (parseInt(a(d).css("paddingTop"), 10) || 0), (b ? Math.max(d.scrollWidth, d.offsetWidth) : d.offsetWidth) - (parseInt(a(d).css("borderLeftWidth"), 10) || 0) - (parseInt(a(d).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (b ? Math.max(d.scrollHeight, d.offsetHeight) : d.offsetHeight) - (parseInt(a(d).css("borderTopWidth"), 10) ||
          0) - (parseInt(a(d).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = e
    }, _convertPositionTo: function (b, e) {
      e || (e = this.position);
      var d = "absolute" === b ? 1 : -1, f = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && a.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, h = /(html|body)/i.test(f[0].tagName);
      return{top: e.top + this.offset.relative.top * d + this.offset.parent.top * d - ("fixed" === this.cssPosition ?
        -this.scrollParent.scrollTop() : h ? 0 : f.scrollTop()) * d, left: e.left + this.offset.relative.left * d + this.offset.parent.left * d - ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : h ? 0 : f.scrollLeft()) * d}
    }, _generatePosition: function (b) {
      var e, d, f, h = this.options, l = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && a.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, n = /(html|body)/i.test(l[0].tagName);
      f = b.pageX;
      d = b.pageY;
      this.originalPosition && (this.containment &&
        (this.relative_container ? (e = this.relative_container.offset(), e = [this.containment[0] + e.left, this.containment[1] + e.top, this.containment[2] + e.left, this.containment[3] + e.top]) : e = this.containment, b.pageX - this.offset.click.left < e[0] && (f = e[0] + this.offset.click.left), b.pageY - this.offset.click.top < e[1] && (d = e[1] + this.offset.click.top), b.pageX - this.offset.click.left > e[2] && (f = e[2] + this.offset.click.left), b.pageY - this.offset.click.top > e[3] && (d = e[3] + this.offset.click.top)), h.grid && (d = h.grid[1] ? this.originalPageY +
        Math.round((d - this.originalPageY) / h.grid[1]) * h.grid[1] : this.originalPageY, d = e ? d - this.offset.click.top >= e[1] || d - this.offset.click.top > e[3] ? d : d - this.offset.click.top >= e[1] ? d - h.grid[1] : d + h.grid[1] : d, f = h.grid[0] ? this.originalPageX + Math.round((f - this.originalPageX) / h.grid[0]) * h.grid[0] : this.originalPageX, f = e ? f - this.offset.click.left >= e[0] || f - this.offset.click.left > e[2] ? f : f - this.offset.click.left >= e[0] ? f - h.grid[0] : f + h.grid[0] : f));
      return{top: d - this.offset.click.top - this.offset.relative.top - this.offset.parent.top +
        ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : n ? 0 : l.scrollTop()), left: f - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : n ? 0 : l.scrollLeft())}
    }, _clear: function () {
      this.dbHelper.removeClass("ui-draggable-dragging");
      this.dbHelper[0] === this.element[0] || this.cancelHelperRemoval || this.dbHelper.remove();
      this.dbHelper = null;
      this.cancelHelperRemoval = !1
    }, _trigger: function (b, e, d) {
      d = d || this._uiHash();
      a.ui.plugin.call(this,
        b, [e, d]);
      "drag" === b && (this.positionAbs = this._convertPositionTo("absolute"));
      return a.Widget.prototype._trigger.call(this, b, e, d)
    }, plugins: {}, _uiHash: function () {
      return{helper: this.helper, position: this.position, originalPosition: this.originalPosition, offset: this.positionAbs}
    }});
    a.ui.plugin.add("draggable", "connectToSortable", {start: function (b, e) {
      var d = a(this).data("ui-draggable"), f = d.options, h = a.extend({}, e, {item: d.element});
      d.sortables = [];
      a(f.connectToSortable).each(function () {
        var e = a.data(this, "ui-sortable");
        e && !e.options.disabled && (d.sortables.push({instance: e, shouldRevert: e.options.revert}), e.refreshPositions(), e._trigger("activate", b, h))
      })
    }, stop: function (b, e) {
      var d = a(this).data("ui-draggable"), f = a.extend({}, e, {item: d.element});
      a.each(d.sortables, function () {
        this.instance.isOver ? (this.instance.isOver = 0, d.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = !0), this.instance._mouseStop(b), this.instance.options.helper = this.instance.options._helper,
          "original" === d.options.helper && this.instance.currentItem.css({top: "auto", left: "auto"})) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", b, f))
      })
    }, drag: function (b, e) {
      var d = a(this).data("ui-draggable"), f = this;
      a.each(d.sortables, function () {
        var h = !1, l = this;
        this.instance.positionAbs = d.positionAbs;
        this.instance.helperProportions = d.helperProportions;
        this.instance.offset.click = d.offset.click;
        this.instance._intersectsWith(this.instance.containerCache) && (h = !0, a.each(d.sortables, function () {
          this.instance.positionAbs =
            d.positionAbs;
          this.instance.helperProportions = d.helperProportions;
          this.instance.offset.click = d.offset.click;
          this !== l && this.instance._intersectsWith(this.instance.containerCache) && a.ui.contains(l.instance.element[0], this.instance.element[0]) && (h = !1);
          return h
        }));
        h ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = a(f).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper =
          function () {
            return e.helper[0]
          }, b.target = this.instance.currentItem[0], this.instance._mouseCapture(b, !0), this.instance._mouseStart(b, !0, !0), this.instance.offset.click.top = d.offset.click.top, this.instance.offset.click.left = d.offset.click.left, this.instance.offset.parent.left -= d.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= d.offset.parent.top - this.instance.offset.parent.top, d._trigger("toSortable", b), d.dropped = this.instance.element, d.currentItem = d.element, this.instance.fromOutside =
          d), this.instance.currentItem && this.instance._mouseDrag(b)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", b, this.instance._uiHash(this.instance)), this.instance._mouseStop(b, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), d._trigger("fromSortable", b), d.dropped = !1)
      })
    }});
    a.ui.plugin.add("draggable",
      "cursor", {start: function () {
        var b = a("body"), e = a(this).data("ui-draggable").options;
        b.css("cursor") && (e._cursor = b.css("cursor"));
        b.css("cursor", e.cursor)
      }, stop: function () {
        var b = a(this).data("ui-draggable").options;
        b._cursor && a("body").css("cursor", b._cursor)
      }});
    a.ui.plugin.add("draggable", "opacity", {start: function (b, e) {
      var d = a(e.helper), f = a(this).data("ui-draggable").options;
      d.css("opacity") && (f._opacity = d.css("opacity"));
      d.css("opacity", f.opacity)
    }, stop: function (b, e) {
      var d = a(this).data("ui-draggable").options;
      d._opacity && a(e.helper).css("opacity", d._opacity)
    }});
    a.ui.plugin.add("draggable", "scroll", {start: function () {
      var b = a(this).data("ui-draggable");
      b.scrollParent[0] !== document && "HTML" !== b.scrollParent[0].tagName && (b.overflowOffset = b.scrollParent.offset())
    }, drag: function (b) {
      var e = a(this).data("ui-draggable"), d = e.options, f = !1;
      e.scrollParent[0] !== document && "HTML" !== e.scrollParent[0].tagName ? (d.axis && "x" === d.axis || (e.overflowOffset.top + e.scrollParent[0].offsetHeight - b.pageY < d.scrollSensitivity ? e.scrollParent[0].scrollTop =
        f = e.scrollParent[0].scrollTop + d.scrollSpeed : b.pageY - e.overflowOffset.top < d.scrollSensitivity && (e.scrollParent[0].scrollTop = f = e.scrollParent[0].scrollTop - d.scrollSpeed)), d.axis && "y" === d.axis || (e.overflowOffset.left + e.scrollParent[0].offsetWidth - b.pageX < d.scrollSensitivity ? e.scrollParent[0].scrollLeft = f = e.scrollParent[0].scrollLeft + d.scrollSpeed : b.pageX - e.overflowOffset.left < d.scrollSensitivity && (e.scrollParent[0].scrollLeft = f = e.scrollParent[0].scrollLeft - d.scrollSpeed))) : (d.axis && "x" === d.axis || (b.pageY -
        a(document).scrollTop() < d.scrollSensitivity ? f = a(document).scrollTop(a(document).scrollTop() - d.scrollSpeed) : a(window).height() - (b.pageY - a(document).scrollTop()) < d.scrollSensitivity && (f = a(document).scrollTop(a(document).scrollTop() + d.scrollSpeed))), d.axis && "y" === d.axis || (b.pageX - a(document).scrollLeft() < d.scrollSensitivity ? f = a(document).scrollLeft(a(document).scrollLeft() - d.scrollSpeed) : a(window).width() - (b.pageX - a(document).scrollLeft()) < d.scrollSensitivity && (f = a(document).scrollLeft(a(document).scrollLeft() +
        d.scrollSpeed))));
      !1 !== f && a.ui.ddmanager && !d.dropBehaviour && a.ui.ddmanager.prepareOffsets(e, b)
    }});
    a.ui.plugin.add("draggable", "snap", {start: function () {
      var b = a(this).data("ui-draggable"), e = b.options;
      b.snapElements = [];
      a(e.snap.constructor !== String ? e.snap.items || ":data(ui-draggable)" : e.snap).each(function () {
        var e = a(this), d = e.offset();
        this !== b.element[0] && b.snapElements.push({item: this, width: e.outerWidth(), height: e.outerHeight(), top: d.top, left: d.left})
      })
    }, drag: function (b, e) {
      var d, f, h, l, n, m, s, r, t, v, p =
        a(this).data("ui-draggable"), x = p.options, B = x.snapTolerance, C = e.offset.left, z = C + p.helperProportions.width, A = e.offset.top, u = A + p.helperProportions.height;
      for (t = p.snapElements.length - 1; 0 <= t; t--)n = p.snapElements[t].left, m = n + p.snapElements[t].width, s = p.snapElements[t].top, r = s + p.snapElements[t].height, n - B < C && C < m + B && s - B < A && A < r + B || n - B < C && C < m + B && s - B < u && u < r + B || n - B < z && z < m + B && s - B < A && A < r + B || n - B < z && z < m + B && s - B < u && u < r + B ? ("inner" !== x.snapMode && (d = Math.abs(s - u) <= B, f = Math.abs(r - A) <= B, h = Math.abs(n - z) <= B, l = Math.abs(m -
        C) <= B, d && (e.position.top = p._convertPositionTo("relative", {top: s - p.helperProportions.height, left: 0}).top - p.margins.top), f && (e.position.top = p._convertPositionTo("relative", {top: r, left: 0}).top - p.margins.top), h && (e.position.left = p._convertPositionTo("relative", {top: 0, left: n - p.helperProportions.width}).left - p.margins.left), l && (e.position.left = p._convertPositionTo("relative", {top: 0, left: m}).left - p.margins.left)), v = d || f || h || l, "outer" !== x.snapMode && (d = Math.abs(s - A) <= B, f = Math.abs(r - u) <= B, h = Math.abs(n - C) <=
        B, l = Math.abs(m - z) <= B, d && (e.position.top = p._convertPositionTo("relative", {top: s, left: 0}).top - p.margins.top), f && (e.position.top = p._convertPositionTo("relative", {top: r - p.helperProportions.height, left: 0}).top - p.margins.top), h && (e.position.left = p._convertPositionTo("relative", {top: 0, left: n}).left - p.margins.left), l && (e.position.left = p._convertPositionTo("relative", {top: 0, left: m - p.helperProportions.width}).left - p.margins.left)), !p.snapElements[t].snapping && (d || f || h || l || v) && p.options.snap.snap && p.options.snap.snap.call(p.element,
        b, a.extend(p._uiHash(), {snapItem: p.snapElements[t].item})), p.snapElements[t].snapping = d || f || h || l || v) : (p.snapElements[t].snapping && p.options.snap.release && p.options.snap.release.call(p.element, b, a.extend(p._uiHash(), {snapItem: p.snapElements[t].item})), p.snapElements[t].snapping = !1)
    }});
    a.ui.plugin.add("draggable", "stack", {start: function () {
      var b, e = a(this).data("ui-draggable").options, e = a.makeArray(a(e.stack)).sort(function (b, e) {
        return(parseInt(a(b).css("zIndex"), 10) || 0) - (parseInt(a(e).css("zIndex"),
          10) || 0)
      });
      e.length && (b = parseInt(e[0].style.zIndex, 10) || 0, a(e).each(function (a) {
        this.style.zIndex = b + a
      }), this[0].style.zIndex = b + e.length)
    }});
    a.ui.plugin.add("draggable", "zIndex", {start: function (b, e) {
      var d = a(e.helper), f = a(this).data("ui-draggable").options;
      d.css("zIndex") && (f._zIndex = d.css("zIndex"));
      d.css("zIndex", f.zIndex)
    }, stop: function (b, e) {
      var d = a(this).data("ui-draggable").options;
      d._zIndex && a(e.helper).css("zIndex", d._zIndex)
    }})
  })(d)
});
define("jqueryui/droppable", ["jquery", "./core", "./widget", "./mouse", "./draggable"], function (d) {
  (function (a, d) {
    a.widget("ui.droppable", {version: "1.10.0", widgetEventPrefix: "drop", options: {accept: "*", activeClass: !1, addClasses: !0, greedy: !1, hoverClass: !1, scope: "default", tolerance: "intersect", activate: null, deactivate: null, drop: null, out: null, over: null}, _create: function () {
      var b = this.options, e = b.accept;
      this.isover = !1;
      this.isout = !0;
      this.accept = a.isFunction(e) ? e : function (a) {
        return a.is(e)
      };
      this.proportions =
      {width: this.element[0].offsetWidth, height: this.element[0].offsetHeight};
      a.ui.ddmanager.droppables[b.scope] = a.ui.ddmanager.droppables[b.scope] || [];
      a.ui.ddmanager.droppables[b.scope].push(this);
      b.addClasses && this.element.addClass("ui-droppable")
    }, _destroy: function () {
      for (var b = 0, e = a.ui.ddmanager.droppables[this.options.scope]; b < e.length; b++)e[b] === this && e.splice(b, 1);
      this.element.removeClass("ui-droppable ui-droppable-disabled")
    }, _setOption: function (b, e) {
      "accept" === b && (this.accept = a.isFunction(e) ? e :
        function (a) {
          return a.is(e)
        });
      a.Widget.prototype._setOption.apply(this, arguments)
    }, _activate: function (b) {
      var e = a.ui.ddmanager.current;
      this.options.activeClass && this.element.addClass(this.options.activeClass);
      e && this._trigger("activate", b, this.ui(e))
    }, _deactivate: function (b) {
      var e = a.ui.ddmanager.current;
      this.options.activeClass && this.element.removeClass(this.options.activeClass);
      e && this._trigger("deactivate", b, this.ui(e))
    }, _over: function (b) {
      var e = a.ui.ddmanager.current;
      e && (e.currentItem || e.element)[0] !==
        this.element[0] && this.accept.call(this.element[0], e.currentItem || e.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), this._trigger("over", b, this.ui(e)))
    }, _out: function (b) {
      var e = a.ui.ddmanager.current;
      e && (e.currentItem || e.element)[0] !== this.element[0] && this.accept.call(this.element[0], e.currentItem || e.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("out", b, this.ui(e)))
    }, _drop: function (b, e) {
      var d = e || a.ui.ddmanager.current,
        f = !1;
      if (!d || (d.currentItem || d.element)[0] === this.element[0])return!1;
      this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function () {
        var b = a.data(this, "ui-droppable");
        if (b.options.greedy && !b.options.disabled && b.options.scope === d.options.scope && b.accept.call(b.element[0], d.currentItem || d.element) && a.ui.intersect(d, a.extend(b, {offset: b.element.offset()}), b.options.tolerance))return f = !0, !1
      });
      return f ? !1 : this.accept.call(this.element[0], d.currentItem || d.element) ? (this.options.activeClass &&
        this.element.removeClass(this.options.activeClass), this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", b, this.ui(d)), this.element) : !1
    }, ui: function (a) {
      return{draggable: a.currentItem || a.element, helper: a.helper, position: a.position, offset: a.positionAbs}
    }});
    a.ui.intersect = function (a, e, d) {
      if (!e.offset)return!1;
      var f = (a.positionAbs || a.position.absolute).left, h = f + a.helperProportions.width, l = (a.positionAbs || a.position.absolute).top, n = l + a.helperProportions.height,
        m = e.offset.left, s = m + e.proportions.width, r = e.offset.top, t = r + e.proportions.height;
      switch (d) {
        case "fit":
          return m <= f && h <= s && r <= l && n <= t;
        case "intersect":
          return m < f + a.helperProportions.width / 2 && h - a.helperProportions.width / 2 < s && r < l + a.helperProportions.height / 2 && n - a.helperProportions.height / 2 < t;
        case "pointer":
          return d = (a.positionAbs || a.position.absolute).left + (a.clickOffset || a.offset.click).left, a = (a.positionAbs || a.position.absolute).top + (a.clickOffset || a.offset.click).top, a > r && a < r + e.proportions.height &&
            d > m && d < m + e.proportions.width;
        case "touch":
          return(l >= r && l <= t || n >= r && n <= t || l < r && n > t) && (f >= m && f <= s || h >= m && h <= s || f < m && h > s);
        default:
          return!1
      }
    };
    a.ui.ddmanager = {current: null, droppables: {"default": []}, prepareOffsets: function (b, e) {
      var d, f, h = a.ui.ddmanager.droppables[b.options.scope] || [], l = e ? e.type : null, n = (b.currentItem || b.element).find(":data(ui-droppable)").addBack();
      d = 0;
      a:for (; d < h.length; d++)if (!(h[d].options.disabled || b && !h[d].accept.call(h[d].element[0], b.currentItem || b.element))) {
        for (f = 0; f < n.length; f++)if (n[f] ===
          h[d].element[0]) {
          h[d].proportions.height = 0;
          continue a
        }
        h[d].visible = "none" !== h[d].element.css("display");
        h[d].visible && ("mousedown" === l && h[d]._activate.call(h[d], e), h[d].offset = h[d].element.offset(), h[d].proportions = {width: h[d].element[0].offsetWidth, height: h[d].element[0].offsetHeight})
      }
    }, drop: function (b, e) {
      var d = !1;
      a.each(a.ui.ddmanager.droppables[b.options.scope] || [], function () {
        this.options && (!this.options.disabled && this.visible && a.ui.intersect(b, this, this.options.tolerance) && (d = this._drop.call(this,
          e) || d), !this.options.disabled && this.visible && this.accept.call(this.element[0], b.currentItem || b.element) && (this.isout = !0, this.isover = !1, this._deactivate.call(this, e)))
      });
      return d
    }, dragStart: function (b, e) {
      b.element.parentsUntil("body").bind("scroll.droppable", function () {
        b.options.refreshPositions || a.ui.ddmanager.prepareOffsets(b, e)
      })
    }, drag: function (b, e) {
      b.options.refreshPositions && a.ui.ddmanager.prepareOffsets(b, e);
      a.each(a.ui.ddmanager.droppables[b.options.scope] || [], function () {
        if (!this.options.disabled && !this.greedyChild && this.visible) {
          var d, f, h;
          h = a.ui.intersect(b, this, this.options.tolerance);
          var l = !h && this.isover ? "isout" : h && !this.isover ? "isover" : null;
          l && (this.options.greedy && (f = this.options.scope, h = this.element.parents(":data(ui-droppable)").filter(function () {
            return a.data(this, "ui-droppable").options.scope === f
          }), h.length && (d = a.data(h[0], "ui-droppable"), d.greedyChild = "isover" === l)), d && "isover" === l && (d.isover = !1, d.isout = !0, d._out.call(d, e)), this[l] = !0, this["isout" === l ? "isover" : "isout"] = !1, this["isover" ===
            l ? "_over" : "_out"].call(this, e), d && "isout" === l && (d.isout = !1, d.isover = !0, d._over.call(d, e)))
        }
      })
    }, dragStop: function (b, e) {
      b.element.parentsUntil("body").unbind("scroll.droppable");
      b.options.refreshPositions || a.ui.ddmanager.prepareOffsets(b, e)
    }}
  })(d)
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, e) {
    function f() {
      this.constructor = a
    }

    for (var k in e)d.call(e, k) && (a[k] = e[k]);
    f.prototype = e.prototype;
    a.prototype = new f;
    a.__super__ = e.prototype;
    return a
  }, f = [].indexOf || function (a) {
    for (var e = 0, d = this.length; e < d; e++)if (e in this && this[e] === a)return e;
    return-1
  };
  define("views/member/member-involve/index", ["view", "views/member/member-menu/index", "./templates/basic", "./templates/list", "jqueryui/droppable"], function (b, e, d, k) {
    var h;
    return function (b) {
      function n() {
        return h =
          n.__super__.constructor.apply(this, arguments)
      }

      a(n, b);
      n.prototype.viewName = "MemberInvolveView";
      n.prototype.tagName = "div";
      n.prototype.className = "involve-view handler-group pull-left";
      n.prototype.events = {click: "openMemberMenu"};
      n.prototype.initialize = function (a) {
        var b;
        if (null != a && a.objectModel && null != a && a.membersCollection)return this.options = a, (b = this.options).gta || (b.gta = {involveMemberLabel: "involve member"}), this.reset(a.objectModel, a.membersCollection), this.$el.html(d(a)), this.setInvolve().render().initDroppable(),
          this
      };
      n.prototype.reset = function (a, b) {
        this.objectModel = a;
        this.membersCollection = b;
        this.listenTo(this.objectModel, "change:involveMembers", this.refresh);
        this.listenTo(this.membersCollection, "change", this.render);
        return this
      };
      n.prototype.setInvolve = function () {
        var a;
        this.involves = this.objectModel.get("involveMembers");
        null != (a = this.involves) && a.length || (this.involves = this.options.resident || []);
        return this
      };
      n.prototype.render = function () {
        var a, b, e, d, f, g;
        a = {asList: null != (e = this.options.$list) ? e.length : void 0,
          members: [], type: this.options.type};
        f = this.involves;
        e = 0;
        for (d = f.length; e < d; e++)b = f[e], b = null != (g = this.membersCollection.get(b)) ? g.toJSON() : void 0, null != b && b._id && a.members.push(b);
        a.asList ? this.options.$list.html(k(a)) : 1 >= a.members.length ? this.$(".add-involvement-handler").html($('<i class="icon icon-involve"></i>')) : this.$(".add-involvement-handler").html(k(a));
        return this
      };
      n.prototype.openMemberMenu = function () {
        var a, b, d = this;
        b = _.extend(this.options, {multi: !0, selected: this.involves, select: function (a) {
          return d.addMember(a)
        },
          unselect: function (a) {
            return d.removeMember(a)
          }, selectAll: function (a) {
            return d.involveAll(a)
          }, close: function () {
            return d.saveInvolve()
          }, collection: this.membersCollection, type: this.options.type});
        a = this.$(".add-involvement-handler");
        this.requestSubView(e, b).setup(a, b);
        return this
      };
      n.prototype.refresh = function (a) {
        _.isArray(a) && a ? this.involves = a : this.involves = _.union(this.objectModel.get("involveMembers"), this.involves);
        this.render();
        return this
      };
      n.prototype.ensurePermission = function (a, b) {
        var e, d;
        e = 0 <=
          f.call(this.involves, a) ? "unselect" : "select";
        return this.options.uneditable || a === (null != (d = this.objectModel) ? d.get("_creatorId") : void 0) && 0 <= f.call(this.objectModel.get("involveMembers"), a) || "unselect" === e && this.options.undeletable && 0 <= f.call(this.objectModel.get("involveMembers"), a) ? !1 : b(e)
      };
      n.prototype.addMember = function (a, b) {
        var e = this;
        this.objectModel ? this.ensurePermission(a, function () {
          return e.addInvolve(a, b)
        }) : this.addInvolve(a, b);
        return this
      };
      n.prototype.removeMember = function (a, b) {
        var e = this;
        this.objectModel ? this.ensurePermission(a, function () {
          return e.removeInvolve(a, b)
        }) : this.removeInvolve(a, b);
        return this
      };
      n.prototype.involveAll = function (a) {
        this.involves = a;
        this.render();
        return this
      };
      n.prototype.addInvolve = function (a, b) {
        this.involves = _.union(this.involves, a);
        this.render();
        b && this.fadeInAvatar(a);
        return this
      };
      n.prototype.removeInvolve = function (a, b) {
        var e, d = this;
        e = function () {
          d.involves = _.without(d.involves, a);
          return d.render()
        };
        b ? this.fadeOutAvatar(a, e) : e();
        return this
      };
      n.prototype.saveInvolve =
        function () {
          var a, b;
          if (null != (b = this.objectModel) && "function" === typeof b[a = this.objectModel.id ? "save" : "set"])b[a]({involveMembers: this.involves.slice(0)});
          return this
        };
      n.prototype.fadeInAvatar = function (a) {
        this.options.$list.find(".avatar" + a).transition({opacity: 0}, 0).transition({opacity: 1});
        return this
      };
      n.prototype.fadeOutAvatar = function (a, b) {
        this.options.$list.find(".avatar" + a).transition({opacity: 0}, function () {
          b.call(this);
          return $(this).remove()
        });
        return this
      };
      n.prototype.initDroppable = function () {
        var a =
          this;
        (this.options.dropArea ? this.options.dropArea : this.options.$list ? this.options.$list : this.$el).droppable({hoverClass: "hover", accept: ".member", drop: function (b, e) {
          var d;
          return null != (d = a.objectModel) ? d[a.objectModel.id ? "save" : "set"]({involveMembers: a.involves.slice(0)}) : void 0
        }, over: function (b, e) {
          var d;
          d = e.helper.data("id");
          return a.addMember(d, !0)
        }, out: function (b, e) {
          var d;
          d = e.helper.data("id");
          return a.removeMember(d, !0)
        }});
        return this
      };
      return n
    }(b)
  })
}).call(this);
define("views/core/mover/templates/basic", [], function () {
  return function (d) {
    var a = "", f = d.collection;
    if (f)for (var b, e = -1, g = f.length - 1; e < g;)b = f[e += 1], a += ' <li class="collection-item ', b._id === d._modelId && (a += "selected"), a += '" data-id="' + b._id + '"> <a>' + b.title + "</a> </li>";
    return a
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/core/mover/index", ["dropdown-view", "warehouse", "./templates/basic"], function (d, b, e) {
    var g;
    return function (d) {
      function f() {
        return g = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "MoverView";
      f.prototype.className = "work-mover";
      f.prototype.events = {"click .collection-item": "moveToCollection"};
      f.prototype.initialize = function (a) {
        if (null != a && a._projectId && a.collection)return this.options = a, this.model = a.model, a.$opener && this.setup(a.$opener), this
      };
      f.prototype.onOpen = function () {
        f.__super__.onOpen.apply(this, arguments);
        this.load();
        return this
      };
      f.prototype.load = function () {
        var a = this;
        b.request(this.options.collection, this.options._projectId, {success: function (b) {
          a.collection = b;
          return a.render()
        }});
        return this
      };
      f.prototype.render = function () {
        var a;
        this.$el.html(e({_modelId: null != (a = this.model) ? a.id :
          void 0, collection: this.collection.toJSON()}));
        return this
      };
      f.prototype.moveToCollection = function (a) {
        var b, e = this;
        a = $(a.currentTarget).data("id");
        if (a !== (null != (b = this.model) ? b.getParentId() : void 0))return this.options.select ? this.options.select(this.collection.get(a)) : this.model.moveToCollection(a, {beforeSend: function () {
        }, success: function (a, b) {
          var d;
          return"function" === typeof(d = e.options).moverSuccess ? d.moverSuccess(a, b) : void 0
        }, error: function () {
        }}), this
      };
      return f
    }(d)
  })
}).call(this);
(function (d, a) {
  var f = function (a, e) {
    var f = {}, k = function (a, b) {
      var e, d, f;
      if ("string" === typeof a)return l(a);
      e = [];
      d = a.length;
      for (f = 0; f < d; f++)e.push(l(a[f]));
      return b.apply(null, e)
    }, h = function (a, b, d) {
      2 === arguments.length && (d = b, b = null);
      if ("string" !== typeof a || !d)throw Error("Define Error");
      k(b || [], function () {
        var b = arguments, h = {exports: d};
        "function" === typeof d && (b.length || (b = [k, h.exports, h]), b = d.apply(null, b), b !== e && (h.exports = b));
        f[a] = h.exports
      })
    }, l = function (e) {
      var d = f[e] || a[e];
      if (!d)throw Error("`" + e +
        "` is undefined");
      return d
    };
    h("base", ["jQuery"], function (a) {
      function b(a, e) {
        return function () {
          return a.apply(e, arguments)
        }
      }

      function e(a) {
        var b;
        if (Object.create)return Object.create(a);
        b = function () {
        };
        b.prototype = a;
        return new b
      }

      var f = function () {
      }, g = Function.call, h = a.Deferred, k = a.when, l = function (a) {
        var b = {}, e = a.match(/WebKit\/([\d.]+)/), d = a.match(/Chrome\/([\d.]+)/) || a.match(/CriOS\/([\d.]+)/), f = a.match(/MSIE\s([\d.]+)/), g = a.match(/Firefox\/([\d.]+)/), h = a.match(/Safari\/([\d.]+)/);
        a = a.match(/OPR\/([\d.]+)/);
        e && (b.webkit = parseFloat(e[1]));
        d && (b.chrome = parseFloat(d[1]));
        f && (b.ie = parseFloat(f[1]));
        g && (b.firefox = parseFloat(g[1]));
        h && (b.safari = parseFloat(h[1]));
        a && (b.opera = parseFloat(a[1]));
        return b
      }(navigator.userAgent), m;
      m = d.console ? b(console.log, console) : f;
      return{version: "0.1.0", $: a, Deferred: h, isPromise: function (a) {
        return a && "function" === typeof a.then
      }, when: k, browser: l, inherits: function (b, d, f) {
        var g;
        "function" === typeof d ? (g = d, d = null) : g = d && d.hasOwnProperty("constructor") ? d.constructor : function () {
          return b.apply(this,
            arguments)
        };
        a.extend(!0, g, b, f || {});
        g.__super__ = b.prototype;
        g.prototype = e(b.prototype);
        d && a.extend(!0, g.prototype, d);
        return g
      }, noop: f, bindFn: b, log: m, nextTick: function () {
        return function (a) {
          setTimeout(a, 1)
        }
      }(), slice: function (a) {
        return function () {
          return g.apply(a, arguments)
        }
      }([].slice), guid: function () {
        var a = 0;
        return function (b) {
          for (var e = (+new Date).toString(32), d = 0; 5 > d; d++)e += Math.floor(65535 * Math.random()).toString(32);
          return(b || "wu_") + e + (a++).toString(32)
        }
      }(), formatSize: function (a, b, e) {
        var d;
        for (e =
               e || ["B", "K", "M", "G", "TB"]; (d = e.shift()) && 1024 < a;)a /= 1024;
        return("B" === d ? a : a.toFixed(b || 2)) + d
      }}
    });
    h("mediator", ["base"], function (a) {
      function b(a, e, d, g) {
        return f.grep(a, function (a) {
          return a && (!e || a.e === e) && (!d || a.cb === d || a.cb._cb === d) && (!g || a.ctx === g)
        })
      }

      function e(a, b, d) {
        f.each((a || "").split(h), function (a, e) {
          d(e, b)
        })
      }

      function d(a, b) {
        for (var e = !1, f = -1, g = a.length, h; ++f < g;)if (h = a[f], !1 === h.cb.apply(h.ctx2, b)) {
          e = !0;
          break
        }
        return!e
      }

      var f = a.$, g = [].slice, h = /\s+/, k;
      k = {on: function (a, b, d) {
        var f = this, g;
        if (!b)return this;
        g = this._events || (this._events = []);
        e(a, b, function (a, b) {
          var e = {e: a};
          e.cb = b;
          e.ctx = d;
          e.ctx2 = d || f;
          e.id = g.length;
          g.push(e)
        });
        return this
      }, once: function (a, b, d) {
        var f = this;
        if (!b)return f;
        e(a, b, function (a, b) {
          var e = function () {
            f.off(a, e);
            return b.apply(d || f, arguments)
          };
          e._cb = b;
          f.on(a, e, d)
        });
        return f
      }, off: function (a, d, g) {
        var h = this._events;
        if (!h)return this;
        if (!a && !d && !g)return this._events = [], this;
        e(a, d, function (a, e) {
          f.each(b(h, a, e, g), function () {
            delete h[this.id]
          })
        });
        return this
      }, trigger: function (a) {
        var e, f,
          h;
        if (!this._events || !a)return this;
        e = g.call(arguments, 1);
        f = b(this._events, a);
        h = b(this._events, "all");
        return d(f, e) && d(h, arguments)
      }};
      return f.extend({installTo: function (a) {
        return f.extend(a, k)
      }}, k)
    });
    h("uploader", ["base", "mediator"], function (a, b) {
      function e(a) {
        this.options = d.extend(!0, {}, e.options, a);
        this._init(this.options)
      }

      var d = a.$;
      e.options = {};
      b.installTo(e.prototype);
      d.each({upload: "start-upload", stop: "stop-upload", getFile: "get-file", getFiles: "get-files", removeFile: "remove-file", skipFile: "skip-file",
        retry: "retry", isInProgress: "is-in-progress", makeThumb: "make-thumb", getDimension: "get-dimension", addButton: "add-btn", getRuntimeType: "get-runtime-type", refresh: "refresh", disable: "disable", enable: "enable"}, function (a, b) {
        e.prototype[a] = function () {
          return this.request(b, arguments)
        }
      });
      d.extend(e.prototype, {state: "pending", _init: function (a) {
        var b = this;
        b.request("init", a, function () {
          b.state = "ready";
          b.trigger("ready")
        })
      }, option: function (a, b) {
        var e = this.options;
        if (1 < arguments.length)d.isPlainObject(b) && d.isPlainObject(e[a]) ?
          d.extend(e[a], b) : e[a] = b; else return a ? e[a] : e
      }, getStats: function () {
        var a = this.request("get-stats");
        return{successNum: a.numOfSuccess, cancelNum: a.numOfCancel, invalidNum: a.numOfInvalid, uploadFailNum: a.numOfUploadFailed, queueNum: a.numOfQueue}
      }, trigger: function (a) {
        var e = [].slice.call(arguments, 1), f = this.options, g = "on" + a.substring(0, 1).toUpperCase() + a.substring(1);
        return!1 === b.trigger.apply(this, arguments) || d.isFunction(f[g]) && !1 === f[g].apply(this, e) || d.isFunction(this[g]) && !1 === this[g].apply(this, e) ? !1 :
          !0
      }, request: a.noop, reset: function () {
      }});
      a.create = e.create = function (a) {
        return new e(a)
      };
      return a.Uploader = e
    });
    h("runtime/runtime", ["base", "mediator"], function (a, b) {
      function e(b) {
        this.options = d.extend({container: document.body}, b);
        this.uid = a.guid("rt_")
      }

      var d = a.$, f = {}, g = function (a) {
        for (var b in a)if (a.hasOwnProperty(b))return b;
        return null
      };
      d.extend(e.prototype, {getContainer: function () {
        var a, b;
        if (this._container)return this._container;
        a = this.options.container || d(document.body);
        b = d(document.createElement("div"));
        b.attr("id", "rt_" + this.uid);
        b.css({position: "absolute", top: "0px", left: "0px", bottom: "0px", right: "0px", overflow: "hidden"});
        a.append(b);
        a.addClass("webuploader-container");
        return this._container = b
      }, init: a.noop, exec: a.noop, destroy: function () {
        this._container && this._container.parentNode.removeChild(this.__container);
        this.off()
      }});
      e.orders = "html5,flash";
      e.addRuntime = function (a, b) {
        f[a] = b
      };
      e.hasRuntime = function (a) {
        return!(a ? !f[a] : !g(f))
      };
      e.create = function (a, b) {
        var h;
        b = b || e.orders;
        d.each(b.split(/\s*,\s*/g),
          function () {
            if (f[this])return h = this, !1
          });
        h = h || g(f);
        if (!h)throw Error("Runtime Error");
        return new f[h](a)
      };
      b.installTo(e.prototype);
      return e
    });
    h("runtime/client", ["base", "mediator", "runtime/runtime"], function (a, b, e) {
      function d(b, g) {
        var h = a.Deferred(), k;
        this.uid = a.guid("client_");
        this.runtimeReady = function (a) {
          return h.done(a)
        };
        this.connectRuntime = function (a, b) {
          if (!k) {
            h.done(b);
            "string" === typeof a && f.get(a) ? k = f.get(a) : !g && f.has() && (k = f.get());
            if (!k)return k = e.create(a, a.runtimeOrder), f.add(k), k.promise =
              h.promise(), k.once("ready", h.resolve), k.init(), k.client = 1, k;
            k.promise.then(h.resolve);
            k.client++;
            return k
          }
        };
        this.getRuntime = function () {
          return k
        };
        this.disconnectRuntime = function () {
          k && (k.client--, 0 >= k.client && (f.remove(k), delete k.promise, k.destroy()), k = null)
        };
        this.exec = function () {
          if (k) {
            var e = a.slice(arguments);
            b && e.unshift(b);
            return k.exec.apply(this, e)
          }
        };
        this.getRuid = function () {
          return k && k.uid
        };
        this.destroy = function (a) {
          return function () {
            a && a.apply(this, arguments);
            this.trigger("destroy");
            this.off();
            this.exec("destroy");
            this.disconnectRuntime()
          }
        }(this.destroy)
      }

      var f = function () {
        var a = {};
        return{add: function (b) {
          a[b.uid] = b
        }, get: function (b) {
          var e;
          if (b)return a[b];
          for (e in a)return a[e];
          return null
        }, remove: function (b) {
          delete a[b.uid]
        }, has: function () {
          return!!this.get.apply(this, arguments)
        }}
      }();
      b.installTo(d.prototype);
      return d
    });
    h("lib/blob", ["base", "runtime/client"], function (a, b) {
      function e(a, d) {
        this.source = d;
        this.ruid = a;
        b.call(this, "Blob");
        this.uid = d.uid || this.uid;
        this.type = d.type || "";
        this.size = d.size ||
          0;
        a && this.connectRuntime(a)
      }

      a.inherits(b, {constructor: e, slice: function (a, b) {
        return this.exec("slice", a, b)
      }, getSource: function () {
        return this.source
      }});
      return e
    });
    h("lib/file", ["base", "lib/blob"], function (a, b) {
      function e(a, g) {
        var h;
        b.apply(this, arguments);
        this.name = g.name || "untitled" + d++;
        h = f.exec(g.name) ? RegExp.$1.toLowerCase() : "";
        !this.type && ~"jpg,jpeg,png,gif,bmp".indexOf(h) && (this.type = "image/" + h);
        this.ext = h;
        this.lastModifiedDate = g.lastModifiedDate || (new Date).toLocaleString()
      }

      var d = 0, f = /\.([^.]+)$/;
      return a.inherits(b, e)
    });
    h("lib/filepicker", ["base", "runtime/client", "lib/file"], function (a, b, e) {
      function f(a) {
        a = this.options = g.extend({}, f.options, a);
        a.container = g(a.id);
        if (!a.container.length)throw Error("");
        a.label = a.label || a.container.html() || " ";
        a.button = g(a.button || document.createElement("div"));
        a.button.html(a.label);
        a.container.html(a.button);
        b.call(this, "FilePicker", !0)
      }

      var g = a.$;
      f.options = {button: null, container: null, label: null, multiple: !0, accept: null};
      a.inherits(b, {constructor: f, init: function () {
        var a =
          this, b = a.options, f = b.button;
        f.addClass("webuploader-pick");
        a.on("all", function (b) {
          switch (b) {
            case "mouseenter":
              f.addClass("webuploader-pick-hover");
              break;
            case "mouseleave":
              f.removeClass("webuploader-pick-hover");
              break;
            case "change":
              b = a.exec("getFiles"), a.trigger("select", g.map(b, function (b) {
                return new e(a.getRuid(), b)
              }))
          }
        });
        a.connectRuntime(b, function () {
          a.refresh();
          a.exec("init", b)
        });
        g(d).on("resize", function () {
          a.refresh()
        })
      }, refresh: function () {
        var a = this.getRuntime().getContainer(), b = this.options.button,
          e = b.outerWidth(), d = b.outerHeight(), b = b.offset();
        e && d && a.css({bottom: "auto", right: "auto", width: e + "px", height: d + "px"}).offset(b)
      }, destroy: function () {
        this.runtime && (this.exec("destroy"), this.disconnectRuntime())
      }});
      return f
    });
    h("widgets/widget", ["base", "uploader"], function (a, b) {
      function e(a) {
        if (!a)return!1;
        var b = a.length, d = f.type(a);
        return 1 === a.nodeType && b ? !0 : "array" === d || "function" !== d && "string" !== d && (0 === b || "number" === typeof b && 0 < b && b - 1 in a)
      }

      function d(a) {
        this.owner = a;
        this.options = a.options
      }

      var f =
        a.$, g = b.prototype._init, h = {}, k = [];
      f.extend(d.prototype, {init: a.noop, invoke: function (a, b) {
        var e = this.responseMap;
        return e && a in e && e[a]in this && f.isFunction(this[e[a]]) ? this[e[a]].apply(this, b) : h
      }, request: function () {
        return this.owner.request.apply(this.owner, arguments)
      }});
      f.extend(b.prototype, {_init: function () {
        var a = this, b = a._widgets = [];
        f.each(k, function (e, d) {
          b.push(new d(a))
        });
        return g.apply(a, arguments)
      }, request: function (b, d, f) {
        var g = 0, k = this._widgets, l = k.length, m = [], n = [], r;
        for (d = e(d) ? d : [d]; g < l; g++)r =
          k[g], r = r.invoke(b, d), r !== h && (a.isPromise(r) ? n.push(r) : m.push(r));
        return f || n.length ? a.when.apply(a, n).then(function () {
          var b = a.Deferred(), e = arguments;
          setTimeout(function () {
            b.resolve.apply(b, e)
          }, 1);
          return b.promise()
        }).then(f || a.noop) : m[0]
      }});
      b.register = d.register = function (b, e) {
        var g = {init: "init"};
        1 === arguments.length ? (e = b, e.responseMap = g) : e.responseMap = f.extend(g, b);
        g = a.inherits(d, e);
        k.push(g);
        return g
      };
      return d
    });
    h("widgets/filepicker", ["base", "uploader", "lib/filepicker", "widgets/widget"], function (a, b, e) {
      var d = a.$;
      d.extend(b.options, {pick: null, accept: null});
      return b.register({"add-btn": "addButton", refresh: "refresh"}, {init: function (a) {
        this.pickers = [];
        return a.pick && this.addButton(a.pick)
      }, refresh: function () {
        d.each(this.pickers, function () {
          this.refresh()
        })
      }, addButton: function (b) {
        var f = this, g = f.options, h = g.accept, k;
        if (b)return k = a.Deferred(), "string" === typeof b && (b = {id: b}), b = d.extend({}, b, {accept: d.isPlainObject(h) ? [h] : h, swf: g.swf, runtimeOrder: g.runtimeOrder}), b = new e(b), b.once("ready", k.resolve),
          b.on("select", function (a) {
            f.owner.request("add-file", [a])
          }), b.init(), this.pickers.push(b), k.promise()
      }})
    });
    h("file", ["base", "mediator"], function (a, b) {
      function e(a) {
        this.name = a.name || "Untitled";
        this.size = a.size || 0;
        this.type = a.type || "application";
        this.lastModifiedDate = a.lastModifiedDate || 1 * new Date;
        this.id = d + f++;
        this.ext = g.exec(this.name) ? RegExp.$1 : "";
        this.statusText = "";
        h[this.id] = e.Status.INITED;
        this.source = a;
        this.loaded = 0;
        this.on("error", function (a) {
          this.setStatus(e.Status.ERROR, a)
        })
      }

      var d = "WU_FILE_",
        f = 0, g = /\.([^.]+)$/, h = {};
      a.$.extend(e.prototype, {setStatus: function (a, b) {
        var e = h[this.id];
        "undefined" !== typeof b && (this.statusText = b);
        a !== e && (h[this.id] = a, this.trigger("statuschange", a, e))
      }, getStatus: function () {
        return h[this.id]
      }, getSource: function () {
        return this.source
      }, destory: function () {
        delete h[this.id]
      }});
      b.installTo(e.prototype);
      e.Status = {INITED: "inited", QUEUED: "queued", PROGRESS: "progress", ERROR: "error", COMPLETE: "complete", CANCELLED: "cancelled", INTERRUPT: "interrupt", INVALID: "invalid"};
      return e
    });
    h("lib/dnd", ["base", "mediator", "runtime/client"], function (a, b, e) {
      function d(a) {
        a = this.options = f.extend({}, d.options, a);
        a.container = f(a.container);
        a.container.length && e.call(this, "DragAndDrop")
      }

      var f = a.$;
      d.options = {accept: null, disableGlobalDnd: !0};
      a.inherits(e, {constructor: d, init: function () {
        var a = this;
        a.connectRuntime(a.options, function () {
          a.exec("init")
        })
      }, destroy: function () {
        this.disconnectRuntime()
      }});
      b.installTo(d.prototype);
      return d
    });
    h("lib/filepaste", ["base", "mediator", "runtime/client"], function (a, b, e) {
      function d(a) {
        a = this.options = f.extend({}, a);
        a.container = f(a.container || document.body);
        e.call(this, "FilePaste")
      }

      var f = a.$;
      a.inherits(e, {constructor: d, init: function () {
        var a = this;
        a.connectRuntime(a.options, function () {
          a.exec("init")
        })
      }, destroy: function () {
        this.exec("destroy");
        this.disconnectRuntime();
        this.off()
      }});
      b.installTo(d.prototype);
      return d
    });
    h("lib/image", ["base", "runtime/client", "lib/blob"], function (a, b, e) {
      function d(a) {
        this.options = f.extend({}, d.options, a);
        b.call(this, "Image");
        this.on("load",
          function () {
            this._info = this.exec("info");
            this._meta = this.exec("meta")
          })
      }

      var f = a.$;
      d.options = {quality: 90, crop: !1, preserveHeaders: !0, allowMagnify: !0};
      a.inherits(b, {constructor: d, info: function (a) {
        return a ? (this._info = a, this) : this._info
      }, meta: function (a) {
        return a ? (this._meta = a, this) : this._meta
      }, loadFromBlob: function (a) {
        var b = this, e = a.getRuid();
        this.connectRuntime(e, function () {
          b.exec("init", b.options);
          b.exec("loadFromBlob", a)
        })
      }, resize: function () {
        var b = a.slice(arguments);
        return this.exec.apply(this, ["resize"].concat(b))
      },
        getAsDataUrl: function (a) {
          return this.exec("getAsDataUrl", a)
        }, getAsBlob: function (a) {
          a = this.exec("getAsBlob", a);
          return new e(this.getRuid(), a)
        }});
      return d
    });
    h("lib/transport", ["base", "runtime/client", "mediator"], function (a, b, e) {
      function d(a) {
        var e = this;
        a = e.options = f.extend(!0, {}, d.options, a || {});
        b.call(this, "Transport");
        this._blob = null;
        this._formData = a.formData || {};
        this._headers = a.headers || {};
        this.on("progress", this._timeout);
        this.on("load error", function () {
          e.trigger("progress", 1);
          clearTimeout(e._timer)
        })
      }

      var f = a.$;
      d.options = {server: "", method: "POST", withCredentials: !1, fileVar: "file", timeout: 12E4, formData: {}, headers: {}, sendAsBinary: !1};
      f.extend(d.prototype, {appendBlob: function (a, b, e) {
        var d = this, f = d.options;
        d.getRuid() && d.disconnectRuntime();
        d.connectRuntime(b.ruid, function () {
          d.exec("init")
        });
        d._blob = b;
        f.fileVar = a || f.fileVar;
        f.filename = e || f.filename
      }, append: function (a, b) {
        "object" === typeof a ? f.extend(this._formData, a) : this._formData[a] = b
      }, setRequestHeader: function (a, b) {
        "object" === typeof a ? f.extend(this._headers,
          a) : this._headers[a] = b
      }, send: function (a) {
        this.exec("send", a);
        this._timeout()
      }, abort: function () {
        clearTimeout(this._timer);
        return this.exec("abort")
      }, destroy: function () {
        this.trigger("destroy");
        this.off();
        this.exec("destroy");
        this.disconnectRuntime()
      }, getResponse: function () {
        return this.exec("getResponse")
      }, getResponseAsJson: function () {
        return this.exec("getResponseAsJson")
      }, getStatus: function () {
        return this.exec("getStatus")
      }, _timeout: function () {
        var a = this, b = a.options.timeout;
        b && (clearTimeout(a._timer),
          a._timer = setTimeout(function () {
            a.abort();
            a.trigger("error", "timeout")
          }, b))
      }});
      e.installTo(d.prototype);
      return d
    });
    h("queue", ["base", "mediator", "file"], function (a, b, e) {
      function d() {
        this.stats = {numOfQueue: 0, numOfSuccess: 0, numOfCancel: 0, numOfProgress: 0, numOfUploadFailed: 0, numOfInvalid: 0};
        this._queue = [];
        this._map = {}
      }

      var f = a.$, g = e.Status;
      f.extend(d.prototype, {append: function (a) {
        this._queue.push(a);
        this._fileAdded(a);
        return this
      }, prepend: function (a) {
        this._queue.unshift(a);
        this._fileAdded(a);
        return this
      },
        getFile: function (a) {
          return"string" !== typeof a ? a : this._map[a]
        }, fetch: function (a) {
          var b = this._queue.length, e, d;
          a = a || g.QUEUED;
          for (e = 0; e < b; e++)if (d = this._queue[e], a === d.getStatus())return d;
          return null
        }, getFiles: function () {
          for (var a = [].slice.call(arguments, 0), b = [], e = 0, d = this._queue.length, g; e < d; e++)g = this._queue[e], a.length && !~f.inArray(g.getStatus(), a) || b.push(g);
          return b
        }, _fileAdded: function (a) {
          var b = this;
          this._map[a.id] || (this._map[a.id] = a, a.on("statuschange", function (a, e) {
            b._onFileStatusChange(a,
              e)
          }));
          a.setStatus(g.QUEUED)
        }, _onFileStatusChange: function (a, b) {
          var e = this.stats;
          switch (b) {
            case g.PROGRESS:
              e.numOfProgress--;
              break;
            case g.QUEUED:
              e.numOfQueue--;
              break;
            case g.ERROR:
              e.numOfUploadFailed--;
              break;
            case g.INVALID:
              e.numOfInvalid--
          }
          switch (a) {
            case g.QUEUED:
              e.numOfQueue++;
              break;
            case g.PROGRESS:
              e.numOfProgress++;
              break;
            case g.ERROR:
              e.numOfUploadFailed++;
              break;
            case g.COMPLETE:
              e.numOfSuccess++;
              break;
            case g.CANCELLED:
              e.numOfCancel++;
              break;
            case g.INVALID:
              e.numOfInvalid++
          }
        }});
      b.installTo(d.prototype);
      return d
    });
    h("runtime/compbase", function () {
      return function (a, b) {
        this.owner = a;
        this.options = a.options;
        this.getRuntime = function () {
          return b
        };
        this.getRuid = function () {
          return b.uid
        };
        this.trigger = function () {
          return a.trigger.apply(a, arguments)
        }
      }
    });
    h("runtime/html5/runtime", ["base", "runtime/runtime", "runtime/compbase"], function (a, b, e) {
      function f() {
        var e = {}, d = this, k = this.destory;
        b.apply(d, arguments);
        d.type = g;
        d.exec = function (b, f) {
          var g = this.uid, k = a.slice(arguments, 2);
          if (h[b] && (g = e[g] = e[g] || new h[b](this, d), g[f]))return g[f].apply(g,
            k)
        };
        d.destory = function () {
          return k && k.apply(this, arguments)
        }
      }

      var g = "html5", h = {};
      a.inherits(b, {constructor: f, init: function () {
        var a = this;
        setTimeout(function () {
          a.trigger("ready")
        }, 1)
      }});
      f.register = function (b, d) {
        return h[b] = a.inherits(e, d)
      };
      d.Blob && d.FileReader && d.DataView && b.addRuntime(g, f);
      return f
    });
    h("runtime/html5/blob", ["runtime/html5/runtime", "lib/blob"], function (a, b) {
      return a.register("Blob", {slice: function (a, e) {
        var d = this.owner.source, d = (d.slice || d.webkitSlice || d.mozSlice).call(d, a, e);
        return new b(this.getRuid(),
          d)
      }})
    });
    h("runtime/html5/dnd", ["base", "runtime/html5/runtime", "lib/file"], function (a, b, e) {
      var d = a.$;
      return b.register("DragAndDrop", {init: function () {
        var b = this.elem = this.options.container;
        this.dragEnterHandler = a.bindFn(this._dragEnterHandler, this);
        this.dragOverHandler = a.bindFn(this._dragOverHandler, this);
        this.dragLeaveHandler = a.bindFn(this._dragLeaveHandler, this);
        this.dropHandler = a.bindFn(this._dropHandler, this);
        this.dndOver = !1;
        b.on("dragenter", this.dragEnterHandler);
        b.on("dragover", this.dragOverHandler);
        b.on("dragleave", this.dragLeaveHandler);
        b.on("drop", this.dropHandler);
        this.options.disableGlobalDnd || (d(document).on("dragover", this.dragOverHandler), d(document).on("drop", this.dropHandler))
      }, _dragEnterHandler: function (a) {
        this.dndOver = !0;
        this.elem.addClass("webuploader-dnd-over");
        a = a.originalEvent || a;
        a.dataTransfer.dropEffect = "copy";
        return!1
      }, _dragOverHandler: function (a) {
        var b = this.elem.parent().get(0);
        if (b && !d.contains(b, a.target))return!1;
        this._dragEnterHandler.call(this, a);
        return!1
      }, _dragLeaveHandler: function () {
        var a =
          this;
        setTimeout(function () {
          a.dndOver || a.elem.removeClass("webuploader-dnd-over")
        }, 50);
        return this.dndOver = !1
      }, _dropHandler: function (b) {
        var f = [], g = [], h = this, k = h.getRuid(), l = h.elem.parent().get(0), m, n, r, t;
        if (l && !d.contains(l, b.target))return!1;
        b = b.originalEvent || b;
        l = b.dataTransfer;
        b = l.items;
        l = l.files;
        t = !(!b || !b[0].webkitGetAsEntry);
        n = 0;
        for (r = l.length; n < r; n++)m = l[n], m.type ? f.push(m) : !m.type && t && g.push(this._traverseDirectoryTree(b[n].webkitGetAsEntry(), f));
        a.when.apply(a, g).done(function () {
          h.trigger("drop",
            d.map(f, function (a) {
              return new e(k, a)
            }))
        });
        this.dndOver = !1;
        this.elem.removeClass("webuploader-dnd-over");
        return!1
      }, _traverseDirectoryTree: function (b, e) {
        var d = a.Deferred(), f = this;
        b.isFile ? b.file(function (a) {
          a.type && e.push(a);
          d.resolve(!0)
        }) : b.isDirectory && b.createReader().readEntries(function (b) {
          var g = b.length, h = [], k = [], l;
          for (l = 0; l < g; l++)h.push(f._traverseDirectoryTree(b[l], k));
          a.when.apply(a, h).then(function () {
            e.push.apply(e, k);
            d.resolve(!0)
          }, d.reject)
        });
        return d.promise()
      }, destroy: function () {
        var a =
          this.elem;
        a.off("dragenter", this.dragEnterHandler);
        a.off("dragover", this.dragEnterHandler);
        a.off("dragleave", this.dragLeaveHandler);
        a.off("drop", this.dropHandler);
        this.options.disableGlobalDnd && (d(document).off("dragover", this.dragOverHandler), d(document).off("drop", this.dropHandler))
      }})
    });
    h("runtime/html5/filepaste", ["base", "runtime/html5/runtime", "lib/file"], function (a, b, e) {
      return b.register("FilePaste", {init: function () {
        var b = this.options, e = this.elem = b.container, d = ".*", f, g, h, k;
        if (b.accept) {
          f = [];
          g = 0;
          for (h = b.accept.length; g < h; g++)(k = b.accept[g].mimeTypes) && f.push(k);
          f.length && (d = f.join(","), d = d.replace(/,/g, "|").replace(/\*/g, ".*"))
        }
        this.accept = RegExp(d, "i");
        this.hander = a.bindFn(this._pasteHander, this);
        e.on("paste", this.hander)
      }, _pasteHander: function (a) {
        var b = [], d = this.getRuid(), f, g, h, p, k;
        a = a.originalEvent || a;
        f = a.clipboardData.items;
        p = 0;
        for (k = f.length; p < k; p++)g = f[p], !g.type || !(h = g.getAsFile()) || 6 > h.size || b.push(new e(d, h));
        b.length && (a.preventDefault(), a.stopPropagation(), this.trigger("paste",
          b))
      }, destroy: function () {
        this.elem.off("paste", this.hander)
      }})
    });
    h("runtime/html5/filepicker", ["base", "runtime/html5/runtime"], function (a, b) {
      var e = a.$;
      return b.register("FilePicker", {init: function () {
        var a = this.getRuntime().getContainer(), b = this, d = b.owner, f = b.options, g = e(document.createElement("label")), h = e(document.createElement("input")), p, k, l, m;
        h.attr("type", "file");
        h.css({position: "absolute", clip: "rect(1px,1px,1px,1px)"});
        g.on("click", function () {
          h.trigger("click")
        });
        g.css({opacity: 0, width: "100%",
          height: "100%", display: "block", cursor: "pointer", background: "#ffffff"});
        f.multiple && h.attr("multiple", "multiple");
        if (f.accept && 0 < f.accept.length) {
          p = [];
          k = 0;
          for (l = f.accept.length; k < l; k++)p.push(f.accept[k].mimeTypes);
          h.attr("accept", p.join(","))
        }
        a.append(h);
        a.append(g);
        m = function (a) {
          d.trigger(a.type)
        };
        h.on("change", function (a) {
          var f = arguments.callee, g;
          b.files = a.target.files;
          g = this.cloneNode(!0);
          this.parentNode.replaceChild(g, this);
          h.off();
          h = e(g).on("change", f).on("mouseenter mouseleave", m);
          d.trigger("change")
        });
        g.on("mouseenter mouseleave", m)
      }, getFiles: function () {
        return this.files
      }, destroy: function () {
      }})
    });
    h("runtime/html5/util", function () {
      var a = d.createObjectURL && d || d.URL && URL.revokeObjectURL && URL || d.webkitURL;
      return{createObjectURL: a && a.createObjectURL, revokeObjectURL: a && a.revokeObjectURL, dataURL2Blob: function (a) {
        var b, e, d, f;
        f = a.split(",");
        b = ~f[0].indexOf("base64") ? atob(f[1]) : decodeURIComponent(f[1]);
        a = new ArrayBuffer(b.length);
        e = new Uint8Array(a);
        for (d = 0; d < b.length; d++)e[d] = b.charCodeAt(d);
        b = f[0].split(":")[1].split(";")[0];
        return new Blob([a], {type: b})
      }, dataURL2ArrayBuffer: function (a) {
        var b, e;
        a = a.split(",");
        a = ~a[0].indexOf("base64") ? atob(a[1]) : decodeURIComponent(a[1]);
        b = new Uint8Array(a.length);
        for (e = 0; e < a.length; e++)b[e] = a.charCodeAt(e);
        return b.buffer
      }, arrayBufferToBlob: function (a, b) {
        return new Blob([a], b ? {type: b} : {})
      }}
    });
    h("runtime/html5/imagemeta", function () {
      var a;
      return a = {parsers: {65505: []}, maxMetaDataSize: 262144, parse: function (a, b) {
        var e = this, d = new FileReader;
        d.onload = function () {
          b(!1, e._parse(this.result));
          d =
            d.onload = d.onerror = null
        };
        d.onerror = function (a) {
          b(a.message);
          d = d.onload = d.onerror = null
        };
        a = a.slice(0, e.maxMetaDataSize);
        d.readAsArrayBuffer(a.getSource())
      }, _parse: function (b, e) {
        if (!(6 > b.byteLength)) {
          var d = new DataView(b), f = 2, g = d.byteLength - 4, h = f, k = {}, l, m;
          if (65496 === d.getUint16(0)) {
            for (; f < g;)if (l = d.getUint16(f), 65504 <= l && 65519 >= l || 65534 === l) {
              m = d.getUint16(f + 2) + 2;
              if (f + m > d.byteLength)break;
              h = a.parsers[l];
              if (!e && h)for (l = 0; l < h.length; l += 1)h[l].call(a, d, f, m, k);
              h = f += m
            } else break;
            6 < h && (k.imageHead = b.slice ?
              b.slice(2, h) : (new Uint8Array(b)).subarray(2, h))
          }
          return k
        }
      }, updateImageHead: function (a, b) {
        var e = this._parse(a, !0), d;
        d = 2;
        e.imageHead && (d = 2 + e.imageHead.byteLength);
        d = a.slice ? a.slice(d) : (new Uint8Array(a)).subarray(d);
        e = new Uint8Array(b.byteLength + 2 + d.byteLength);
        e[0] = 255;
        e[1] = 216;
        e.set(new Uint8Array(b), 2);
        e.set(new Uint8Array(d), b.byteLength + 2);
        return e.buffer
      }}
    });
    h("runtime/html5/image", ["runtime/html5/runtime", "runtime/html5/util", "runtime/html5/imagemeta"], function (a, b, e) {
      return a.register("Image",
        {modified: !1, init: function () {
          var a = this, b = new Image;
          b.onload = function () {
            a._info = {type: a.type, width: this.width, height: this.height};
            !a._metas && ~"image/jpegimage/jpg".indexOf(a.type) ? e.parse(a._blob, function (b, e) {
              a._metas = e;
              a.owner.trigger("load")
            }) : a.owner.trigger("load")
          };
          b.onerror = function () {
            a.owner.trigger("error")
          };
          a._img = b
        }, loadFromBlob: function (a) {
          var e = this._img;
          this._blob = a;
          this.type = a.type;
          e.src = b.createObjectURL(a.getSource());
          this.owner.once("load", function () {
            b.revokeObjectURL(e.src)
          })
        },
          resize: function (a, b) {
            var e = this._canvas || (this._canvas = document.createElement("canvas"));
            this._resize(this._img, e, a, b);
            this._blob = null;
            this.modified = !0;
            this.owner.trigger("complete")
          }, getAsBlob: function (a) {
          var d = this._blob, f = this.options;
          a = a || this.type;
          if (this.modified || this.type !== a) {
            d = this._canvas;
            if ("image/jpeg" === a) {
              if (d = d.toDataURL("image/jpeg", f.quality / 100), f.preserveHeaders && this._metas && this._metas.imageHead)return d = b.dataURL2ArrayBuffer(d), d = e.updateImageHead(d, this._metas.imageHead), d =
                b.arrayBufferToBlob(d, a)
            } else d = d.toDataURL(a);
            d = b.dataURL2Blob(d)
          }
          return d
        }, getAsDataUrl: function (a) {
          var b = this.options;
          a = a || this.type;
          return"image/jpeg" === a ? this._canvas.toDataURL(a, b.quality / 100) : this._canvas.toDataURL(a)
        }, getOrientation: function () {
          return this._metas && this._metas.exif && this._metas.exif.get("Orientation") || 1
        }, info: function (a) {
          return a ? (this._info = a, this) : this._info
        }, meta: function (a) {
          return a ? (this._meta = a, this) : this._meta
        }, destroy: function () {
          var a = this._canvas;
          this._img.onload =
            null;
          a && (a.getContext("2d").clearRect(0, 0, a.width, a.height), a.width = a.height = 0, this._canvas = null);
          this._img.src = "data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D";
          this._img = this._blob = null
        }, _resize: function (a, b, e, d) {
          var f = this.options, g = a.width, h = a.height, p = this.getOrientation(), k;
          ~[5, 6, 7, 8].indexOf(p) && (e ^= d, d ^= e, e ^= d);
          k = Math[f.crop ? "max" : "min"](e / g, d / h);
          f.allowMagnify || (k = Math.min(1, k));
          g *= k;
          h *= k;
          f.crop ? (b.width = e, b.height = d) : (b.width = g, b.height = h);
          e = (b.width - g) / 2;
          d = (b.height - h) / 2;
          f.preserveHeaders ||
          this._rotate2Orientaion(b, p);
          this._renderImageToCanvas(b, a, e, d, g, h)
        }, _rotate2Orientaion: function (a, b) {
          var e = a.width, d = a.height, f = a.getContext("2d");
          switch (b) {
            case 5:
            case 6:
            case 7:
            case 8:
              a.width = d, a.height = e
          }
          switch (b) {
            case 2:
              f.translate(e, 0);
              f.scale(-1, 1);
              break;
            case 3:
              f.translate(e, d);
              f.rotate(Math.PI);
              break;
            case 4:
              f.translate(0, d);
              f.scale(1, -1);
              break;
            case 5:
              f.rotate(0.5 * Math.PI);
              f.scale(1, -1);
              break;
            case 6:
              f.rotate(0.5 * Math.PI);
              f.translate(0, -d);
              break;
            case 7:
              f.rotate(0.5 * Math.PI);
              f.translate(e, -d);
              f.scale(-1, 1);
              break;
            case 8:
              f.rotate(-0.5 * Math.PI), f.translate(-e, 0)
          }
        }, _renderImageToCanvas: function (a, b, e, d, f, g) {
          a.getContext("2d").drawImage(b, e, d, f, g)
        }})
    });
    h("runtime/html5/imagemeta/exif", ["base", "runtime/html5/imagemeta"], function (a, b) {
      var e = {ExifMap: function () {
        return this
      }};
      e.ExifMap.prototype.map = {Orientation: 274};
      e.ExifMap.prototype.get = function (a) {
        return this[a] || this[this.map[a]]
      };
      e.exifTagTypes = {1: {getValue: function (a, b) {
        return a.getUint8(b)
      }, size: 1}, 2: {getValue: function (a, b) {
        return String.fromCharCode(a.getUint8(b))
      },
        size: 1, ascii: !0}, 3: {getValue: function (a, b, e) {
        return a.getUint16(b, e)
      }, size: 2}, 4: {getValue: function (a, b, e) {
        return a.getUint32(b, e)
      }, size: 4}, 5: {getValue: function (a, b, e) {
        return a.getUint32(b, e) / a.getUint32(b + 4, e)
      }, size: 8}, 9: {getValue: function (a, b, e) {
        return a.getInt32(b, e)
      }, size: 4}, 10: {getValue: function (a, b, e) {
        return a.getInt32(b, e) / a.getInt32(b + 4, e)
      }, size: 8}};
      e.exifTagTypes[7] = e.exifTagTypes[1];
      e.getExifValue = function (b, d, f, g, h, k) {
        g = e.exifTagTypes[g];
        var l, m;
        if (g)if (l = g.size * h, m = 4 < l ? d + b.getUint32(f +
          8, k) : f + 8, m + l > b.byteLength)a.log("Invalid Exif data: Invalid data offset."); else {
          if (1 === h)return g.getValue(b, m, k);
          d = [];
          for (f = 0; f < h; f += 1)d[f] = g.getValue(b, m + f * g.size, k);
          if (g.ascii) {
            b = "";
            for (f = 0; f < d.length; f += 1) {
              h = d[f];
              if ("\x00" === h)break;
              b += h
            }
            return b
          }
          return d
        } else a.log("Invalid Exif data: Invalid tag type.")
      };
      e.parseExifTag = function (a, b, d, f, g) {
        var h = a.getUint16(d, f);
        g.exif[h] = e.getExifValue(a, b, d, a.getUint16(d + 2, f), a.getUint32(d + 4, f), f)
      };
      e.parseExifTags = function (b, e, d, f, g) {
        var h, k, l;
        if (d + 6 > b.byteLength)a.log("Invalid Exif data: Invalid directory offset.");
        else if (h = b.getUint16(d, f), k = d + 2 + 12 * h, k + 4 > b.byteLength)a.log("Invalid Exif data: Invalid directory size."); else {
          for (l = 0; l < h; l += 1)this.parseExifTag(b, e, d + 2 + 12 * l, f, g);
          return b.getUint32(k, f)
        }
      };
      e.parseExifData = function (b, d, f, g) {
        f = d + 10;
        var h;
        if (1165519206 === b.getUint32(d + 4))if (f + 8 > b.byteLength)a.log("Invalid Exif data: Invalid segment size."); else if (0 !== b.getUint16(d + 8))a.log("Invalid Exif data: Missing byte alignment offset."); else {
          switch (b.getUint16(f)) {
            case 18761:
              d = !0;
              break;
            case 19789:
              d = !1;
              break;
            default:
              a.log("Invalid Exif data: Invalid byte alignment marker.");
              return
          }
          42 !== b.getUint16(f + 2, d) ? a.log("Invalid Exif data: Missing TIFF marker.") : (h = b.getUint32(f + 4, d), g.exif = new e.ExifMap, e.parseExifTags(b, f, f + h, d, g))
        }
      };
      b.parsers[65505].push(e.parseExifData);
      return e
    });
    h("runtime/html5/transport", ["base", "runtime/html5/runtime"], function (a, b) {
      var e = a.noop, d = a.$;
      return b.register("Transport", {init: function () {
        this._status = 0;
        this._response = null
      }, send: function () {
        var a = this.owner, b = this.options, e = this._initAjax(),
          f = a._blob, g = b.server, h, p;
        b.sendAsBinary ? (g += (/\?/.test(g) ? "&" : "?") + d.param(a._formData), p = f.getSource()) : (h = new FormData, d.each(a._formData, function (a, b) {
          h.append(a, b)
        }), h.append(b.fileVar, f.getSource(), b.filename || a._formData.name || ""));
        b.withCredentials && "withCredentials"in e ? (e.open(b.method, g, !0), e.withCredentials = !0) : e.open(b.method, g);
        this._setRequestHeader(e, b.headers);
        p && e.overrideMimeType("application/octet-stream");
        e.send(p || h)
      }, getResponse: function () {
        return this._response
      }, getResponseAsJson: function () {
        return this._parseJson(this._response)
      },
        getStatus: function () {
          return this._status
        }, abort: function () {
          var a = this._xhr;
          a && (a.upload.onprogress = e, a.onreadystatechange = e, a.abort(), this._xhr = null)
        }, destroy: function () {
          this.abort()
        }, _initAjax: function () {
          var a = this, b = new XMLHttpRequest;
          !this.options.withCredentials || "withCredentials"in b || "undefined" === typeof XDomainRequest || (b = new XDomainRequest);
          b.upload.onprogress = function (b) {
            var e = 0;
            b.lengthComputable && (e = b.loaded / b.total);
            return a.trigger("progress", e)
          };
          b.onreadystatechange = function () {
            if (4 ===
              b.readyState) {
              b.upload.onprogress = e;
              b.onreadystatechange = e;
              a._xhr = null;
              if (200 === b.status)return a._response = b.responseText, a.trigger("load");
              a._status = b.status;
              b = null;
              return a.trigger("error", a._status ? "http" : "abort")
            }
          };
          return a._xhr = b
        }, _setRequestHeader: function (a, b) {
          d.each(b, function (b, e) {
            a.setRequestHeader(b, e)
          })
        }, _parseJson: function (a) {
          var b;
          try {
            b = JSON.parse(a)
          } catch (e) {
            b = {}
          }
          return b
        }})
    });
    h("widgets/filednd", ["base", "uploader", "lib/dnd", "widgets/widget"], function (a, b, e) {
      var d = a.$;
      b.options.dnd =
        "";
      return b.register({init: function (b) {
        if (b.dnd && "html5" === this.request("predict-runtime-type")) {
          var f = this, g = a.Deferred();
          b = d.extend({}, {container: b.dnd, accept: b.accept});
          b = new e(b);
          b.once("ready", g.resolve);
          b.on("drop", function (a) {
            f.request("add-file", [a])
          });
          b.init();
          return g.promise()
        }
      }})
    });
    h("widgets/filepaste", ["base", "uploader", "lib/filepaste", "widgets/widget"], function (a, b, e) {
      var d = a.$;
      return b.register({init: function (b) {
        if (b.paste && "html5" === this.request("predict-runtime-type")) {
          var f = this,
            g = a.Deferred();
          b = d.extend({}, {container: b.paste, accept: b.accept});
          b = new e(b);
          b.once("ready", g.resolve);
          b.on("paste", function (a) {
            f.owner.request("add-file", [a])
          });
          b.init();
          return g.promise()
        }
      }})
    });
    h("widgets/image", ["base", "uploader", "lib/image", "widgets/widget"], function (a, b, e) {
      var d = a.$, f;
      f = function (a) {
        var b = 0, e = [], d = function () {
          for (var d; e.length && b < a;)d = e.shift(), b += d[0], d[1]()
        };
        return function (a, f, g) {
          e.push([f, g]);
          a.once("destroy", function () {
            b -= f;
            setTimeout(d, 1)
          });
          setTimeout(d, 1)
        }
      }(5242880);
      d.extend(b.options,
        {thumb: {width: 110, height: 110, quality: 70, allowMagnify: !0, crop: !0, preserveHeaders: !1, type: "image/jpeg"}, compress: {width: 1600, height: 1600, quality: 90, allowMagnify: !1, crop: !1, preserveHeaders: !0}});
      return b.register({"make-thumb": "makeThumb", "before-send-file": "compressImage"}, {makeThumb: function (a, b, g, h) {
        var p, k;
        a = this.request("get-file", a);
        a.type.match(/^image/) ? (p = d.extend({}, this.options.thumb), d.isPlainObject(g) && (p = d.extend(p, g), g = null), g = g || p.width, h = h || p.height, k = new e(p), k.once("load", function () {
          a._info =
            a._info || k.info();
          a._meta = a._meta || k.meta();
          k.resize(g, h)
        }), k.once("complete", function () {
          b(!1, k.getAsDataUrl(p.type));
          k.destroy()
        }), k.once("error", function () {
          b(!0);
          k.destroy()
        }), f(k, a.source.size, function () {
          a._info && k.info(a._info);
          a._meta && k.meta(a._meta);
          k.loadFromBlob(a.source)
        })) : b(!0)
      }, compressImage: function (b) {
        var f = this.options.compress || this.options.resize, g = f && f.compressSize || 307200, h, k;
        b = this.request("get-file", b);
        if (f && ~"image/jpeg,image/jpg".indexOf(b.type) && !(b.size < g || b._compressed))return f =
          d.extend({}, f), k = a.Deferred(), h = new e(f), k.always(function () {
          h.destroy();
          h = null
        }), h.once("error", k.reject), h.once("load", function () {
          b._info = b._info || h.info();
          b._meta = b._meta || h.meta();
          h.resize(f.width, f.height)
        }), h.once("complete", function () {
          var a, e;
          a = h.getAsBlob(f.type);
          e = b.size;
          a.size < e && (b.source = a, b.size = a.size, b.trigger("resize", a.size, e));
          b._compressed = !0;
          k.resolve(!0)
        }), b._info && h.info(b._info), b._meta && h.meta(b._meta), h.loadFromBlob(b.source), k.promise()
      }})
    });
    h("widgets/queue", ["base", "uploader",
      "queue", "file", "widgets/widget"], function (a, b, e, d) {
      var f = a.$, g = /\.\w+$/, h = d.Status;
      return b.register({"add-file": "addFiles", "get-file": "getFile", "fetch-file": "fetchFile", "get-stats": "getStats", "get-files": "getFiles", "remove-file": "removeFile", retry: "retry"}, {init: function (a) {
        var b, d, g, h, k;
        f.isPlainObject(a.accept) && (a.accept = [a.accept]);
        if (a.accept) {
          h = [];
          d = 0;
          for (b = a.accept.length; d < b; d++)(g = a.accept[d].extensions) && h.push(g);
          h.length && (k = "\\." + h.join(",").replace(/,/g, "$|\\.").replace(/\*/g, ".*") +
            "$");
          this.accept = RegExp(k, "i")
        }
        this.queue = new e;
        this.stats = this.queue.stats
      }, _addFile: function (a) {
        if (a && !(6 > a.size || this.accept && g.exec(a.name) && !this.accept.test(a.name)) && (a instanceof d || (a = new d(a)), this.owner.trigger("beforeFileQueued", a)))return this.queue.append(a), this.owner.trigger("fileQueued", a), a
      }, getFile: function (a) {
        return this.queue.getFile(a)
      }, addFiles: function (a) {
        var b = this;
        a.length || (a = [a]);
        a = f.map(a, function (a) {
          return b._addFile(a)
        });
        b.owner.trigger("filesQueued", a);
        b.options.auto &&
        b.request("start-upload")
      }, getStats: function () {
        return this.stats
      }, removeFile: function (a) {
        a = a.id ? a : this.queue.getFile(a);
        a.setStatus(h.CANCELLED);
        this.owner.trigger("fileDequeued", a)
      }, getFiles: function () {
        return this.queue.getFiles.apply(this.queue, arguments)
      }, fetchFile: function () {
        return this.queue.fetch.apply(this.queue, arguments)
      }, retry: function (a, b) {
        var e, d, f;
        if (a)a = a.id ? a : this.queue.getFile(a), a.setStatus(h.QUEUED), b || this.request("start-upload"); else {
          e = this.queue.getFiles(h.ERROR);
          d = 0;
          for (f = e.length; d <
            f; d++)a = e[d], a.setStatus(h.QUEUED);
          this.request("start-upload")
        }
      }})
    });
    h("widgets/runtime", ["uploader", "runtime/runtime", "widgets/widget"], function (a, b) {
      a.support = function () {
        return b.hasRuntime.apply(b, arguments)
      };
      return a.register({"predict-runtime-type": "predictRuntmeType"}, {init: function () {
        if (!this.predictRuntmeType())throw Error("Runtime Error");
      }, predictRuntmeType: function () {
        var a = this.options.runtimeOrder || b.orders, e = this.type, d, f;
        if (!e)for (a = a.split(/\s*,\s*/g), d = 0, f = a.length; d < f; d++)if (b.hasRuntime(a[d])) {
          this.type =
            e = a[d];
          break
        }
        return e
      }})
    });
    h("widgets/upload", ["base", "uploader", "file", "lib/transport", "widgets/widget"], function (a, b, e, d) {
      function f(a, b) {
        for (var e = [], d = a.source.size, g = b ? Math.ceil(d / b) : 1, h = 0, k = 0, p; k < g;)p = Math.min(b, d - h), e.push({file: a, start: h, end: h + p, total: d, chunks: g, chunk: k++}), h += p;
        a.blocks = e.concat();
        a.remaning = e.length;
        return{file: a, has: function () {
          return!!e.length
        }, fetch: function () {
          return e.shift()
        }}
      }

      var g = a.$, h = a.isPromise, k = e.Status;
      g.extend(b.options, {prepareNextFile: !1, chunked: !1, chunkSize: 5242880,
        chunkRetry: 2, threads: 3, formdata: null});
      b.register({"start-upload": "start", "stop-upload": "stop", "skip-file": "skipFile", "is-in-progress": "isInProgress"}, {init: function () {
        var b = this.owner;
        this.runing = !1;
        this.pool = [];
        this.pending = [];
        this.remaning = 0;
        this.__tick = a.bindFn(this._tick, this);
        b.on("uploadComplete", function (a) {
          a.blocks && g.each(a.blocks, function (a, b) {
            b.transport && (b.transport.abort(), b.transport.destroy());
            delete b.transport
          });
          delete a.blocks;
          delete a.remaning
        })
      }, start: function () {
        var b = this;
        g.each(b.request("get-files",
          k.INVALID), function () {
          b.request("remove-file", this)
        });
        b.runing || (b.runing = !0, g.each(b.pool, function (a, e) {
          var d = e.file;
          d.getStatus() === k.INTERRUPT && (d.setStatus(k.PROGRESS), b._trigged = !1, e.transport && e.transport.send())
        }), b._trigged = !1, b.owner.trigger("startUpload"), a.nextTick(b.__tick))
      }, stop: function (a) {
        !1 !== this.runing && (this.runing = !1, a && g.each(this.pool, function (a, b) {
          b.transport && b.transport.abort();
          b.file.setStatus(k.INTERRUPT)
        }), this.owner.trigger("stopUpload"))
      }, isInProgress: function () {
        return!!this.runing
      },
        getStats: function () {
          return this.request("get-stats")
        }, skipFile: function (a, b) {
          a = this.request("get-file", a);
          a.setStatus(b || k.COMPLETE);
          a.skipped = !0;
          a.blocks && g.each(a.blocks, function (a, b) {
            var e = b.transport;
            e && (e.abort(), e.destroy(), delete b.transport)
          });
          this.owner.trigger("uploadSkip", a)
        }, _tick: function () {
          var b = this, e = b.options, d;
          if (b._promise)return b._promise.always(b.__tick);
          b.pool.length < e.threads && (d = b._nextBlock()) ? (b._trigged = !1, e = function (e) {
            b._promise = null;
            e && e.file && b._startSend(e);
            a.nextTick(b.__tick)
          },
            b._promise = h(d) ? d.always(e) : e(d)) : b.remaning || b.getStats().numOfQueue || (b.runing = !1, b._trigged || a.nextTick(function () {
            b.owner.trigger("uploadFinished")
          }), b._trigged = !0)
        }, _nextBlock: function () {
          var a = this, b = a._act, e = a.options, d, g;
          if (b && b.has() && b.file.getStatus() === k.PROGRESS)return e.prepareNextFile && !a.pending.length && a._prepareNextFile(), b.fetch();
          if (a.runing)return!a.pending.length && a.getStats().numOfQueue && a._prepareNextFile(), d = a.pending.shift(), g = function (d) {
            if (!d)return null;
            b = f(d, e.chunked ?
              e.chunkSize : 0);
            a._act = b;
            return b.fetch()
          }, h(d) ? d.then(g) : g(d)
        }, _prepareNextFile: function () {
          var a = this, b = a.request("fetch-file"), e = a.pending, d;
          b && (d = a.request("before-send-file", b, function () {
            return b.getStatus() === k.QUEUED ? (a.owner.trigger("uploadStart", b), b.setStatus(k.PROGRESS), b) : a._finishFile(b)
          }), d.done(function () {
            var a = g.inArray(d, e);
            ~a && e.splice(a, 1, b)
          }), d.fail(function (e) {
            b.setStatus(k.ERROR, e);
            a.owner.trigger("uploadError", b, e);
            a.owner.trigger("uploadComplete", b)
          }), e.push(d))
        }, _popBlock: function (a) {
          var b =
            g.inArray(a, this.pool);
          this.pool.splice(b, 1);
          a.file.remaning--;
          this.remaning--
        }, _startSend: function (b) {
          var e = this, d = b.file;
          e.pool.push(b);
          e.remaning++;
          b.blob = 1 === b.chunks ? d.source : d.source.slice(b.start, b.end);
          e.request("before-send", b,function () {
            d.getStatus() === k.PROGRESS ? e._doSend(b) : (e._popBlock(b), a.nextTick(e.__tick))
          }).fail(function () {
            1 === d.remaning ? e._finishFile(d).always(function () {
              b.percentage = 1;
              e._popBlock(b);
              e.owner.trigger("uploadComplete", d);
              a.nextTick(e.__tick)
            }) : (b.percentage = 1, e._popBlock(b),
              a.nextTick(e.__tick))
          })
        }, _doSend: function (b) {
          var e = this, f = e.owner, h = e.options, l = b.file, m = new d(h), n = g.extend({}, h.formData), r = g.extend({}, h.headers);
          b.transport = m;
          m.on("destroy", function () {
            delete b.transport;
            e._popBlock(b);
            a.nextTick(e.__tick)
          });
          m.on("progress", function (a) {
            var e = 0, d = 0, e = b.percentage = a;
            1 < b.chunks && (g.each(l.blocks, function (a, b) {
              d += (b.percentage || 0) * (b.end - b.start)
            }), e = d / l.size);
            f.trigger("uploadProgress", l, e || 0)
          });
          m.on("error", function (a) {
            b.retried = b.retried || 0;
            1 < b.chunks && ~"http,abort".indexOf(a) &&
              b.retried < h.chunkRetry ? (b.retried++, m.send()) : (l.setStatus(k.ERROR, a), f.trigger("uploadError", l, a), f.trigger("uploadComplete", l))
          });
          m.on("load", function () {
            var a = m.getResponseAsJson() || {}, d;
            a._raw = m.getResponse();
            f.trigger("uploadAccept", b, a, function (a) {
              d = a
            }) || (d = d || "server");
            d ? m.trigger("error", d) : 1 === l.remaning ? e._finishFile(l, a) : m.destroy()
          });
          n = g.extend(n, {id: l.id, name: l.name, type: l.type, lastModifiedDate: l.lastModifiedDate, size: l.size});
          1 < b.chunks && g.extend(n, {chunks: b.chunks, chunk: b.chunk});
          f.trigger("uploadBeforeSend",
            b, n, r);
          m.appendBlob(h.fileVal, b.blob, l.name);
          m.append(n);
          m.setRequestHeader(r);
          m.send()
        }, _finishFile: function (a, b, e) {
          var d = this.owner;
          return d.request("after-send-file", arguments,function () {
            a.setStatus(k.COMPLETE);
            d.trigger("uploadSuccess", a, b, e)
          }).fail(function (b) {
            a.getStatus() === k.PROGRESS && a.setStatus(k.ERROR, b);
            d.trigger("uploadError", a, b)
          }).always(function () {
            d.trigger("uploadComplete", a)
          })
        }})
    });
    h("widgets/validator", ["base", "uploader", "file", "widgets/widget"], function (a, b, e) {
      var d = a.$, f = {};
      a =
      {addValidator: function (a, b) {
        f[a] = b
      }, removeValidator: function (a) {
        delete f[a]
      }};
      b.register({init: function () {
        var a = this;
        d.each(f, function () {
          this.call(a.owner)
        })
      }});
      a.addValidator("fileNumLimit", function () {
        var a = 0, b = this.options.fileNumLimit >> 0, e = !0;
        b && (this.on("beforeFileQueued", function () {
          a >= b && e && (e = !1, this.trigger("error", "Q_EXCEED_NUM_LIMIT", b), setTimeout(function () {
            e = !0
          }, 1));
          return a >= b ? !1 : !0
        }), this.on("fileQueued", function () {
          a++
        }), this.on("fileDequeued", function () {
          a--
        }), this.on("uploadFinished",
          function () {
            a = 0
          }))
      });
      a.addValidator("fileSizeLimit", function () {
        var a = 0, b = this.options.fileSizeLimit >> 0, e = !0;
        b && (this.on("beforeFileQueued", function (d) {
          (d = a + d.size > b) && e && (e = !1, this.trigger("error", "Q_EXCEED_SIZE_LIMIT", b), setTimeout(function () {
            e = !0
          }, 1));
          return d ? !1 : !0
        }), this.on("fileQueued", function (b) {
          a += b.size
        }), this.on("fileDequeued", function (b) {
          a -= b.size
        }), this.on("uploadFinished", function () {
          a = 0
        }))
      });
      a.addValidator("fileSingleSizeLimit", function () {
        var a = this.options.fileSingleSizeLimit;
        if (a)this.on("beforeFileQueued",
          function (b) {
            if (b.size > a)return b.setStatus(e.Status.INVALID, "exceed_size"), this.trigger("error", "F_EXCEED_SIZE"), !1
          })
      });
      a.addValidator("duplicate", function () {
        function a(b) {
          for (var e = 0, d = 0, f = b.length, g; d < f; d++)g = b.charCodeAt(d), e = g + (e << 6) + (e << 16) - e;
          return e
        }

        var b = {};
        this.options.duplicate || (this.on("beforeFileQueued", function (e) {
          e = a(e.name + e.size + e.lastModifiedDate);
          if (b[e])return this.trigger("error", "F_DUPLICATE"), !1
        }), this.on("fileQueued", function (e) {
          e = a(e.name + e.size + e.lastModifiedDate);
          b[e] = !0
        }),
          this.on("fileDequeued", function (e) {
            e = a(e.name + e.size + e.lastModifiedDate);
            delete b[e]
          }))
      });
      return a
    });
    var n, m, s, r, t = f.base, v = function (a) {
      return a && a.charAt(0).toUpperCase() + a.substr(1)
    };
    for (n in f)if (h = t, f.hasOwnProperty(n)) {
      m = n.split("/");
      for (r = v(m.pop()); s = v(m.shift());)h[s] = h[s] || {}, h = h[s];
      h[r] = f[n]
    }
    return t
  }(d);
  "object" === typeof module && "object" === typeof module.exports ? module.exports = f : "function" === typeof define && define.amd && define("WebUploader", function () {
    return f
  });
  origin = d.WebUploader;
  d.WebUploader =
    f;
  d.WebUploader.noConflict = function () {
    d.WebUploader = origin
  }
})(this);
define("webuploader", ["jquery"], function (d) {
  return function () {
    return d.WebUploader
  }
}(this));
~function (d, a) {
  var f = {is: function (a, b) {
    return Object.prototype.toString.call(a).slice(8, -1) === b
  }, copy: function (a, b) {
    for (var d in b)if (b.hasOwnProperty(d)) {
      var f = b[d];
      a[d] = this.is(f, "Object") ? this.copy({}, f) : this.is(f, "Array") ? this.copy([], f) : f
    }
    return a
  }}, b = function () {
    var b = this;
    this.defaults = {placement: "top", status: "normal"};
    this.el = a.createElement("div");
    this.el.className = "essage";
    this.close = '<span class="close">&times;</span>';
    this.error = '<span class="icon icon-circle-error"></span>';
    this.warning =
      '<span class="icon icon-circle-warning"></span>';
    this.success = '<span class="icon icon-circle-check"></span>';
    this.info = '<span class="icon icon-circle-info"></span>';
    this.el.onclick = function (a) {
      a = a || d.event;
      "close" === (a.target || a.srcElement).className && b.hide()
    };
    this.placement = "top";
    a.body.appendChild(this.el);
    this.el.top = -this._height();
    return this
  };
  b.prototype._height = function () {
    return this.el.offsetHeight || this.el.clientHeight
  };
  b.prototype._width = function () {
    return this.el.offsetWidth || this.el.clientWidth
  };
  b.prototype._class = function (a, b) {
    var d = this.el;
    if (d.classList)d.classList[b ? "remove" : "add"](a); else {
      var f = d.className, l = RegExp("\\b" + a + "\\b", "g");
      d.className = b ? f.replace(l, "") : f.match(l) ? f : f + " " + a
    }
    return d
  };
  b.prototype.set = function (a) {
    a = "string" === typeof a ? {message: a} : a;
    this.config = f.copy({}, this.defaults);
    this.config = f.copy(this.config, a);
    !this.config.placement.match(/^(?:top|bottom)$/) && (this.config.placement = "top");
    this.el.style["top" === this.config.placement ? "bottom" : "top"] = "auto";
    this.el.className =
      "essage";
    this._class("essage-" + this.config.status);
    return this
  };
  b.prototype.show = function (a, b) {
    var d = this.el, f = this.set(a), l, n;
    d.innerHTML = this.close + this[this.config.status] + " " + this.config.message;
    var m = -this._height() - 50, s = -this._width() / 2;
    this.el.style.marginLeft = s + "px";
    this._timeout && clearTimeout(this._timeout);
    b && (n = function () {
      return setTimeout(function () {
        f.hide()
      }, b)
    });
    l = setInterval(function () {
      if (20 === m)return f._timeout = n && n(), clearInterval(l);
      d.style[f.config.placement] = (m += 1) + "px"
    }, 1);
    return this
  };
  b.prototype.hide = function () {
    var a = +this.el.style[this.config.placement].slice(0, -2), b = -this._height() - 50, d = this, f;
    f = setInterval(function () {
      if (a === b)return f && clearInterval(f);
      d.el.style[d.config.placement] = (a -= 1) + "px"
    }, 1);
    return this
  };
  d.Essage = new b
}(window, document);
define("essage", function () {
});
(function () {
  define("lib/uploader/index", ["webuploader", "thenjs", "util", "essage"], function (d, a, f) {
    var b;
    b = /\/.*$/;
    return function () {
      function e(e) {
        var f, h, l;
        l = this.setupOptions(e);
        h = l.onError;
        l.onError = null;
        f = this.uploader = d.create(l);
        f.on("filesQueued",function (e) {
          return a.each(e,function (a, e) {
            e.retry = 0;
            e.category = e.type.replace(b, "");
            !e.ext && ~e.type.indexOf("image/") && (e.ext = e.type.slice(6), e.name += "." + e.ext);
            return f.makeThumb(e, function (b, d) {
              var g;
              if (g = l.onCreate({fileName: e.name, fileSize: e.size,
                fileType: e.ext, fileCategory: e.category, thumbnail: d, thumbnailUrl: d}))e.model = g, g.removeFile = function () {
                return f.removeFile(e)
              };
              return a()
            })
          }).all(function () {
              return f.upload()
            })
        }).on("uploadProgress",function (a, b) {
            return l.onProgress(b, a.model)
          }).on("uploadError",function (a, b) {
            if (2 > a.retry)return a.retry++, f.retry();
            Essage.show({message: b, status: "error"});
            f.removeFile(a);
            return h(b, a.model)
          }).on("uploadSuccess",function (a, b) {
            var e;
            delete b._raw;
            if (b.code)return f.trigger("error", b.message), h(b.message,
              a.model);
            b = null != (e = a.model) ? e.parse(b) : void 0;
            return l.onComplete(b, a.model)
          }).on("startUpload",function () {
            return l.onStart(f)
          }).on("stopUpload",function () {
            return l.onStop(f)
          }).on("uploadFinished",function () {
            return l.onFinish()
          }).on("error", function (a) {
            a = function () {
              switch (a) {
                case "Q_EXCEED_NUM_LIMIT":
                  return"10";
                case "F_EXCEED_SIZE":
                  return" " + name + " 20M";
                case "F_DUPLICATE":
                  return"";
                default:
                  return a
              }
            }();
            return Essage.show({message: a, status: "error"})
          })
      }

      e.prototype.setupOptions =
        function (a) {
          return _.extend({server: teambition.uploadUrl, dnd: null, paste: null, pick: {id: null, label: "", multiple: !1}, accept: {title: "Images", extensions: "gif,jpg,jpeg,bmp,png", mimeTypes: "image/*"}, thumb: {width: 200, height: 200, quality: 100, allowMagnify: !0, crop: !1, preserveHeaders: !1, type: "image/jpeg"}, compress: !1, prepareNextFile: !0, chunked: !1, chunkSize: 5242880, chunkRetry: 2, threads: 3, formdata: null, fileNumLimit: 10, fileSizeLimit: 2048E5, fileSingleSizeLimit: 2048E4, duplicate: !1, withCredentials: !0, onCreate: function (a) {
          },
            onStart: function (a) {
            }, onStop: function (a) {
            }, onProgress: function (a, b) {
            }, onComplete: function (a, b) {
            }, onError: function (a, b) {
            }, onFinish: function () {
            }}, a)
        };
      return e
    }()
  })
}).call(this);
define("highlight", [], function () {
  var d = new function () {
    function a(a) {
      return a.replace(/&/gm, "&amp;").replace(/</gm, "&lt;").replace(/>/gm, "&gt;")
    }

    function d(a, b) {
      var e = a && a.exec(b);
      return e && 0 == e.index
    }

    function b(a) {
      a = (a.className + " " + (a.parentNode ? a.parentNode.className : "")).split(/\s+/);
      a = a.map(function (a) {
        return a.replace(/^lang(uage)?-/, "")
      });
      return a.filter(function (a) {
        return t(a) || "no-highlight" == a
      })[0]
    }

    function e(a, b) {
      var e = {}, d;
      for (d in a)e[d] = a[d];
      if (b)for (d in b)e[d] = b[d];
      return e
    }

    function g(a) {
      var b =
        [];
      (function A(a, e) {
        for (var d = a.firstChild; d; d = d.nextSibling)3 == d.nodeType ? e += d.nodeValue.length : "br" == d.nodeName.toLowerCase() ? e += 1 : 1 == d.nodeType && (b.push({event: "start", offset: e, node: d}), e = A(d, e), b.push({event: "stop", offset: e, node: d}));
        return e
      })(a, 0);
      return b
    }

    function k(b, e, d) {
      function f() {
        return b.length && e.length ? b[0].offset != e[0].offset ? b[0].offset < e[0].offset ? b : e : "start" == e[0].event ? b : e : b.length ? b : e
      }

      function g(b) {
        l += "<" + b.nodeName.toLowerCase() + Array.prototype.map.call(b.attributes,function (b) {
          return" " +
            b.nodeName + '="' + a(b.value) + '"'
        }).join("") + ">"
      }

      function h(a) {
        l += "</" + a.nodeName.toLowerCase() + ">"
      }

      function k(a) {
        ("start" == a.event ? g : h)(a.node)
      }

      for (var p = 0, l = "", m = []; b.length || e.length;) {
        var n = f(), l = l + a(d.substr(p, n[0].offset - p)), p = n[0].offset;
        if (n == b) {
          m.reverse().forEach(h);
          do k(n.splice(0, 1)[0]), n = f(); while (n == b && n.length && n[0].offset == p);
          m.reverse().forEach(g)
        } else"start" == n[0].event ? m.push(n[0].node) : m.pop(), k(n.splice(0, 1)[0])
      }
      return l + a(d.substr(p))
    }

    function h(a) {
      function b(a) {
        return a && a.source ||
          a
      }

      function d(e, f) {
        return RegExp(b(e), "m" + (a.case_insensitive ? "i" : "") + (f ? "g" : ""))
      }

      function f(g, h) {
        if (!g.compiled) {
          g.compiled = !0;
          g.keywords = g.keywords || g.beginKeywords;
          if (g.keywords) {
            var k = {}, p = function (b, e) {
              a.case_insensitive && (e = e.toLowerCase());
              e.split(" ").forEach(function (a) {
                a = a.split("|");
                k[a[0]] = [b, a[1] ? Number(a[1]) : 1]
              })
            };
            "string" == typeof g.keywords ? p("keyword", g.keywords) : Object.keys(g.keywords).forEach(function (a) {
              p(a, g.keywords[a])
            });
            g.keywords = k
          }
          g.lexemesRe = d(g.lexemes || /\b[A-Za-z0-9_]+\b/,
            !0);
          h && (g.beginKeywords && (g.begin = "\\b(" + g.beginKeywords.split(" ").join("|") + ")\\b"), g.begin || (g.begin = /\B|\b/), g.beginRe = d(g.begin), g.end || g.endsWithParent || (g.end = /\B|\b/), g.end && (g.endRe = d(g.end)), g.terminator_end = b(g.end) || "", g.endsWithParent && h.terminator_end && (g.terminator_end += (g.end ? "|" : "") + h.terminator_end));
          g.illegal && (g.illegalRe = d(g.illegal));
          void 0 === g.relevance && (g.relevance = 1);
          g.contains || (g.contains = []);
          var l = [];
          g.contains.forEach(function (a) {
            a.variants ? a.variants.forEach(function (b) {
              l.push(e(a,
                b))
            }) : l.push("self" == a ? g : a)
          });
          g.contains = l;
          g.contains.forEach(function (a) {
            f(a, g)
          });
          g.starts && f(g.starts, h);
          var m = g.contains.map(function (a) {
            return a.beginKeywords ? "\\.?(" + a.begin + ")\\.?" : a.begin
          }).concat([g.terminator_end, g.illegal]).map(b).filter(Boolean);
          g.terminators = m.length ? d(m.join("|"), !0) : {exec: function (a) {
            return null
          }};
          g.continuation = {}
        }
      }

      f(a)
    }

    function l(b, e, g, k) {
      function m(a, b) {
        if (d(a.endRe, b))return a;
        if (a.endsWithParent)return m(a.parent, b)
      }

      function r(a, b, e, d) {
        d = '<span class="' + (d ? "" : v.classPrefix);
        return d + (a + '">') + b + (e ? "" : "</span>")
      }

      function s() {
        var b;
        if (void 0 !== E.subLanguage)E.subLanguage && !p[E.subLanguage] ? b = a(K) : (b = E.subLanguage ? l(E.subLanguage, K, !0, E.continuation.top) : n(K), 0 < E.relevance && (N += b.relevance), "continuous" == E.subLanguageMode && (E.continuation.top = b.top), b = r(b.language, b.value, !1, !0)); else if (E.keywords) {
          b = "";
          var e = 0;
          E.lexemesRe.lastIndex = 0;
          for (var d = E.lexemesRe.exec(K); d;) {
            b += a(K.substr(e, d.index - e));
            var e = E, f = d, f = H.case_insensitive ? f[0].toLowerCase() : f[0];
            (e = e.keywords.hasOwnProperty(f) &&
              e.keywords[f]) ? (N += e[1], b += r(e[0], a(d[0]))) : b += a(d[0]);
            e = E.lexemesRe.lastIndex;
            d = E.lexemesRe.exec(K)
          }
          b += a(K.substr(e))
        } else b = a(K);
        return b
      }

      function x(b, e) {
        var d = b.className ? r(b.className, "", !0) : "";
        b.returnBegin ? (I += d, K = "") : b.excludeBegin ? (I += a(e) + d, K = "") : (I += d, K = e);
        E = Object.create(b, {parent: {value: E}})
      }

      function F(b, e) {
        K += b;
        if (void 0 === e)return I += s(), 0;
        var h;
        a:{
          h = E;
          for (var k = 0; k < h.contains.length; k++)if (d(h.contains[k].beginRe, e)) {
            h = h.contains[k];
            break a
          }
          h = void 0
        }
        if (h)return I += s(), x(h, e), h.returnBegin ?
          0 : e.length;
        if (h = m(E, e)) {
          k = E;
          k.returnEnd || k.excludeEnd || (K += e);
          I += s();
          do E.className && (I += "</span>"), N += E.relevance, E = E.parent; while (E != h.parent);
          k.excludeEnd && (I += a(e));
          K = "";
          h.starts && x(h.starts, "");
          return k.returnEnd ? 0 : e.length
        }
        if (!g && d(E.illegalRe, e))throw Error('Illegal lexeme "' + e + '" for mode "' + (E.className || "<unnamed>") + '"');
        K += e;
        return e.length || 1
      }

      var H = t(b);
      if (!H)throw Error('Unknown language: "' + b + '"');
      h(H);
      var E = k || H, I = "";
      for (k = E; k != H; k = k.parent)k.className && (I += r(k.className, I, !0));
      var K =
        "", N = 0;
      try {
        for (var R, S, L = 0; ;) {
          E.terminators.lastIndex = L;
          R = E.terminators.exec(e);
          if (!R)break;
          S = F(e.substr(L, R.index - L), R[0]);
          L = R.index + S
        }
        F(e.substr(L));
        for (k = E; k.parent; k = k.parent)k.className && (I += "</span>");
        return{relevance: N, value: I, language: b, top: E}
      } catch (D) {
        if (-1 != D.message.indexOf("Illegal"))return{relevance: 0, value: a(e)};
        throw D;
      }
    }

    function n(b, e) {
      e = e || v.languages || Object.keys(p);
      var d = {relevance: 0, value: a(b)}, f = d;
      e.forEach(function (a) {
        if (t(a)) {
          var e = l(a, b, !1);
          e.language = a;
          e.relevance > f.relevance &&
          (f = e);
          e.relevance > d.relevance && (f = d, d = e)
        }
      });
      f.language && (d.second_best = f);
      return d
    }

    function m(a) {
      v.tabReplace && (a = a.replace(/^((<[^>]+>|\t)+)/gm, function (a, b, e, d) {
        return b.replace(/\t/g, v.tabReplace)
      }));
      v.useBR && (a = a.replace(/\n/g, "<br>"));
      return a
    }

    function s(a) {
      var e = v.useBR ? a.innerHTML.replace(/\n/g, "").replace(/<br>|<br [^>]*>/g, "\n").replace(/<[^>]*>/g, "") : a.textContent, d = b(a);
      if ("no-highlight" != d) {
        var f = d ? l(d, e, !0) : n(e), h = g(a);
        if (h.length) {
          var p = document.createElementNS("http://www.w3.org/1999/xhtml",
            "pre");
          p.innerHTML = f.value;
          f.value = k(h, g(p), e)
        }
        f.value = m(f.value);
        a.innerHTML = f.value;
        a.className += " hljs " + (!d && f.language || "");
        a.result = {language: f.language, re: f.relevance};
        f.second_best && (a.second_best = {language: f.second_best.language, re: f.second_best.relevance})
      }
    }

    function r() {
      if (!r.called) {
        r.called = !0;
        var a = document.querySelectorAll("pre code");
        Array.prototype.forEach.call(a, s)
      }
    }

    function t(a) {
      return p[a] || p[x[a]]
    }

    var v = {classPrefix: "hljs-", tabReplace: null, useBR: !1, languages: void 0}, p = {}, x = {};
    this.highlight = l;
    this.highlightAuto = n;
    this.fixMarkup = m;
    this.highlightBlock = s;
    this.configure = function (a) {
      v = e(v, a)
    };
    this.initHighlighting = r;
    this.initHighlightingOnLoad = function () {
      addEventListener("DOMContentLoaded", r, !1);
      addEventListener("load", r, !1)
    };
    this.registerLanguage = function (a, b) {
      var e = p[a] = b(this);
      e.aliases && e.aliases.forEach(function (b) {
        x[b] = a
      })
    };
    this.listLanguages = function () {
      return Object.keys(p)
    };
    this.getLanguage = t;
    this.inherit = e;
    this.IDENT_RE = "[a-zA-Z][a-zA-Z0-9_]*";
    this.UNDERSCORE_IDENT_RE =
      "[a-zA-Z_][a-zA-Z0-9_]*";
    this.NUMBER_RE = "\\b\\d+(\\.\\d+)?";
    this.C_NUMBER_RE = "(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";
    this.BINARY_NUMBER_RE = "\\b(0b[01]+)";
    this.RE_STARTERS_RE = "!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";
    this.BACKSLASH_ESCAPE = {begin: "\\\\[\\s\\S]", relevance: 0};
    this.APOS_STRING_MODE = {className: "string", begin: "'", end: "'", illegal: "\\n", contains: [this.BACKSLASH_ESCAPE]};
    this.QUOTE_STRING_MODE = {className: "string", begin: '"', end: '"', illegal: "\\n", contains: [this.BACKSLASH_ESCAPE]};
    this.PHRASAL_WORDS_MODE = {begin: /\b(a|an|the|are|I|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such)\b/};
    this.C_LINE_COMMENT_MODE = {className: "comment", begin: "//", end: "$", contains: [this.PHRASAL_WORDS_MODE]};
    this.C_BLOCK_COMMENT_MODE = {className: "comment", begin: "/\\*", end: "\\*/", contains: [this.PHRASAL_WORDS_MODE]};
    this.HASH_COMMENT_MODE = {className: "comment",
      begin: "#", end: "$", contains: [this.PHRASAL_WORDS_MODE]};
    this.NUMBER_MODE = {className: "number", begin: this.NUMBER_RE, relevance: 0};
    this.C_NUMBER_MODE = {className: "number", begin: this.C_NUMBER_RE, relevance: 0};
    this.BINARY_NUMBER_MODE = {className: "number", begin: this.BINARY_NUMBER_RE, relevance: 0};
    this.CSS_NUMBER_MODE = {className: "number", begin: this.NUMBER_RE + "(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?", relevance: 0};
    this.REGEXP_MODE = {className: "regexp", begin: /\//,
      end: /\/[gim]*/, illegal: /\n/, contains: [this.BACKSLASH_ESCAPE, {begin: /\[/, end: /\]/, relevance: 0, contains: [this.BACKSLASH_ESCAPE]}]};
    this.TITLE_MODE = {className: "title", begin: this.IDENT_RE, relevance: 0};
    this.UNDERSCORE_TITLE_MODE = {className: "title", begin: this.UNDERSCORE_IDENT_RE, relevance: 0}
  };
  d.registerLanguage("bash", function (a) {
    var d = {className: "variable", variants: [
      {begin: /\$[\w\d#@][\w\d_]*/},
      {begin: /\$\{(.*?)\}/}
    ]}, b = {className: "string", begin: /"/, end: /"/, contains: [a.BACKSLASH_ESCAPE, d, {className: "variable",
      begin: /\$\(/, end: /\)/, contains: [a.BACKSLASH_ESCAPE]}]};
    return{aliases: ["sh", "zsh"], lexemes: /-?[a-z\.]+/, keywords: {keyword: "if then else elif fi for break continue while in do done exit return set declare case esac export exec", literal: "true false", built_in: "printf echo read cd pwd pushd popd dirs let eval unset typeset readonly getopts source shopt caller type hash bind help sudo", operator: "-ne -eq -lt -gt -f -d -e -s -l -a"}, contains: [
      {className: "shebang", begin: /^#![^\n]+sh\s*$/, relevance: 10},
      {className: "function",
        begin: /\w[\w\d_]*\s*\(\s*\)\s*\{/, returnBegin: !0, contains: [a.inherit(a.TITLE_MODE, {begin: /\w[\w\d_]*/})], relevance: 0},
      a.HASH_COMMENT_MODE,
      a.NUMBER_MODE,
      b,
      {className: "string", begin: /'/, end: /'/},
      d
    ]}
  });
  d.registerLanguage("clojure", function (a) {
    var d = {className: "number", begin: "[\\s:\\(\\{]+\\d+(\\.\\d+)?", relevance: 0};
    a = a.inherit(a.QUOTE_STRING_MODE, {illegal: null});
    var b = {className: "comment", begin: ";", end: "$", relevance: 0}, e = {className: "collection", begin: "[\\[\\{]", end: "[\\]\\}]"}, g = {className: "comment",
      begin: "\\^[a-zA-Z_0-9\\!\\.\\?\\-\\+\\*\\/\\<\\=\\>\\&\\#\\$';]+"}, k = {className: "attribute", begin: "[:][a-zA-Z_0-9\\!\\.\\?\\-\\+\\*\\/\\<\\=\\>\\&\\#\\$';]+"}, h = {className: "list", begin: "\\(", end: "\\)"}, l = {endsWithParent: !0, keywords: {literal: "true false nil"}, relevance: 0};
    h.contains = [
      {className: "comment", begin: "comment"},
      {keywords: {built_in: "def cond apply if-not if-let if not not= = &lt; < > &lt;= <= >= == + / * - rem quot neg? pos? delay? symbol? keyword? true? false? integer? empty? coll? list? set? ifn? fn? associative? sequential? sorted? counted? reversible? number? decimal? class? distinct? isa? float? rational? reduced? ratio? odd? even? char? seq? vector? string? map? nil? contains? zero? instance? not-every? not-any? libspec? -> ->> .. . inc compare do dotimes mapcat take remove take-while drop letfn drop-last take-last drop-while while intern condp case reduced cycle split-at split-with repeat replicate iterate range merge zipmap declare line-seq sort comparator sort-by dorun doall nthnext nthrest partition eval doseq await await-for let agent atom send send-off release-pending-sends add-watch mapv filterv remove-watch agent-error restart-agent set-error-handler error-handler set-error-mode! error-mode shutdown-agents quote var fn loop recur throw try monitor-enter monitor-exit defmacro defn defn- macroexpand macroexpand-1 for dosync and or when when-not when-let comp juxt partial sequence memoize constantly complement identity assert peek pop doto proxy defstruct first rest cons defprotocol cast coll deftype defrecord last butlast sigs reify second ffirst fnext nfirst nnext defmulti defmethod meta with-meta ns in-ns create-ns import refer keys select-keys vals key val rseq name namespace promise into transient persistent! conj! assoc! dissoc! pop! disj! use class type num float double short byte boolean bigint biginteger bigdec print-method print-dup throw-if printf format load compile get-in update-in pr pr-on newline flush read slurp read-line subvec with-open memfn time re-find re-groups rand-int rand mod locking assert-valid-fdecl alias resolve ref deref refset swap! reset! set-validator! compare-and-set! alter-meta! reset-meta! commute get-validator alter ref-set ref-history-count ref-min-history ref-max-history ensure sync io! new next conj set! to-array future future-call into-array aset gen-class reduce map filter find empty hash-map hash-set sorted-map sorted-map-by sorted-set sorted-set-by vec vector seq flatten reverse assoc dissoc list disj get union difference intersection extend extend-type extend-protocol int nth delay count concat chunk chunk-buffer chunk-append chunk-first chunk-rest max min dec unchecked-inc-int unchecked-inc unchecked-dec-inc unchecked-dec unchecked-negate unchecked-add-int unchecked-add unchecked-subtract-int unchecked-subtract chunk-next chunk-cons chunked-seq? prn vary-meta lazy-seq spread list* str find-keyword keyword symbol gensym force rationalize"},
        lexemes: "[a-zA-Z_0-9\\!\\.\\?\\-\\+\\*\\/\\<\\=\\>\\&\\#\\$';]+", className: "title", begin: "[a-zA-Z_0-9\\!\\.\\?\\-\\+\\*\\/\\<\\=\\>\\&\\#\\$';]+", starts: l},
      l
    ];
    l.contains = [h, a, g, {className: "comment", begin: "\\^\\{", end: "\\}"}, b, k, e, d];
    e.contains = [h, a, g, b, k, e, d];
    return{aliases: ["clj"], illegal: /\S/, contains: [b, h, {className: "prompt", begin: /^=> /, starts: {end: /\n\n|\Z/}}]}
  });
  d.registerLanguage("coffeescript", function (a) {
    var d = {keyword: "in if for while finally new do return else break catch instanceof throw try this switch continue typeof delete debugger super then unless until loop of by when and or is isnt not",
      literal: "true false null undefined yes no on off", reserved: "case default function var void with const let enum export import native __hasProp __extends __slice __bind __indexOf", built_in: "npm require console print module global window document"}, b = a.inherit(a.TITLE_MODE, {begin: "[A-Za-z$_][0-9A-Za-z$_]*"}), e = {className: "subst", begin: /#\{/, end: /}/, keywords: d}, g = [a.BINARY_NUMBER_MODE, a.inherit(a.C_NUMBER_MODE, {starts: {end: "(\\s*/)?", relevance: 0}}), {className: "string", variants: [
      {begin: /'''/, end: /'''/,
        contains: [a.BACKSLASH_ESCAPE]},
      {begin: /'/, end: /'/, contains: [a.BACKSLASH_ESCAPE]},
      {begin: /"""/, end: /"""/, contains: [a.BACKSLASH_ESCAPE, e]},
      {begin: /"/, end: /"/, contains: [a.BACKSLASH_ESCAPE, e]}
    ]}, {className: "regexp", variants: [
      {begin: "///", end: "///", contains: [e, a.HASH_COMMENT_MODE]},
      {begin: "//[gim]*", relevance: 0},
      {begin: "/\\S(\\\\.|[^\\n])*?/[gim]*(?=\\s|\\W|$)"}
    ]}, {className: "property", begin: "@[A-Za-z$_][0-9A-Za-z$_]*"}, {begin: "`", end: "`", excludeBegin: !0, excludeEnd: !0, subLanguage: "javascript"}];
    e.contains =
      g;
    return{aliases: ["coffee", "cson", "iced"], keywords: d, contains: g.concat([
      {className: "comment", begin: "###", end: "###"},
      a.HASH_COMMENT_MODE,
      {className: "function", begin: "([A-Za-z$_][0-9A-Za-z$_]*\\s*=\\s*)?(\\(.*\\))?\\s*\\B[-=]>", end: "[-=]>", returnBegin: !0, contains: [b, {className: "params", begin: "\\(", returnBegin: !0, contains: [
        {begin: /\(/, end: /\)/, keywords: d, contains: ["self"].concat(g)}
      ]}]},
      {className: "class", beginKeywords: "class", end: "$", illegal: /[:="\[\]]/, contains: [
        {beginKeywords: "extends", endsWithParent: !0,
          illegal: /[:="\[\]]/, contains: [b]},
        b
      ]},
      {className: "attribute", begin: "[A-Za-z$_][0-9A-Za-z$_]*:", end: ":", returnBegin: !0, excludeEnd: !0, relevance: 0}
    ])}
  });
  d.registerLanguage("cpp", function (a) {
    var d = {keyword: "false int float while private char catch export virtual operator sizeof dynamic_cast|10 typedef const_cast|10 const struct for static_cast|10 union namespace unsigned long throw volatile static protected bool template mutable if public friend do return goto auto void enum else break new extern using true class asm case typeid short reinterpret_cast|10 default double register explicit signed typename try this switch continue wchar_t inline delete alignof char16_t char32_t constexpr decltype noexcept nullptr static_assert thread_local restrict _Bool complex _Complex _Imaginary",
      built_in: "std string cin cout cerr clog stringstream istringstream ostringstream auto_ptr deque list queue stack vector map set bitset multiset multimap unordered_set unordered_map unordered_multiset unordered_multimap array shared_ptr abort abs acos asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp fscanf isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper isxdigit tolower toupper labs ldexp log10 log malloc memchr memcmp memcpy memset modf pow printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan vfprintf vprintf vsprintf"};
    return{aliases: ["c", "h", "c++", "h++"], keywords: d, illegal: "</", contains: [a.C_LINE_COMMENT_MODE, a.C_BLOCK_COMMENT_MODE, a.QUOTE_STRING_MODE, {className: "string", begin: "'\\\\?.", end: "'", illegal: "."}, {className: "number", begin: "\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"}, a.C_NUMBER_MODE, {className: "preprocessor", begin: "#", end: "$", keywords: "if else elif endif define undef warning error line pragma", contains: [
      {begin: 'include\\s*[<"]', end: '[>"]', keywords: "include", illegal: "\\n"},
      a.C_LINE_COMMENT_MODE
    ]},
      {className: "stl_container", begin: "\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<", end: ">", keywords: d, relevance: 10, contains: ["self"]}, {begin: a.IDENT_RE + "::"}]}
  });
  d.registerLanguage("cs", function (a) {
    return{keywords: "abstract as base bool break byte case catch char checked const continue decimal default delegate do double else enum event explicit extern false finally fixed float for foreach goto if implicit in int interface internal is lock long new null object operator out override params private protected public readonly ref return sbyte sealed short sizeof stackalloc static string struct switch this throw true try typeof uint ulong unchecked unsafe ushort using virtual volatile void while async await ascending descending from get group into join let orderby partial select set value var where yield",
      illegal: /::/, contains: [
        {className: "comment", begin: "///", end: "$", returnBegin: !0, contains: [
          {className: "xmlDocTag", variants: [
            {begin: "///", relevance: 0},
            {begin: "\x3c!--|--\x3e"},
            {begin: "</?", end: ">"}
          ]}
        ]},
        a.C_LINE_COMMENT_MODE,
        a.C_BLOCK_COMMENT_MODE,
        {className: "preprocessor", begin: "#", end: "$", keywords: "if else elif endif define undef warning error line region endregion pragma checksum"},
        {className: "string", begin: '@"', end: '"', contains: [
          {begin: '""'}
        ]},
        a.APOS_STRING_MODE,
        a.QUOTE_STRING_MODE,
        a.C_NUMBER_MODE,
        {beginKeywords: "protected public private internal", end: /[{;=]/, keywords: "abstract as base bool break byte case catch char checked const continue decimal default delegate do double else enum event explicit extern false finally fixed float for foreach goto if implicit in int interface internal is lock long new null object operator out override params private protected public readonly ref return sbyte sealed short sizeof stackalloc static string struct switch this throw true try typeof uint ulong unchecked unsafe ushort using virtual volatile void while async await ascending descending from get group into join let orderby partial select set value var where yield",
          contains: [
            {beginKeywords: "class namespace interface", starts: {contains: [a.TITLE_MODE]}},
            {begin: a.IDENT_RE + "\\s*\\(", returnBegin: !0, contains: [a.TITLE_MODE]}
          ]}
      ]}
  });
  d.registerLanguage("css", function (a) {
    var d = {className: "function", begin: "[a-zA-Z-][a-zA-Z0-9_-]*\\(", returnBegin: !0, excludeEnd: !0, end: "\\("};
    return{case_insensitive: !0, illegal: "[=/|']", contains: [a.C_BLOCK_COMMENT_MODE, {className: "id", begin: "\\#[A-Za-z0-9_-]+"}, {className: "class", begin: "\\.[A-Za-z0-9_-]+", relevance: 0}, {className: "attr_selector",
      begin: "\\[", end: "\\]", illegal: "$"}, {className: "pseudo", begin: ":(:)?[a-zA-Z0-9\\_\\-\\+\\(\\)\\\"\\']+"}, {className: "at_rule", begin: "@(font-face|page)", lexemes: "[a-z-]+", keywords: "font-face page"}, {className: "at_rule", begin: "@", end: "[{;]", contains: [
      {className: "keyword", begin: /\S+/},
      {begin: /\s/, endsWithParent: !0, excludeEnd: !0, relevance: 0, contains: [d, a.APOS_STRING_MODE, a.QUOTE_STRING_MODE, a.CSS_NUMBER_MODE]}
    ]}, {className: "tag", begin: "[a-zA-Z-][a-zA-Z0-9_-]*", relevance: 0}, {className: "rules", begin: "{",
      end: "}", illegal: "[^\\s]", relevance: 0, contains: [a.C_BLOCK_COMMENT_MODE, {className: "rule", begin: "[^\\s]", returnBegin: !0, end: ";", endsWithParent: !0, contains: [
        {className: "attribute", begin: "[A-Z\\_\\.\\-]+", end: ":", excludeEnd: !0, illegal: "[^\\s]", starts: {className: "value", endsWithParent: !0, excludeEnd: !0, contains: [d, a.CSS_NUMBER_MODE, a.QUOTE_STRING_MODE, a.APOS_STRING_MODE, a.C_BLOCK_COMMENT_MODE, {className: "hexcolor", begin: "#[0-9A-Fa-f]+"}, {className: "important", begin: "!important"}]}}
      ]}]}]}
  });
  d.registerLanguage("go",
    function (a) {
      return{aliases: ["golang"], keywords: {keyword: "break default func interface select case map struct chan else goto package switch const fallthrough if range type continue for import return var go defer", constant: "true false iota nil", typename: "bool byte complex64 complex128 float32 float64 int8 int16 int32 int64 string uint8 uint16 uint32 uint64 int uint uintptr rune", built_in: "append cap close complex copy imag len make new panic print println real recover delete"}, illegal: "</", contains: [a.C_LINE_COMMENT_MODE,
        a.C_BLOCK_COMMENT_MODE, a.QUOTE_STRING_MODE, {className: "string", begin: "'", end: "[^\\\\]'"}, {className: "string", begin: "`", end: "`"}, {className: "number", begin: "[^a-zA-Z_0-9](\\-|\\+)?\\d+(\\.\\d+|\\/\\d+)?((d|e|f|l|s)(\\+|\\-)?\\d+)?", relevance: 0}, a.C_NUMBER_MODE]}
    });
  d.registerLanguage("http", function (a) {
    return{illegal: "\\S", contains: [
      {className: "status", begin: "^HTTP/[0-9\\.]+", end: "$", contains: [
        {className: "number", begin: "\\b\\d{3}\\b"}
      ]},
      {className: "request", begin: "^[A-Z]+ (.*?) HTTP/[0-9\\.]+$", returnBegin: !0,
        end: "$", contains: [
        {className: "string", begin: " ", end: " ", excludeBegin: !0, excludeEnd: !0}
      ]},
      {className: "attribute", begin: "^\\w", end: ": ", excludeEnd: !0, illegal: "\\n|\\s|=", starts: {className: "string", end: "$"}},
      {begin: "\\n\\n", starts: {subLanguage: "", endsWithParent: !0}}
    ]}
  });
  d.registerLanguage("ini", function (a) {
    return{case_insensitive: !0, illegal: /\S/, contains: [
      {className: "comment", begin: ";", end: "$"},
      {className: "title", begin: "^\\[", end: "\\]"},
      {className: "setting", begin: "^[a-z0-9\\[\\]_-]+[ \\t]*=[ \\t]*",
        end: "$", contains: [
        {className: "value", endsWithParent: !0, keywords: "on off true false yes no", contains: [a.QUOTE_STRING_MODE, a.NUMBER_MODE], relevance: 0}
      ]}
    ]}
  });
  d.registerLanguage("java", function (a) {
    return{aliases: ["jsp"], keywords: "false synchronized int abstract float private char boolean static null if const for true while long throw strictfp finally protected import native final return void enum else break transient new catch instanceof byte super volatile case assert short package default double public try this switch continue throws",
      illegal: /<\//, contains: [
        {className: "javadoc", begin: "/\\*\\*", end: "\\*/", contains: [
          {className: "javadoctag", begin: "(^|\\s)@[A-Za-z]+"}
        ], relevance: 10},
        a.C_LINE_COMMENT_MODE,
        a.C_BLOCK_COMMENT_MODE,
        a.APOS_STRING_MODE,
        a.QUOTE_STRING_MODE,
        {beginKeywords: "protected public private", end: /[{;=]/, keywords: "false synchronized int abstract float private char boolean static null if const for true while long throw strictfp finally protected import native final return void enum else break transient new catch instanceof byte super volatile case assert short package default double public try this switch continue throws",
          contains: [
            {className: "class", beginKeywords: "class interface", endsWithParent: !0, excludeEnd: !0, illegal: /[:"<>]/, contains: [
              {beginKeywords: "extends implements", relevance: 10},
              a.UNDERSCORE_TITLE_MODE
            ]},
            {begin: a.UNDERSCORE_IDENT_RE + "\\s*\\(", returnBegin: !0, contains: [a.UNDERSCORE_TITLE_MODE]}
          ]},
        a.C_NUMBER_MODE,
        {className: "annotation", begin: "@[A-Za-z]+"}
      ]}
  });
  d.registerLanguage("javascript", function (a) {
    return{aliases: ["js"], keywords: {keyword: "in if for while finally var new function do return void else break catch instanceof with throw case default try this switch continue typeof delete let yield const class",
      literal: "true false null undefined NaN Infinity", built_in: "eval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Error EvalError InternalError RangeError ReferenceError StopIteration SyntaxError TypeError URIError Number Math Date String RegExp Array Float32Array Float64Array Int16Array Int32Array Int8Array Uint16Array Uint32Array Uint8Array Uint8ClampedArray ArrayBuffer DataView JSON Intl arguments require module console window document"},
      contains: [
        {className: "pi", begin: /^\s*('|")use strict('|")/, relevance: 10},
        a.APOS_STRING_MODE,
        a.QUOTE_STRING_MODE,
        a.C_LINE_COMMENT_MODE,
        a.C_BLOCK_COMMENT_MODE,
        a.C_NUMBER_MODE,
        {begin: "(" + a.RE_STARTERS_RE + "|\\b(case|return|throw)\\b)\\s*", keywords: "return throw case", contains: [a.C_LINE_COMMENT_MODE, a.C_BLOCK_COMMENT_MODE, a.REGEXP_MODE, {begin: /</, end: />;/, relevance: 0, subLanguage: "xml"}], relevance: 0},
        {className: "function", beginKeywords: "function", end: /\{/, excludeEnd: !0, contains: [a.inherit(a.TITLE_MODE,
          {begin: /[A-Za-z$_][0-9A-Za-z$_]*/}), {className: "params", begin: /\(/, end: /\)/, contains: [a.C_LINE_COMMENT_MODE, a.C_BLOCK_COMMENT_MODE], illegal: /["'\(]/}], illegal: /\[|%/},
        {begin: /\$[(.]/},
        {begin: "\\." + a.IDENT_RE, relevance: 0}
      ]}
  });
  d.registerLanguage("json", function (a) {
    var d = {literal: "true false null"}, b = [a.QUOTE_STRING_MODE, a.C_NUMBER_MODE], e = {className: "value", end: ",", endsWithParent: !0, excludeEnd: !0, contains: b, keywords: d}, g = {begin: "{", end: "}", contains: [
      {className: "attribute", begin: '\\s*"', end: '"\\s*:\\s*',
        excludeBegin: !0, excludeEnd: !0, contains: [a.BACKSLASH_ESCAPE], illegal: "\\n", starts: e}
    ], illegal: "\\S"};
    a = {begin: "\\[", end: "\\]", contains: [a.inherit(e, {className: null})], illegal: "\\S"};
    b.splice(b.length, 0, g, a);
    return{contains: b, keywords: d, illegal: "\\S"}
  });
  d.registerLanguage("lisp", function (a) {
    var d = {className: "literal", begin: "\\b(t{1}|nil)\\b"}, b = {className: "number", variants: [
      {begin: "(\\-|\\+)?\\d+(\\.\\d+|\\/\\d+)?((d|e|f|l|s)(\\+|\\-)?\\d+)?", relevance: 0},
      {begin: "#b[0-1]+(/[0-1]+)?"},
      {begin: "#o[0-7]+(/[0-7]+)?"},
      {begin: "#x[0-9a-f]+(/[0-9a-f]+)?"},
      {begin: "#c\\((\\-|\\+)?\\d+(\\.\\d+|\\/\\d+)?((d|e|f|l|s)(\\+|\\-)?\\d+)? +(\\-|\\+)?\\d+(\\.\\d+|\\/\\d+)?((d|e|f|l|s)(\\+|\\-)?\\d+)?", end: "\\)"}
    ]};
    a = a.inherit(a.QUOTE_STRING_MODE, {illegal: null});
    var e = {className: "comment", begin: ";", end: "$"}, g = {className: "variable", begin: "\\*", end: "\\*"}, k = {className: "keyword", begin: "[:&][a-zA-Z_\\-\\+\\*\\/\\<\\=\\>\\&\\#][a-zA-Z0-9_\\-\\+\\*\\/\\<\\=\\>\\&\\#!]*"}, h = {className: "quoted", contains: [b, a, g, k, {begin: "\\(", end: "\\)",
      contains: ["self", d, a, b]}], variants: [
      {begin: "['`]\\(", end: "\\)"},
      {begin: "\\(quote ", end: "\\)", keywords: {title: "quote"}}
    ]}, l = {className: "list", begin: "\\(", end: "\\)"}, n = {endsWithParent: !0, relevance: 0};
    l.contains = [
      {className: "title", begin: "[a-zA-Z_\\-\\+\\*\\/\\<\\=\\>\\&\\#][a-zA-Z0-9_\\-\\+\\*\\/\\<\\=\\>\\&\\#!]*"},
      n
    ];
    n.contains = [h, l, d, b, a, e, g, k];
    return{illegal: /\S/, contains: [b, {className: "shebang", begin: "^#!", end: "$"}, d, a, e, h, l]}
  });
  d.registerLanguage("lua", function (a) {
    var d = {begin: "\\[=*\\[", end: "\\]=*\\]",
      contains: ["self"]}, b = [
      {className: "comment", begin: "--(?!\\[=*\\[)", end: "$"},
      {className: "comment", begin: "--\\[=*\\[", end: "\\]=*\\]", contains: [d], relevance: 10}
    ];
    return{lexemes: a.UNDERSCORE_IDENT_RE, keywords: {keyword: "and break do else elseif end false for if in local nil not or repeat return then true until while", built_in: "_G _VERSION assert collectgarbage dofile error getfenv getmetatable ipairs load loadfile loadstring module next pairs pcall print rawequal rawget rawset require select setfenv setmetatable tonumber tostring type unpack xpcall coroutine debug io math os package string table"},
      contains: b.concat([
        {className: "function", beginKeywords: "function", end: "\\)", contains: [a.inherit(a.TITLE_MODE, {begin: "([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*"}), {className: "params", begin: "\\(", endsWithParent: !0, contains: b}].concat(b)},
        a.C_NUMBER_MODE,
        a.APOS_STRING_MODE,
        a.QUOTE_STRING_MODE,
        {className: "string", begin: "\\[=*\\[", end: "\\]=*\\]", contains: [d], relevance: 10}
      ])}
  });
  d.registerLanguage("makefile", function (a) {
    var d = {className: "variable", begin: /\$\(/, end: /\)/, contains: [a.BACKSLASH_ESCAPE]};
    return{aliases: ["mk", "mak"], contains: [a.HASH_COMMENT_MODE, {begin: /^\w+\s*\W*=/, returnBegin: !0, relevance: 0, starts: {className: "constant", end: /\s*\W*=/, excludeEnd: !0, starts: {end: /$/, relevance: 0, contains: [d]}}}, {className: "title", begin: /^[\w]+:\s*$/}, {className: "phony", begin: /^\.PHONY:/, end: /$/, keywords: ".PHONY", lexemes: /[\.\w]+/}, {begin: /^\t+/, end: /$/, contains: [a.QUOTE_STRING_MODE, d]}]}
  });
  d.registerLanguage("xml", function (a) {
    a = {begin: /<\?(php)?(?!\w)/, end: /\?>/, subLanguage: "php", subLanguageMode: "continuous"};
    var d = {endsWithParent: !0, illegal: /</, relevance: 0, contains: [a, {className: "attribute", begin: "[A-Za-z0-9\\._:-]+", relevance: 0}, {begin: "=", relevance: 0, contains: [
      {className: "value", variants: [
        {begin: /"/, end: /"/},
        {begin: /'/, end: /'/},
        {begin: /[^\s\/>]+/}
      ]}
    ]}]};
    return{aliases: "html xhtml rss atom xsl plist".split(" "), case_insensitive: !0, contains: [
      {className: "doctype", begin: "<!DOCTYPE", end: ">", relevance: 10, contains: [
        {begin: "\\[", end: "\\]"}
      ]},
      {className: "comment", begin: "\x3c!--", end: "--\x3e", relevance: 10},
      {className: "cdata",
        begin: "<\\!\\[CDATA\\[", end: "\\]\\]>", relevance: 10},
      {className: "tag", begin: "<style(?=\\s|>|$)", end: ">", keywords: {title: "style"}, contains: [d], starts: {end: "</style>", returnEnd: !0, subLanguage: "css"}},
      {className: "tag", begin: "<script(?=\\s|>|$)", end: ">", keywords: {title: "script"}, contains: [d], starts: {end: "\x3c/script>", returnEnd: !0, subLanguage: "javascript"}},
      {begin: "<%", end: "%>", subLanguage: "vbscript"},
      a,
      {className: "pi", begin: /<\?\w+/, end: /\?>/, relevance: 10},
      {className: "tag", begin: "</?", end: "/?>", contains: [
        {className: "title",
          begin: "[^ /><]+", relevance: 0},
        d
      ]}
    ]}
  });
  d.registerLanguage("markdown", function (a) {
    return{aliases: ["md", "mkdown", "mkd"], contains: [
      {className: "header", variants: [
        {begin: "^#{1,6}", end: "$"},
        {begin: "^.+?\\n[=-]{2,}$"}
      ]},
      {begin: "<", end: ">", subLanguage: "xml", relevance: 0},
      {className: "bullet", begin: "^([*+-]|(\\d+\\.))\\s+"},
      {className: "strong", begin: "[*_]{2}.+?[*_]{2}"},
      {className: "emphasis", variants: [
        {begin: "\\*.+?\\*"},
        {begin: "_.+?_", relevance: 0}
      ]},
      {className: "blockquote", begin: "^>\\s+", end: "$"},
      {className: "code",
        variants: [
          {begin: "`.+?`"},
          {begin: "^( {4}|\t)", end: "$", relevance: 0}
        ]},
      {className: "horizontal_rule", begin: "^[-\\*]{3,}", end: "$"},
      {begin: "\\[.+?\\][\\(\\[].+?[\\)\\]]", returnBegin: !0, contains: [
        {className: "link_label", begin: "\\[", end: "\\]", excludeBegin: !0, returnEnd: !0, relevance: 0},
        {className: "link_url", begin: "\\]\\(", end: "\\)", excludeBegin: !0, excludeEnd: !0},
        {className: "link_reference", begin: "\\]\\[", end: "\\]", excludeBegin: !0, excludeEnd: !0}
      ], relevance: 10},
      {begin: "^\\[.+\\]:", end: "$", returnBegin: !0, contains: [
        {className: "link_reference",
          begin: "\\[", end: "\\]", excludeBegin: !0, excludeEnd: !0},
        {className: "link_url", begin: "\\s", end: "$"}
      ]}
    ]}
  });
  d.registerLanguage("nginx", function (a) {
    var d = {className: "variable", variants: [
      {begin: /\$\d+/},
      {begin: /\$\{/, end: /}/},
      {begin: "[\\$\\@]" + a.UNDERSCORE_IDENT_RE}
    ]};
    return{aliases: ["nginxconf"], contains: [a.HASH_COMMENT_MODE, {begin: a.UNDERSCORE_IDENT_RE + "\\s", end: ";|{", returnBegin: !0, contains: [
      {className: "title", begin: a.UNDERSCORE_IDENT_RE, starts: {endsWithParent: !0, lexemes: "[a-z/_]+", keywords: {built_in: "on off yes no true false none blocked debug info notice warn error crit select break last permanent redirect kqueue rtsig epoll poll /dev/poll"},
        relevance: 0, illegal: "=>", contains: [a.HASH_COMMENT_MODE, {className: "string", contains: [a.BACKSLASH_ESCAPE, d], variants: [
          {begin: /"/, end: /"/},
          {begin: /'/, end: /'/}
        ]}, {className: "url", begin: "([a-z]+):/", end: "\\s", endsWithParent: !0, excludeEnd: !0}, {className: "regexp", contains: [a.BACKSLASH_ESCAPE, d], variants: [
          {begin: "\\s\\^", end: "\\s|{|;", returnEnd: !0},
          {begin: "~\\*?\\s+", end: "\\s|{|;", returnEnd: !0},
          {begin: "\\*(\\.[a-z\\-]+)+"},
          {begin: "([a-z\\-]+\\.)+\\*"}
        ]}, {className: "number", begin: "\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}(:\\d{1,5})?\\b"},
          {className: "number", begin: "\\b\\d+[kKmMgGdshdwy]*\\b", relevance: 0}, d]}}
    ], relevance: 0}], illegal: "[^\\s\\}]"}
  });
  d.registerLanguage("objectivec", function (a) {
    var d = /[a-zA-Z@][a-zA-Z0-9_]*/;
    return{aliases: ["m", "mm", "objc", "obj-c"], keywords: {keyword: "int float while char export sizeof typedef const struct for union unsigned long volatile static bool mutable if do return goto void enum else break extern asm case short default double register explicit signed typename this switch continue wchar_t inline readonly assign self synchronized id nonatomic super unichar IBOutlet IBAction strong weak @private @protected @public @try @property @end @throw @catch @finally @synthesize @dynamic @selector @optional @required",
      literal: "false true FALSE TRUE nil YES NO NULL", built_in: "NSString NSDictionary CGRect CGPoint UIButton UILabel UITextView UIWebView MKMapView UISegmentedControl NSObject UITableViewDelegate UITableViewDataSource NSThread UIActivityIndicator UITabbar UIToolBar UIBarButtonItem UIImageView NSAutoreleasePool UITableView BOOL NSInteger CGFloat NSException NSLog NSMutableString NSMutableArray NSMutableDictionary NSURL NSIndexPath CGSize UITableViewCell UIView UIViewController UINavigationBar UINavigationController UITabBarController UIPopoverController UIPopoverControllerDelegate UIImage NSNumber UISearchBar NSFetchedResultsController NSFetchedResultsChangeType UIScrollView UIScrollViewDelegate UIEdgeInsets UIColor UIFont UIApplication NSNotFound NSNotificationCenter NSNotification UILocalNotification NSBundle NSFileManager NSTimeInterval NSDate NSCalendar NSUserDefaults UIWindow NSRange NSArray NSError NSURLRequest NSURLConnection UIInterfaceOrientation MPMoviePlayerController dispatch_once_t dispatch_queue_t dispatch_sync dispatch_async dispatch_once"},
      lexemes: d, illegal: "</", contains: [a.C_LINE_COMMENT_MODE, a.C_BLOCK_COMMENT_MODE, a.C_NUMBER_MODE, a.QUOTE_STRING_MODE, {className: "string", begin: "'", end: "[^\\\\]'", illegal: "[^\\\\][^']"}, {className: "preprocessor", begin: "#import", end: "$", contains: [
        {className: "title", begin: '"', end: '"'},
        {className: "title", begin: "<", end: ">"}
      ]}, {className: "preprocessor", begin: "#", end: "$"}, {className: "class", begin: "(@interface|@class|@protocol|@implementation)\\b", end: "({|$)", excludeEnd: !0, keywords: "@interface @class @protocol @implementation",
        lexemes: d, contains: [a.UNDERSCORE_TITLE_MODE]}, {className: "variable", begin: "\\." + a.UNDERSCORE_IDENT_RE, relevance: 0}]}
  });
  d.registerLanguage("perl", function (a) {
    var d = {className: "subst", begin: "[$@]\\{", end: "\\}", keywords: "getpwent getservent quotemeta msgrcv scalar kill dbmclose undef lc ma syswrite tr send umask sysopen shmwrite vec qx utime local oct semctl localtime readpipe do return format read sprintf dbmopen pop getpgrp not getpwnam rewinddir qqfileno qw endprotoent wait sethostent bless s|0 opendir continue each sleep endgrent shutdown dump chomp connect getsockname die socketpair close flock exists index shmgetsub for endpwent redo lstat msgctl setpgrp abs exit select print ref gethostbyaddr unshift fcntl syscall goto getnetbyaddr join gmtime symlink semget splice x|0 getpeername recv log setsockopt cos last reverse gethostbyname getgrnam study formline endhostent times chop length gethostent getnetent pack getprotoent getservbyname rand mkdir pos chmod y|0 substr endnetent printf next open msgsnd readdir use unlink getsockopt getpriority rindex wantarray hex system getservbyport endservent int chr untie rmdir prototype tell listen fork shmread ucfirst setprotoent else sysseek link getgrgid shmctl waitpid unpack getnetbyname reset chdir grep split require caller lcfirst until warn while values shift telldir getpwuid my getprotobynumber delete and sort uc defined srand accept package seekdir getprotobyname semop our rename seek if q|0 chroot sysread setpwent no crypt getc chown sqrt write setnetent setpriority foreach tie sin msgget map stat getlogin unless elsif truncate exec keys glob tied closedirioctl socket readlink eval xor readline binmode setservent eof ord bind alarm pipe atan2 getgrent exp time push setgrent gt lt or ne m|0 break given say state when"},
      b = {begin: "->{", end: "}"}, e = {className: "variable", variants: [
        {begin: /\$\d/},
        {begin: /[\$\%\@\*](\^\w\b|#\w+(\:\:\w+)*|{\w+}|\w+(\:\:\w*)*)/},
        {begin: /[\$\%\@\*][^\s\w{]/, relevance: 0}
      ]}, g = {className: "comment", begin: "^(__END__|__DATA__)", end: "\\n$", relevance: 5};
    a = [e, a.HASH_COMMENT_MODE, g, {className: "comment", begin: "^\\=\\w", end: "\\=cut", endsWithParent: !0}, b, {className: "string", contains: [a.BACKSLASH_ESCAPE, d, e], variants: [
      {begin: "q[qwxr]?\\s*\\(", end: "\\)", relevance: 5},
      {begin: "q[qwxr]?\\s*\\[", end: "\\]", relevance: 5},
      {begin: "q[qwxr]?\\s*\\{", end: "\\}", relevance: 5},
      {begin: "q[qwxr]?\\s*\\|", end: "\\|", relevance: 5},
      {begin: "q[qwxr]?\\s*\\<", end: "\\>", relevance: 5},
      {begin: "qw\\s+q", end: "q", relevance: 5},
      {begin: "'", end: "'", contains: [a.BACKSLASH_ESCAPE]},
      {begin: '"', end: '"'},
      {begin: "`", end: "`", contains: [a.BACKSLASH_ESCAPE]},
      {begin: "{\\w+}", contains: [], relevance: 0},
      {begin: "-?\\w+\\s*\\=\\>", contains: [], relevance: 0}
    ]}, {className: "number", begin: "(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b", relevance: 0},
      {begin: "(\\/\\/|" + a.RE_STARTERS_RE + "|\\b(split|return|print|reverse|grep)\\b)\\s*", keywords: "split return print reverse grep", relevance: 0, contains: [a.HASH_COMMENT_MODE, g, {className: "regexp", begin: "(s|tr|y)/(\\\\.|[^/])*/(\\\\.|[^/])*/[a-z]*", relevance: 10}, {className: "regexp", begin: "(m|qr)?/", end: "/[a-z]*", contains: [a.BACKSLASH_ESCAPE], relevance: 0}]}, {className: "sub", beginKeywords: "sub", end: "(\\s*\\(.*?\\))?[;{]", relevance: 5}, {className: "operator", begin: "-\\w\\b", relevance: 0}];
    d.contains = a;
    b.contains =
      a;
    return{aliases: ["pl"], keywords: "getpwent getservent quotemeta msgrcv scalar kill dbmclose undef lc ma syswrite tr send umask sysopen shmwrite vec qx utime local oct semctl localtime readpipe do return format read sprintf dbmopen pop getpgrp not getpwnam rewinddir qqfileno qw endprotoent wait sethostent bless s|0 opendir continue each sleep endgrent shutdown dump chomp connect getsockname die socketpair close flock exists index shmgetsub for endpwent redo lstat msgctl setpgrp abs exit select print ref gethostbyaddr unshift fcntl syscall goto getnetbyaddr join gmtime symlink semget splice x|0 getpeername recv log setsockopt cos last reverse gethostbyname getgrnam study formline endhostent times chop length gethostent getnetent pack getprotoent getservbyname rand mkdir pos chmod y|0 substr endnetent printf next open msgsnd readdir use unlink getsockopt getpriority rindex wantarray hex system getservbyport endservent int chr untie rmdir prototype tell listen fork shmread ucfirst setprotoent else sysseek link getgrgid shmctl waitpid unpack getnetbyname reset chdir grep split require caller lcfirst until warn while values shift telldir getpwuid my getprotobynumber delete and sort uc defined srand accept package seekdir getprotobyname semop our rename seek if q|0 chroot sysread setpwent no crypt getc chown sqrt write setnetent setpriority foreach tie sin msgget map stat getlogin unless elsif truncate exec keys glob tied closedirioctl socket readlink eval xor readline binmode setservent eof ord bind alarm pipe atan2 getgrent exp time push setgrent gt lt or ne m|0 break given say state when",
      contains: a}
  });
  d.registerLanguage("php", function (a) {
    var d = {className: "variable", begin: "\\$+[a-zA-Z_-][a-zA-Z0-9_-]*"}, b = {className: "preprocessor", begin: /<\?(php)?|\?>/}, e = {className: "string", contains: [a.BACKSLASH_ESCAPE, b], variants: [
      {begin: 'b"', end: '"'},
      {begin: "b'", end: "'"},
      a.inherit(a.APOS_STRING_MODE, {illegal: null}),
      a.inherit(a.QUOTE_STRING_MODE, {illegal: null})
    ]}, g = {variants: [a.BINARY_NUMBER_MODE, a.C_NUMBER_MODE]};
    return{aliases: ["php3", "php4", "php5", "php6"], case_insensitive: !0, keywords: "and include_once list abstract global private echo interface as static endswitch array null if endwhile or const for endforeach self var while isset public protected exit foreach throw elseif include __FILE__ empty require_once do xor return parent clone use __CLASS__ __LINE__ else break print eval new catch __METHOD__ case exception default die require __FUNCTION__ enddeclare final try switch continue endfor endif declare unset true false trait goto instanceof insteadof __DIR__ __NAMESPACE__ yield finally",
      contains: [a.C_LINE_COMMENT_MODE, a.HASH_COMMENT_MODE, {className: "comment", begin: "/\\*", end: "\\*/", contains: [
        {className: "phpdoc", begin: "\\s@[A-Za-z]+"},
        b
      ]}, {className: "comment", begin: "__halt_compiler.+?;", endsWithParent: !0, keywords: "__halt_compiler", lexemes: a.UNDERSCORE_IDENT_RE}, {className: "string", begin: "<<<['\"]?\\w+['\"]?$", end: "^\\w+;", contains: [a.BACKSLASH_ESCAPE]}, b, d, {className: "function", beginKeywords: "function", end: /[;{]/, excludeEnd: !0, illegal: "\\$|\\[|%", contains: [a.UNDERSCORE_TITLE_MODE,
        {className: "params", begin: "\\(", end: "\\)", contains: ["self", d, a.C_BLOCK_COMMENT_MODE, e, g]}]}, {className: "class", beginKeywords: "class interface", end: "{", excludeEnd: !0, illegal: /[:\(\$"]/, contains: [
        {beginKeywords: "extends implements", relevance: 10},
        a.UNDERSCORE_TITLE_MODE
      ]}, {beginKeywords: "namespace", end: ";", illegal: /[\.']/, contains: [a.UNDERSCORE_TITLE_MODE]}, {beginKeywords: "use", end: ";", contains: [a.UNDERSCORE_TITLE_MODE]}, {begin: "=>"}, e, g]}
  });
  d.registerLanguage("python", function (a) {
    var d = {className: "prompt",
      begin: /^(>>>|\.\.\.) /}, b = {className: "string", contains: [a.BACKSLASH_ESCAPE], variants: [
      {begin: /(u|b)?r?'''/, end: /'''/, contains: [d], relevance: 10},
      {begin: /(u|b)?r?"""/, end: /"""/, contains: [d], relevance: 10},
      {begin: /(u|r|ur)'/, end: /'/, relevance: 10},
      {begin: /(u|r|ur)"/, end: /"/, relevance: 10},
      {begin: /(b|br)'/, end: /'/},
      {begin: /(b|br)"/, end: /"/},
      a.APOS_STRING_MODE,
      a.QUOTE_STRING_MODE
    ]}, e = {className: "number", relevance: 0, variants: [
      {begin: a.BINARY_NUMBER_RE + "[lLjJ]?"},
      {begin: "\\b(0o[0-7]+)[lLjJ]?"},
      {begin: a.C_NUMBER_RE +
        "[lLjJ]?"}
    ]}, g = {end: /:/, illegal: /[${=;\n]/, contains: [a.UNDERSCORE_TITLE_MODE, {className: "params", begin: /\(/, end: /\)/, contains: ["self", d, e, b]}]};
    return{aliases: ["py", "gyp"], keywords: {keyword: "and elif is global as in if from raise for except finally print import pass return exec else break not with class assert yield try while continue del or def lambda nonlocal|10 None True False", built_in: "Ellipsis NotImplemented"}, illegal: /(<\/|->|\?)/, contains: [d, e, b, a.HASH_COMMENT_MODE, a.inherit(g, {className: "function",
      beginKeywords: "def", relevance: 10}), a.inherit(g, {className: "class", beginKeywords: "class"}), {className: "decorator", begin: /@/, end: /$/}, {begin: /\b(print|exec)\(/}]}
  });
  d.registerLanguage("ruby", function (a) {
    var d = {className: "yardoctag", begin: "@[A-Za-z]+"}, b = {className: "comment", variants: [
        {begin: "#", end: "$", contains: [d]},
        {begin: "^\\=begin", end: "^\\=end", contains: [d], relevance: 10},
        {begin: "^__END__", end: "\\n$"}
      ]}, d = {className: "subst", begin: "#\\{", end: "}", keywords: "and false then defined module in return redo if BEGIN retry end for true self when next until do begin unless END rescue nil else break undef not super class case require yield alias while ensure elsif or include attr_reader attr_writer attr_accessor"},
      e = {className: "string", contains: [a.BACKSLASH_ESCAPE, d], variants: [
        {begin: /'/, end: /'/},
        {begin: /"/, end: /"/},
        {begin: "%[qw]?\\(", end: "\\)"},
        {begin: "%[qw]?\\[", end: "\\]"},
        {begin: "%[qw]?{", end: "}"},
        {begin: "%[qw]?<", end: ">", relevance: 10},
        {begin: "%[qw]?/", end: "/", relevance: 10},
        {begin: "%[qw]?%", end: "%", relevance: 10},
        {begin: "%[qw]?-", end: "-", relevance: 10},
        {begin: "%[qw]?\\|", end: "\\|", relevance: 10},
        {begin: /\B\?(\\\d{1,3}|\\x[A-Fa-f0-9]{1,2}|\\u[A-Fa-f0-9]{4}|\\?\S)\b/}
      ]}, g = {className: "params", begin: "\\(", end: "\\)",
        keywords: "and false then defined module in return redo if BEGIN retry end for true self when next until do begin unless END rescue nil else break undef not super class case require yield alias while ensure elsif or include attr_reader attr_writer attr_accessor"};
    a = [e, b, {className: "class", beginKeywords: "class module", end: "$|;", illegal: /=/, contains: [a.inherit(a.TITLE_MODE, {begin: "[A-Za-z_]\\w*(::\\w+)*(\\?|\\!)?"}), {className: "inheritance", begin: "<\\s*", contains: [
      {className: "parent", begin: "(" + a.IDENT_RE +
        "::)?" + a.IDENT_RE}
    ]}, b]}, {className: "function", beginKeywords: "def", end: " |$|;", relevance: 0, contains: [a.inherit(a.TITLE_MODE, {begin: "[a-zA-Z_]\\w*[!?=]?|[-+~]\\@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?"}), g, b]}, {className: "constant", begin: "(::)?(\\b[A-Z]\\w*(::)?)+", relevance: 0}, {className: "symbol", begin: ":", contains: [e, {begin: "[a-zA-Z_]\\w*[!?=]?|[-+~]\\@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?"}], relevance: 0}, {className: "symbol", begin: a.UNDERSCORE_IDENT_RE + "(\\!|\\?)?:",
      relevance: 0}, {className: "number", begin: "(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b", relevance: 0}, {className: "variable", begin: "(\\$\\W)|((\\$|\\@\\@?)(\\w+))"}, {begin: "(" + a.RE_STARTERS_RE + ")\\s*", contains: [b, {className: "regexp", contains: [a.BACKSLASH_ESCAPE, d], illegal: /\n/, variants: [
      {begin: "/", end: "/[a-z]*"},
      {begin: "%r{", end: "}[a-z]*"},
      {begin: "%r\\(", end: "\\)[a-z]*"},
      {begin: "%r!", end: "![a-z]*"},
      {begin: "%r\\[", end: "\\][a-z]*"}
    ]}], relevance: 0}];
    d.contains = a;
    g.contains = a;
    return{aliases: ["rb", "gemspec", "podspec", "thor"], keywords: "and false then defined module in return redo if BEGIN retry end for true self when next until do begin unless END rescue nil else break undef not super class case require yield alias while ensure elsif or include attr_reader attr_writer attr_accessor", contains: a}
  });
  d.registerLanguage("scala", function (a) {
    var d = {className: "annotation", begin: "@[A-Za-z]+"}, b = {className: "string", begin: 'u?r?"""', end: '"""', relevance: 10};
    return{keywords: "type yield lazy override def with val var false true sealed abstract private trait object null if for while throw finally protected extends import final return else break new catch super class case package default try this match continue throws",
      contains: [
        {className: "javadoc", begin: "/\\*\\*", end: "\\*/", contains: [
          {className: "javadoctag", begin: "@[A-Za-z]+"}
        ], relevance: 10},
        a.C_LINE_COMMENT_MODE,
        a.C_BLOCK_COMMENT_MODE,
        b,
        a.QUOTE_STRING_MODE,
        {className: "symbol", begin: "'\\w[\\w\\d_]*(?!')"},
        {className: "class", begin: "((case )?class |object |trait )", end: "({|$)", excludeEnd: !0, illegal: ":", keywords: "case class trait object", contains: [
          {beginKeywords: "extends with", relevance: 10},
          a.UNDERSCORE_TITLE_MODE,
          {className: "params", begin: "\\(", end: "\\)", contains: [a.QUOTE_STRING_MODE,
            b, d]}
        ]},
        a.C_NUMBER_MODE,
        d
      ]}
  });
  d.registerLanguage("scss", function (a) {
    var d = {className: "variable", begin: "(\\$[a-zA-Z-][a-zA-Z0-9_-]*)\\b"}, b = {className: "function", begin: "[a-zA-Z-][a-zA-Z0-9_-]*\\(", returnBegin: !0, excludeEnd: !0, end: "\\("}, e = {className: "hexcolor", begin: "#[0-9A-Fa-f]+"};
    return{case_insensitive: !0, illegal: "[=/|']", contains: [a.C_LINE_COMMENT_MODE, a.C_BLOCK_COMMENT_MODE, b, {className: "id", begin: "\\#[A-Za-z0-9_-]+", relevance: 0}, {className: "class", begin: "\\.[A-Za-z0-9_-]+", relevance: 0}, {className: "attr_selector",
      begin: "\\[", end: "\\]", illegal: "$"}, {className: "tag", begin: "\\b(a|abbr|acronym|address|area|article|aside|audio|b|base|big|blockquote|body|br|button|canvas|caption|cite|code|col|colgroup|command|datalist|dd|del|details|dfn|div|dl|dt|em|embed|fieldset|figcaption|figure|footer|form|frame|frameset|(h[1-6])|head|header|hgroup|hr|html|i|iframe|img|input|ins|kbd|keygen|label|legend|li|link|map|mark|meta|meter|nav|noframes|noscript|object|ol|optgroup|option|output|p|param|pre|progress|q|rp|rt|ruby|samp|script|section|select|small|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|time|title|tr|tt|ul|var|video)\\b",
      relevance: 0}, {className: "pseudo", begin: ":(visited|valid|root|right|required|read-write|read-only|out-range|optional|only-of-type|only-child|nth-of-type|nth-last-of-type|nth-last-child|nth-child|not|link|left|last-of-type|last-child|lang|invalid|indeterminate|in-range|hover|focus|first-of-type|first-line|first-letter|first-child|first|enabled|empty|disabled|default|checked|before|after|active)"}, {className: "pseudo", begin: "::(after|before|choices|first-letter|first-line|repeat-index|repeat-item|selection|value)"},
      d, {className: "attribute", begin: "\\b(z-index|word-wrap|word-spacing|word-break|width|widows|white-space|visibility|vertical-align|unicode-bidi|transition-timing-function|transition-property|transition-duration|transition-delay|transition|transform-style|transform-origin|transform|top|text-underline-position|text-transform|text-shadow|text-rendering|text-overflow|text-indent|text-decoration-style|text-decoration-line|text-decoration-color|text-decoration|text-align-last|text-align|tab-size|table-layout|right|resize|quotes|position|pointer-events|perspective-origin|perspective|page-break-inside|page-break-before|page-break-after|padding-top|padding-right|padding-left|padding-bottom|padding|overflow-y|overflow-x|overflow-wrap|overflow|outline-width|outline-style|outline-offset|outline-color|outline|orphans|order|opacity|object-position|object-fit|normal|none|nav-up|nav-right|nav-left|nav-index|nav-down|min-width|min-height|max-width|max-height|mask|marks|margin-top|margin-right|margin-left|margin-bottom|margin|list-style-type|list-style-position|list-style-image|list-style|line-height|letter-spacing|left|justify-content|initial|inherit|ime-mode|image-orientation|image-resolution|image-rendering|icon|hyphens|height|font-weight|font-variant-ligatures|font-variant|font-style|font-stretch|font-size-adjust|font-size|font-language-override|font-kerning|font-feature-settings|font-family|font|float|flex-wrap|flex-shrink|flex-grow|flex-flow|flex-direction|flex-basis|flex|filter|empty-cells|display|direction|cursor|counter-reset|counter-increment|content|column-width|column-span|column-rule-width|column-rule-style|column-rule-color|column-rule|column-gap|column-fill|column-count|columns|color|clip-path|clip|clear|caption-side|break-inside|break-before|break-after|box-sizing|box-shadow|box-decoration-break|bottom|border-width|border-top-width|border-top-style|border-top-right-radius|border-top-left-radius|border-top-color|border-top|border-style|border-spacing|border-right-width|border-right-style|border-right-color|border-right|border-radius|border-left-width|border-left-style|border-left-color|border-left|border-image-width|border-image-source|border-image-slice|border-image-repeat|border-image-outset|border-image|border-color|border-collapse|border-bottom-width|border-bottom-style|border-bottom-right-radius|border-bottom-left-radius|border-bottom-color|border-bottom|border|background-size|background-repeat|background-position|background-origin|background-image|background-color|background-clip|background-attachment|background|backface-visibility|auto|animation-timing-function|animation-play-state|animation-name|animation-iteration-count|animation-fill-mode|animation-duration|animation-direction|animation-delay|animation|align-self|align-items|align-content)\\b",
        illegal: "[^\\s]"}, {className: "value", begin: "\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},
      {className: "value", begin: ":", end: ";", contains: [b, d, e, a.CSS_NUMBER_MODE, a.QUOTE_STRING_MODE, a.APOS_STRING_MODE, {className: "important", begin: "!important"}]}, {className: "at_rule", begin: "@", end: "[{;]", keywords: "mixin include extend for if else each while charset import debug media page content font-face namespace warn", contains: [b, d, a.QUOTE_STRING_MODE, a.APOS_STRING_MODE, e, a.CSS_NUMBER_MODE, {className: "preprocessor", begin: "\\s[A-Za-z0-9_.-]+", relevance: 0}]}]}
  });
  d.registerLanguage("sql", function (a) {
    return{case_insensitive: !0,
      illegal: /[<>]/, contains: [
        {className: "operator", beginKeywords: "begin end start commit rollback savepoint lock alter create drop rename call delete do handler insert load replace select truncate update set show pragma grant merge describe use explain help declare prepare execute deallocate savepoint release unlock purge reset change stop analyze cache flush optimize repair kill install uninstall checksum restore check backup", end: /;/, endsWithParent: !0, keywords: "abs absolute acos action add adddate addtime aes_decrypt aes_encrypt after aggregate all allocate alter analyze and any are as asc ascii asin assertion at atan atan2 atn2 authorization authors avg backup before begin benchmark between bin binary binlog bit bit_and bit_count bit_length bit_or bit_xor both by cache call cascade cascaded case cast catalog ceil ceiling chain change changed char char_length character character_length charindex charset check checksum checksum_agg choose close coalesce coercibility collate collation collationproperty column columns columns_updated commit compress concat concat_ws concurrent connect connection connection_id consistent constraint constraints continue contributors conv convert convert_tz corresponding cos cot count count_big crc32 create cross cume_dist curdate current current_date current_time current_timestamp current_user cursor curtime data database databases datalength date date_add date_format date_sub dateadd datediff datefromparts datename datepart datetime2fromparts datetimeoffsetfromparts day dayname dayofmonth dayofweek dayofyear deallocate dec decimal declare decode default deferrable deferred degrees delayed delete des_decrypt des_encrypt des_key_file desc describe descriptor diagnostics difference disconnect distinct distinctrow div do domain double drop dumpfile each else elt enclosed encode encrypt end end-exec engine engines eomonth errors escape escaped event eventdata events except exception exec execute exists exp explain export_set extended external extract false fast fetch field fields find_in_set first first_value float floor flush for force foreign format found found_rows from from_base64 from_days from_unixtime full function get get_format get_lock getdate getutcdate global go goto grant grants greatest group group_concat grouping grouping_id gtid_subset gtid_subtract handler having help hex high_priority hosts hour ident_current ident_incr ident_seed identified identity if ifnull ignore iif ilike immediate in index indicator inet6_aton inet6_ntoa inet_aton inet_ntoa infile initially inner innodb input insert install instr int integer intersect interval into is is_free_lock is_ipv4 is_ipv4_compat is_ipv4_mapped is_not is_not_null is_used_lock isdate isnull isolation join key kill language last last_day last_insert_id last_value lcase lead leading least leaves left len lenght level like limit lines ln load load_file local localtime localtimestamp locate lock log log10 log2 logfile logs low_priority lower lpad ltrim make_set makedate maketime master master_pos_wait match matched max md5 medium merge microsecond mid min minute mod mode module month monthname mutex name_const names national natural nchar next no no_write_to_binlog not now null nullif number numeric nvarchar oct octet_length of old_password on only open optimize option optionally or ord order outer outfile output pad parse partial partition password patindex percent_rank percentile_cont percentile_disc period_add period_diff pi plugin position pow power pragma precision prepare preserve primary prior privileges procedure procedure_analyze processlist profile profiles public publishingservername purge quarter query quick quote quotename radians rand read real references regexp relative relaylog release release_lock rename repair repeat replace replicate reset restore restrict return returns reverse revoke right rlike rollback rollup round row row_count rows rpad rtrim savepoint schema scroll sec_to_time second section select serializable server session session_user set sha sha1 sha2 share show sign sin size slave sleep smalldatetimefromparts smallint snapshot some soname soundex sounds_like space sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sql_variant_property sqlstate sqrt square start starting status std stddev stddev_pop stddev_samp stdev stdevp stop str str_to_date straight_join strcmp string stuff subdate substr substring subtime subtring_index sum switchoffset sysdate sysdatetime sysdatetimeoffset system_user sysutcdatetime table tables tablespace tan temporary terminated tertiary_weights then time time_format time_to_sec timediff timefromparts timestamp timestampadd timestampdiff timezone_hour timezone_minute to to_base64 to_days to_seconds todatetimeoffset trailing transaction translation trigger trigger_nestlevel triggers trim true truncate try_cast try_convert try_parse ucase uncompress uncompressed_length unhex unicode uninstall union unique unix_timestamp unknown unlock update upgrade upped upper usage use user user_resources using utc_date utc_time utc_timestamp uuid uuid_short validate_password_strength value values var var_pop var_samp varchar variables variance varp varying version view warnings week weekday weekofyear weight_string when whenever where with work write xml xor year yearweek zon",
          contains: [
            {className: "string", begin: "'", end: "'", contains: [a.BACKSLASH_ESCAPE, {begin: "''"}]},
            {className: "string", begin: '"', end: '"', contains: [a.BACKSLASH_ESCAPE, {begin: '""'}]},
            {className: "string", begin: "`", end: "`", contains: [a.BACKSLASH_ESCAPE]},
            a.C_BLOCK_COMMENT_MODE,
            a.C_NUMBER_MODE
          ]},
        a.C_BLOCK_COMMENT_MODE,
        {className: "comment", begin: "--", end: "$"}
      ]}
  });
  d.registerLanguage("vim", function (a) {
    return{lexemes: /[!#@\w]+/, keywords: {keyword: "N|0 P|0 X|0 a|0 ab abc abo al am an|0 ar arga argd arge argdo argg argl argu as au aug aun b|0 bN ba bad bd be bel bf bl bm bn bo bp br brea breaka breakd breakl bro bufdo buffers bun bw c|0 cN cNf ca cabc caddb cad caddf cal cat cb cc ccl cd ce cex cf cfir cgetb cgete cg changes chd che checkt cl cla clo cm cmapc cme cn cnew cnf cno cnorea cnoreme co col colo com comc comp con conf cope cp cpf cq cr cs cst cu cuna cunme cw d|0 delm deb debugg delc delf dif diffg diffo diffp diffpu diffs diffthis dig di dl dell dj dli do doautoa dp dr ds dsp e|0 ea ec echoe echoh echom echon el elsei em en endfo endf endt endw ene ex exe exi exu f|0 files filet fin fina fini fir fix fo foldc foldd folddoc foldo for fu g|0 go gr grepa gu gv ha h|0 helpf helpg helpt hi hid his i|0 ia iabc if ij il im imapc ime ino inorea inoreme int is isp iu iuna iunme j|0 ju k|0 keepa kee keepj lN lNf l|0 lad laddb laddf la lan lat lb lc lch lcl lcs le lefta let lex lf lfir lgetb lgete lg lgr lgrepa lh ll lla lli lmak lm lmapc lne lnew lnf ln loadk lo loc lockv lol lope lp lpf lr ls lt lu lua luad luaf lv lvimgrepa lw m|0 ma mak map mapc marks mat me menut mes mk mks mksp mkv mkvie mod mz mzf nbc nb nbs n|0 new nm nmapc nme nn nnoreme noa no noh norea noreme norm nu nun nunme ol o|0 om omapc ome on ono onoreme opt ou ounme ow p|0 profd prof pro promptr pc ped pe perld po popu pp pre prev ps pt ptN ptf ptj ptl ptn ptp ptr pts pu pw py3 python3 py3d py3f py pyd pyf q|0 quita qa r|0 rec red redi redr redraws reg res ret retu rew ri rightb rub rubyd rubyf rund ru rv s|0 sN san sa sal sav sb sbN sba sbf sbl sbm sbn sbp sbr scrip scripte scs se setf setg setl sf sfir sh sim sig sil sl sla sm smap smapc sme sn sni sno snor snoreme sor so spelld spe spelli spellr spellu spellw sp spr sre st sta startg startr star stopi stj sts sun sunm sunme sus sv sw sy synti sync t|0 tN tabN tabc tabdo tabe tabf tabfir tabl tabm tabnew tabn tabo tabp tabr tabs tab ta tags tc tcld tclf te tf th tj tl tm tn to tp tr try ts tu u|0 undoj undol una unh unl unlo unm unme uns up v|0 ve verb vert vim vimgrepa vi viu vie vm vmapc vme vne vn vnoreme vs vu vunme windo w|0 wN wa wh wi winc winp wn wp wq wqa ws wu wv x|0 xa xmapc xm xme xn xnoreme xu xunme y|0 z|0 ~ Next Print append abbreviate abclear aboveleft all amenu anoremenu args argadd argdelete argedit argglobal arglocal argument ascii autocmd augroup aunmenu buffer bNext ball badd bdelete behave belowright bfirst blast bmodified bnext botright bprevious brewind break breakadd breakdel breaklist browse bunload bwipeout change cNext cNfile cabbrev cabclear caddbuffer caddexpr caddfile call catch cbuffer cclose center cexpr cfile cfirst cgetbuffer cgetexpr cgetfile chdir checkpath checktime clist clast close cmap cmapclear cmenu cnext cnewer cnfile cnoremap cnoreabbrev cnoremenu copy colder colorscheme command comclear compiler continue confirm copen cprevious cpfile cquit crewind cscope cstag cunmap cunabbrev cunmenu cwindow delete delmarks debug debuggreedy delcommand delfunction diffupdate diffget diffoff diffpatch diffput diffsplit digraphs display deletel djump dlist doautocmd doautoall deletep drop dsearch dsplit edit earlier echo echoerr echohl echomsg else elseif emenu endif endfor endfunction endtry endwhile enew execute exit exusage file filetype find finally finish first fixdel fold foldclose folddoopen folddoclosed foldopen function global goto grep grepadd gui gvim hardcopy help helpfind helpgrep helptags highlight hide history insert iabbrev iabclear ijump ilist imap imapclear imenu inoremap inoreabbrev inoremenu intro isearch isplit iunmap iunabbrev iunmenu join jumps keepalt keepmarks keepjumps lNext lNfile list laddexpr laddbuffer laddfile last language later lbuffer lcd lchdir lclose lcscope left leftabove lexpr lfile lfirst lgetbuffer lgetexpr lgetfile lgrep lgrepadd lhelpgrep llast llist lmake lmap lmapclear lnext lnewer lnfile lnoremap loadkeymap loadview lockmarks lockvar lolder lopen lprevious lpfile lrewind ltag lunmap luado luafile lvimgrep lvimgrepadd lwindow move mark make mapclear match menu menutranslate messages mkexrc mksession mkspell mkvimrc mkview mode mzscheme mzfile nbclose nbkey nbsart next nmap nmapclear nmenu nnoremap nnoremenu noautocmd noremap nohlsearch noreabbrev noremenu normal number nunmap nunmenu oldfiles open omap omapclear omenu only onoremap onoremenu options ounmap ounmenu ownsyntax print profdel profile promptfind promptrepl pclose pedit perl perldo pop popup ppop preserve previous psearch ptag ptNext ptfirst ptjump ptlast ptnext ptprevious ptrewind ptselect put pwd py3do py3file python pydo pyfile quit quitall qall read recover redo redir redraw redrawstatus registers resize retab return rewind right rightbelow ruby rubydo rubyfile rundo runtime rviminfo substitute sNext sandbox sargument sall saveas sbuffer sbNext sball sbfirst sblast sbmodified sbnext sbprevious sbrewind scriptnames scriptencoding scscope set setfiletype setglobal setlocal sfind sfirst shell simalt sign silent sleep slast smagic smapclear smenu snext sniff snomagic snoremap snoremenu sort source spelldump spellgood spellinfo spellrepall spellundo spellwrong split sprevious srewind stop stag startgreplace startreplace startinsert stopinsert stjump stselect sunhide sunmap sunmenu suspend sview swapname syntax syntime syncbind tNext tabNext tabclose tabedit tabfind tabfirst tablast tabmove tabnext tabonly tabprevious tabrewind tag tcl tcldo tclfile tearoff tfirst throw tjump tlast tmenu tnext topleft tprevious trewind tselect tunmenu undo undojoin undolist unabbreviate unhide unlet unlockvar unmap unmenu unsilent update vglobal version verbose vertical vimgrep vimgrepadd visual viusage view vmap vmapclear vmenu vnew vnoremap vnoremenu vsplit vunmap vunmenu write wNext wall while winsize wincmd winpos wnext wprevious wqall wsverb wundo wviminfo xit xall xmapclear xmap xmenu xnoremap xnoremenu xunmap xunmenu yank",
      built_in: "abs acos add and append argc argidx argv asin atan atan2 browse browsedir bufexists buflisted bufloaded bufname bufnr bufwinnr byte2line byteidx call ceil changenr char2nr cindent clearmatches col complete complete_add complete_check confirm copy cos cosh count cscope_connection cursor deepcopy delete did_filetype diff_filler diff_hlID empty escape eval eventhandler executable exists exp expand extend feedkeys filereadable filewritable filter finddir findfile float2nr floor fmod fnameescape fnamemodify foldclosed foldclosedend foldlevel foldtext foldtextresult foreground function garbagecollect get getbufline getbufvar getchar getcharmod getcmdline getcmdpos getcmdtype getcwd getfontname getfperm getfsize getftime getftype getline getloclist getmatches getpid getpos getqflist getreg getregtype gettabvar gettabwinvar getwinposx getwinposy getwinvar glob globpath has has_key haslocaldir hasmapto histadd histdel histget histnr hlexists hlID hostname iconv indent index input inputdialog inputlist inputrestore inputsave inputsecret insert invert isdirectory islocked items join keys len libcall libcallnr line line2byte lispindent localtime log log10 luaeval map maparg mapcheck match matchadd matcharg matchdelete matchend matchlist matchstr max min mkdir mode mzeval nextnonblank nr2char or pathshorten pow prevnonblank printf pumvisible py3eval pyeval range readfile reltime reltimestr remote_expr remote_foreground remote_peek remote_read remote_send remove rename repeat resolve reverse round screenattr screenchar screencol screenrow search searchdecl searchpair searchpairpos searchpos server2client serverlist setbufvar setcmdpos setline setloclist setmatches setpos setqflist setreg settabvar settabwinvar setwinvar sha256 shellescape shiftwidth simplify sin sinh sort soundfold spellbadword spellsuggest split sqrt str2float str2nr strchars strdisplaywidth strftime stridx string strlen strpart strridx strtrans strwidth submatch substitute synconcealed synID synIDattr synIDtrans synstack system tabpagebuflist tabpagenr tabpagewinnr tagfiles taglist tan tanh tempname tolower toupper tr trunc type undofile undotree values virtcol visualmode wildmenumode winbufnr wincol winheight winline winnr winrestcmd winrestview winsaveview winwidth writefile xor"},
      illegal: /[{:]/, contains: [a.NUMBER_MODE, a.APOS_STRING_MODE, {className: "string", begin: /"((\\")|[^"\n])*("|\n)/}, {className: "variable", begin: /[bwtglsav]:[\w\d_]*/}, {className: "function", beginKeywords: "function function!", end: "$", relevance: 0, contains: [a.TITLE_MODE, {className: "params", begin: "\\(", end: "\\)"}]}]}
  });
  return d
});
define("views/library/previewer/templates/basic", [], function () {
  return function (d) {
    return'<div class="previewer-content"> <div class="previewer-content-image-wapper"> <div class="img-previewer"></div> <div class="pdf-previewer"></div> <div class="text-previewer thin-scroll"></div> <ul class="thumbnails-previewer"></ul> <div class="work"> <div class="work-thumbnail"><p class="work-name"></p></div> <p class="work-title"></p> <a class="previewer-download-link" href="#" target="_blank" data-gta="event" data-label="download work">  <span></span> </a> <p class="deleted-info"></p> </div> <div class="previewer-handler-set"> <div class="thumbnail-set"> <div class="handler-group"> <a class="enter-collection-handler" data-gta="event" data-label="enter collection">  </a> </div> </div> <div class="previewer-set"> <div class="handler-group"> <a class="download-image-handler" data-gta="event" data-label="download work">  </a> </div> <span>|</span> <div class="handler-group"> <a class="update-work-handler" data-gta="event" data-label="update work">  </a> </div> <span>|</span> <div class="handler-group"> <a class="move-image-handler dropdown-toggler" data-gta="event" data-label="move work">  </a> </div> <span>|</span> <div class="handler-group"> <a class="dropdown-toggler" data-toggle="dropdown" data-gta="event" data-label="delete work">  </a> <ul class="dropdown-menu"> <li> <a class="delete-image-handler"> <span class="icon icon-trash"></span>  </a> </li> </ul> </div> </div> </div> <div class="previewer-footer"> <h3 class="image-info"> <span class="image-name"></span> </h3> <div class="images-count map"> </div> </div> <div class="prev-handler"> </div> <div class="next-handler"> </div> </div> <div class="activities-container transparent-scroll"> <div class="involve-set"> <ul class="involve-members"></ul> </div> <div class="activities"></div> </div> <div class="activity-creator-wrapper"></div> <a class="close-previewer-handler icon icon-remove" data-gta="event" data-label="close previewer"></a></div>'
  }
});
define("views/library/previewer/templates/creator", [], function () {
  return function (d) {
    return'<div class="creator-wrapper"> <div class="avatar avatar' + d._id + ' img-circle pull-left" style="background-image: url(' + d.avatarUrl + ');"></div> <div class="creator-info"> <span class="creator-name">' + d.name + '</span> <time class="time-stamp muted" datetime="' + d.created + '"></time> </div></div>'
  }
});
define("views/library/previewer/templates/count", [], function () {
  return function (d) {
    for (var a = '<ol class="map-indicators"> ', f = d.begin; f <= d.end; f++)a += ' <li class="previewer-map-btn ', d.index == f && (a += "active"), a += " ", -1 == f && (a += "thumbnail-map-btn"), a += '" data-map-to="' + f + '"></li> ';
    return a + "</ol>"
  }
});
define("views/library/previewer/templates/empty", [], function () {
  return function (d) {
    return'<div class="previewer-overlay modal-backdrop"> <div class="empty"></div></div>'
  }
});
define("views/library/previewer/templates/error", [], function () {
  return function (d) {
    var a = "";
    "fail" === d ? a += '<a class="previewer-error-indicator"> <p class="message"> <span class="icon icon-refresh"></span>  </p></a>' : "error" === d && (a += '<div class="previewer-error-indicator"> <p class="message">  </p></div>');
    return a
  }
});
var PDFObject = function (d) {
  if (!d || !d.url)return!1;
  var a = d.id || !1, f = d.width || "100%", b = d.height || "100%", e = d.pdfOpenParams, g, k, h, l, n, m, s, r, t;
  h = function (a) {
    var b;
    try {
      b = new ActiveXObject(a)
    } catch (e) {
      b = null
    }
    return b
  };
  l = function () {
    var a = null;
    return window.ActiveXObject && ((a = h("AcroPDF.PDF")) || (a = h("PDF.PdfCtrl")), null !== a) ? !0 : !1
  };
  n = function () {
    var a, b = navigator.plugins, e = b.length, d = /Adobe Reader|Adobe PDF|Acrobat/gi;
    for (a = 0; a < e; a++)if (d.test(b[a].name))return!0;
    return!1
  };
  m = function () {
    var a = navigator.mimeTypes["application/pdf"];
    return a && a.enabledPlugin
  };
  isIE9 = function () {
    return-1 < navigator.userAgent.indexOf("Trident/5")
  };
  s = function () {
    var a = document.getElementsByTagName("html"), b;
    if (!a)return!1;
    a = a[0].style;
    b = document.body.style;
    a.height = "100%";
    a.overflow = "hidden";
    b.margin = "0";
    b.padding = "0";
    b.height = "100%";
    b.overflow = "hidden"
  };
  r = function (d) {
    var h = null;
    switch (d) {
      case "url":
        h = g;
        break;
      case "id":
        h = a;
        break;
      case "width":
        h = f;
        break;
      case "height":
        h = b;
        break;
      case "pdfOpenParams":
        h = e;
        break;
      case "pluginTypeFound":
        h = k;
        break;
      case "pdfobjectversion":
        h =
          "1.2"
    }
    return h
  };
  t = function (a) {
    if (!k)return!1;
    var e = null;
    if (a) {
      if (e = a.nodeType && 1 === a.nodeType ? a : document.getElementById(a), !e)return!1
    } else e = document.body, s(), b = f = "100%";
    if (isIE9())return e.innerHTML = '<iframe    src="' + g + '" width="' + f + '" height="' + b + '"></iframe>', e.getElementsByTagName("iframe")[0];
    e.innerHTML = '<object    data="' + g + '" type="application/pdf" width="' + f + '" height="' + b + '"></object>';
    return e.getElementsByTagName("object")[0]
  };
  g = encodeURI(d.url) + "#" + function (a) {
    var b = "", e;
    if (!a)return b;
    for (e in a)a.hasOwnProperty(e) && (b += e + "=", b = "search" === e ? b + encodeURI(a[e]) : b + a[e], b += "&");
    return b.slice(0, b.length - 1)
  }(e);
  k = function () {
    var a = null;
    n() || l() ? a = "Adobe" : m() && (a = "generic");
    return a
  }();
  this.get = function (a) {
    return r(a)
  };
  this.embed = function (a) {
    return t(a)
  };
  this.pdfobjectversion = "1.2";
  return this
};
define("pdf", function () {
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/library/previewer/index", "exports view views/member/member-involve/index views/activity/activity-timeline/index views/core/mover/index lib/uploader/index warehouse collections/collections collections/members util thenjs highlight ./templates/basic ./templates/creator ./templates/count ./templates/empty ./templates/error essage pdf".split(" "),
    function (d, b, e, g, k, h, l, n, m, s, r, t, v, p, x, B, C) {
      var z, A;
      z = teambition.router;
      b = function (b) {
        function d() {
          return A = d.__super__.constructor.apply(this, arguments)
        }

        a(d, b);
        d.prototype.viewName = "PreviewerView";
        d.prototype.tagName = "div";
        d.prototype.className = "previewer";
        d.prototype.hotkeys = {right: "goNext", left: "goPrev", esc: function (a) {
          a.preventDefault();
          return this.close()
        }};
        d.prototype.preventHotkeys = ["i", "n", "h"];
        d.prototype.events = {"click .prev-handler": "goPrev", "click .next-handler": "goNext", "click .previewer-overlay": "close",
          "click .close-previewer-handler": "close", "click .download-image-handler": "openImageInNewWindow", "click .move-image-handler": "openMover", "click .delete-image-handler": "deleteWork", "click .previewer-map-btn": "goToIndex", "click .download-collection-handler": "downloadCollection", "click .enter-collection-handler": "enterCollection", "click .img-previewer img": "showNaturalImage"};
        d.prototype.initialize = function (a) {
          if (null != a && a._projectId) {
            this.options = a;
            this.worksCollection = this.options.worksCollection;
            this.workModels = this.options.workModels;
            if (this.thumbnailModel = 1 === this.workModels.length ? null : this.options.thumbnailModel)this.workModels[-1] = this.thumbnailModel;
            this._imgForComputeList = [];
            this.reset(this.thumbnailModel || this.options.workModel || this.workModels[0]);
            this.setupIndex();
            this.render();
            return this
          }
        };
        d.prototype.close = function (a) {
          var b, e, d;
          null != a && "function" === typeof a.stopPropagation && a.stopPropagation();
          null != (b = this.$img) && b.hide();
          this.imgOffLoad();
          null != (e = this.$pdfViewer) && e.remove();
          this.$pdfViewer = $('<a class="pdf-previewer" width="100%" height="100%"></a>');
          this.$pdfViewer.appendTo(this.$imgset);
          a = z.getUrl().replace(/\/work\/.+/, "");
          z.navigate(a, {trigger: !1});
          null != (d = this.parentView) && d.remove();
          return this
        };
        d.prototype.render = function () {
          this.workModel ? (this.$el.html(v()), this.$thumbnails = this.$(".thumbnails-previewer").hide(), this.$lastView = this.$img = this.$(".img-previewer").hide(), this.$pdfViewer = this.$(".pdf-previewer").hide(), this.$textViewer = this.$(".text-previewer").hide(),
            this.$file = this.$(".work").hide(), this.$closeHandler = this.$(".close-previewer-handler"), this.$thumbnailHeader = this.$(".previewer-handler-set > .thumbnail-set"), this.$previewerHeader = this.$(".previewer-handler-set > .previewer-set"), this.$imgset = this.$(".previewer-content-image-wapper"), this.$name = this.$(".image-name"), this.$activities = this.$(".activities"), this.$prev = this.$(".prev-handler"), this.$next = this.$(".next-handler"), this.$count = this.$(".images-count"), this.$loadingimg = this.$(".loadingimg"),
            this.checkHideOrShow(), this.renderImageOrPdf(), this.refreshFooter(), this.refreshPreviewerUrl(), this.options.disableActivity ? this.$el.addClass("disable-activity") : (this.initInvolve(), this.renderCreator(), this.renderActivities()), this.initUploader()) : this.$el.html(B());
          return this
        };
        d.prototype.reset = function (a) {
          this.stopListening();
          this.workModel = a;
          if (!this.workModel)return this;
          0 <= this.index && (this.listenTo(this.workModel, "change:src", this.renderImageOrPdf), this.listenTo(this.workModel, "change:fileName",
            this.refreshName), this.listenTo(this.workModel, "remove", this.close));
          return this
        };
        d.prototype.renderCreator = function () {
          var a;
          null != (a = this.$creator) && a.remove();
          if (a = this.membersCollection.get(this.workModel.get("_creatorId")))return a = a.toJSON(), a.created = this.workModel.get("created"), this.$creator = $(p(a)), this.$creator.find("time").timesince(), this.$(".activities-container").prepend(this.$creator), this
        };
        d.prototype.setupIndex = function () {
          if (this.workModel && this.workModels)return this.index = _.indexOf(_.pluck(this.workModels,
            "id"), this.workModel.id), this
        };
        d.prototype.refreshFooter = function () {
          this.refreshCount();
          this.refreshName();
          return this
        };
        d.prototype.refreshCount = function () {
          this.$count.html(x({begin: this.workModels[-1] ? -1 : 0, end: this.workModels.length - 1, index: this.index}));
          return this
        };
        d.prototype.refreshName = function () {
          var a;
          a = this.workModel.get("fileName") || this.workModel.get("title");
          this.$name.html(a);
          return this
        };
        d.prototype.renderImageOrPdf = function () {
          var a, b, e = this;
          a = ("function" === typeof(b = this.workModel).toJSON ?
            b.toJSON() : void 0) || this.workModel;
          ~this.index ? (this.$thumbnailHeader.hide(), this.$previewerHeader.show()) : (this.$thumbnailHeader.show(), this.$previewerHeader.hide());
          this.$lastView.stop().animate({opacity: 0}, function () {
            var b;
            e.$lastView.hide();
            return e.$lastView = ~e.index ? "image" === a.fileCategory ? (e.renderImage(), e.$img.show()) : a.previewUrl || "pdf" === a.fileType ? (e.renderPDF(a), e.$pdfViewer.show().animate({opacity: 1})) : "text" === a.fileCategory || "txt" === (b = a.fileType) || "md" === b || "html" === b || "js" === b ||
              "json" === b ? (e.renderText(a, e.workModel), e.$textViewer.show().animate({opacity: 1})) : (e.renderFile(a), e.$file.show().animate({opacity: 1})) : (e.renderThumbnails(), e.$thumbnails.css({opacity: 1}).show())
          });
          return this
        };
        d.prototype.renderPDF = function (a) {
          this.$pdfViewer.html("");
          this.onLoaded();
          (new PDFObject({url: a.previewUrl || a.downloadUrl})).embed(this.$pdfViewer[0]);
          return this
        };
        d.prototype.renderText = function (a, b) {
          var e, d = this;
          this.$textViewer.html("");
          this.onLoading();
          e = function (e) {
            d.onLoaded();
            a._cacheText !==
              e && null != b && "function" === typeof b.set && b.set("_cacheText", e);
            e = $("<code></code>").text(e);
            t.highlightBlock(e[0]);
            return $("<pre></pre>").append(e).appendTo(d.$textViewer)
          };
          a._cacheText ? e(a._cacheText) : s.http(a.downloadUrl, {converters: {"text script": !0, "text json": !0, "text xml": !0}, success: e});
          return this
        };
        d.prototype.renderImage = function () {
          var a, b, e = this;
          this.$img.html("");
          a = this.workModels[this.index];
          a = "function" === typeof a.toJSON ? a.toJSON() : void 0;
          null != a && a.downloadUrl && (this.onLoading(), b = s.loadImage(a.downloadUrl,
            function (a, d, f) {
              var g, h;
              e.onLoaded();
              s.removeItem(e._imgForComputeList, b);
              if (!a)return a = $(b), h = e.$imgset.width(), g = e.$imgset.height(), d = d > h || f > g ? d / f > h / g ? {width: h, height: f * h / d} : {width: d * g / f, height: g} : {width: d, height: f}, a.css(d), e.$img.attr("style", "").css(d).html(a)
            }), this._imgForComputeList.push(b));
          return this
        };
        d.prototype.renderThumbnails = function () {
          var a, b, e, d = this;
          this.onLoading();
          this.$thumbnails.children().remove();
          this.$thumbnails.show();
          e = this.workModels.length;
          b = s.calcuGrid(this.$thumbnails.width(),
            this.$thumbnails.height(), e, 1.618);
          a = '<li style="width: ' + b.width + "px; height: " + b.height + 'px;">';
          e <= b.rows && this.$thumbnails.width(b.width * e);
          r.each(this.workModels,function (b, e, f) {
            var g, h, k;
            g = $("<div>");
            h = $('<div class="previewer-map-btn work" data-map-to="' + f + '">');
            f = e.get("thumbnail") || e.thumbnail || "";
            k = !f;
            $(a).append(h).appendTo(d.$thumbnails);
            return d.getImageProp(f, g, h, !0, function () {
              k && g.addClass("work-thumbnail").text(e.get("fileName"));
              h.append(g);
              k && h.append('<p class="work-title ' + e.get("fileType") +
                '">' + e.get("fileType") + "</p>");
              g.css("line-height", g.height() + "px").animate({opacity: 1});
              return b()
            })
          }).all(function (a) {
              return d.onLoaded()
            });
          return this
        };
        d.prototype.getImageProp = function (a, b, e, d, f) {
          var g, h = this;
          if (!a)return f("url err!");
          g = s.loadImage(a, function (k, p, l) {
            var m;
            s.removeItem(h._imgForComputeList, g);
            k && f(k);
            b.css({"background-image": "url(" + a + ")", opacity: 0});
            m = e.width();
            k = e.height();
            p > m || l > k ? d || b.css({backgroundSize: p / l > m / k ? "" + m + "px auto" : "auto " + k + "px", width: "", height: ""}) : b.css({width: p,
              height: l});
            return f()
          });
          this._imgForComputeList.push(g);
          return this
        };
        d.prototype.imgOffLoad = function () {
          _.each(this._imgForComputeList, function (a) {
            return a.abort()
          });
          this._imgForComputeList = [];
          return this
        };
        d.prototype.renderFile = function (a) {
          var b, e, d, f;
          f = a.fileName;
          b = this.$file.find(".deleted-info");
          e = this.$file.find(".work-thumbnail");
          d = this.$file.find(".work-title");
          a.isDeleted ? b.show() : b.hide();
          this.$file.find(".work-title").html("" + a.fileType);
          this.$file.find(".work-title").addClass("" + a.fileType);
          this.$file.find(".work-name").html(f);
          b = this.$file.find(".previewer-download-link");
          a.isDeleted ? (b.hide(), e.hide(), d.hide()) : (b.show().attr("href", a.downloadUrl), e.show(), d.show());
          this.$file.find(".previewer-download-link span").html("(" + s.formatFileSize(a.fileSize) + ")");
          this.onLoaded();
          return this
        };
        d.prototype.initInvolve = function () {
          var a, b, d = this;
          null != (b = this.involveView) && b.remove();
          delete this.involveView;
          b = this.options._projectId;
          a = this.$(".involve-members");
          l.request(m, b, {success: function (b) {
            d.membersCollection =
              b;
            d.involveView = d.requestSubView(e, {objectModel: d.workModel, membersCollection: b, $list: a, dropArea: d.$el, undeletable: !1, type: "previewer"});
            return d.involveView.$el.insertBefore(a)
          }});
          return this
        };
        d.prototype.renderActivities = function () {
          var a, b;
          null != (a = this.workModel) && a.id && (null != (b = this.activityTimeline) && b.remove(), this.activityTimeline = this.requestSubView(g, {_objectId: this.workModel.id, boundToObjectType: this.workModel.get("objectType"), _projectId: this.options._projectId, noCreator: !0}), this.activityTimeline.$el.appendTo(this.$activities),
            this.activityTimeline.renderCreator(this.$(".activity-creator-wrapper")));
          return this
        };
        d.prototype.onLoading = function () {
          this.showLoadingIndicator(this.$imgset, {isPrepend: !0});
          return this
        };
        d.prototype.onLoaded = function () {
          this.hideLoadingIndicator({animated: !0});
          return this
        };
        d.prototype.onFailed = function () {
          var a = this;
          this.$failedHandler = $(C("fail"));
          this.$failedHandler.appendTo(this.$imgset).click(function () {
            a.$failedHandler.remove();
            return a.renderImage()
          });
          return this
        };
        d.prototype.checkHideOrShow =
          function () {
            this.workModels[this.index + 1] ? this.$next.css({visibility: "visible"}) : this.$next.css({visibility: "hidden"});
            this.workModels[this.index - 1] ? this.$prev.css({visibility: "visible"}) : this.$prev.css({visibility: "hidden"});
            return this
          };
        d.prototype.goPrev = function () {
          if (this.$prev)return this.workModels[this.index - 1] && (this.index--, this.doSwitch()), this
        };
        d.prototype.goNext = function () {
          if (this.$next)return this.workModels[this.index + 1] && (this.index++, this.doSwitch()), this
        };
        d.prototype.goToIndex = function (a) {
          a =
            $(a.currentTarget).data("map-to") - 0;
          if (this.index === a)return!1;
          this.index = a;
          this.doSwitch();
          return this
        };
        d.prototype.doSwitch = function () {
          this.imgOffLoad();
          this.$file.find(".work-title").removeClass(this.workModel.get("fileType"));
          this.reset(this.workModels[this.index]);
          this.checkHideOrShow();
          this.renderImageOrPdf();
          this.refreshFooter();
          this.refreshPreviewerUrl();
          this.initUploader();
          this.options.disableActivity || (this.initInvolve(), this.renderCreator(), this.renderActivities());
          return this
        };
        d.prototype.openImageInNewWindow =
          function () {
            var a;
            a = this.workModels[this.index].get("downloadUrl");
            window.open("" + a);
            return this
          };
        d.prototype.openMover = function (a) {
          var b = this;
          this.requestSubView(k, {model: this.workModels[this.index], collection: n, _projectId: this.options._projectId, moverSuccess: function () {
            return b.close()
          }}).setup(a.currentTarget);
          return this
        };
        d.prototype.deleteWork = function () {
          var a = this;
          this.workModels[this.index].destroy({success: function () {
            return a.close()
          }});
          return this
        };
        d.prototype.initUploader = function () {
          var a =
            this;
          if (~this.index)return this.uploader = new h({accept: null, model: this.workModel, pick: {id: this.$(".update-work-handler"), multiple: !1}, onCreate: function () {
            return a.workModel
          }, onStart: function () {
            return a.onLoading()
          }, onComplete: function (b, e) {
            b.version = !0;
            delete b._id;
            e.save(b);
            a.onLoaded();
            return a.renderImageOrPdf()
          }}), this
        };
        d.prototype.downloadCollection = function () {
          return this
        };
        d.prototype.enterCollection = function () {
          var a;
          if (a = this.workModels[0].get("_collectionId"))this.close(), z.navigate("project/" +
            this.options._projectId + "/library/" + a, {trigger: !0});
          return this
        };
        d.prototype.refreshPreviewerUrl = function () {
          var a, b;
          b = this.options.parentUrl || z.getUrl();
          a = "/work/" + (-1 < this.index ? this.workModel.id : "thumbnails");
          ~b.indexOf(a) || (b = b.replace(/\/work\/.+/, ""), z.navigate(b + a, {trigger: !1}));
          return this
        };
        d.prototype.showNaturalImage = function (a) {
          var b, e, d, f;
          d = a.currentTarget;
          a = $("<img>").attr({src: d.src, height: d.naturalHeight, width: d.naturalWidth});
          b = $(window);
          f = d.naturalHeight < b.height() ? "auto" : 0;
          b = d.naturalWidth <
            b.width() ? "auto" : 0;
          a.css("margin", "" + f + " " + b);
          e = $("<div>").addClass("natural-image");
          e.append(a).appendTo(this.$el);
          a.one("click", function (a) {
            $(d).show();
            e.remove();
            return a.stopPropagation()
          });
          $(d).hide();
          return this
        };
        return d
      }(b);
      return d.Constructor = b
    })
}).call(this);
define("views/activity/activity-destroyer/templates/basic", [], function () {
  return function (d) {
    return'<div class="card-header"> <p class="card-title"></p></div><div class="card-content"> <div class="btn btn-danger confirm-destroy-handler"></div> <div class="btn cancel-destroy-handler"></div></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/activity/activity-destroyer/index", ["view", "./templates/basic"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "ActivityDestroyerView";
      f.prototype.className = "activity-destroyer modal-dialog card";
      f.prototype.events =
      {"click .confirm-destroy-handler": "onConfirm", "click .cancel-destroy-handler": "onCancel"};
      f.prototype.initialize = function (a) {
        if (null != a && a.activityModel)return this.activityModel = a.activityModel, this.render(), this
      };
      f.prototype.render = function () {
        this.$el.html(b());
        return this
      };
      f.prototype.onConfirm = function () {
        var a = this;
        this.activityModel.destroy({beforeSend: function () {
          a.$(".confirm-destroy-handler").text("...");
          return a.$(".cancel-destroy-handler").hide()
        }, success: function () {
          return a.close()
        },
          error: function () {
            a.$(".confirm-destroy-handler").text("");
            return a.$(".cancel-destroy-handler").show()
          }});
        return this
      };
      f.prototype.onCancel = function () {
        this.close();
        return this
      };
      f.prototype.close = function () {
        var a;
        null != (a = this.parentView) && a.remove();
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/activity/activity/templates/basic", [], function () {
  return function (d) {
    var a = "";
    d.lastActivityAction && ("comment" === d.action && "comment" !== d.lastActivityAction || "comment" !== d.action && "comment" === d.lastActivityAction) && (a += " <hr>");
    if ("comment" === d.action) {
      if (a += ' <div class="activity-creator-avatar img-36 img-circle pull-left" data-id="' + d.creatorData._id + '" style="background-image: url(' + d.creatorData.avatarUrl + ');"> </div> <div class="activity-body"> <div class="activity-header clearfix"> <span class="activity-creator-name">' +
        d.creatorData.name + '</span> <time class="time-stamp muted pull-right ', d.creatorData._id === teambition.user.id && (a += "self"), a += '" datetime="' + d.created + '"></time> </div> ', d.creatorData._id === teambition.user.id && (a += ' <div class="activity-handler-set"> <a class="btn btn-link btn-mini delete-activity-handler"></a> </div> '), a += ' <div class="activity-content readable">' + d.content + "</div> ", 0 < d.attachments.length) {
        var a = a + ' <ul class="activity-attachments previewer-handler"> ', f = d.attachments;
        if (f) {
          var b;
          d = -1;
          for (var e = f.length - 1; d < e;)b = f[d += 1], a += ' <li class="activity-attachment"> ', "image" === b.fileCategory && "psd" !== b.fileType ? a += ' <div class="attachment-thumbnail image pull-left" style="background-image: url(' + b.thumbnail + ');"> </div> ' : (a += ' <div class="attachment-thumbnail file-color ' + b.fileType + "-color pull-left ", "audio" === b.fileCategory && (a += " audio-color "), a += '"> ', a = "ai" === b.fileType ? a + " Ai " : "psd" === b.fileType ? a + " Ps " : "audio" === b.fileCategory ? a + ' <span class="icon icon-audio"></span> ' :
            a + (" " + b.fileType + " "), a += " </div> "), a += ' <div class="attachment-content"> <p class="attachment-title hinted" data-title="' + b.fileName + '"> ' + b.fileNameFix + ' <span class="attachment-size">(' + b.fileSizeFix + ")</span> </p> </div> </li> "
        }
        a += " </ul> "
      }
    } else if (a += ' <span class="icon ', "involve" == d.action ? a += " icon-add-user " : "set_stage" == d.action ? a += " icon-stage " : "set_duedate" == d.action ? a += " icon-calendar " : "set_priority" == d.action ? a += " icon-circle " : "set_executor" == d.action ? a += " icon-user " : "set_note" ==
      d.action ? a += " icon-book " : "set_content" == d.action ? a += " icon-pencil " : "add_task_subtasks" == d.action || "update_task_subtask_status" == d.action || "remove_task_subtask" == d.action ? a += " icon-sub-task " : "transform_task_subtask" == d.action ? a += " icon-convert " : "set_tasklist" == d.action ? a += " icon-th-list " : "create" == d.action ? a += " icon-plus " : "set_done" == d.action ? a += " icon-tick " : "set_redo" == d.action ? a += " icon-checkbox " : "set_version" == d.action ? a += " icon-file " : "set_collection" == d.action ? a += " icon-file " : (d.action =
      "change_event", a += " icon-pencil "), a += ' activity-type-icon pull-left muted"></span> <time class="time-stamp muted pull-right" datetime="' + d.created + '"></time> <div class="activity-body-coyness readable muted"> <span class="actor">' + d.creatorData.name + "</span> <span>" + (d.title || "") + "</span> ", "set_content" === d.action ? a += ' <div class="activity-content overflow"> <blockquote class="activity-description">' + d.description + '</blockquote> <blockquote class="activity-content-detail">' + d.content + "</blockquote> </div> " :
      "set_note" === d.action && d.note && d.note.trim() && (a += ' <div class="activity-content overflow"> <blockquote class="activity-description">' + d.description + '</blockquote> <blockquote class="activity-content-detail">' + d.note + "</blockquote> </div> "), a += " ", d.subtasks) {
      a += ' <ul class="subtask-list"> ';
      if (f = d.subtasks)for (d = -1, e = f.length - 1; d < e;)b = f[d += 1], a += " <li>" + b.content + "</li> ";
      a += " </ul> "
    } else"update_task_subtask_status" == d.action && d.subtask && (a += ' <ul class="subtask-list"> <li>' + d.subtask.content +
      "</li> </ul> ");
    return a + " </div>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/activity/activity/index", "view lib/window/index views/library/previewer/index views/activity/activity-destroyer/index util thenjs highlight warehouse models/work ./templates/basic".split(" "), function (d, b, e, g, k, h, l, n, m, s) {
    var r;
    return function (d) {
      function f() {
        return r = f.__super__.constructor.apply(this,
          arguments)
      }

      a(f, d);
      f.prototype.viewName = "ActivityView";
      f.prototype.tagName = "li";
      f.prototype.className = "activity";
      f.prototype.events = {"click .delete-activity-handler": "showDeleteConfirmModal", "click .previewer-handler": "enterPreviewer", "click .activity-content": "toggleOverflow"};
      f.prototype.initialize = function (a) {
        if (null != a && a.activityModel && a.membersCollection)return this.options = a, this.activityModel = a.activityModel, this.lastActivityModel = a.lastActivityModel, this.membersCollection = a.membersCollection,
          this.listen().render(), this
      };
      f.prototype.listen = function () {
        this.listenTo(this.activityModel, "remove destroy", this.remove);
        this.listenTo(this.activityModel, "change:subtasks", this.render);
        return this
      };
      f.prototype.render = function () {
        var a, b, e;
        a = this.activityModel.toJSON();
        a.creatorData = (null != (b = this.membersCollection.get(a._creatorId)) ? b.toJSON() : void 0) || {};
        a.lastActivityAction = null != (e = this.lastActivityModel) ? e.get("action") : void 0;
        a.title || (a.title = "");
        a.content = this.activityModel.getContent();
        a.description =
          $("<div>" + a.content + "</div>").text() || a.note || a.title;
        _.each(a.attachments, function (a) {
          var b;
          a.fileSizeFix = k.formatFileSize(a.fileSize);
          return a.fileNameFix = (null != (b = a.fileName) ? b.replace(/\.[^.]*$/, "") : void 0) || ""
        });
        this.$el.html(s(a)).attr("data-id", this.activityModel.id);
        this.$("time").timesince();
        this.$("pre code").each(function () {
          return l.highlightBlock(this)
        });
        return this
      };
      f.prototype.refreshAvatar = function (a) {
        var b;
        b = a.get("avatarUrl");
        $(".avatar" + a.id, this.$el).css({"background-image": "url(" +
          b + ")"});
        return this
      };
      f.prototype.refreshName = function (a) {
        $(".author" + a.id, this.$el).html(a.get("name"));
        return this
      };
      f.prototype.showDeleteConfirmModal = function () {
        this.requestSubView(b).open(g, {activityModel: this.activityModel});
        return this
      };
      f.prototype.enterPreviewer = function (a) {
        var d = this;
        a = this.activityModel.get("attachments");
        if (null == a || !a.length)return this;
        h.each(a,function (a, b) {
          return n.fetchOne(m, b._id, {success: function (b) {
            return a(null, b)
          }, error: function (e) {
            b.isDeleted = !0;
            b = n.createModel(m,
              b);
            return a(null, b)
          }})
        }).all(function (a, f, g) {
            a = {_projectId: d.options._projectId, thumbnailModel: d.activityModel, disableActivity: !0};
            a.workModels = _.compact(g);
            return d.detailView = d.requestSubView(b).open(e, a)
          });
        return this
      };
      f.prototype.toggleOverflow = function (a) {
        $(a.currentTarget).toggleClass("overflow");
        return this
      };
      f.prototype.remove = function () {
        var a;
        null != (a = this.$clone) && a.remove();
        return f.__super__.remove.apply(this, arguments)
      };
      return f
    }(d)
  })
}).call(this);
define("views/work/work/templates/basic", [], function () {
  return function (d) {
    var a = '<div class="work-content"> <div class="work-title"> ', a = "image" === d.fileCategory ? a + (' <div class="work-thumbnail image" style="background-image: url(' + d.thumbnail + ');"></div> ') : a + (' <div class="work-thumbnail ' + d.fileType + '">' + d.fileType + "</div> ");
    return a += " " + d.fileName + ' </div> <a class="delete-work-handler icon icon-remove"></a></div><div class="progress-bar"></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/work/work/index", ["view", "./templates/basic"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "WorkNewView";
      f.prototype.tagName = "li";
      f.prototype.className = "work creating";
      f.prototype.events = {"click .delete-work-handler": "deleteWork"};
      f.prototype.initialize = function (a) {
        if (null != a && a.workModel)return this.workModel = a.workModel, this.renderBasic().listen(), this
      };
      f.prototype.listen = function () {
        this.listenTo(this.workModel, "change:_id", this.renderId);
        this.listenTo(this.workModel, "change:thumbnail", this.renderImage);
        this.listenTo(this.workModel, "change:progress", this.onProgress);
        this.listenTo(this.workModel, "change:completed", this.onComplete);
        this.listenTo(this.workModel, "remove destroy", this.remove);
        return this
      };
      f.prototype.renderBasic =
        function () {
          var a;
          a = this.workModel.toJSON();
          this.$el.html(b(a));
          this.$progressBar = this.$(".progress-bar");
          this.$el.css("opacity", 0.7);
          this.workModel.id && this.renderId();
          return this
        };
      f.prototype.renderId = function () {
        this.$el.data("id", this.workModel.id);
        return this
      };
      f.prototype.renderImage = function () {
        var a;
        (a = this.workModel.get("thumbnail")) && this.$(".work-thumbnail").css("background-image", "url(" + a + ")");
        return this
      };
      f.prototype.onProgress = function () {
        var a, b, e;
        e = this.workModel.get("progress") || 0;
        a = this.$progressBar;
        a.stop(!0, !1);
        0.9 < e ? (b = function (e) {
          return a.animate({width: "100%"}, {duration: e, progress: function (d, f) {
            if (0.5 < f)return a.stop(), b(1.2 * e)
          }})
        })(2E3) : a.animate({width: "" + 100 * e + "%"}, 500);
        return this
      };
      f.prototype.onComplete = function () {
        this.$el.css("opacity", "");
        this.$progressBar.stop(!0, !0).remove();
        return this
      };
      f.prototype.deleteWork = function (a) {
        var b;
        a.stopPropagation();
        "function" === typeof(b = this.workModel).removeFile && b.removeFile();
        this.workModel.destroy();
        return this
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/core/selector/index", ["view", "warehouse"], function (d) {
    var b;
    return function (e) {
      function d() {
        return b = d.__super__.constructor.apply(this, arguments)
      }

      a(d, e);
      d.prototype.viewName = "SelectorView";
      d.prototype.className = "selector";
      d.prototype.events = {"click .selector-item": "select", "input input": "checkCreateCondition",
        "click .create-handler": "create"};
      d.prototype.initialize = function (a) {
        var b = this;
        this.options = a;
        this.reset(a).render().bindEvents();
        this.$el.appendTo(this.options.$container);
        _.delay(function () {
          if (b.options)return b.position()
        }, 200);
        return this
      };
      d.prototype.reset = function (a) {
        this.collection = a.collection;
        return this
      };
      d.prototype.render = function () {
        this.$el.html(this.options.template({selected: this.options.selected, collection: this.options.collection}));
        this.$input = this.$("input");
        this.$createHandler =
          this.$(".create-handler");
        return this
      };
      d.prototype.position = function () {
        var a, b, e;
        a = this.options.$container || $("body");
        b = this.options.$opener;
        e = this.options.collection.length;
        6 < e && (e = 6);
        a = b.offset().top - a.offset().top - 25 * e - 10;
        this.$el.css({position: "absolute", top: a, left: 90, right: 10});
        return this
      };
      d.prototype.bindEvents = function () {
        var a = this;
        return this.options.$opener.click(function () {
          return a.show()
        })
      };
      d.prototype.bindBlueHandler = function () {
        var a = this;
        return $(document).one("click", function (b) {
          if (a.$el)return 0 ===
            $(b.target).closest(".selector").length || $(b.target).closest(".selector-item").length ? a.hide() : a.bindBlueHandler()
        })
      };
      d.prototype.select = function (a) {
        this.$(".active").removeClass("active");
        $(a.currentTarget).addClass("active");
        return this.options.select(a)
      };
      d.prototype.show = function () {
        var a = this;
        this.position();
        this.$el.show();
        _.delay(function () {
          return a.bindBlueHandler()
        });
        return this
      };
      d.prototype.hide = function () {
        this.$el.hide();
        return this
      };
      d.prototype.checkCreateCondition = function () {
        return this.$createHandler.prop("disabled",
          !this.$input.val())
      };
      d.prototype.create = function (a) {
        return this.options.create(this.$input.val()) ? (this.$input.val(""), this.hide()) : this.$input.focus()
      };
      return d
    }(d)
  })
}).call(this);
define("views/work/works-uploader/templates/basic", [], function () {
  return function (d) {
    var a = '<div class="card modal-dialog"> <div class="card-header"> <p class="card-title pull-left"> <span class="card-title-doing">#{count}...</span> <span class="card-title-collection" style="display: none"></span> </p> <div class="close-creator pull-right"> <span class="icon icon-remove"></span> </div> </div> <ul class="work-set clearfix"></ul> <div class="work-handlers"> <a class="all-work-handler">#{count}</a> </div> <div class="collection-selector-selected selector-selected"> <div class="selector-label"></div> <div class="open-selector-handler"> <div class="selector-title"> <strong> ', a =
      d ? a + (" " + d.title + " ") : a + "  ";
    return a + ' </strong> </div> <b class="caret"></b> </div> </div> <ul class="collection-selector"></ul> <div class="card-footer"> <button class="submit-handler btn btn-primary btn-block btn-large" disabled="true"></button> </div></div>'
  }
});
define("views/work/works-uploader/templates/collection", [], function () {
  return function (d) {
    var a = '<div class="selector-create-form"> <input class="collection-title-input form-control pull-left" type="text" placeholder=""/> <button class="create-handler btn btn-primary" disabled="true"></button></div><ul class="selector-options thin-scroll"> ', f = d.collection;
    if (f)for (var b, e = -1, g = f.length - 1; e < g;)b = f[e += 1], a += ' <li class="work-creator-collection-item clearfix ', d.selected && d.selected._id ===
      b._id && (a += " active "), a += ' selector-item" data-id="' + b._id + '"> <div class="collection-info selector-item-content pull-left"> <strong class="collection-name">' + b.title + '</strong> <span class="collection-num">  ' + b.workCount + '</span> </div> <div class="selected-icon pull-left"> </div> </li> ';
    return a + "</ul>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/work/works-uploader/index", "view views/core/selector/index views/work/work/index warehouse models/collection collections/works collections/collections util ./templates/basic ./templates/collection essage".split(" "), function (d, b, e, g, k, h, l, n, m, s) {
    var r, t;
    r = teambition.user;
    return function (d) {
      function f() {
        return t =
          f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "WorksUploaderView";
      f.prototype.tagName = "section";
      f.prototype.className = "works-uploader modal-dialog card";
      f.prototype.events = {"click .close-creator": "close", "click .submit-handler": "submit", "click .all-work-handler": "showAllWorks"};
      f.prototype.initialize = function (a) {
        var b = this;
        if (null != a && a._projectId && a.collection && a.uploader)return this.options = a, this._projectId = a._projectId, this.uploader = a.uploader, this.collection = a.collection,
          this.renderBasic().initUploader().renderWorks().listen(), g.request(l, this._projectId, {success: function (e) {
          b.collectionsCollection = e;
          b.collectionModel = a.collectionModel || e.at(0);
          b.refreshTitleCollection();
          b.renderSelector();
          return b.listenTo(b.collectionsCollection, "add change remove", b.renderSelector)
        }}), this
      };
      f.prototype.listen = function () {
        this.listenTo(this.collection, "add", this.renderWork);
        this.listenTo(this.collection, "remove", this.removeWork);
        this.listenTo(this.collection, "change:completed", this.checkUpload);
        return this
      };
      f.prototype.renderBasic = function () {
        var a, b;
        a = null != (b = this.collectionModel) ? b.toJSON() : void 0;
        this.$el.html(m(a));
        this.$workSet = this.$(".work-set");
        this.$allWorkHandler = this.$(".all-work-handler");
        this.$workHandlerSet = this.$(".work-handlers");
        this.$titleSelector = this.$(".collection-selector");
        this.$creatorTitleDoing = this.$(".card-title-doing");
        this.$creatorTitleCollection = this.$(".card-title-collection");
        this.$footer = this.$(".card-footer");
        this.$selectedCollectionTitle = this.$(".card-title-collection");
        this.$openSelectorHandler = this.$(".open-selector-handler");
        this.$collectSelected = this.$(".collection-selector-selected");
        this.$submitHandler = this.$(".submit-handler");
        this.$collectSelected.hide();
        this.$footer.hide();
        return this
      };
      f.prototype.initUploader = function () {
        return this
      };
      f.prototype.renderSelector = function () {
        var a = this;
        this.$(".selector").remove();
        this.requestSubView(b, {$container: this.$(".modal-dialog"), $opener: this.$openSelectorHandler, selected: this.collectionModel || null, collection: this.collectionsCollection.toJSON().reverse(),
          template: s, select: function (b) {
            return a.selectCollection(b)
          }, create: function (b) {
            return a.createCollection(b)
          }});
        return this
      };
      f.prototype.showSelector = function (a) {
        return this.$titleSelector.show()
      };
      f.prototype.renderWorks = function () {
        var a = this;
        this.collection.each(function (b) {
          return a.renderWork(b)
        });
        return this
      };
      f.prototype.renderWork = function (a) {
        this.requestSubView(e, {workModel: a}).$el.addClass("card").appendTo(this.$workSet);
        this.checkUpload();
        return this
      };
      f.prototype.removeWork = function () {
        0 === this.collection.length ?
          this.close() : this.checkUpload();
        return this
      };
      f.prototype.checkUpload = function () {
        this.refreshTitleDoing();
        this.collection.getUploadingCount() || (this.toggleWorkSet(!0), this.$collectSelected.show(), this.$footer.show(), this.$submitHandler.prop("disabled", !1));
        return this
      };
      f.prototype.showAllWorks = function () {
        return this.toggleWorkSet(!1)
      };
      f.prototype.toggleWorkSet = function (a) {
        var b;
        b = this.$workSet.find(".work.creating");
        if (a) {
          if (b.filter(":even").each(function (a, b) {
            return $(b).transition({x: 0, y: -71 * a})
          }),
            b.filter(":odd").each(function (a, b) {
              return $(b).transition({x: -290, y: -71 * a})
            }), this.$workSet.data("originHeight", this.$workSet.height()).transition({height: "90px"}), 1 < b.length)return this.$workHandlerSet.show()
        } else return b.each(function (a, b) {
          return $(b).transition({x: 0, y: 0})
        }), this.$workSet.transition({height: "" + this.$workSet.data("originHeight") + "px"}, function () {
          return $(this).css("height", "auto")
        }), this.$workHandlerSet.hide()
      };
      f.prototype.selectCollection = function (a) {
        a = $(a.currentTarget).data("id");
        this.collectionModel = this.collectionsCollection.get(a);
        this.refreshTitleCollection();
        return this
      };
      f.prototype.createCollection = function (a) {
        a = "function" === typeof a.trim ? a.trim() : void 0;
        if (!a)return!1;
        this.collectionModel = g.createModel(k, {_creatorId: r.id, _projectId: this._projectId, title: a, description: ""});
        this.collectionsCollection.create(this.collectionModel, {wait: !0});
        this.refreshTitleCollection();
        return!0
      };
      f.prototype.submit = function (a) {
        if (this.collectionModel)return this.$submitHandler.html("...").prop("disabled",
          !0), this.submitWorks(this.collectionModel.id)
      };
      f.prototype.submitWorks = function (a) {
        var b, e = this;
        return(b = this.collection.getUploadingCount()) ? Essage.show({message: "" + b + "...", status: "error"}) : g.get(h, a).addWorks(this.collection.toJSON(), {beforeSend: function () {
        }, success: function (a) {
          var b;
          e.$(".submit-btn").html("");
          "function" === typeof(b = e.options).success && b.success(a);
          e.collection.reset(null, {silent: !0});
          return e.close()
        }, error: function () {
          return e.$submitHandler.html("").prop("disabled",
            !1)
        }})
      };
      f.prototype.refreshTitleDoing = function () {
        var a;
        (a = this.collection.getUploadingCount()) ? (this.$creatorTitleDoing.text("" + a + "..."), this.$creatorTitleCollection.hide()) : (a = this.collection.length, this.$creatorTitleDoing.text("" + a + ""), this.$creatorTitleCollection.show());
        this.$allWorkHandler.text("" + a + "");
        return this
      };
      f.prototype.refreshTitleCollection = function () {
        var a;
        this.collectionModel ? (a = this.collectionModel.get("title"), this.$selectedCollectionTitle.html(" " + a), this.$(".selector-title strong").text(a)) :
          this.$selectedCollectionTitle.html("");
        return this
      };
      f.prototype.close = function () {
        var a;
        null != (a = this.parentView) && a.remove();
        return this
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/work/work-uploader/index", "view lib/window/index lib/uploader/index views/work/works-uploader/index warehouse collections/works essage".split(" "), function (d, b, e, g, k, h) {
    var l;
    return function (d) {
      function f() {
        return l = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName =
        "WorkUploaderView";
      f.prototype.initialize = function (a) {
        var b = this;
        if (null != a && a._projectId)return a.collection || (a.collection = k.createCollection(h)), this.collection = a.collection, this.options = _.extend({accept: null, onCreate: function (a) {
          a.progress = 0;
          a.completed = !1;
          a = b.collection.add(a);
          b.options.noDialog || b.openCreator();
          return a
        }, onProgress: function (a, b) {
          return b.set("progress", a)
        }, onComplete: function (a, b) {
          b.set(a);
          return b.set("completed", !0)
        }, onError: function (a, e) {
          return b.collection.remove(e)
        }}, a),
          this.options.uploader = new e(this.options), this
      };
      f.prototype.getData = function () {
        return this.collection.toJSON()
      };
      f.prototype.openCreator = function () {
        var a;
        if (null == (a = this.worksUploaderView) || !a.$el)return this.worksUploaderView = this.requestSubView(b).open(g, this.options)
      };
      return f
    }(d)
  })
}).call(this);
define("views/activity/activity-creator/templates/basic", [], function () {
  return function (d) {
    return'<div class="comment-box-wrap"> <textarea type="text" placeholder="" class="form-control comment-input"></textarea></div><div class="activity-handler clearfix"> <a class="add-work-handler pull-left" data-gta="event" data-label="activity add works"> <span class="icon icon-paperclip"></span> </a> <a class="btn btn-primary reply-handler pull-right"></a> <label class="checkbox pull-right quick-create-label"> <input type="checkbox" class="quick-create">  </label> <ul class="attachments-list scrollable thin-scroll"></ul></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/activity/activity-creator/index", "view util store warehouse models/work collections/collections collections/works views/work/work/index views/work/work-uploader/index ./templates/basic essage".split(" "), function (d, b, e, g, k, h, l, n, m, s) {
    var r, t, v;
    t = teambition.user;
    r = teambition.PREFERENCE;
    return function (d) {
      function f() {
        return v =
          f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "ActivityCreatorView";
      f.prototype.tagName = "div";
      f.prototype.className = "activity-creator";
      f.prototype.events = {focusout: "blurAttachment", "mousewheel .scrollable": b.mousewheel};
      f.prototype.initialize = function (a) {
        var b = this;
        this.options = a;
        this._projectId = a._projectId;
        this.collection = a.collection;
        this.localCache = e.namespace("activities_" + a.boundToObjectType);
        this.localCacheId = "" + a._projectId + "_" + t.id;
        a = this.localCache(this.localCacheId) ||
        {};
        this.attachments = g.createCollection(l, a.attachments, {boundToObjectType: "project", _boundToObjectId: this._projectId});
        this.renderBasic().initUploader().listen();
        this.checkQuickCreateMode();
        this.$textareaset.on("focus.ac",function () {
          return b.focusAttachment()
        }).on("keydown.ac",function (a) {
          return b.quickSubmit(a)
        }).on("change.ac",function () {
          return b.cacheActivity()
        }).val(a.content);
        this.$submit.on("click.ac", function () {
          return b.submit()
        });
        this.$(".quick-create").on("change.ac", function () {
          r.quickReply(b.$quickCreate.prop("checked")) ||
          (b.$textareaset.attr("placeholder", " Ctrl+Enter "), _.delay(function () {
            var a;
            return null != (a = b.$textareaset) ? a.attr("placeholder", "") : void 0
          }, 2E3));
          return b.$textareaset.focus()
        });
        return this
      };
      f.prototype.renderBasic = function () {
        var a = this;
        this.$el.html(s());
        this.$textareaset = this.$(".comment-input").flexText();
        this.$attachmentsList = this.$(".attachments-list");
        this.$quickCreate = this.$(".quick-create");
        this.$submit = this.$(".reply-handler");
        this.attachments.each(function (b) {
          return a.renderAttachment(b)
        });
        return this
      };
      f.prototype.submit = function () {
        var a, b, e = this;
        if (!this.$submit.prop("disabled"))return b = this.$textareaset.val().trim(), (a = this.attachments.getUploadingCount()) ? Essage.show({message: "" + a + "...", status: "warning"}, 2E3) : b || this.attachments.length ? (this.disableSubmit(!0), this.collection.create({action: "comment", _creatorId: t.id, content: b, attachments: this.attachments.pluck("_id")}, {wait: !0, _projectId: this._projectId, success: function () {
          var a;
          e.$textareaset.val("");
          e.$attachmentsList.empty();
          e.attachments.reset();
          e.disableSubmit(!1);
          e.deactiveAttachment();
          e.$textareaset.trigger("blur");
          e.localCache.remove(e.localCacheId);
          return"function" === typeof(a = e.options).onAdd ? a.onAdd() : void 0
        }, error: function () {
          e.disableSubmit(!1);
          return e.$textareaset.focus()
        }})) : this.$textareaset.focus(), this
      };
      f.prototype.disableSubmit = function (a) {
        this.$submit.prop("disabled", a);
        this.$submit[a ? "addClass" : "removeClass"]("disabled");
        return this
      };
      f.prototype.quickSubmit = function (a) {
        13 === a.keyCode && (a.ctrlKey || r.quickReply()) &&
        (a.preventDefault(), this.submit());
        return this
      };
      f.prototype.checkQuickCreateMode = function () {
        this.$quickCreate.prop("checked", r.quickReply());
        return this
      };
      f.prototype.listen = function () {
        var a = this;
        this.listenTo(this.attachments, "add", function (b) {
          return a.renderAttachment(b)
        });
        this.listenTo(this.attachments, "add change", function () {
          return a.cacheActivity()
        });
        this.listenTo(this.attachments, "add remove reset", function () {
          if (a.attachments.length)return a.$attachmentsList.addClass("has-attachments");
          a.$attachmentsList.removeClass("has-attachments");
          return a.deactiveAttachment()
        });
        return this
      };
      f.prototype.initUploader = function () {
        var a, b, e = this;
        null != (a = this.workuploaderView) && a.remove();
        null != (b = this.workuploaderView2) && b.remove();
        a = {_projectId: this._projectId, collection: this.attachments, noDialog: !0, pick: {id: this.$(".add-work-handler"), multiple: !0}, dnd: this.$el, paste: this.$textareaset, onFinish: function () {
          return e.attachments.addWorks(e.attachments.toJSON(), {success: function (a) {
            return e.attachments.set(a, {remove: !1})
          }})
        }};
        this.workuploaderView =
          this.requestSubView(m, a);
        this.options.secondUpload && (a = {_projectId: this._projectId, collection: this.attachments, noDialog: !0, onFinish: function () {
          return e.attachments.addWorks(e.attachments.toJSON(), {success: function (a) {
            e.attachments.set(a, {remove: !1});
            return e.submit()
          }})
        }}, this.options.secondUpload.$uploadArea && (a.pick = {id: this.options.secondUpload.$uploadArea, multiple: !0}), this.options.secondUpload.$dropArea && (a.dnd = this.options.secondUpload.$dropArea), this.workuploaderView2 = this.requestSubView(m,
          a));
        return this
      };
      f.prototype.renderAttachment = function (a) {
        this.requestSubView(n, {workModel: a}).$el.appendTo(this.$attachmentsList);
        this.$(".comment-input").focus();
        return this
      };
      f.prototype.cacheActivity = function () {
        this.localCache(this.localCacheId, {content: this.$textareaset.val().trim(), attachments: this.attachments.toJSON()});
        return this
      };
      f.prototype.focusAttachment = function () {
        var a = this;
        this.checkQuickCreateMode();
        this.$el.addClass("focus");
        this.$el.addClass("active");
        b.handleClickOutside(this.$el,
          function () {
            return a.deactiveAttachment()
          }, "click", ".works-uploader");
        return this
      };
      f.prototype.blurAttachment = function () {
        this.$el.removeClass("focus");
        return this
      };
      f.prototype.deactiveAttachment = function () {
        this.attachments.length || this.$textareaset.val().trim() || (this.$textareaset.val(""), this.$textareaset.trigger("change"), this.$el.removeClass("active"));
        return this
      };
      f.prototype.remove = function () {
        this.$(".comment-input, .reply-handler, .quick-create").off(".ac");
        return f.__super__.remove.apply(this,
          arguments)
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  define("lib/scrollable", [], function () {
    var d, a, f;
    d = $("body");
    a = $(document);
    f = $(window);
    return{scrollTo: function (a, e) {
      var f, k, h;
      if (_.isElement(a) || a instanceof $) {
        f = $(a);
        if (this.$scrollFrame.is(f))return f.get(0).scrollIntoView(e);
        this.$scrollFrame.is(d) || (h = d.scrollTop(e));
        k = this.$scrollFrame.get(0).getBoundingClientRect();
        f = f.get(0).getBoundingClientRect();
        e ? this.$scrollFrame.scrollTop(this.$scrollFrame.scrollTop() + (f.top - k.top)) : this.$scrollFrame.scrollTop(this.$scrollFrame.scrollTop() + (f.bottom -
          k.bottom));
        null != h && d.scrollTop(h)
      } else this.$scrollFrame.scrollTop(a);
      return this
    }, slideTo: function (a, e, f) {
      var k, h, l, n = this;
      if (!this.scrolling) {
        k = this.$scrollFrame.get(0) === document ? d : this.$scrollFrame;
        this.scrolling = 1;
        l = this._getScrollViewRect();
        if (_.isElement(a) || a instanceof $)a = $(a), a = a.get(0).getBoundingClientRect(), e = !1 !== e ? l.top - (a.top - 60) : l.bottom - a.bottom, h = -e + k.scrollTop();
        if (f)return k.animate({scrollTop: h}, "fast", null, function () {
          n.scrolling = 0;
          return f()
        });
        k.scrollTop(h);
        return this.scrolling =
          0
      }
    }, _getScrollViewRect: function () {
      var b;
      this.$scrollFrame || (this.$scrollFrame = a);
      b = this.$scrollFrame.get(0) === document ? document.body.getBoundingClientRect() : this.$scrollFrame.get(0).getBoundingClientRect();
      return{top: this.$scrollFrame.is(this.$scrollContent) ? b.top : b.top + this.$scrollContent.position().top + this.$scrollFrame.scrollTop(), bottom: b.bottom}
    }, setupScroll: function (b, e) {
      var d, f = this;
      e || (e = {});
      null != (d = this.$scrollFrame) && d.scrollTop(0).off("scroll");
      this.$scrollFrame = b || this.$(".scrollable").first() ||
        a;
      e.noShadow || (this.$scrollFrame.on("scroll", function () {
        return f._updateScrollStyle()
      }), this._updateScrollStyle());
      d = this.$scrollFrame.find(".scrollable");
      this.$scrollContent = d.length ? d.first() : this.$scrollFrame;
      if (this.loadMore)return this.setupLoadMore()
    }, keepScrollPos: function (a, e) {
      var d, f, h, l, n = this;
      if (!this.$scrollFrame)return e();
      _.isFunction(a) ? (e = a, a = null) : a instanceof $ && (a = a.get(0));
      l = this.$scrollFrame.get(0).getBoundingClientRect();
      a || (h = (l.top + l.bottom) / 2, f = (l.left + l.right) / 2, a = document.elementFromPoint(f,
        h));
      d = a.getBoundingClientRect().top - l.top;
      return e(function () {
        var e;
        if ($.contains(document, a))return e = a.getBoundingClientRect(), e = e.top - l.top, n.$scrollFrame.scrollTop(n.$scrollFrame.scrollTop() + e - d)
      })
    }, _updateScrollStyle: function () {
      var a;
      return null != (a = this.$el) ? a.toggleClass("overflow-top", !!this.$scrollFrame.get(0).scrollTop) : void 0
    }, scrollElement: function () {
      return this.$scrollFrame
    }, setupLoadMore: function (b, e) {
      var d, k, h = this;
      b || (b = 200);
      null != (k = this.$scrollFrame) && k.off("scroll.loadmore");
      d =
        function () {
          var k;
          return null != (k = h.$scrollFrame) ? k.on("scroll.loadmore", function (k) {
            var l, s;
            if (!h.$el)return null != (l = h.$scrollFrame) ? l.off("scroll.loadmore") : void 0;
            k.currentTarget.body ? (l = a.scrollTop(), k = a.height() - l - f.height()) : (l = h.$scrollFrame.scrollTop(), k = h.$scrollFrame[0].scrollHeight - l - h.$scrollFrame.height());
            if (e && 0 >= l || k <= b && 0 <= l)return null != (s = h.$scrollFrame) && s.off("scroll.loadmore"), h.loadMore(d, e && 0 >= l)
          }) : void 0
        };
      return d()
    }}
  })
}).call(this);
define("views/activity/activity-timeline/templates/basic", [], function () {
  return function (d) {
    return'<div class="activities-wrapper"> <ul class="activities-list"></ul></div>'
  }
});
define("views/activity/activity-timeline/templates/more", [], function () {
  return function (d) {
    return'<li class="activity"> <a class="load-activities-handler"> <span class="icon icon-more pull-left"></span> <div class="activity-body-coyness"> <p>' + d.count + "</p> </div> <hr> </a></li>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/activity/activity-timeline/index", "exports view views/activity/activity/index views/activity/activity-creator/index warehouse collections/members collections/activities lib/scrollable ./templates/basic ./templates/more".split(" "), function (d, b, e, g, k, h, l, n, m, s) {
    var r;
    b = function (b) {
      function d() {
        return r =
          d.__super__.constructor.apply(this, arguments)
      }

      a(d, b);
      d.prototype.viewName = "ActivityTimelineView";
      d.prototype.tagName = "div";
      d.prototype.className = "activities-timeline";
      d.prototype.events = {"click .load-activities-handler": "load"};
      d.prototype.initialize = function (a) {
        if (!(null != a && a._projectId && null != a && a._objectId && null != a && a.boundToObjectType))return!1;
        this.options = a;
        this._projectId = this.options._projectId;
        this.membersCollection = k.get(h, this._projectId);
        this.collection = k.get(l, this.options._objectId,
          null, {boundToObjectType: this.options.boundToObjectType});
        this.activitiesCount = this.options.activitiesCount;
        this.renderBasic();
        this.listen();
        a.onlyLast ? (this.collection.add(this.options.activityModel, {silent: !0}), this.renderLastActivity(), this.renderActivity(this.options.activityModel)) : this.load();
        this.setupScroll(this.$activitiesList, this.options);
        a.noCreator || this.renderCreator();
        return this
      };
      d.prototype.listen = function () {
        var a = this;
        this.listenTo(this.membersCollection, "change:name", this.refreshName);
        this.listenTo(this.membersCollection, "change:avatarUrl", this.refreshAvatar);
        this.listenTo(this.collection, "add", function (b) {
          var e;
          a.activitiesCount += 1;
          a.renderLastActivity(b);
          a.renderActivity(b, a.collection.at(a.collection.length - 2));
          return"function" === typeof(e = a.options).activityCollectionChange ? e.activityCollectionChange(a.collection) : void 0
        });
        this.listenTo(this.collection, "remove", function (b) {
          var e;
          a.activitiesCount -= 1;
          return"function" === typeof(e = a.options).activityCollectionChange ? e.activityCollectionChange(a.collection) :
            void 0
        });
        return this
      };
      d.prototype.load = function () {
        var a = this;
        k.request(l, this.options._objectId, null, {silent: !0, boundToObjectType: this.options.boundToObjectType, beforeSend: function () {
          return a.showLoadingIndicator(a.$activitiesList, {isPrepend: !0})
        }, success: function (b) {
          var e;
          a.activitiesCount = b.length;
          a.hideLoadingIndicator();
          a.renderActivities();
          return"function" === typeof(e = a.options).activityCollectionChange ? e.activityCollectionChange(b) : void 0
        }, error: function (a) {
        }});
        return this
      };
      d.prototype.renderBasic =
        function () {
          this.$el.html(m());
          this.$activitiesList = this.$(".activities-list");
          this.$involveMembers = this.$(".involve-members");
          return this
        };
      d.prototype.renderActivities = function () {
        var a, b, e, d, f;
        this.$activitiesList.empty();
        f = this.collection.models;
        e = 0;
        for (d = f.length; e < d; e++)a = f[e], this.renderActivity(a, b), b = a;
        return this
      };
      d.prototype.renderActivity = function (a, b) {
        var d, f;
        if (!a)return this;
        f = this.requestSubView(e, {activityModel: a, lastActivityModel: b, membersCollection: this.membersCollection, _projectId: this.options._projectId});
        f.$el.appendTo(this.$activitiesList);
        (d = this.options.$attachmentsContainer) && a.get("attachments").length && (f.$clone = f.$el.clone(!0, !0), f.$clone.appendTo(d));
        return this
      };
      d.prototype.renderCreator = function (a) {
        var b = this;
        a || (a = this.$el);
        this.requestSubView(g, {_projectId: this.options._projectId, _objectId: this.options._objectId, type: this.options.type, boundToObjectType: this.options.boundToObjectType, collection: this.collection, secondUpload: this.options.secondUpload, onAdd: function () {
          return b.scrollToBottom()
        }}).$el.appendTo(a);
        return this
      };
      d.prototype.renderLastActivity = function (a) {
        var b;
        (a || this.options.activityModel) && 1 < this.activitiesCount && (b = this.$(".load-activities-handler"), 0 < b.length ? b.parent().replaceWith(s({count: this.activitiesCount})) : a || this.$activitiesList.append(s({count: this.activitiesCount})));
        return this
      };
      d.prototype.isInExtended = function () {
        return!!this.$el.parents("#extend-app-content").length
      };
      d.prototype.scrollToBottom = function () {
        "function" === typeof this.scrollTo && this.scrollTo(this.$activitiesList);
        return this
      };
      return d
    }(b);
    _.extend(b.prototype, n);
    return d.Constructor = b
  })
}).call(this);
define("views/board/stage/stage-switcher/templates/basic", [], function () {
  return function (d) {
    var a = "", f = d.stages;
    if (f)for (var b, e = -1, g = f.length - 1; e < g;)b = f[e += 1], a += '<li class="stage-item ', b.id === d.currentStageId && (a += "selected"), a += '" data-id="' + b.id + '"> <a>' + b.get("name") + "</a></li>";
    return a
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/stage/stage-switcher/index", ["dropdown-view", "./templates/basic"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "StageSwitcherView";
      f.prototype.className = "stage-switcher";
      f.prototype.events = {"click .stage-item": "changeStage"};
      f.prototype.initialize = function (a) {
        if (a)return this.options = a, this.stagesCollection = a.stagesCollection, this.currentStageId = this.options.currentStageId, this
      };
      f.prototype.onOpen = function () {
        f.__super__.onOpen.apply(this, arguments);
        this.render();
        return this
      };
      f.prototype.render = function () {
        var a;
        a = {stages: this.stagesCollection.getOrderedStages(), currentStageId: this.currentStageId};
        this.$el.html(b(a));
        return this
      };
      f.prototype.changeStage = function (a) {
        this.currentStageId = $(a.currentTarget).data("id");
        this.options.select(this.currentStageId);
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/board/task/task-priority/templates/basic", [], function () {
  return function (d) {
    var a = "", f = d.priorityLabels;
    if (f)for (var b, e = -1, g = f.length - 1; e < g;)b = f[e += 1], a += '<li class="task-priority-' + e + " ", d.currentPriority === e && (a += "selected"), a += '"> <a class="set-task-priority-handler" data-priority="' + e + '"> <span class="task-priority-icon"></span> ' + b + " </a></li>";
    return a
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/task/task-priority/index", ["dropdown-view", "./templates/basic"], function (d, b) {
    var e, g;
    e = ["", "", ""];
    return function (d) {
      function f() {
        return g = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "TaskPriorityView";
      f.prototype.className = "task-priority-setter";
      f.prototype.events = {"click .set-task-priority-handler": "setPriority"};
      f.prototype.initialize = function (a) {
        if (a)return this.options = a, this.currentPriority = a.currentPriority, this
      };
      f.prototype.onOpen = function () {
        f.__super__.onOpen.apply(this, arguments);
        this.render();
        return this
      };
      f.prototype.render = function () {
        this.$el.html(b({priorityLabels: e, currentPriority: this.currentPriority}));
        return this
      };
      f.prototype.setPriority = function (a) {
        this.currentPriority = $(a.currentTarget).data("priority");
        this.options.select(this.currentPriority);
        return this
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/stage", ["model"], function (d) {
    var b;
    return function (e) {
      function d() {
        return b = d.__super__.constructor.apply(this, arguments)
      }

      a(d, e);
      d.prototype.name = "stage";
      d.prototype.defaults = {name: void 0, _tasklistId: void 0, _nextId: void 0};
      d.prototype.getNextStageModel = function () {
        var a;
        return(a = this.get("_nextId")) ?
          this.collection.get(a) : !1
      };
      return d
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/stages", ["collection", "models/stage"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.name = "stages";
      f.prototype.model = b;
      f.prototype.boundToObjectType = "tasklist";
      f.prototype.getFirstStage = function () {
        return this.where({isFirst: !0})[0]
      };
      f.prototype.getLastStage = function () {
        return this.where({_nextId: void 0})[0]
      };
      f.prototype.getOrderedStages = function () {
        var a, b;
        for (b = [a = this.getFirstStage()]; a.getNextStageModel();)a = a.getNextStageModel(), b.push(a);
        return b
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/subtask", ["warehouse", "model"], function (d, b) {
    var e;
    return function (b) {
      function k() {
        return e = k.__super__.constructor.apply(this, arguments)
      }

      a(k, b);
      k.prototype.name = "subtask";
      k.prototype.defaults = {isDone: !1, content: ""};
      k.prototype.transform = function (a) {
        var b;
        b = _.extend({success: function () {
        },
          beforeSend: function () {
          }, error: function () {
          }}, a);
        d.socket.emit("transform:subtask", {_id: this.id});
        d.socket.once("transform:subtask/" + this.id, function (a) {
          return a.errorCode ? "function" === typeof b.error ? b.error(a.errorCode) : void 0 : b.success(a)
        });
        return this
      };
      return k
    }(b)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/subtasks", ["collection", "models/subtask"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.name = "subtasks";
      f.prototype.model = b;
      f.prototype.boundToObjectType = "task";
      f.prototype.orderBy = "earliest-created";
      return f
    }(d)
  })
}).call(this);
define("views/board/task/task-detail/templates/basic", [], function () {
  return function (d) {
    return'<header class="task-detail-header clearfix"> <div class="task-detail-handler-cell big-cell"> <div class="task-detail-handler"> <a class="task-detail-executor hinted" data-gta="event" data-label="task detail|change executor"> </a> </div> <div class="task-detail-handler"> <a class="task-detail-due-date hinted" data-gta="event" data-label="task detail|choose duedate">  </a> </div> <div class="task-detail-handler"> <a class="task-detail-stage hinted" data-gta="event" data-label="task detail|move stage"> </a> </div> </div> <div class="task-detail-handler-cell small-cell"> <div class="task-detail-handler hr"> <hr /> </div> <div class="task-detail-handler"> <a class="task-detail-tasklist hinted" data-gta="event" data-label="task detail|move tasklist"> </a> </div> <div class="task-detail-handler"> <a class="task-detail-priority hinted" data-gta="event" data-label="task detail|set priority"> </a> </div> <div class="task-detail-handler"> <a class="menu-handler hinted" data-toggle="popover" data-title="" data-gta="event" data-label="task detail|task detail|delete task"> <span class="task-detail-handler-icon icon icon-trash"></span> </a> </div> </div></header><div class="task-detail-content"> <div class="task-wrapper"></div> <div class="task-detail-subtasks"></div> <div class="task-detail-note"> <div class="task-note"> <textarea class="task-note-content form-control" data-gta="event" data-label="task detail|write note" data-action="focus" data-category="textarea" placeholder="..."></textarea> </div> </div> <div class="task-detail-involve-set involve-set"> <ul class="involve-members"></ul> </div> <ul class="nav nav-tabs"> <li class="active tab-handler" data-toggle=".task-detail-activities" data-gta="event" data-label="task detail|open activities tab"> <a><span class="activities-number"></span></a> </li> <li class="tab-handler" data-toggle=".task-detail-attachments" data-gta="event" data-label="task detail|open attachments tab"> <a><span class="attachments-number"></span></a> </li> </ul> <div class="tab-content"> <div class="tab-pane active task-detail-activities activities"></div> <div class="tab-pane task-detail-attachments"> <div class="task-attachments-handler"> <button class="btn btn-primary add-work-handler" data-gta="event" data-label="task detail||attachments tab|add works" type="button"></button> <span></span> </div> <ul class="activities-list"></ul> </div> </div></div><div class="activity-creator-wrapper"></div>'
  }
});
define("views/board/task/task-detail/templates/task", [], function () {
  return function (d) {
    var a = '<div class="task ';
    d.isDone && (a += "done");
    a += '"> ';
    0 < d.hasRight ? (a += ' <div class="check-box hinted" data-title="', a = d.isDone ? a + "" : a + "", a += '" data-gta="event" data-label="task detail|check task" data-action="click" data-category="div"> <span class="icon icon-tick"></span> </div> ') : a += ' <div class="check-box non-checkable" title="' + d.executorData.name + '" data-gta="event" data-label="task detail|check task" data-action="click" data-category="div"> <span class="icon icon-tick"></span> </div> ';
    return a + ' <div class="task-content-wrapper"> <textarea class="task-content-input form-control hinted" data-title=""></textarea> </div></div>'
  }
});
define("views/board/task/task-detail/templates/info-executor", [], function () {
  return function (d) {
    var a = "";
    return a = d.executorData ? a + (' <div class="task-detail-handler-icon executor-avatar img-24 img-circle" style="background-image: url(' + d.executorData.avatarUrl + ')"></div> ' + d.executorData.name) : a + ' <div class="task-detail-handler-icon avatar executor-avatar img-circle" style="background-image: url(/v3.8.4/images/avatar/nobody-avator@2x.png)"></div> '
  }
});
define("views/board/task/task-detail/templates/info-due-date", [], function () {
  return function (d) {
    var a = '<span class="task-detail-handler-icon icon icon-calendar"></span>';
    return a = d.dueDate ? a + (" " + d.dueDate.dateString) : a + " "
  }
});
define("views/board/task/task-detail/templates/info-priority", [], function () {
  return function (d) {
    return'<span class="priority-label img-circle task-priority-' + d.priority + '"></span>'
  }
});
define("views/board/task/task-detail/templates/info-stage", [], function () {
  return function (d) {
    return'<span class="task-detail-handler-icon icon icon-stage"></span>' + d.stageName
  }
});
define("views/board/task/task-detail/templates/info-tasklist", [], function () {
  return function (d) {
    return'<span class="task-detail-handler-icon icon icon-th-list"></span>'
  }
});
(function (d) {
  function a(a) {
    this.$textarea = d(a);
    this._init()
  }

  a.prototype = {_init: function () {
    var a = this;
    this.$textarea.wrap('<div class="flex-text-wrap" />').before("<div><span /><br></div>");
    this.$span = this.$textarea.prev().find("span");
    this.$textarea.on("input propertychange keyup change", function () {
      a._mirror()
    });
    d.valHooks.textarea = {get: function (a) {
      return a.value.replace(/\r?\n/g, "\r\n")
    }};
    this._mirror()
  }, _mirror: function () {
    this.$span.text(this.$textarea.val())
  }};
  d.fn.flexText = function () {
    return this.each(function () {
      d.data(this,
        "flexText") || d.data(this, "flexText", new a(this))
    })
  }
})(jQuery);
define("flexText", function () {
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/task/task-detail/index", "view views/board/task/task-menu/index views/board/subtask/subtask-card/index views/activity/activity-timeline/index views/member/member-involve/index views/member/member-menu/index views/board/stage/stage-switcher/index views/core/mover/index views/board/task/task-priority/index warehouse models/task collections/members collections/stages collections/subtasks collections/tasklists util thenjs ./templates/basic ./templates/task ./templates/info-executor ./templates/info-due-date ./templates/info-priority ./templates/info-stage ./templates/info-tasklist flexText".split(" "), function (d, b, e, g, k, h, l, n, m, s, r, t, v, p, x, B, C, z, A, u, w, y, J, F) {
    var H, E, I, K;
    H = teambition.APP;
    I = teambition.user;
    E = teambition.router;
    return function (d) {
      function f() {
        return K = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "TaskDetailView";
      f.prototype.className = "task-detail";
      f.prototype.events = {"click .check-box": "toggleDone", "click .task-detail-due-date": "showDueDatePickerInDetail", "click .menu-handler": "toggleTaskMenu", "click .tab-handler": "switchTabs", "focus .task-content-input": "enterEditContent",
        "blur .task-content-input": "updateTaskContent", "focus .task-note-content": "enterNoteContent", "blur .task-note-content": "updateTaskNote", "keydown .task-content-input": "quickUpdateTaskContent"};
      f.prototype.initialize = function (a) {
        var b, e = this;
        this.options = _.extend({noCreator: !0}, a);
        b = function () {
          return e.load({beforeSend: function () {
            return e.renderBasic()
          }, success: function () {
            e.renderTask().renderInvolve().renderActivities().renderInfo().listen();
            return"function" === typeof a.success ? a.success(e) : void 0
          }})
        };
        return this.options.taskModel ? (this.taskModel = this.options.taskModel, this._projectId = this.taskModel.get("_projectId"), b(), this) : this.options._taskId ? (s.fetchOne(r, this.options._taskId, {beforeSend: function () {
          return e.showLoadingIndicator()
        }, success: function (a) {
          e.hideLoadingIndicator();
          e.taskModel = a;
          e._projectId = e.taskModel.get("_projectId");
          return b()
        }, error: function (b) {
          var d;
          e.hideLoadingIndicator();
          return 400302 === b ? e.renderError() : a.onError ? a.onError(b) : "function" === typeof(d = H.currentView).onRouteError ?
            d.onRouteError() : void 0
        }}), this) : !1
      };
      f.prototype.load = function (a) {
        var b, e, d = this;
        b = _.extend({beforeSend: function () {
        }, success: function () {
        }, error: function () {
        }}, a);
        e = this.taskModel.get("_tasklistId");
        b.beforeSend();
        C.parallel([function (a) {
          return s.request(x, d._projectId, e, {success: function (b) {
            return a(null, b)
          }, error: function (b) {
            return a(b, null)
          }})
        }, function (a) {
          return s.request(v, e, {success: function (b) {
            return a(null, b)
          }, error: function (b) {
            return a(b, null)
          }})
        }, function (a) {
          return s.request(p, d.taskModel.id,
            {success: function (b) {
              return a(null, b)
            }, error: function (b) {
              return a(b, null)
            }})
        }, function (a) {
          return s.request(t, d._projectId, {success: function (b) {
            return a(null, b)
          }, error: function (b) {
            return a(b, null)
          }})
        }]).all(function (a, e, f) {
            if (e)return d.renderError();
            d.tasklistModel = f[0];
            d.stagesCollection = f[1];
            d.subtasksCollection = f[2];
            d.membersCollection = f[3];
            return b.success(f)
          });
        return this
      };
      f.prototype.listen = function () {
        this.listenTo(this.taskModel, "change:content change:isDone", this.renderTask);
        this.listenTo(this.taskModel,
          "change:_executorId", this.renderExecutor);
        this.listenTo(this.taskModel, "change:dueDate", this.renderDuedate);
        this.listenTo(this.taskModel, "change:note", this.renderNote);
        this.listenTo(this.taskModel, "change:priority", this.renderPriority);
        this.listenTo(this.taskModel, "change:_stageId", this.renderStage);
        this.listenTo(this.taskModel, "change:_tasklistId", this.renderTasklist);
        this.listenTo(this.taskModel, "destroy remove", this.close);
        return this
      };
      f.prototype.slideToBottom = function (a) {
        var b = this;
        "set" !== a.get("action").slice(0,
          3) && _.delay(function () {
          b.$el.scrollTop(1E4);
          return b.$el.parent().scrollTop(1E4)
        }, 0);
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(z(this.options));
        this.$task = this.$(".task-wrapper");
        this.$info = this.$(".task-detail-info");
        this.$involveSet = this.$(".task-detail-involve-set");
        this.$activities = this.$(".task-detail-activities");
        this.$wrapper = this.$(".task-detail-wrapper");
        this.$executor = this.$(".task-detail-executor");
        this.$dueDate = this.$(".task-detail-due-date");
        this.$note = this.$(".task-note");
        this.$noteContent = this.$(".task-note-content");
        this.$priority = this.$(".task-detail-priority");
        this.$stage = this.$(".task-detail-stage");
        this.$tasklist = this.$(".task-detail-tasklist");
        this.$subtasks = this.$(".task-detail-subtasks");
        return this
      };
      f.prototype.renderError = function () {
        var a;
        this.$el.empty();
        this.$el.addClass("empty");
        null != (a = this.$placeholder) && a.remove();
        return this.$placeholder = $("<div class='no-task-placeholder placeholder' style='font-size: 25px; text-align: center;'>\n  \n  <div style='font-size: 18px;margin-top: 20px;'>\n    \n  </div>\n</div>").appendTo(this.$el)
      };
      f.prototype.renderTask = function () {
        var a, b;
        a = this.taskModel.toJSON();
        I.id === a._executorId && (a.hasRight = 1);
        a.executorData = (null != (b = this.membersCollection.get(this.taskModel.get("_executorId"))) ? b.toJSON() : void 0) || {};
        this.$task.html(A(a));
        this.$contentWrapper = this.$(".task-content-wrapper");
        this.$contentInput = this.$(".task-content-input").val(a.content).flexText();
        return this
      };
      f.prototype.renderInfo = function () {
        this.renderExecutor();
        this.renderDuedate();
        this.renderNote();
        this.renderPriority();
        this.renderStage();
        this.renderTasklist();
        this.renderSubtaskCard();
        this.setupInfoWidgets();
        this.$info.addClass("in");
        return this
      };
      f.prototype.renderExecutor = function () {
        var a, b;
        a = null != (b = this.membersCollection.get(this.taskModel.get("_executorId"))) ? b.toJSON() : void 0;
        this.$executor.html(u({executorData: a})).data("title", null != a && a.name ? "" + (null != a ? a.name : void 0) + " " : "");
        return this
      };
      f.prototype.renderDuedate = function () {
        var a;
        a = this.taskModel.get("dueDate") ? B.formatDate(this.taskModel.get("dueDate")) : null;
        this.$dueDate.html(w({dueDate: a})).data("title",
          " " + ((null != a ? a.dateString : void 0) || ""));
        return this
      };
      f.prototype.renderStage = function () {
        var a, b;
        a = null != (b = this.stagesCollection) ? b.get(this.taskModel.get("_stageId")) : void 0;
        a = (null != a ? a.get("name") : void 0) || "()";
        this.$stage.html(J({stageName: a})).data("title", " " + a);
        return this
      };
      f.prototype.renderTasklist = function () {
        var a;
        a = this.tasklistModel.get("title");
        this.$tasklist.html(F({tasklistName: a})).data("title", " " + a);
        return this
      };
      f.prototype.renderPriority = function () {
        var a;
        a = B.getPriorityDisplay(this.taskModel.get("priority"));
        this.$priority.html(y({priority: this.taskModel.get("priority"), priorityTitle: a})).data("title", "" + a);
        return this
      };
      f.prototype.renderNote = function () {
        var a;
        a = _.unescape(this.taskModel.get("note"));
        this.$noteContent.val(a).flexText();
        return this
      };
      f.prototype.renderSubtaskCard = function () {
        this.requestSubView(e, {taskModel: this.taskModel, subtasksCollection: this.subtasksCollection}).$el.appendTo(this.$subtasks);
        return this
      };
      f.prototype.renderActivities = function () {
        var a = this;
        this.activityTimelineView = this.requestSubView(g,
          {_projectId: this._projectId, _objectId: this.taskModel.id, boundToObjectType: "task", type: "taskDetail", $attachmentsContainer: this.$(".task-detail-attachments .activities-list"), noCreator: this.options.noCreator, secondUpload: {$uploadArea: this.$(".task-attachments-handler .add-work-handler"), $dropArea: this.$(".task-attachments-handler")}, activityCollectionChange: function (b) {
            a.renderActivitiesNum(b.length);
            return a.renderAttachmentsNum(b.reduce(function (a, b) {
              return b.get("attachments").length + a
            }, 0))
          }});
        this.activityTimelineView.$el.appendTo(this.$activities);
        this.$activityCreator = this.$(".activity-creator-wrapper");
        this.options.hideActivityCreator && this.$activityCreator.hide();
        return this
      };
      f.prototype.renderInvolve = function () {
        this.requestSubView(k, {objectModel: this.taskModel, membersCollection: this.membersCollection, $list: this.$(".involve-members"), undeletable: !1, dropArea: this.$el, type: "taskDetail"}).$el.prependTo(this.$involveSet);
        return this
      };
      f.prototype.renderActivitiesNum = function (a) {
        return this.$(".activities-number").text(0 < a ? "  " + a : "")
      };
      f.prototype.renderAttachmentsNum =
        function (a) {
          return this.$(".attachments-number").text(0 < a ? "  " + a : "")
        };
      f.prototype.setupInfoWidgets = function () {
        this.initExecutorSwitcherInDetail();
        this.initMoverInDetail();
        this.initStageSwitcherInDetail();
        this.initPrioritySetDetail();
        return this
      };
      f.prototype.initExecutorSwitcherInDetail = function () {
        var a = this;
        this.requestSubView(h, {membersCollection: this.membersCollection, selected: [this.taskModel.get("_executorId")], select: function (b) {
          return a.taskModel.save("_executorId", b)
        }}).setup(this.$executor);
        return this
      };
      f.prototype.initStageSwitcherInDetail = function () {
        var a = this;
        this.requestSubView(l, {stagesCollection: this.stagesCollection, currentStageId: this.taskModel.get("_stageId"), select: function (b) {
          return a.taskModel.save({_stageId: b})
        }}).setup(this.$stage);
        return this
      };
      f.prototype.initMoverInDetail = function () {
        var a = this;
        this.requestSubView(n, {model: this.taskModel, _projectId: this.taskModel.get("_projectId"), collection: x, moverSuccess: function () {
          if ("taskDetailPanel" === a.parentView.viewName)return a.parentView.hide()
        }}).setup(this.$tasklist);
        return this
      };
      f.prototype.initPrioritySetDetail = function () {
        var a = this;
        this.requestSubView(m, {currentPriority: this.taskModel.get("priority"), select: function (b) {
          return a.taskModel.save({priority: b})
        }}).setup(this.$priority);
        return this
      };
      f.prototype.assignToSelf = function () {
        var a, b;
        b = I.id;
        a = this.taskModel.get("_executorId");
        if (b !== a)return this.taskModel.save({_executorId: b}), this
      };
      f.prototype.toggleDone = function () {
        var a;
        if (!(0 < this.taskModel.get("hasRight") || this.taskModel.get("_executorId") === I.id))return this;
        a = this.taskModel.get("isDone");
        this.taskModel.save({isDone: !a, onStage: a ? 0 : null});
        return this
      };
      f.prototype.showDueDatePickerInDetail = function () {
        var a, b = this;
        this.$dueDate.data("datepicker") ? (a = !this.$dueDate.data("showDatepicker"), this.$dueDate.data("showDatepicker", a), this.$dueDate.data("datepicker").picker.toggle(a)) : (this.$dueDate.datepicker({format: "yyyy-mm-dd", language: "zh-CN", todayHighlight: !0, placement: "left", todayBtn: "linked", tomorrowBtn: "linked", somedayBtn: "linked"}).datepicker("show").focus().on("changeDate",
          function (a) {
            b.taskModel.editDueDate(a.date);
            return b.$dueDate.datepicker("hide")
          }).on("hide", function (a) {
            return b.$dueDate.data("showDatepicker", !1)
          }), this.$dueDate.data("showDatepicker", !0));
        return!0
      };
      f.prototype.enterEditContent = function () {
        this.$contentWrapper.addClass("editing");
        return this
      };
      f.prototype.quickUpdateTaskContent = function (a) {
        13 === a.keyCode && (a.preventDefault(), this.updateTaskContent());
        return this
      };
      f.prototype.updateTaskContent = function () {
        var a;
        a = this.$contentInput.val().trim();
        a =
          a.replace(/\s+/g, " ").trim();
        this.taskModel.get("content");
        a ? this.taskModel.save({content: a}) : this.$contentInput.val(this.taskModel.get("content"));
        this.$contentWrapper.removeClass("editing");
        return this
      };
      f.prototype.enterNoteContent = function (a) {
        return this.$note.addClass("editing")
      };
      f.prototype.updateTaskNote = function () {
        var a;
        a = this.$noteContent.val().trim();
        this.taskModel.save({note: a});
        this.$note.removeClass("editing");
        return this
      };
      f.prototype.assignToSelf = function () {
        this.taskModel.save({_executorId: I.id});
        return this
      };
      f.prototype.close = function () {
        var a, b;
        "taskDetailPanel" === (null != (b = this.parentView) ? b.viewName : void 0) ? "function" === typeof(a = this.parentView).back && a.back() : this.remove();
        return this
      };
      f.prototype.remove = function () {
        var a;
        null != (a = this.$activityCreator) && a.remove();
        this.taskModel && (a = E.getUrl().replace("/task/" + this.taskModel.id, ""), E.navigate(a, {trigger: !1}));
        return f.__super__.remove.apply(this, arguments)
      };
      f.prototype.toggleTaskMenu = function (a) {
        a = $(a.currentTarget);
        a.data("bs.popover") ||
        this.requestSubView(b, {$toggler: a, _projectId: this._projectId, taskModel: this.taskModel}).show();
        return this
      };
      f.prototype.switchTabs = function (a) {
        a = $(a.currentTarget);
        a.hasClass("active") || (a.siblings().removeClass("active"), a.addClass("active"), this.$(".tab-content .active").removeClass("active"), a = a.data("toggle"), this.$("" + a).addClass("active"), ".task-detail-activities" === a ? this.$activityCreator.slideShow() : this.$activityCreator.slideHide());
        return this
      };
      return f
    }(d)
  })
}).call(this);
var wysihtml5 = {version: "@VERSION", commands: {}, dom: {}, quirks: {}, toolbar: {}, lang: {}, selection: {}, views: {}, INVISIBLE_SPACE: "", EMPTY_FUNCTION: function () {
}, ELEMENT_NODE: 1, TEXT_NODE: 3, BACKSPACE_KEY: 8, ENTER_KEY: 13, ESCAPE_KEY: 27, SPACE_KEY: 32, DELETE_KEY: 46};
window.rangy = function () {
  function d(a, b) {
    var e = typeof a[b];
    return"function" == e || !("object" != e || !a[b]) || "unknown" == e
  }

  function a(a, b) {
    return!("object" != typeof a[b] || !a[b])
  }

  function f(a, b) {
    return"undefined" != typeof a[b]
  }

  function b(a) {
    return function (b, e) {
      for (var d = e.length; d--;)if (!a(b, e[d]))return!1;
      return!0
    }
  }

  function e(a) {
    return a && r(a, s) && v(a, m)
  }

  function g(a) {
    window.alert("Rangy not supported in your browser. Reason: " + a);
    p.initialized = !0;
    p.supported = !1
  }

  function k() {
    if (!p.initialized) {
      var b, f = !1, h =
        !1;
      d(document, "createRange") && (b = document.createRange(), r(b, n) && v(b, l) && (f = !0), b.detach());
      (b = a(document, "body") ? document.body : document.getElementsByTagName("body")[0]) && d(b, "createTextRange") && (b = b.createTextRange(), e(b) && (h = !0));
      f || h || g("Neither Range nor TextRange are implemented");
      p.initialized = !0;
      p.features = {implementsDomRange: f, implementsTextRange: h};
      f = B.concat(x);
      h = 0;
      for (b = f.length; h < b; ++h)try {
        f[h](p)
      } catch (k) {
        a(window, "console") && d(window.console, "log") && window.console.log("Init listener threw an exception. Continuing.",
          k)
      }
    }
  }

  function h(a) {
    this.name = a;
    this.supported = this.initialized = !1
  }

  var l = "startContainer startOffset endContainer endOffset collapsed commonAncestorContainer START_TO_START START_TO_END END_TO_START END_TO_END".split(" "), n = "setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "), m = "boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),
    s = "collapse compareEndPoints duplicate getBookmark moveToBookmark moveToElementText parentElement pasteHTML select setEndPoint getBoundingClientRect".split(" "), r = b(d), t = b(a), v = b(f), p = {version: "1.2.3", initialized: !1, supported: !0, util: {isHostMethod: d, isHostObject: a, isHostProperty: f, areHostMethods: r, areHostObjects: t, areHostProperties: v, isTextRange: e}, features: {}, modules: {}, config: {alertOnWarn: !1, preferTextRange: !1}};
  p.fail = g;
  p.warn = function (a) {
    a = "Rangy warning: " + a;
    p.config.alertOnWarn ? window.alert(a) :
      "undefined" != typeof window.console && "undefined" != typeof window.console.log && window.console.log(a)
  };
  ({}).hasOwnProperty ? p.util.extend = function (a, b) {
    for (var e in b)b.hasOwnProperty(e) && (a[e] = b[e])
  } : g("hasOwnProperty not supported");
  var x = [], B = [];
  p.init = k;
  p.addInitListener = function (a) {
    p.initialized ? a(p) : x.push(a)
  };
  var C = [];
  p.addCreateMissingNativeApiListener = function (a) {
    C.push(a)
  };
  p.createMissingNativeApi = function (a) {
    a = a || window;
    k();
    for (var b = 0, e = C.length; b < e; ++b)C[b](a)
  };
  h.prototype.fail = function (a) {
    this.initialized = !0;
    this.supported = !1;
    throw Error("Module '" + this.name + "' failed to load: " + a);
  };
  h.prototype.warn = function (a) {
    p.warn("Module " + this.name + ": " + a)
  };
  h.prototype.createError = function (a) {
    return Error("Error in Rangy " + this.name + " module: " + a)
  };
  p.createModule = function (a, b) {
    var e = new h(a);
    p.modules[a] = e;
    B.push(function (a) {
      b(a, e);
      e.initialized = !0;
      e.supported = !0
    })
  };
  p.requireModules = function (a) {
    for (var b = 0, e = a.length, d, f; b < e; ++b) {
      f = a[b];
      d = p.modules[f];
      if (!(d && d instanceof h))throw Error("Module '" + f + "' not found");
      if (!d.supported)throw Error("Module '" + f + "' not supported");
    }
  };
  var z = !1, t = function () {
    z || (z = !0, p.initialized || k())
  };
  if ("undefined" == typeof window)g("No window found"); else if ("undefined" == typeof document)g("No document found"); else return d(document, "addEventListener") && document.addEventListener("DOMContentLoaded", t, !1), d(window, "addEventListener") ? window.addEventListener("load", t, !1) : d(window, "attachEvent") ? window.attachEvent("onload", t) : g("Window does not have required addEventListener or attachEvent method"),
    p
}();
rangy.createModule("DomUtil", function (d, a) {
  function f(a) {
    for (var b = 0; a = a.previousSibling;)b++;
    return b
  }

  function b(a, b) {
    var e = [], d;
    for (d = a; d; d = d.parentNode)e.push(d);
    for (d = b; d; d = d.parentNode)if (v(e, d))return d;
    return null
  }

  function e(a, b, e) {
    for (e = e ? a : a.parentNode; e;) {
      a = e.parentNode;
      if (a === b)return e;
      e = a
    }
    return null
  }

  function g(a) {
    a = a.nodeType;
    return 3 == a || 4 == a || 8 == a
  }

  function k(a, b) {
    var e = b.nextSibling, d = b.parentNode;
    e ? d.insertBefore(a, e) : d.appendChild(a);
    return a
  }

  function h(a) {
    if (9 == a.nodeType)return a;
    if ("undefined" != typeof a.ownerDocument)return a.ownerDocument;
    if ("undefined" != typeof a.document)return a.document;
    if (a.parentNode)return h(a.parentNode);
    throw Error("getDocument: no document found for node");
  }

  function l(a) {
    return a ? g(a) ? '"' + a.data + '"' : 1 == a.nodeType ? "<" + a.nodeName + (a.id ? ' id="' + a.id + '"' : "") + ">[" + a.childNodes.length + "]" : a.nodeName : "[No node]"
  }

  function n(a) {
    this._next = this.root = a
  }

  function m(a, b) {
    this.node = a;
    this.offset = b
  }

  function s(a) {
    this.code = this[a];
    this.codeName = a;
    this.message = "DOMException: " +
      this.codeName
  }

  var r = d.util;
  r.areHostMethods(document, ["createDocumentFragment", "createElement", "createTextNode"]) || a.fail("document missing a Node creation method");
  r.isHostMethod(document, "getElementsByTagName") || a.fail("document missing getElementsByTagName method");
  var t = document.createElement("div");
  r.areHostMethods(t, ["insertBefore", "appendChild", "cloneNode"]) || a.fail("Incomplete Element implementation");
  r.isHostProperty(t, "innerHTML") || a.fail("Element is missing innerHTML property");
  t = document.createTextNode("test");
  r.areHostMethods(t, ["splitText", "deleteData", "insertData", "appendData", "cloneNode"]) || a.fail("Incomplete Text Node implementation");
  var v = function (a, b) {
    for (var e = a.length; e--;)if (a[e] === b)return!0;
    return!1
  };
  n.prototype = {_current: null, hasNext: function () {
    return!!this._next
  }, next: function () {
    var a = this._current = this._next, b;
    if (this._current) {
      if (!(b = a.firstChild))for (b = null; a !== this.root && !(b = a.nextSibling);)a = a.parentNode;
      this._next = b
    }
    return this._current
  }, detach: function () {
    this._current = this._next = this.root =
      null
  }};
  m.prototype = {equals: function (a) {
    return this.node === a.node & this.offset == a.offset
  }, inspect: function () {
    return"[DomPosition(" + l(this.node) + ":" + this.offset + ")]"
  }};
  s.prototype = {INDEX_SIZE_ERR: 1, HIERARCHY_REQUEST_ERR: 3, WRONG_DOCUMENT_ERR: 4, NO_MODIFICATION_ALLOWED_ERR: 7, NOT_FOUND_ERR: 8, NOT_SUPPORTED_ERR: 9, INVALID_STATE_ERR: 11};
  s.prototype.toString = function () {
    return this.message
  };
  d.dom = {arrayContains: v, isHtmlNamespace: function (a) {
    var b;
    return"undefined" == typeof a.namespaceURI || null === (b = a.namespaceURI) ||
      "http://www.w3.org/1999/xhtml" == b
  }, parentElement: function (a) {
    a = a.parentNode;
    return 1 == a.nodeType ? a : null
  }, getNodeIndex: f, getNodeLength: function (a) {
    var b;
    return g(a) ? a.length : (b = a.childNodes) ? b.length : 0
  }, getCommonAncestor: b, isAncestorOf: function (a, b, e) {
    for (b = e ? b : b.parentNode; b;) {
      if (b === a)return!0;
      b = b.parentNode
    }
    return!1
  }, getClosestAncestorIn: e, isCharacterDataNode: g, insertAfter: k, splitDataNode: function (a, b) {
    var e = a.cloneNode(!1);
    e.deleteData(0, b);
    a.deleteData(b, a.length - b);
    k(e, a);
    return e
  }, getDocument: h,
    getWindow: function (a) {
      a = h(a);
      if ("undefined" != typeof a.defaultView)return a.defaultView;
      if ("undefined" != typeof a.parentWindow)return a.parentWindow;
      throw Error("Cannot get a window object for node");
    }, getIframeWindow: function (a) {
      if ("undefined" != typeof a.contentWindow)return a.contentWindow;
      if ("undefined" != typeof a.contentDocument)return a.contentDocument.defaultView;
      throw Error("getIframeWindow: No Window object found for iframe element");
    }, getIframeDocument: function (a) {
      if ("undefined" != typeof a.contentDocument)return a.contentDocument;
      if ("undefined" != typeof a.contentWindow)return a.contentWindow.document;
      throw Error("getIframeWindow: No Document object found for iframe element");
    }, getBody: function (a) {
      return r.isHostObject(a, "body") ? a.body : a.getElementsByTagName("body")[0]
    }, getRootContainer: function (a) {
      for (var b; b = a.parentNode;)a = b;
      return a
    }, comparePoints: function (a, d, g, h) {
      var k;
      if (a == g)return d === h ? 0 : d < h ? -1 : 1;
      if (k = e(g, a, !0))return d <= f(k) ? -1 : 1;
      if (k = e(a, g, !0))return f(k) < h ? -1 : 1;
      d = b(a, g);
      a = a === d ? d : e(a, d, !0);
      g = g === d ? d : e(g, d, !0);
      if (a ===
        g)throw Error("comparePoints got to case 4 and childA and childB are the same!");
      for (d = d.firstChild; d;) {
        if (d === a)return-1;
        if (d === g)return 1;
        d = d.nextSibling
      }
      throw Error("Should not be here!");
    }, inspectNode: l, fragmentFromNodeChildren: function (a) {
      for (var b = h(a).createDocumentFragment(), e; e = a.firstChild;)b.appendChild(e);
      return b
    }, createIterator: function (a) {
      return new n(a)
    }, DomPosition: m};
  d.DOMException = s
});
rangy.createModule("DomRange", function (d) {
  function a(a, b) {
    return 3 != a.nodeType && (D.isAncestorOf(a, b.startContainer, !0) || D.isAncestorOf(a, b.endContainer, !0))
  }

  function f(a) {
    return D.getDocument(a.startContainer)
  }

  function b(a, b, e) {
    if (b = a._listeners[b])for (var d = 0, f = b.length; d < f; ++d)b[d].call(a, {target: a, args: e})
  }

  function e(a) {
    return new Y(a.parentNode, D.getNodeIndex(a))
  }

  function g(a) {
    return new Y(a.parentNode, D.getNodeIndex(a) + 1)
  }

  function k(a, b, e) {
    var d = 11 == a.nodeType ? a.firstChild : a;
    D.isCharacterDataNode(b) ?
      e == b.length ? D.insertAfter(a, b) : b.parentNode.insertBefore(a, 0 == e ? b : D.splitDataNode(b, e)) : e >= b.childNodes.length ? b.appendChild(a) : b.insertBefore(a, b.childNodes[e]);
    return d
  }

  function h(a) {
    for (var b, e, d = f(a.range).createDocumentFragment(); e = a.next();) {
      b = a.isPartiallySelectedSubtree();
      e = e.cloneNode(!b);
      b && (b = a.getSubtreeIterator(), e.appendChild(h(b)), b.detach(!0));
      if (10 == e.nodeType)throw new M("HIERARCHY_REQUEST_ERR");
      d.appendChild(e)
    }
    return d
  }

  function l(a, b, e) {
    var d, f;
    for (e = e || {stop: !1}; d = a.next();)if (a.isPartiallySelectedSubtree())if (!1 ===
      b(d)) {
      e.stop = !0;
      break
    } else {
      if (d = a.getSubtreeIterator(), l(d, b, e), d.detach(!0), e.stop)break
    } else for (d = D.createIterator(d); f = d.next();)if (!1 === b(f)) {
      e.stop = !0;
      return
    }
  }

  function n(a) {
    for (var b; a.next();)a.isPartiallySelectedSubtree() ? (b = a.getSubtreeIterator(), n(b), b.detach(!0)) : a.remove()
  }

  function m(a) {
    for (var b, e = f(a.range).createDocumentFragment(), d; b = a.next();) {
      a.isPartiallySelectedSubtree() ? (b = b.cloneNode(!1), d = a.getSubtreeIterator(), b.appendChild(m(d)), d.detach(!0)) : a.remove();
      if (10 == b.nodeType)throw new M("HIERARCHY_REQUEST_ERR");
      e.appendChild(b)
    }
    return e
  }

  function s(a, b, e) {
    var d = !(!b || !b.length), f, g = !!e;
    d && (f = RegExp("^(" + b.join("|") + ")$"));
    var h = [];
    l(new t(a, !1), function (a) {
      d && !f.test(a.nodeType) || g && !e(a) || h.push(a)
    });
    return h
  }

  function r(a) {
    return"[" + ("undefined" == typeof a.getName ? "Range" : a.getName()) + "(" + D.inspectNode(a.startContainer) + ":" + a.startOffset + ", " + D.inspectNode(a.endContainer) + ":" + a.endOffset + ")]"
  }

  function t(a, b) {
    this.range = a;
    this.clonePartiallySelectedTextNodes = b;
    if (!a.collapsed) {
      this.sc = a.startContainer;
      this.so =
        a.startOffset;
      this.ec = a.endContainer;
      this.eo = a.endOffset;
      var e = a.commonAncestorContainer;
      this.sc === this.ec && D.isCharacterDataNode(this.sc) ? (this.isSingleCharacterDataNode = !0, this._first = this._last = this._next = this.sc) : (this._first = this._next = this.sc !== e || D.isCharacterDataNode(this.sc) ? D.getClosestAncestorIn(this.sc, e, !0) : this.sc.childNodes[this.so], this._last = this.ec !== e || D.isCharacterDataNode(this.ec) ? D.getClosestAncestorIn(this.ec, e, !0) : this.ec.childNodes[this.eo - 1])
    }
  }

  function v(a) {
    this.code = this[a];
    this.codeName = a;
    this.message = "RangeException: " + this.codeName
  }

  function p(a, b, e) {
    this.nodes = s(a, b, e);
    this._next = this.nodes[0];
    this._position = 0
  }

  function x(a) {
    return function (b, e) {
      for (var d, f = e ? b : b.parentNode; f;) {
        d = f.nodeType;
        if (D.arrayContains(a, d))return f;
        f = f.parentNode
      }
      return null
    }
  }

  function B(a, b) {
    if (ba(a, b))throw new v("INVALID_NODE_TYPE_ERR");
  }

  function C(a) {
    if (!a.startContainer)throw new M("INVALID_STATE_ERR");
  }

  function z(a, b) {
    if (!D.arrayContains(b, a.nodeType))throw new v("INVALID_NODE_TYPE_ERR");
  }

  function A(a, b) {
    if (0 > b || b > (D.isCharacterDataNode(a) ? a.length : a.childNodes.length))throw new M("INDEX_SIZE_ERR");
  }

  function u(a, b) {
    if (ea(a, !0) !== ea(b, !0))throw new M("WRONG_DOCUMENT_ERR");
  }

  function w(a) {
    if (G(a, !0))throw new M("NO_MODIFICATION_ALLOWED_ERR");
  }

  function y(a, b) {
    if (!a)throw new M(b);
  }

  function J(a) {
    return!!a.startContainer && !!a.endContainer && !(!D.arrayContains(da, a.startContainer.nodeType) && !ea(a.startContainer, !0)) && !(!D.arrayContains(da, a.endContainer.nodeType) && !ea(a.endContainer, !0)) &&
      a.startOffset <= (D.isCharacterDataNode(a.startContainer) ? a.startContainer.length : a.startContainer.childNodes.length) && a.endOffset <= (D.isCharacterDataNode(a.endContainer) ? a.endContainer.length : a.endContainer.childNodes.length)
  }

  function F(a) {
    C(a);
    if (!J(a))throw Error("Range error: Range is no longer valid after DOM mutation (" + a.inspect() + ")");
  }

  function H() {
  }

  function E(a) {
    a.START_TO_START = W;
    a.START_TO_END = ka;
    a.END_TO_END = pa;
    a.END_TO_START = sa;
    a.NODE_BEFORE = q;
    a.NODE_AFTER = ta;
    a.NODE_BEFORE_AND_AFTER = ca;
    a.NODE_INSIDE = Aa
  }

  function I(a) {
    E(a);
    E(a.prototype)
  }

  function K(a, b) {
    return function () {
      F(this);
      var e = this.startContainer, d = this.startOffset, f = this.commonAncestorContainer, h = new t(this, !0);
      e !== f && (e = D.getClosestAncestorIn(e, f, !0), d = g(e), e = d.node, d = d.offset);
      l(h, w);
      h.reset();
      f = a(h);
      h.detach();
      b(this, e, d, e, d);
      return f
    }
  }

  function N(b, f, h) {
    function k(a, b) {
      return function (d) {
        C(this);
        z(d, T);
        z(ja(d), da);
        d = (a ? e : g)(d);
        (b ? l : p)(this, d.node, d.offset)
      }
    }

    function l(a, b, e) {
      var d = a.endContainer, g = a.endOffset;
      if (b !== a.startContainer ||
        e !== a.startOffset) {
        if (ja(b) != ja(d) || 1 == D.comparePoints(b, e, d, g))d = b, g = e;
        f(a, b, e, d, g)
      }
    }

    function p(a, b, e) {
      var d = a.startContainer, g = a.startOffset;
      if (b !== a.endContainer || e !== a.endOffset) {
        if (ja(b) != ja(d) || -1 == D.comparePoints(b, e, d, g))d = b, g = e;
        f(a, d, g, b, e)
      }
    }

    b.prototype = new H;
    d.util.extend(b.prototype, {setStart: function (a, b) {
      C(this);
      B(a, !0);
      A(a, b);
      l(this, a, b)
    }, setEnd: function (a, b) {
      C(this);
      B(a, !0);
      A(a, b);
      p(this, a, b)
    }, setStartBefore: k(!0, !0), setStartAfter: k(!1, !0), setEndBefore: k(!0, !1), setEndAfter: k(!1, !1),
      collapse: function (a) {
        F(this);
        a ? f(this, this.startContainer, this.startOffset, this.startContainer, this.startOffset) : f(this, this.endContainer, this.endOffset, this.endContainer, this.endOffset)
      }, selectNodeContents: function (a) {
        C(this);
        B(a, !0);
        f(this, a, 0, a, D.getNodeLength(a))
      }, selectNode: function (a) {
        C(this);
        B(a, !1);
        z(a, T);
        var b = e(a);
        a = g(a);
        f(this, b.node, b.offset, a.node, a.offset)
      }, extractContents: K(m, f), deleteContents: K(n, f), canSurroundContents: function () {
        F(this);
        w(this.startContainer);
        w(this.endContainer);
        var b = new t(this, !0), e = b._first && a(b._first, this) || b._last && a(b._last, this);
        b.detach();
        return!e
      }, detach: function () {
        h(this)
      }, splitBoundaries: function () {
        F(this);
        var a = this.startContainer, b = this.startOffset, e = this.endContainer, d = this.endOffset, g = a === e;
        D.isCharacterDataNode(e) && 0 < d && d < e.length && D.splitDataNode(e, d);
        D.isCharacterDataNode(a) && 0 < b && b < a.length && (a = D.splitDataNode(a, b), g ? (d -= b, e = a) : e == a.parentNode && d >= D.getNodeIndex(a) && d++, b = 0);
        f(this, a, b, e, d)
      }, normalizeBoundaries: function () {
        F(this);
        var a =
          this.startContainer, b = this.startOffset, e = this.endContainer, d = this.endOffset, g = function (a) {
          var b = a.nextSibling;
          b && b.nodeType == a.nodeType && (e = a, d = a.length, a.appendData(b.data), b.parentNode.removeChild(b))
        }, h = function (f) {
          var g = f.previousSibling;
          if (g && g.nodeType == f.nodeType) {
            a = f;
            var h = f.length;
            b = g.length;
            f.insertData(0, g.data);
            g.parentNode.removeChild(g);
            a == e ? (d += b, e = a) : e == f.parentNode && (g = D.getNodeIndex(f), d == g ? (e = f, d = h) : d > g && d--)
          }
        }, k = !0;
        D.isCharacterDataNode(e) ? e.length == d && g(e) : (0 < d && (k = e.childNodes[d -
          1]) && D.isCharacterDataNode(k) && g(k), k = !this.collapsed);
        k ? D.isCharacterDataNode(a) ? 0 == b && h(a) : b < a.childNodes.length && (g = a.childNodes[b]) && D.isCharacterDataNode(g) && h(g) : (a = e, b = d);
        f(this, a, b, e, d)
      }, collapseToPoint: function (a, b) {
        C(this);
        B(a, !0);
        A(a, b);
        a === this.startContainer && b === this.startOffset && a === this.endContainer && b === this.endOffset || f(this, a, b, a, b)
      }});
    I(b)
  }

  function R(a) {
    a.collapsed = a.startContainer === a.endContainer && a.startOffset === a.endOffset;
    a.commonAncestorContainer = a.collapsed ? a.startContainer :
      D.getCommonAncestor(a.startContainer, a.endContainer)
  }

  function S(a, e, d, f, g) {
    var h = a.startContainer !== e || a.startOffset !== d, k = a.endContainer !== f || a.endOffset !== g;
    a.startContainer = e;
    a.startOffset = d;
    a.endContainer = f;
    a.endOffset = g;
    R(a);
    b(a, "boundarychange", {startMoved: h, endMoved: k})
  }

  function L(a) {
    this.startContainer = a;
    this.startOffset = 0;
    this.endContainer = a;
    this.endOffset = 0;
    this._listeners = {boundarychange: [], detach: []};
    R(this)
  }

  d.requireModules(["DomUtil"]);
  var D = d.dom, Y = D.DomPosition, M = d.DOMException;
  t.prototype =
  {_current: null, _next: null, _first: null, _last: null, isSingleCharacterDataNode: !1, reset: function () {
    this._current = null;
    this._next = this._first
  }, hasNext: function () {
    return!!this._next
  }, next: function () {
    var a = this._current = this._next;
    a && (this._next = a !== this._last ? a.nextSibling : null, D.isCharacterDataNode(a) && this.clonePartiallySelectedTextNodes && (a === this.ec && (a = a.cloneNode(!0)).deleteData(this.eo, a.length - this.eo), this._current === this.sc && (a = a.cloneNode(!0)).deleteData(0, this.so)));
    return a
  }, remove: function () {
    var a =
      this._current, b, e;
    !D.isCharacterDataNode(a) || a !== this.sc && a !== this.ec ? a.parentNode && a.parentNode.removeChild(a) : (b = a === this.sc ? this.so : 0, e = a === this.ec ? this.eo : a.length, b != e && a.deleteData(b, e - b))
  }, isPartiallySelectedSubtree: function () {
    return a(this._current, this.range)
  }, getSubtreeIterator: function () {
    var a;
    if (this.isSingleCharacterDataNode)a = this.range.cloneRange(), a.collapse(); else {
      a = new L(f(this.range));
      var b = this._current, e = b, d = 0, g = b, h = D.getNodeLength(b);
      D.isAncestorOf(b, this.sc, !0) && (e = this.sc,
        d = this.so);
      D.isAncestorOf(b, this.ec, !0) && (g = this.ec, h = this.eo);
      S(a, e, d, g, h)
    }
    return new t(a, this.clonePartiallySelectedTextNodes)
  }, detach: function (a) {
    a && this.range.detach();
    this.range = this._current = this._next = this._first = this._last = this.sc = this.so = this.ec = this.eo = null
  }};
  v.prototype = {BAD_BOUNDARYPOINTS_ERR: 1, INVALID_NODE_TYPE_ERR: 2};
  v.prototype.toString = function () {
    return this.message
  };
  p.prototype = {_current: null, hasNext: function () {
    return!!this._next
  }, next: function () {
    this._current = this._next;
    this._next =
      this.nodes[++this._position];
    return this._current
  }, detach: function () {
    this._current = this._next = this.nodes = null
  }};
  var T = [1, 3, 4, 5, 7, 8, 10], da = [2, 9, 11], Z = [1, 3, 4, 5, 7, 8, 10, 11], O = [1, 3, 4, 5, 7, 8], ja = D.getRootContainer, ea = x([9, 11]), G = x([5, 6, 10, 12]), ba = x([6, 10, 12]), Q = document.createElement("style"), aa = !1;
  try {
    Q.innerHTML = "<b>x</b>", aa = 3 == Q.firstChild.nodeType
  } catch (fa) {
  }
  d.features.htmlParsingConforms = aa;
  var U = "startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "), W = 0, ka =
    1, pa = 2, sa = 3, q = 0, ta = 1, ca = 2, Aa = 3;
  H.prototype = {attachListener: function (a, b) {
    this._listeners[a].push(b)
  }, compareBoundaryPoints: function (a, b) {
    F(this);
    u(this.startContainer, b.startContainer);
    var e = a == sa || a == W ? "start" : "end", d = a == ka || a == W ? "start" : "end";
    return D.comparePoints(this[e + "Container"], this[e + "Offset"], b[d + "Container"], b[d + "Offset"])
  }, insertNode: function (a) {
    F(this);
    z(a, Z);
    w(this.startContainer);
    if (D.isAncestorOf(a, this.startContainer, !0))throw new M("HIERARCHY_REQUEST_ERR");
    this.setStartBefore(k(a,
      this.startContainer, this.startOffset))
  }, cloneContents: function () {
    F(this);
    var a, b;
    if (this.collapsed)return f(this).createDocumentFragment();
    if (this.startContainer === this.endContainer && D.isCharacterDataNode(this.startContainer))return a = this.startContainer.cloneNode(!0), a.data = a.data.slice(this.startOffset, this.endOffset), b = f(this).createDocumentFragment(), b.appendChild(a), b;
    b = new t(this, !0);
    a = h(b);
    b.detach();
    return a
  }, canSurroundContents: function () {
    F(this);
    w(this.startContainer);
    w(this.endContainer);
    var b = new t(this, !0), e = b._first && a(b._first, this) || b._last && a(b._last, this);
    b.detach();
    return!e
  }, surroundContents: function (a) {
    z(a, O);
    if (!this.canSurroundContents())throw new v("BAD_BOUNDARYPOINTS_ERR");
    var b = this.extractContents();
    if (a.hasChildNodes())for (; a.lastChild;)a.removeChild(a.lastChild);
    k(a, this.startContainer, this.startOffset);
    a.appendChild(b);
    this.selectNode(a)
  }, cloneRange: function () {
    F(this);
    for (var a = new L(f(this)), b = U.length, e; b--;)e = U[b], a[e] = this[e];
    return a
  }, toString: function () {
    F(this);
    var a = this.startContainer;
    if (a === this.endContainer && D.isCharacterDataNode(a))return 3 == a.nodeType || 4 == a.nodeType ? a.data.slice(this.startOffset, this.endOffset) : "";
    var b = [], a = new t(this, !0);
    l(a, function (a) {
      3 != a.nodeType && 4 != a.nodeType || b.push(a.data)
    });
    a.detach();
    return b.join("")
  }, compareNode: function (a) {
    F(this);
    var b = a.parentNode, e = D.getNodeIndex(a);
    if (!b)throw new M("NOT_FOUND_ERR");
    a = this.comparePoint(b, e);
    b = this.comparePoint(b, e + 1);
    return 0 > a ? 0 < b ? ca : q : 0 < b ? ta : Aa
  }, comparePoint: function (a, b) {
    F(this);
    y(a, "HIERARCHY_REQUEST_ERR");
    u(a, this.startContainer);
    return 0 > D.comparePoints(a, b, this.startContainer, this.startOffset) ? -1 : 0 < D.comparePoints(a, b, this.endContainer, this.endOffset) ? 1 : 0
  }, createContextualFragment: aa ? function (a) {
    var b = this.startContainer, e = D.getDocument(b);
    if (!b)throw new M("INVALID_STATE_ERR");
    var d = null;
    1 == b.nodeType ? d = b : D.isCharacterDataNode(b) && (d = D.parentElement(b));
    d = null === d || "HTML" == d.nodeName && D.isHtmlNamespace(D.getDocument(d).documentElement) && D.isHtmlNamespace(d) ? e.createElement("body") :
      d.cloneNode(!1);
    d.innerHTML = a;
    return D.fragmentFromNodeChildren(d)
  } : function (a) {
    C(this);
    var b = f(this).createElement("body");
    b.innerHTML = a;
    return D.fragmentFromNodeChildren(b)
  }, toHtml: function () {
    F(this);
    var a = f(this).createElement("div");
    a.appendChild(this.cloneContents());
    return a.innerHTML
  }, intersectsNode: function (a, b) {
    F(this);
    y(a, "NOT_FOUND_ERR");
    if (D.getDocument(a) !== f(this))return!1;
    var e = a.parentNode, d = D.getNodeIndex(a);
    y(e, "NOT_FOUND_ERR");
    var g = D.comparePoints(e, d, this.endContainer, this.endOffset),
      e = D.comparePoints(e, d + 1, this.startContainer, this.startOffset);
    return b ? 0 >= g && 0 <= e : 0 > g && 0 < e
  }, isPointInRange: function (a, b) {
    F(this);
    y(a, "HIERARCHY_REQUEST_ERR");
    u(a, this.startContainer);
    return 0 <= D.comparePoints(a, b, this.startContainer, this.startOffset) && 0 >= D.comparePoints(a, b, this.endContainer, this.endOffset)
  }, intersectsRange: function (a, b) {
    F(this);
    if (f(a) != f(this))throw new M("WRONG_DOCUMENT_ERR");
    var e = D.comparePoints(this.startContainer, this.startOffset, a.endContainer, a.endOffset), d = D.comparePoints(this.endContainer,
      this.endOffset, a.startContainer, a.startOffset);
    return b ? 0 >= e && 0 <= d : 0 > e && 0 < d
  }, intersection: function (a) {
    if (this.intersectsRange(a)) {
      var b = D.comparePoints(this.startContainer, this.startOffset, a.startContainer, a.startOffset), e = D.comparePoints(this.endContainer, this.endOffset, a.endContainer, a.endOffset), d = this.cloneRange();
      -1 == b && d.setStart(a.startContainer, a.startOffset);
      1 == e && d.setEnd(a.endContainer, a.endOffset);
      return d
    }
    return null
  }, union: function (a) {
    if (this.intersectsRange(a, !0)) {
      var b = this.cloneRange();
      -1 == D.comparePoints(a.startContainer, a.startOffset, this.startContainer, this.startOffset) && b.setStart(a.startContainer, a.startOffset);
      1 == D.comparePoints(a.endContainer, a.endOffset, this.endContainer, this.endOffset) && b.setEnd(a.endContainer, a.endOffset);
      return b
    }
    throw new v("Ranges do not intersect");
  }, containsNode: function (a, b) {
    return b ? this.intersectsNode(a, !1) : this.compareNode(a) == Aa
  }, containsNodeContents: function (a) {
    return 0 <= this.comparePoint(a, 0) && 0 >= this.comparePoint(a, D.getNodeLength(a))
  }, containsRange: function (a) {
    return this.intersection(a).equals(a)
  },
    containsNodeText: function (a) {
      var b = this.cloneRange();
      b.selectNode(a);
      var e = b.getNodes([3]);
      return 0 < e.length ? (b.setStart(e[0], 0), a = e.pop(), b.setEnd(a, a.length), a = this.containsRange(b), b.detach(), a) : this.containsNodeContents(a)
    }, createNodeIterator: function (a, b) {
      F(this);
      return new p(this, a, b)
    }, getNodes: function (a, b) {
      F(this);
      return s(this, a, b)
    }, getDocument: function () {
      return f(this)
    }, collapseBefore: function (a) {
      C(this);
      this.setEndBefore(a);
      this.collapse(!1)
    }, collapseAfter: function (a) {
      C(this);
      this.setStartAfter(a);
      this.collapse(!0)
    }, getName: function () {
      return"DomRange"
    }, equals: function (a) {
      return L.rangesEqual(this, a)
    }, isValid: function () {
      return J(this)
    }, inspect: function () {
      return r(this)
    }};
  N(L, S, function (a) {
    C(a);
    a.startContainer = a.startOffset = a.endContainer = a.endOffset = null;
    a.collapsed = a.commonAncestorContainer = null;
    b(a, "detach", null);
    a._listeners = null
  });
  d.rangePrototype = H.prototype;
  L.rangeProperties = U;
  L.RangeIterator = t;
  L.copyComparisonConstants = I;
  L.createPrototypeRange = N;
  L.inspect = r;
  L.getRangeDocument = f;
  L.rangesEqual =
    function (a, b) {
      return a.startContainer === b.startContainer && a.startOffset === b.startOffset && a.endContainer === b.endContainer && a.endOffset === b.endOffset
    };
  d.DomRange = L;
  d.RangeException = v
});
rangy.createModule("WrappedRange", function (d) {
  function a(a, b, d, f) {
    var h = a.duplicate();
    h.collapse(d);
    var k = h.parentElement();
    e.isAncestorOf(b, k, !0) || (k = b);
    if (!k.canHaveHTML)return new g(k.parentNode, e.getNodeIndex(k));
    b = e.getDocument(k).createElement("span");
    var v, p = d ? "StartToStart" : "StartToEnd";
    do k.insertBefore(b, b.previousSibling), h.moveToElementText(b); while (0 < (v = h.compareEndPoints(p, a)) && b.previousSibling);
    p = b.nextSibling;
    if (-1 == v && p && e.isCharacterDataNode(p)) {
      h.setEndPoint(d ? "EndToStart" : "EndToEnd",
        a);
      if (/[\r\n]/.test(p.data))for (k = h.duplicate(), d = k.text.replace(/\r\n/g, "\r").length, d = k.moveStart("character", d); -1 == k.compareEndPoints("StartToEnd", k);)d++, k.moveStart("character", 1); else d = h.text.length;
      k = new g(p, d)
    } else p = (f || !d) && b.previousSibling, k = (d = (f || d) && b.nextSibling) && e.isCharacterDataNode(d) ? new g(d, 0) : p && e.isCharacterDataNode(p) ? new g(p, p.length) : new g(k, e.getNodeIndex(b));
    b.parentNode.removeChild(b);
    return k
  }

  function f(a, b) {
    var d, f, g = a.offset, h = e.getDocument(a.node), k = h.body.createTextRange(),
      p = e.isCharacterDataNode(a.node);
    p ? (d = a.node, f = d.parentNode) : (d = a.node.childNodes, d = g < d.length ? d[g] : null, f = a.node);
    h = h.createElement("span");
    h.innerHTML = "&#feff;";
    d ? f.insertBefore(h, d) : f.appendChild(h);
    k.moveToElementText(h);
    k.collapse(!b);
    f.removeChild(h);
    if (p)k[b ? "moveStart" : "moveEnd"]("character", g);
    return k
  }

  d.requireModules(["DomUtil", "DomRange"]);
  var b, e = d.dom, g = e.DomPosition, k = d.DomRange;
  if (d.features.implementsDomRange && (!d.features.implementsTextRange || !d.config.preferTextRange))(function () {
    function a(b) {
      for (var e =
        g.length, d; e--;)d = g[e], b[d] = b.nativeRange[d]
    }

    var f, g = k.rangeProperties, h, r;
    b = function (b) {
      if (!b)throw Error("Range must be specified");
      this.nativeRange = b;
      a(this)
    };
    k.createPrototypeRange(b, function (a, b, e, d, f) {
      var g = a.endContainer !== d || a.endOffset != f;
      if (a.startContainer !== b || a.startOffset != e || g)a.setEnd(d, f), a.setStart(b, e)
    }, function (a) {
      a.nativeRange.detach();
      a.detached = !0;
      for (var b = g.length, e; b--;)e = g[b], a[e] = null
    });
    f = b.prototype;
    f.selectNode = function (b) {
      this.nativeRange.selectNode(b);
      a(this)
    };
    f.deleteContents =
      function () {
        this.nativeRange.deleteContents();
        a(this)
      };
    f.extractContents = function () {
      var b = this.nativeRange.extractContents();
      a(this);
      return b
    };
    f.cloneContents = function () {
      return this.nativeRange.cloneContents()
    };
    f.surroundContents = function (b) {
      this.nativeRange.surroundContents(b);
      a(this)
    };
    f.collapse = function (b) {
      this.nativeRange.collapse(b);
      a(this)
    };
    f.cloneRange = function () {
      return new b(this.nativeRange.cloneRange())
    };
    f.refresh = function () {
      a(this)
    };
    f.toString = function () {
      return this.nativeRange.toString()
    };
    var t = document.createTextNode("test");
    e.getBody(document).appendChild(t);
    var v = document.createRange();
    v.setStart(t, 0);
    v.setEnd(t, 0);
    try {
      v.setStart(t, 1), h = !0, f.setStart = function (b, e) {
        this.nativeRange.setStart(b, e);
        a(this)
      }, f.setEnd = function (b, e) {
        this.nativeRange.setEnd(b, e);
        a(this)
      }, r = function (b) {
        return function (e) {
          this.nativeRange[b](e);
          a(this)
        }
      }
    } catch (p) {
      h = !1, f.setStart = function (b, e) {
        try {
          this.nativeRange.setStart(b, e)
        } catch (d) {
          this.nativeRange.setEnd(b, e), this.nativeRange.setStart(b, e)
        }
        a(this)
      },
        f.setEnd = function (b, e) {
          try {
            this.nativeRange.setEnd(b, e)
          } catch (d) {
            this.nativeRange.setStart(b, e), this.nativeRange.setEnd(b, e)
          }
          a(this)
        }, r = function (b, e) {
        return function (d) {
          try {
            this.nativeRange[b](d)
          } catch (f) {
            this.nativeRange[e](d), this.nativeRange[b](d)
          }
          a(this)
        }
      }
    }
    f.setStartBefore = r("setStartBefore", "setEndBefore");
    f.setStartAfter = r("setStartAfter", "setEndAfter");
    f.setEndBefore = r("setEndBefore", "setStartBefore");
    f.setEndAfter = r("setEndAfter", "setStartAfter");
    v.selectNodeContents(t);
    f.selectNodeContents =
      v.startContainer == t && v.endContainer == t && 0 == v.startOffset && v.endOffset == t.length ? function (b) {
        this.nativeRange.selectNodeContents(b);
        a(this)
      } : function (a) {
        this.setStart(a, 0);
        this.setEnd(a, k.getEndOffset(a))
      };
    v.selectNodeContents(t);
    v.setEnd(t, 3);
    h = document.createRange();
    h.selectNodeContents(t);
    h.setEnd(t, 4);
    h.setStart(t, 2);
    f.compareBoundaryPoints = -1 == v.compareBoundaryPoints(v.START_TO_END, h) & 1 == v.compareBoundaryPoints(v.END_TO_START, h) ? function (a, b) {
      b = b.nativeRange || b;
      a == b.START_TO_END ? a = b.END_TO_START :
        a == b.END_TO_START && (a = b.START_TO_END);
      return this.nativeRange.compareBoundaryPoints(a, b)
    } : function (a, b) {
      return this.nativeRange.compareBoundaryPoints(a, b.nativeRange || b)
    };
    d.util.isHostMethod(v, "createContextualFragment") && (f.createContextualFragment = function (a) {
      return this.nativeRange.createContextualFragment(a)
    });
    e.getBody(document).removeChild(t);
    v.detach();
    h.detach()
  })(), d.createNativeRange = function (a) {
    a = a || document;
    return a.createRange()
  }; else if (d.features.implementsTextRange) {
    b = function (a) {
      this.textRange =
        a;
      this.refresh()
    };
    b.prototype = new k(document);
    b.prototype.refresh = function () {
      var b, d, f = this.textRange;
      b = f.parentElement();
      var g = f.duplicate();
      g.collapse(!0);
      d = g.parentElement();
      g = f.duplicate();
      g.collapse(!1);
      f = g.parentElement();
      d = d == f ? d : e.getCommonAncestor(d, f);
      d = d == b ? d : e.getCommonAncestor(b, d);
      0 == this.textRange.compareEndPoints("StartToEnd", this.textRange) ? d = b = a(this.textRange, d, !0, !0) : (b = a(this.textRange, d, !0, !1), d = a(this.textRange, d, !1, !1));
      this.setStart(b.node, b.offset);
      this.setEnd(d.node, d.offset)
    };
    k.copyComparisonConstants(b);
    var h = function () {
      return this
    }();
    "undefined" == typeof h.Range && (h.Range = b);
    d.createNativeRange = function (a) {
      a = a || document;
      return a.body.createTextRange()
    }
  }
  d.features.implementsTextRange && (b.rangeToTextRange = function (a) {
    if (a.collapsed)return f(new g(a.startContainer, a.startOffset), !0);
    var b = f(new g(a.startContainer, a.startOffset), !0), d = f(new g(a.endContainer, a.endOffset), !1);
    a = e.getDocument(a.startContainer).body.createTextRange();
    a.setEndPoint("StartToStart", b);
    a.setEndPoint("EndToEnd",
      d);
    return a
  });
  b.prototype.getName = function () {
    return"WrappedRange"
  };
  d.WrappedRange = b;
  d.createRange = function (a) {
    a = a || document;
    return new b(d.createNativeRange(a))
  };
  d.createRangyRange = function (a) {
    a = a || document;
    return new k(a)
  };
  d.createIframeRange = function (a) {
    return d.createRange(e.getIframeDocument(a))
  };
  d.createIframeRangyRange = function (a) {
    return d.createRangyRange(e.getIframeDocument(a))
  };
  d.addCreateMissingNativeApiListener(function (a) {
    a = a.document;
    "undefined" == typeof a.createRange && (a.createRange =
      function () {
        return d.createRange(this)
      });
    a = a = null
  })
});
rangy.createModule("WrappedSelection", function (d, a) {
  function f(a) {
    return(a || window).getSelection()
  }

  function b(a) {
    return(a || window).document.selection
  }

  function e(a, b, e) {
    var d = e ? "end" : "start";
    e = e ? "start" : "end";
    a.anchorNode = b[d + "Container"];
    a.anchorOffset = b[d + "Offset"];
    a.focusNode = b[e + "Container"];
    a.focusOffset = b[e + "Offset"]
  }

  function g(a) {
    a.anchorNode = a.focusNode = null;
    a.anchorOffset = a.focusOffset = 0;
    a.rangeCount = 0;
    a.isCollapsed = !0;
    a._ranges.length = 0
  }

  function k(a) {
    var b;
    a instanceof B ? (b = a._selectionNativeRange,
      b || (b = d.createNativeRange(p.getDocument(a.startContainer)), b.setEnd(a.endContainer, a.endOffset), b.setStart(a.startContainer, a.startOffset), a._selectionNativeRange = b, a.attachListener("detach", function () {
        this._selectionNativeRange = null
      }))) : a instanceof C ? b = a.nativeRange : d.features.implementsDomRange && a instanceof p.getWindow(a.startContainer).Range && (b = a);
    return b
  }

  function h(a) {
    var b = a.getNodes(), e;
    a:if (b.length && 1 == b[0].nodeType) {
      e = 1;
      for (var d = b.length; e < d; ++e)if (!p.isAncestorOf(b[0], b[e])) {
        e = !1;
        break a
      }
      e = !0
    } else e = !1;
    if (!e)throw Error("getSingleElementFromRange: range " + a.inspect() + " did not consist of a single element");
    return b[0]
  }

  function l(a, b) {
    var d = new C(b);
    a._ranges = [d];
    e(a, d, !1);
    a.rangeCount = 1;
    a.isCollapsed = d.collapsed
  }

  function n(a) {
    a._ranges.length = 0;
    if ("None" == a.docSelection.type)g(a); else {
      var b = a.docSelection.createRange();
      if (b && "undefined" != typeof b.text)l(a, b); else {
        a.rangeCount = b.length;
        for (var f, h = p.getDocument(b.item(0)), k = 0; k < a.rangeCount; ++k)f = d.createRange(h), f.selectNode(b.item(k)),
          a._ranges.push(f);
        a.isCollapsed = 1 == a.rangeCount && a._ranges[0].collapsed;
        e(a, a._ranges[a.rangeCount - 1], !1)
      }
    }
  }

  function m(a, b) {
    for (var e = a.docSelection.createRange(), d = h(b), f = p.getDocument(e.item(0)), f = p.getBody(f).createControlRange(), g = 0, k = e.length; g < k; ++g)f.add(e.item(g));
    try {
      f.add(d)
    } catch (l) {
      throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");
    }
    f.select();
    n(a)
  }

  function s(a, b, e) {
    this.nativeSelection = a;
    this.docSelection = b;
    this._ranges =
      [];
    this.win = e;
    this.refresh()
  }

  function r(a, b) {
    for (var e = p.getDocument(b[0].startContainer), e = p.getBody(e).createControlRange(), d = 0, f; d < rangeCount; ++d) {
      f = h(b[d]);
      try {
        e.add(f)
      } catch (g) {
        throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)");
      }
    }
    e.select();
    n(a)
  }

  function t(a, b) {
    if (a.anchorNode && p.getDocument(a.anchorNode) !== p.getDocument(b))throw new z("WRONG_DOCUMENT_ERR");
  }

  function v(a) {
    var b = [], e = new A(a.anchorNode, a.anchorOffset),
      d = new A(a.focusNode, a.focusOffset), f = "function" == typeof a.getName ? a.getName() : "Selection";
    if ("undefined" != typeof a.rangeCount)for (var g = 0, h = a.rangeCount; g < h; ++g)b[g] = B.inspect(a.getRangeAt(g));
    return"[" + f + "(Ranges: " + b.join(", ") + ")(anchor: " + e.inspect() + ", focus: " + d.inspect() + "]"
  }

  d.requireModules(["DomUtil", "DomRange", "WrappedRange"]);
  d.config.checkSelectionRanges = !0;
  var p = d.dom, x = d.util, B = d.DomRange, C = d.WrappedRange, z = d.DOMException, A = p.DomPosition, u, w, y = d.util.isHostMethod(window, "getSelection"),
    J = d.util.isHostObject(document, "selection"), F = J && (!y || d.config.preferTextRange);
  F ? (u = b, d.isSelectionValid = function (a) {
    a = (a || window).document;
    var b = a.selection;
    return"None" != b.type || p.getDocument(b.createRange().parentElement()) == a
  }) : y ? (u = f, d.isSelectionValid = function () {
    return!0
  }) : a.fail("Neither document.selection or window.getSelection() detected.");
  d.getNativeSelection = u;
  var y = u(), H = d.createNativeRange(document), E = p.getBody(document), I = x.areHostObjects(y, x.areHostProperties(y, ["anchorOffset", "focusOffset"]));
  d.features.selectionHasAnchorAndFocus = I;
  var K = x.isHostMethod(y, "extend");
  d.features.selectionHasExtend = K;
  var N = "number" == typeof y.rangeCount;
  d.features.selectionHasRangeCount = N;
  var R = !1, S = !0;
  x.areHostMethods(y, ["addRange", "getRangeAt", "removeAllRanges"]) && "number" == typeof y.rangeCount && d.features.implementsDomRange && function () {
    var a = document.createElement("iframe");
    a.frameBorder = 0;
    a.style.position = "absolute";
    a.style.left = "-10000px";
    E.appendChild(a);
    var b = p.getIframeDocument(a);
    b.open();
    b.write("<html><head></head><body>12</body></html>");
    b.close();
    var e = p.getIframeWindow(a).getSelection(), d = b.documentElement.lastChild.firstChild, b = b.createRange();
    b.setStart(d, 1);
    b.collapse(!0);
    e.addRange(b);
    S = 1 == e.rangeCount;
    e.removeAllRanges();
    var f = b.cloneRange();
    b.setStart(d, 0);
    f.setEnd(d, 2);
    e.addRange(b);
    e.addRange(f);
    R = 2 == e.rangeCount;
    b.detach();
    f.detach();
    E.removeChild(a)
  }();
  d.features.selectionSupportsMultipleRanges = R;
  d.features.collapsedNonEditableSelectionsSupported = S;
  var L = !1, D;
  E && x.isHostMethod(E, "createControlRange") && (D = E.createControlRange(),
    x.areHostProperties(D, ["item", "add"]) && (L = !0));
  d.features.implementsControlRange = L;
  w = I ? function (a) {
    return a.anchorNode === a.focusNode && a.anchorOffset === a.focusOffset
  } : function (a) {
    return a.rangeCount ? a.getRangeAt(a.rangeCount - 1).collapsed : !1
  };
  var Y;
  x.isHostMethod(y, "getRangeAt") ? Y = function (a, b) {
    try {
      return a.getRangeAt(b)
    } catch (e) {
      return null
    }
  } : I && (Y = function (a) {
    var b = p.getDocument(a.anchorNode), b = d.createRange(b);
    b.setStart(a.anchorNode, a.anchorOffset);
    b.setEnd(a.focusNode, a.focusOffset);
    b.collapsed !==
      this.isCollapsed && (b.setStart(a.focusNode, a.focusOffset), b.setEnd(a.anchorNode, a.anchorOffset));
    return b
  });
  d.getSelection = function (a) {
    a = a || window;
    var e = a._rangySelection, d = u(a), f = J ? b(a) : null;
    e ? (e.nativeSelection = d, e.docSelection = f, e.refresh(a)) : (e = new s(d, f, a), a._rangySelection = e);
    return e
  };
  d.getIframeSelection = function (a) {
    return d.getSelection(p.getIframeWindow(a))
  };
  D = s.prototype;
  if (!F && I && x.areHostMethods(y, ["removeAllRanges", "addRange"])) {
    D.removeAllRanges = function () {
      this.nativeSelection.removeAllRanges();
      g(this)
    };
    var M = function (a, b) {
      var e = B.getRangeDocument(b), e = d.createRange(e);
      e.collapseToPoint(b.endContainer, b.endOffset);
      a.nativeSelection.addRange(k(e));
      a.nativeSelection.extend(b.startContainer, b.startOffset);
      a.refresh()
    };
    D.addRange = N ? function (a, b) {
      if (L && J && "Control" == this.docSelection.type)m(this, a); else if (b && K)M(this, a); else {
        var f;
        R ? f = this.rangeCount : (this.removeAllRanges(), f = 0);
        this.nativeSelection.addRange(k(a));
        this.rangeCount = this.nativeSelection.rangeCount;
        this.rangeCount == f + 1 ? (d.config.checkSelectionRanges &&
          (f = Y(this.nativeSelection, this.rangeCount - 1)) && !B.rangesEqual(f, a) && (a = new C(f)), this._ranges[this.rangeCount - 1] = a, e(this, a, Z(this.nativeSelection)), this.isCollapsed = w(this)) : this.refresh()
      }
    } : function (a, b) {
      b && K ? M(this, a) : (this.nativeSelection.addRange(k(a)), this.refresh())
    };
    D.setRanges = function (a) {
      if (L && 1 < a.length)r(this, a); else {
        this.removeAllRanges();
        for (var b = 0, e = a.length; b < e; ++b)this.addRange(a[b])
      }
    }
  } else if (x.isHostMethod(y, "empty") && x.isHostMethod(H, "select") && L && F)D.removeAllRanges = function () {
    try {
      if (this.docSelection.empty(),
        "None" != this.docSelection.type) {
        var a;
        if (this.anchorNode)a = p.getDocument(this.anchorNode); else if ("Control" == this.docSelection.type) {
          var b = this.docSelection.createRange();
          b.length && (a = p.getDocument(b.item(0)).body.createTextRange())
        }
        a && (a.body.createTextRange().select(), this.docSelection.empty())
      }
    } catch (e) {
    }
    g(this)
  }, D.addRange = function (a) {
    "Control" == this.docSelection.type ? m(this, a) : (C.rangeToTextRange(a).select(), this._ranges[0] = a, this.rangeCount = 1, this.isCollapsed = this._ranges[0].collapsed, e(this,
      a, !1))
  }, D.setRanges = function (a) {
    this.removeAllRanges();
    var b = a.length;
    1 < b ? r(this, a) : b && this.addRange(a[0])
  }; else return a.fail("No means of selecting a Range or TextRange was found"), !1;
  D.getRangeAt = function (a) {
    if (0 > a || a >= this.rangeCount)throw new z("INDEX_SIZE_ERR");
    return this._ranges[a]
  };
  var T;
  if (F)T = function (a) {
    var b;
    d.isSelectionValid(a.win) ? b = a.docSelection.createRange() : (b = p.getBody(a.win.document).createTextRange(), b.collapse(!0));
    "Control" == a.docSelection.type ? n(a) : b && "undefined" != typeof b.text ?
      l(a, b) : g(a)
  }; else if (x.isHostMethod(y, "getRangeAt") && "number" == typeof y.rangeCount)T = function (a) {
    if (L && J && "Control" == a.docSelection.type)n(a); else if (a._ranges.length = a.rangeCount = a.nativeSelection.rangeCount, a.rangeCount) {
      for (var b = 0, f = a.rangeCount; b < f; ++b)a._ranges[b] = new d.WrappedRange(a.nativeSelection.getRangeAt(b));
      e(a, a._ranges[a.rangeCount - 1], Z(a.nativeSelection));
      a.isCollapsed = w(a)
    } else g(a)
  }; else if (I && "boolean" == typeof y.isCollapsed && "boolean" == typeof H.collapsed && d.features.implementsDomRange)T =
    function (a) {
      var b;
      b = a.nativeSelection;
      b.anchorNode ? (b = Y(b, 0), a._ranges = [b], a.rangeCount = 1, b = a.nativeSelection, a.anchorNode = b.anchorNode, a.anchorOffset = b.anchorOffset, a.focusNode = b.focusNode, a.focusOffset = b.focusOffset, a.isCollapsed = w(a)) : g(a)
    }; else return a.fail("No means of obtaining a Range or TextRange from the user's selection was found"), !1;
  D.refresh = function (a) {
    var b = a ? this._ranges.slice(0) : null;
    T(this);
    if (a) {
      a = b.length;
      if (a != this._ranges.length)return!1;
      for (; a--;)if (!B.rangesEqual(b[a], this._ranges[a]))return!1;
      return!0
    }
  };
  var da = function (a, b) {
    var e = a.getAllRanges(), d = !1;
    a.removeAllRanges();
    for (var f = 0, h = e.length; f < h; ++f)d || b !== e[f] ? a.addRange(e[f]) : d = !0;
    a.rangeCount || g(a)
  };
  D.removeRange = L ? function (a) {
    if ("Control" == this.docSelection.type) {
      var b = this.docSelection.createRange();
      a = h(a);
      for (var e = p.getDocument(b.item(0)), e = p.getBody(e).createControlRange(), d, f = !1, g = 0, k = b.length; g < k; ++g)d = b.item(g), d !== a || f ? e.add(b.item(g)) : f = !0;
      e.select();
      n(this)
    } else da(this, a)
  } : function (a) {
    da(this, a)
  };
  var Z;
  !F && I && d.features.implementsDomRange ?
    (Z = function (a) {
      var b = !1;
      a.anchorNode && (b = 1 == p.comparePoints(a.anchorNode, a.anchorOffset, a.focusNode, a.focusOffset));
      return b
    }, D.isBackwards = function () {
      return Z(this)
    }) : Z = D.isBackwards = function () {
    return!1
  };
  D.toString = function () {
    for (var a = [], b = 0, e = this.rangeCount; b < e; ++b)a[b] = "" + this._ranges[b];
    return a.join("")
  };
  D.collapse = function (a, b) {
    t(this, a);
    var e = d.createRange(p.getDocument(a));
    e.collapseToPoint(a, b);
    this.removeAllRanges();
    this.addRange(e);
    this.isCollapsed = !0
  };
  D.collapseToStart = function () {
    if (this.rangeCount) {
      var a =
        this._ranges[0];
      this.collapse(a.startContainer, a.startOffset)
    } else throw new z("INVALID_STATE_ERR");
  };
  D.collapseToEnd = function () {
    if (this.rangeCount) {
      var a = this._ranges[this.rangeCount - 1];
      this.collapse(a.endContainer, a.endOffset)
    } else throw new z("INVALID_STATE_ERR");
  };
  D.selectAllChildren = function (a) {
    t(this, a);
    var b = d.createRange(p.getDocument(a));
    b.selectNodeContents(a);
    this.removeAllRanges();
    this.addRange(b)
  };
  D.deleteFromDocument = function () {
    if (L && J && "Control" == this.docSelection.type) {
      for (var a = this.docSelection.createRange(),
             b; a.length;)b = a.item(0), a.remove(b), b.parentNode.removeChild(b);
      this.refresh()
    } else if (this.rangeCount) {
      a = this.getAllRanges();
      this.removeAllRanges();
      b = 0;
      for (var e = a.length; b < e; ++b)a[b].deleteContents();
      this.addRange(a[e - 1])
    }
  };
  D.getAllRanges = function () {
    return this._ranges.slice(0)
  };
  D.setSingleRange = function (a) {
    this.setRanges([a])
  };
  D.containsNode = function (a, b) {
    for (var e = 0, d = this._ranges.length; e < d; ++e)if (this._ranges[e].containsNode(a, b))return!0;
    return!1
  };
  D.toHtml = function () {
    var a = "";
    if (this.rangeCount) {
      for (var a =
        B.getRangeDocument(this._ranges[0]).createElement("div"), b = 0, e = this._ranges.length; b < e; ++b)a.appendChild(this._ranges[b].cloneContents());
      a = a.innerHTML
    }
    return a
  };
  D.getName = function () {
    return"WrappedSelection"
  };
  D.inspect = function () {
    return v(this)
  };
  D.detach = function () {
    this.win = this.anchorNode = this.focusNode = this.win._rangySelection = null
  };
  s.inspect = v;
  d.Selection = s;
  d.selectionPrototype = D;
  d.addCreateMissingNativeApiListener(function (a) {
    "undefined" == typeof a.getSelection && (a.getSelection = function () {
      return d.getSelection(this)
    });
    a = null
  })
});
var Base = function () {
};
Base.extend = function (d, a) {
  var f = Base.prototype.extend;
  Base._prototyping = !0;
  var b = new this;
  f.call(b, d);
  b.base = function () {
  };
  delete Base._prototyping;
  var e = b.constructor, g = b.constructor = function () {
    if (!Base._prototyping)if (this._constructing || this.constructor == g)this._constructing = !0, e.apply(this, arguments), delete this._constructing; else if (null != arguments[0])return(arguments[0].extend || f).call(arguments[0], b)
  };
  g.ancestor = this;
  g.extend = this.extend;
  g.forEach = this.forEach;
  g.implement = this.implement;
  g.prototype =
    b;
  g.toString = this.toString;
  g.valueOf = function (a) {
    return"object" == a ? g : e.valueOf()
  };
  f.call(g, a);
  "function" == typeof g.init && g.init();
  return g
};
Base.prototype = {extend: function (d, a) {
  if (1 < arguments.length) {
    var f = this[d];
    if (f && "function" == typeof a && (!f.valueOf || f.valueOf() != a.valueOf()) && /\bbase\b/.test(a)) {
      var b = a.valueOf();
      a = function () {
        var a = this.base || Base.prototype.base;
        this.base = f;
        var e = b.apply(this, arguments);
        this.base = a;
        return e
      };
      a.valueOf = function (e) {
        return"object" == e ? a : b
      };
      a.toString = Base.toString
    }
    this[d] = a
  } else if (d) {
    var e = Base.prototype.extend;
    Base._prototyping || "function" == typeof this || (e = this.extend || e);
    for (var g = {toSource: null},
           k = ["constructor", "toString", "valueOf"], h = Base._prototyping ? 0 : 1; l = k[h++];)d[l] != g[l] && e.call(this, l, d[l]);
    for (var l in d)g[l] || e.call(this, l, d[l])
  }
  return this
}};
Base = Base.extend({constructor: function (d) {
  this.extend(d)
}}, {ancestor: Object, version: "1.1", forEach: function (d, a, f) {
  for (var b in d)void 0 === this.prototype[b] && a.call(f, d[b], b, d)
}, implement: function () {
  for (var d = 0; d < arguments.length; d++)if ("function" == typeof arguments[d])arguments[d](this.prototype); else this.prototype.extend(arguments[d]);
  return this
}, toString: function () {
  return String(this.valueOf())
}});
wysihtml5.browser = function () {
  var d = navigator.userAgent, a = document.createElement("div"), f = -1 !== d.indexOf("MSIE") && -1 === d.indexOf("Opera"), b = -1 !== d.indexOf("Gecko") && -1 === d.indexOf("KHTML"), e = -1 !== d.indexOf("AppleWebKit/"), g = -1 !== d.indexOf("Chrome/"), k = -1 !== d.indexOf("Opera/");
  return{USER_AGENT: d, supported: function () {
    var b = this.USER_AGENT.toLowerCase(), e = "contentEditable"in a, d = document.execCommand && document.queryCommandSupported && document.queryCommandState, f = document.querySelector && document.querySelectorAll,
      g;
    if (g = this.isIos())g = 5 > +(/ipad|iphone|ipod/.test(b) && b.match(/ os (\d+).+? like mac os x/) || [void 0, 0])[1];
    b = g || this.isAndroid() && 4 > +(b.match(/android (\d+)/) || [void 0, 0])[1] || -1 !== b.indexOf("opera mobi") || -1 !== b.indexOf("hpwos/");
    return e && d && f && !b
  }, isTouchDevice: function () {
    return this.supportsEvent("touchmove")
  }, isIos: function () {
    return/ipad|iphone|ipod/i.test(this.USER_AGENT)
  }, isAndroid: function () {
    return-1 !== this.USER_AGENT.indexOf("Android")
  }, supportsSandboxedIframes: function () {
    return f
  }, throwsMixedContentWarningWhenIframeSrcIsEmpty: function () {
    return!("querySelector"in
      document)
  }, displaysCaretInEmptyContentEditableCorrectly: function () {
    return f
  }, hasCurrentStyleProperty: function () {
    return"currentStyle"in a
  }, hasHistoryIssue: function () {
    return b && "Mac" === navigator.platform.substr(0, 3)
  }, insertsLineBreaksOnReturn: function () {
    return b
  }, supportsPlaceholderAttributeOn: function (a) {
    return"placeholder"in a
  }, supportsEvent: function (b) {
    var e;
    (e = "on" + b in a) || (a.setAttribute("on" + b, "return;"), e = "function" === typeof a["on" + b]);
    return e
  }, supportsEventsInIframeCorrectly: function () {
    return!k
  },
    supportsHTML5Tags: function (a) {
      a = a.createElement("div");
      a.innerHTML = "<article>foo</article>";
      return"<article>foo</article>" === a.innerHTML.toLowerCase()
    }, supportsCommand: function () {
      var a = {formatBlock: f, insertUnorderedList: f || e, insertOrderedList: f || e}, d = {insertHTML: b};
      return function (b, e) {
        if (!a[e]) {
          try {
            return b.queryCommandSupported(e)
          } catch (f) {
          }
          try {
            return b.queryCommandEnabled(e)
          } catch (g) {
            return!!d[e]
          }
        }
        return!1
      }
    }(), doesAutoLinkingInContentEditable: function () {
      return f
    }, canDisableAutoLinking: function () {
      return this.supportsCommand(document,
        "AutoUrlDetect")
    }, clearsContentEditableCorrectly: function () {
      return b || k || e
    }, supportsGetAttributeCorrectly: function () {
      return"1" != document.createElement("td").getAttribute("rowspan")
    }, canSelectImagesInContentEditable: function () {
      return b || f || k
    }, autoScrollsToCaret: function () {
      return!e
    }, autoClosesUnclosedTags: function () {
      var b = a.cloneNode(!1), e;
      b.innerHTML = "<p><div></div>";
      b = b.innerHTML.toLowerCase();
      e = "<p></p><div></div>" === b || "<p><div></div></p>" === b;
      this.autoClosesUnclosedTags = function () {
        return e
      };
      return e
    },
    supportsNativeGetElementsByClassName: function () {
      return-1 !== String(document.getElementsByClassName).indexOf("[native code]")
    }, supportsSelectionModify: function () {
      return"getSelection"in window && "modify"in window.getSelection()
    }, supportsSelectLine: function () {
      return this.supportsSelectionModify() || document.selection ? !0 : !1
    }, needsSpaceAfterLineBreak: function () {
      return k
    }, supportsSpeechApiOn: function (a) {
      return 11 <= (d.match(/Chrome\/(\d+)/) || [void 0, 0])[1] && ("onwebkitspeechchange"in a || "speech"in a)
    }, crashesWhenDefineProperty: function (a) {
      return f &&
        ("XMLHttpRequest" === a || "XDomainRequest" === a)
    }, doesAsyncFocus: function () {
      return f
    }, hasProblemsSettingCaretAfterImg: function () {
      return f
    }, hasUndoInContextMenu: function () {
      return b || g || k
    }, hasInsertNodeIssue: function () {
      return k
    }, hasIframeFocusIssue: function () {
      return f
    }, createsNestedInvalidMarkupAfterPaste: function () {
      return e
    }, supportsMutationEvents: function () {
      return"MutationEvent"in window
    }}
}();
wysihtml5.lang.array = function (d) {
  return{contains: function (a) {
    return-1 !== wysihtml5.lang.array(d).indexOf(a)
  }, indexOf: function (a) {
    if (d.indexOf)return d.indexOf(a);
    for (var f = 0, b = d.length; f < b; f++)if (d[f] === a)return f;
    return-1
  }, without: function (a) {
    a = wysihtml5.lang.array(a);
    for (var f = [], b = 0, e = d.length; b < e; b++)a.contains(d[b]) || f.push(d[b]);
    return f
  }, get: function () {
    for (var a = 0, f = d.length, b = []; a < f; a++)b.push(d[a]);
    return b
  }, map: function (a, f) {
    if (Array.prototype.map)return d.map(a, f);
    for (var b = d.length >>> 0,
           e = Array(b), g = 0; g < b; g++)e[g] = a.call(f, d[g], g, d);
    return e
  }}
};
wysihtml5.lang.Dispatcher = Base.extend({on: function (d, a) {
  this.events = this.events || {};
  this.events[d] = this.events[d] || [];
  this.events[d].push(a);
  return this
}, off: function (d, a) {
  this.events = this.events || {};
  var f = 0, b, e;
  if (d) {
    b = this.events[d] || [];
    for (e = []; f < b.length; f++)b[f] !== a && a && e.push(b[f]);
    this.events[d] = e
  } else this.events = {};
  return this
}, fire: function (d, a) {
  this.events = this.events || {};
  for (var f = this.events[d] || [], b = 0; b < f.length; b++)f[b].call(this, a);
  return this
}, observe: function () {
  return this.on.apply(this,
    arguments)
}, stopObserving: function () {
  return this.off.apply(this, arguments)
}});
wysihtml5.lang.object = function (d) {
  return{merge: function (a) {
    for (var f in a)d[f] = a[f];
    return this
  }, get: function () {
    return d
  }, clone: function () {
    var a = {}, f;
    for (f in d)a[f] = d[f];
    return a
  }, isArray: function () {
    return"[object Array]" === Object.prototype.toString.call(d)
  }}
};
(function () {
  var d = /^\s+/, a = /\s+$/, f = /[&<>"]/g, b = {"&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;"};
  wysihtml5.lang.string = function (e) {
    e = String(e);
    return{trim: function () {
      return e.replace(d, "").replace(a, "")
    }, interpolate: function (a) {
      for (var b in a)e = this.replace("#{"+b+"}").by(a[b]);
      return e
    }, replace: function (a) {
      return{by: function (b) {
        return e.split(a).join(b)
      }}
    }, escapeHTML: function () {
      return e.replace(f, function (a) {
        return b[a]
      })
    }}
  }
})();
(function (d) {
  function a(a) {
    return a.replace(e, function (a, b) {
      var e = (b.match(g) || [])[1] || "", d = h[e];
      b = b.replace(g, "");
      b.split(d).length > b.split(e).length && (b += e, e = "");
      var f = d = b;
      b.length > k && (f = f.substr(0, k) + "...");
      "www." === d.substr(0, 4) && (d = "http://" + d);
      return'<a href="' + d + '">' + f + "</a>" + e
    })
  }

  function f(g) {
    if (!b.contains(g.nodeName))if (g.nodeType === d.TEXT_NODE && g.data.match(e)) {
      var h = g.parentNode, k = d.lang.string(g.data).escapeHTML(), s;
      s = h.ownerDocument;
      var r = s._wysihtml5_tempElement;
      r || (r = s._wysihtml5_tempElement =
        s.createElement("div"));
      s = r;
      s.innerHTML = "<span></span>" + a(k);
      for (s.removeChild(s.firstChild); s.firstChild;)h.insertBefore(s.firstChild, g);
      h.removeChild(g)
    } else {
      h = d.lang.array(g.childNodes).get();
      k = h.length;
      for (s = 0; s < k; s++)f(h[s]);
      return g
    }
  }

  var b = d.lang.array("CODE PRE A SCRIPT HEAD TITLE STYLE".split(" ")), e = /((https?:\/\/|www\.)[^\s<]{3,})/gi, g = /([^\w\/\-](,?))$/i, k = 100, h = {")": "(", "]": "[", "}": "{"};
  d.dom.autoLink = function (a) {
    var e;
    a:{
      e = a;
      for (var d; e.parentNode;) {
        e = e.parentNode;
        d = e.nodeName;
        if (b.contains(d)) {
          e = !0;
          break a
        }
        if ("body" === d)break
      }
      e = !1
    }
    if (e)return a;
    a === a.ownerDocument.documentElement && (a = a.ownerDocument.body);
    return f(a)
  };
  d.dom.autoLink.URL_REG_EXP = e
})(wysihtml5);
(function (d) {
  var a = d.dom;
  a.addClass = function (d, b) {
    var e = d.classList;
    if (e)return e.add(b);
    a.hasClass(d, b) || (d.className += " " + b)
  };
  a.removeClass = function (a, b) {
    var e = a.classList;
    if (e)return e.remove(b);
    a.className = a.className.replace(RegExp("(^|\\s+)" + b + "(\\s+|$)"), " ")
  };
  a.hasClass = function (a, b) {
    var e = a.classList;
    if (e)return e.contains(b);
    e = a.className;
    return 0 < e.length && (e == b || RegExp("(^|\\s)" + b + "(\\s|$)").test(e))
  }
})(wysihtml5);
wysihtml5.dom.contains = function () {
  var d = document.documentElement;
  if (d.contains)return function (a, d) {
    d.nodeType !== wysihtml5.ELEMENT_NODE && (d = d.parentNode);
    return a !== d && a.contains(d)
  };
  if (d.compareDocumentPosition)return function (a, d) {
    return!!(a.compareDocumentPosition(d) & 16)
  }
}();
wysihtml5.dom.convertToList = function () {
  function d(a, d) {
    var b = a.createElement("li");
    d.appendChild(b);
    return b
  }

  return function (a, f, b) {
    if ("UL" === a.nodeName || "OL" === a.nodeName || "MENU" === a.nodeName)return a;
    var e = a.ownerDocument;
    f = e.createElement(f);
    var g = a.querySelectorAll("br"), k = g.length, h, l, n, m, s;
    for (s = 0; s < k; s++)for (l = g[s]; (h = l.parentNode) && h !== a && h.lastChild === l;) {
      if ("block" === wysihtml5.dom.getStyle("display").from(h)) {
        h.removeChild(l);
        break
      }
      wysihtml5.dom.insert(l).after(l.parentNode)
    }
    h = wysihtml5.lang.array(a.childNodes).get();
    g = h.length;
    for (s = 0; s < g; s++)m = m || d(e, f), k = h[s], l = "block" === wysihtml5.dom.getStyle("display").from(k), n = "BR" === k.nodeName, !l || b && wysihtml5.dom.hasClass(k, b) ? n ? m = m.firstChild ? null : m : m.appendChild(k) : (m = m.firstChild ? d(e, f) : m, m.appendChild(k), m = null);
    0 === h.length && d(e, f);
    a.parentNode.replaceChild(f, a);
    return f
  }
}();
wysihtml5.dom.copyAttributes = function (d) {
  return{from: function (a) {
    return{to: function (f) {
      for (var b, e = 0, g = d.length; e < g; e++)b = d[e], "undefined" !== typeof a[b] && "" !== a[b] && (f[b] = a[b]);
      return{andTo: arguments.callee}
    }}
  }}
};
(function (d) {
  var a = ["-webkit-box-sizing", "-moz-box-sizing", "-ms-box-sizing", "box-sizing"], f = function (b) {
    var e;
    a:{
      e = 0;
      for (var f = a.length; e < f; e++)if ("border-box" === d.getStyle(a[e]).from(b)) {
        e = a[e];
        break a
      }
      e = void 0
    }
    return e ? parseInt(d.getStyle("width").from(b), 10) < b.offsetWidth : !1
  };
  d.copyStyles = function (b) {
    return{from: function (e) {
      f(e) && (b = wysihtml5.lang.array(b).without(a));
      for (var g = "", k = b.length, h = 0, l; h < k; h++)l = b[h], g += l + ":" + d.getStyle(l).from(e) + ";";
      return{to: function (a) {
        d.setStyles(g).on(a);
        return{andTo: arguments.callee}
      }}
    }}
  }
})(wysihtml5.dom);
(function (d) {
  d.dom.delegate = function (a, f, b, e) {
    return d.dom.observe(a, b, function (b) {
      for (var k = b.target, h = d.lang.array(a.querySelectorAll(f)); k && k !== a;) {
        if (h.contains(k)) {
          e.call(k, b);
          break
        }
        k = k.parentNode
      }
    })
  }
})(wysihtml5);
wysihtml5.dom.getAsDom = function () {
  var d = "abbr article aside audio bdi canvas command datalist details figcaption figure footer header hgroup keygen mark meter nav output progress rp rt ruby svg section source summary time track video wbr".split(" ");
  return function (a, f) {
    f = f || document;
    var b;
    if ("object" === typeof a && a.nodeType)b = f.createElement("div"), b.appendChild(a); else if (wysihtml5.browser.supportsHTML5Tags(f))b = f.createElement("div"), b.innerHTML = a; else {
      b = f;
      if (!b._wysihtml5_supportsHTML5Tags) {
        for (var e =
          0, g = d.length; e < g; e++)b.createElement(d[e]);
        b._wysihtml5_supportsHTML5Tags = !0
      }
      b = f;
      e = b.createElement("div");
      e.style.display = "none";
      b.body.appendChild(e);
      try {
        e.innerHTML = a
      } catch (k) {
      }
      b.body.removeChild(e);
      b = e
    }
    return b
  }
}();
wysihtml5.dom.getParentElement = function () {
  function d(a, d) {
    return d && d.length ? "string" === typeof d ? a === d : wysihtml5.lang.array(d).contains(a) : !0
  }

  return function (a, f, b) {
    b = b || 50;
    if (f.className || f.classRegExp) {
      a:{
        var e = f.nodeName, g = f.className;
        for (f = f.classRegExp; b-- && a && "BODY" !== a.nodeName;) {
          var k;
          if (k = a.nodeType === wysihtml5.ELEMENT_NODE)if (k = d(a.nodeName, e)) {
            k = g;
            var h = (a.className || "").match(f) || [];
            k = k ? h[h.length - 1] === k : !!h.length
          }
          if (k)break a;
          a = a.parentNode
        }
        a = null
      }
      return a
    }
    a:{
      e = f.nodeName;
      for (g = b; g-- &&
        a && "BODY" !== a.nodeName;) {
        if (d(a.nodeName, e))break a;
        a = a.parentNode
      }
      a = null
    }
    return a
  }
}();
wysihtml5.dom.getStyle = function () {
  function d(a) {
    return a.replace(f, function (a) {
      return a.charAt(1).toUpperCase()
    })
  }

  var a = {"float": "styleFloat"in document.createElement("div").style ? "styleFloat" : "cssFloat"}, f = /\-[a-z]/g;
  return function (b) {
    return{from: function (e) {
      if (e.nodeType === wysihtml5.ELEMENT_NODE) {
        var f = e.ownerDocument, k = a[b] || d(b), h = e.style, l = e.currentStyle, n = h[k];
        if (n)return n;
        if (l)try {
          return l[k]
        } catch (m) {
        }
        var k = f.defaultView || f.parentWindow, f = ("height" === b || "width" === b) && "TEXTAREA" === e.nodeName,
          s;
        if (k.getComputedStyle)return f && (s = h.overflow, h.overflow = "hidden"), e = k.getComputedStyle(e, null).getPropertyValue(b), f && (h.overflow = s || ""), e
      }
    }}
  }
}();
wysihtml5.dom.hasElementWithTagName = function () {
  var d = {}, a = 1;
  return function (f, b) {
    var e = (f._wysihtml5_identifier || (f._wysihtml5_identifier = a++)) + ":" + b, g = d[e];
    g || (g = d[e] = f.getElementsByTagName(b));
    return 0 < g.length
  }
}();
(function (d) {
  var a = {}, f = 1;
  d.dom.hasElementWithClassName = function (b, e) {
    if (!d.browser.supportsNativeGetElementsByClassName())return!!b.querySelector("." + e);
    var g = (b._wysihtml5_identifier || (b._wysihtml5_identifier = f++)) + ":" + e, k = a[g];
    k || (k = a[g] = b.getElementsByClassName(e));
    return 0 < k.length
  }
})(wysihtml5);
wysihtml5.dom.insert = function (d) {
  return{after: function (a) {
    a.parentNode.insertBefore(d, a.nextSibling)
  }, before: function (a) {
    a.parentNode.insertBefore(d, a)
  }, into: function (a) {
    a.appendChild(d)
  }}
};
wysihtml5.dom.insertCSS = function (d) {
  d = d.join("\n");
  return{into: function (a) {
    var f = a.createElement("style");
    f.type = "text/css";
    f.styleSheet ? f.styleSheet.cssText = d : f.appendChild(a.createTextNode(d));
    var b = a.querySelector("head link");
    b ? b.parentNode.insertBefore(f, b) : (a = a.querySelector("head")) && a.appendChild(f)
  }}
};
wysihtml5.dom.observe = function (d, a, f) {
  a = "string" === typeof a ? [a] : a;
  for (var b, e, g = 0, k = a.length; g < k; g++)e = a[g], d.addEventListener ? d.addEventListener(e, f, !1) : (b = function (a) {
    "target"in a || (a.target = a.srcElement);
    a.preventDefault = a.preventDefault || function () {
      this.returnValue = !1
    };
    a.stopPropagation = a.stopPropagation || function () {
      this.cancelBubble = !0
    };
    f.call(d, a)
  }, d.attachEvent("on" + e, b));
  return{stop: function () {
    for (var e, g = 0, k = a.length; g < k; g++)e = a[g], d.removeEventListener ? d.removeEventListener(e, f, !1) : d.detachEvent("on" +
      e, b)
  }}
};
wysihtml5.dom.parse = function () {
  function d(a, f) {
    var g = a.nodeType, h = a.childNodes, k = h.length, m = b[g], r = 0, n;
    if (l && 1 === g && wysihtml5.dom.hasClass(a, l))return a;
    m = m && m(a);
    if (!m) {
      if (!1 === m) {
        g = a.ownerDocument.createDocumentFragment();
        for (r = k; r--;)(n = d(h[r], f)) && g.insertBefore(n, g.firstChild);
        wysihtml5.lang.array("div pre p table td th ul ol li dd dl footer header section h1 h2 h3 h4 h5 h6".split(" ")).contains(a.nodeName.toLowerCase()) && a.parentNode.lastChild !== a && (a.nextSibling && 3 === a.nextSibling.nodeType && /^\s/.test(a.nextSibling.nodeValue) ||
          g.appendChild(a.ownerDocument.createTextNode(" ")));
        g.normalize && g.normalize();
        return g
      }
      return null
    }
    for (r = 0; r < k; r++)(n = d(h[r], f)) && m.appendChild(n);
    if (f && m.nodeName.toLowerCase() === e && (!m.childNodes.length || /^\s*$/gi.test(m.innerHTML) && "_wysihtml5-temp-placeholder" !== a.className || !m.attributes.length)) {
      for (g = m.ownerDocument.createDocumentFragment(); m.firstChild;)g.appendChild(m.firstChild);
      g.normalize && g.normalize();
      return g
    }
    m.normalize && m.normalize();
    return m
  }

  function a(a, b) {
    var e = a.getAttribute("class"),
      d = a.getAttribute("style"), h, k, l;
    if (e && b.classes) {
      e = e.replace(/^\s+/g, "").replace(/\s+$/g, "").split(g);
      h = e.length;
      for (var m = 0; m < h; m++)if (b.classes[e[m]])return!0
    }
    if (d && b.styles)for (k in d = d.split(";"), b.styles)if (b.styles.hasOwnProperty(k))for (h = d.length; h--;)if (e = d[h].split(":"), e[0].replace(/\s/g, "").toLowerCase() === k && (!0 === b.styles[k] || e[1].replace(/\s/g, "").toLowerCase() === b.styles[k]))return!0;
    if (b.attrs)for (l in b.attrs)if (b.attrs.hasOwnProperty(l) && (d = f(a, l), "string" === typeof d && -1 < d.search(b.attrs[l])))return!0;
    return!1
  }

  function f(a, b) {
    b = b.toLowerCase();
    var e;
    if (e = "IMG" == a.nodeName)if (e = "src" == b) {
      var d;
      a:{
        try {
          d = a.complete && !a.mozMatchesSelector(":-moz-broken");
          break a
        } catch (f) {
          if (a.complete && "complete" === a.readyState) {
            d = !0;
            break a
          }
        }
        d = void 0
      }
      e = !0 === d
    }
    return e ? a.src : n && "outerHTML"in a ? -1 != a.outerHTML.toLowerCase().indexOf(" " + b + "=") ? a.getAttribute(b) : null : a.getAttribute(b)
  }

  var b = {1: function (b) {
      var d, k;
      d = h.tags;
      k = b.nodeName.toLowerCase();
      var l = b.scopeName;
      if (b._wysihtml5)return null;
      b._wysihtml5 = 1;
      if ("wysihtml5-temp" ===
        b.className)return null;
      l && "HTML" != l && (k = l + ":" + k);
      "outerHTML"in b && (wysihtml5.browser.autoClosesUnclosedTags() || "P" !== b.nodeName || "</p>" === b.outerHTML.slice(-4).toLowerCase() || (k = "div"));
      if (k in d) {
        d = d[k];
        if (!d || d.remove)return null;
        if (d.unwrap)return!1;
        if (l = d.one_of_type) {
          var m;
          a:{
            var l = h, n = d.one_of_type, z;
            if ("SPAN" === b.nodeName && "_wysihtml5-temp-placeholder" === b.className)m = !0; else {
              for (m in n)if (n.hasOwnProperty(m) && l.type_definitions && l.type_definitions[m] && (z = l.type_definitions[m], a(b, z))) {
                m = !0;
                break a
              }
              m = !1
            }
          }
          l = !m
        }
        if (l)return d.remove_action && "unwrap" == d.remove_action ? !1 : null;
        d = "string" === typeof d ? {rename_tag: d} : d
      } else if (b.firstChild)d = {rename_tag: e}; else return null;
      k = b.ownerDocument.createElement(d.rename_tag || k);
      m = {};
      var A = d.set_class, u = d.add_class, w = d.set_attributes, y = d.check_attributes;
      z = h.classes;
      var J = 0, F = [], l = [], n = [], H = [], E;
      w && (m = wysihtml5.lang.object(w).clone());
      if (y)for (E in y)if (w = s[y[E]])if ((oldAttribute = f(b, E)) || "alt" === E && "IMG" == b.nodeName)w = w(oldAttribute), "string" === typeof w &&
        (m[E] = w);
      A && F.push(A);
      if (u)for (E in u)if (w = r[u[E]])A = w(f(b, E)), "string" === typeof A && F.push(A);
      z["_wysihtml5-temp-placeholder"] = 1;
      (H = b.getAttribute("class")) && (F = F.concat(H.split(g)));
      for (A = F.length; J < A; J++)u = F[J], z[u] && l.push(u);
      for (z = l.length; z--;)u = l[z], wysihtml5.lang.array(n).contains(u) || n.unshift(u);
      n.length && (m["class"] = n.join(" "));
      for (E in m)try {
        k.setAttribute(E, m[E])
      } catch (I) {
      }
      m.src && ("undefined" !== typeof m.width && k.setAttribute("width", m.width), "undefined" !== typeof m.height && k.setAttribute("height",
        m.height));
      E = d;
      var K;
      if (E && E.keep_styles)for (K in E.keep_styles)E.keep_styles.hasOwnProperty(K) && ("float" == K ? (b.style.styleFloat && (k.style.styleFloat = b.style.styleFloat), b.style.cssFloat && (k.style.cssFloat = b.style.cssFloat)) : b.style[K] && (k.style[K] = b.style[K]));
      k.normalize && k.normalize();
      return k
    }, 3: function (a) {
      var b = a.nextSibling;
      if (b && b.nodeType === wysihtml5.TEXT_NODE)b.data = a.data + b.data; else return b = a.data.replace(m, ""), a.ownerDocument.createTextNode(b)
    }}, e = "span", g = /\s+/, k = {tags: {}, classes: {}},
    h = {}, l = !1, n = !wysihtml5.browser.supportsGetAttributeCorrectly(), m = /\uFEFF/g, s = {url: function () {
      var a = /^https?:\/\//i;
      return function (b) {
        return b && b.match(a) ? b.replace(a, function (a) {
          return a.toLowerCase()
        }) : null
      }
    }(), src: function () {
      var a = /^(\/|https?:\/\/)/i;
      return function (b) {
        return b && b.match(a) ? b.replace(a, function (a) {
          return a.toLowerCase()
        }) : null
      }
    }(), href: function () {
      var a = /^(\/|https?:\/\/|mailto:)/i;
      return function (b) {
        return b && b.match(a) ? b.replace(a, function (a) {
          return a.toLowerCase()
        }) : null
      }
    }(),
      alt: function () {
        var a = /[^ a-z0-9_\-]/gi;
        return function (b) {
          return b ? b.replace(a, "") : ""
        }
      }(), numbers: function () {
        var a = /\D/g;
        return function (b) {
          return(b = (b || "").replace(a, "")) || null
        }
      }(), any: function () {
        return function (a) {
          return a
        }
      }()}, r = {align_img: function () {
      var a = {left: "wysiwyg-float-left", right: "wysiwyg-float-right"};
      return function (b) {
        return a[String(b).toLowerCase()]
      }
    }(), align_text: function () {
      var a = {left: "wysiwyg-text-align-left", right: "wysiwyg-text-align-right", center: "wysiwyg-text-align-center",
        justify: "wysiwyg-text-align-justify"};
      return function (b) {
        return a[String(b).toLowerCase()]
      }
    }(), clear_br: function () {
      var a = {left: "wysiwyg-clear-left", right: "wysiwyg-clear-right", both: "wysiwyg-clear-both", all: "wysiwyg-clear-both"};
      return function (b) {
        return a[String(b).toLowerCase()]
      }
    }(), size_font: function () {
      var a = {1: "wysiwyg-font-size-xx-small", 2: "wysiwyg-font-size-small", 3: "wysiwyg-font-size-medium", 4: "wysiwyg-font-size-large", 5: "wysiwyg-font-size-x-large", 6: "wysiwyg-font-size-xx-large", 7: "wysiwyg-font-size-xx-large",
        "-": "wysiwyg-font-size-smaller", "+": "wysiwyg-font-size-larger"};
      return function (b) {
        return a[String(b).charAt(0)]
      }
    }()};
  return function (a, b) {
    wysihtml5.lang.object(h).merge(k).merge(b.rules).get();
    var e = b.context || a.ownerDocument || document, f = e.createDocumentFragment(), g = "string" === typeof a, m, r;
    b.uneditableClass && (l = b.uneditableClass);
    for (e = g ? wysihtml5.dom.getAsDom(a, e) : a; e.firstChild;)r = e.firstChild, m = d(r, b.cleanUp), e.removeChild(r), m && f.appendChild(m);
    e.innerHTML = "";
    e.appendChild(f);
    return g ? wysihtml5.quirks.getCorrectInnerHTML(e) :
      e
  }
}();
wysihtml5.dom.removeEmptyTextNodes = function (d) {
  for (var a = wysihtml5.lang.array(d.childNodes).get(), f = a.length, b = 0; b < f; b++)d = a[b], d.nodeType === wysihtml5.TEXT_NODE && "" === d.data && d.parentNode.removeChild(d)
};
wysihtml5.dom.renameElement = function (d, a) {
  for (var f = d.ownerDocument.createElement(a), b; b = d.firstChild;)f.appendChild(b);
  wysihtml5.dom.copyAttributes(["align", "className"]).from(d).to(f);
  d.parentNode.replaceChild(f, d);
  return f
};
wysihtml5.dom.replaceWithChildNodes = function (d) {
  if (d.parentNode)if (d.firstChild) {
    for (var a = d.ownerDocument.createDocumentFragment(); d.firstChild;)a.appendChild(d.firstChild);
    d.parentNode.replaceChild(a, d)
  } else d.parentNode.removeChild(d)
};
(function (d) {
  function a(a) {
    return"block" === d.getStyle("display").from(a)
  }

  function f(a) {
    var e = a.ownerDocument.createElement("br");
    a.appendChild(e)
  }

  d.resolveList = function (b, e) {
    if (b.nodeName.match(/^(MENU|UL|OL)$/)) {
      var d = b.ownerDocument, k = d.createDocumentFragment(), h = b.previousElementSibling || b.previousSibling, l, n;
      if (e)for (h && !a(h) && "BR" !== h.nodeName && f(k); n = b.firstElementChild || b.firstChild;) {
        for (d = n.lastChild; h = n.firstChild;)l = (l = h === d) && !a(h) && "BR" !== h.nodeName, k.appendChild(h), l && f(k);
        n.parentNode.removeChild(n)
      } else for (; n =
                      b.firstElementChild || b.firstChild;) {
        if (n.querySelector && n.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6"))for (; h = n.firstChild;)k.appendChild(h); else {
          for (l = d.createElement("p"); h = n.firstChild;)l.appendChild(h);
          k.appendChild(l)
        }
        n.parentNode.removeChild(n)
      }
      b.parentNode.replaceChild(k, b)
    }
  }
})(wysihtml5.dom);
(function (d) {
  var a = document, f = "parent top opener frameElement frames localStorage globalStorage sessionStorage indexedDB".split(" "), b = "open close openDialog showModalDialog alert confirm prompt openDatabase postMessage XMLHttpRequest XDomainRequest".split(" "), e = ["referrer", "write", "open", "close"];
  d.dom.Sandbox = Base.extend({constructor: function (a, b) {
    this.callback = a || d.EMPTY_FUNCTION;
    this.config = d.lang.object({}).merge(b).get();
    this.editableArea = this._createIframe()
  }, insertInto: function (b) {
    "string" === typeof b && (b = a.getElementById(b));
    b.appendChild(this.editableArea)
  }, getIframe: function () {
    return this.editableArea
  }, getWindow: function () {
    this._readyError()
  }, getDocument: function () {
    this._readyError()
  }, destroy: function () {
    var a = this.getIframe();
    a.parentNode.removeChild(a)
  }, _readyError: function () {
    throw Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet");
  }, _createIframe: function () {
    var b = this, e = a.createElement("iframe");
    e.className = "wysihtml5-sandbox";
    d.dom.setAttributes({security: "restricted", allowtransparency: "true",
      frameborder: 0, width: 0, height: 0, marginwidth: 0, marginheight: 0}).on(e);
    d.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty() && (e.src = "javascript:'<html></html>'");
    e.onload = function () {
      e.onreadystatechange = e.onload = null;
      b._onLoadIframe(e)
    };
    e.onreadystatechange = function () {
      /loaded|complete/.test(e.readyState) && (e.onreadystatechange = e.onload = null, b._onLoadIframe(e))
    };
    return e
  }, _onLoadIframe: function (g) {
    if (d.dom.contains(a.documentElement, g)) {
      var k = this, h = g.contentWindow, l = g.contentWindow.document, n = this._getHtml({charset: a.characterSet ||
        a.charset || "utf-8", stylesheets: this.config.stylesheets});
      l.open("text/html", "replace");
      l.write(n);
      l.close();
      this.getWindow = function () {
        return g.contentWindow
      };
      this.getDocument = function () {
        return g.contentWindow.document
      };
      h.onerror = function (a, b, e) {
        throw Error("wysihtml5.Sandbox: " + a, b, e);
      };
      if (!d.browser.supportsSandboxedIframes()) {
        var m, n = 0;
        for (m = f.length; n < m; n++)this._unset(h, f[n]);
        n = 0;
        for (m = b.length; n < m; n++)this._unset(h, b[n], d.EMPTY_FUNCTION);
        n = 0;
        for (m = e.length; n < m; n++)this._unset(l, e[n]);
        this._unset(l,
          "cookie", "", !0)
      }
      this.loaded = !0;
      setTimeout(function () {
        k.callback(k)
      }, 0)
    }
  }, _getHtml: function (a) {
    var b = a.stylesheets, e = "", f = 0, n;
    if (b = "string" === typeof b ? [b] : b)for (n = b.length; f < n; f++)e += '<link rel="stylesheet" href="' + b[f] + '">';
    a.stylesheets = e;
    return d.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(a)
  }, _unset: function (a, b, e, f) {
    try {
      a[b] = e
    } catch (n) {
    }
    try {
      a.__defineGetter__(b, function () {
        return e
      })
    } catch (m) {
    }
    if (f)try {
      a.__defineSetter__(b,
        function () {
        })
    } catch (s) {
    }
    if (!d.browser.crashesWhenDefineProperty(b))try {
      var r = {get: function () {
        return e
      }};
      f && (r.set = function () {
      });
      Object.defineProperty(a, b, r)
    } catch (t) {
    }
  }})
})(wysihtml5);
(function (d) {
  var a = document;
  d.dom.ContentEditableArea = Base.extend({getContentEditable: function () {
    return this.element
  }, getWindow: function () {
    return this.element.ownerDocument.defaultView
  }, getDocument: function () {
    return this.element.ownerDocument
  }, constructor: function (a, b, e) {
    this.callback = a || d.EMPTY_FUNCTION;
    this.config = d.lang.object({}).merge(b).get();
    this.element = e ? this._bindElement(e) : this._createElement()
  }, _createElement: function () {
    var d = a.createElement("div");
    d.className = "wysihtml5-sandbox";
    this._loadElement(d);
    return d
  }, _bindElement: function (a) {
    a.className = a.className && "" != a.className ? a.className + " wysihtml5-sandbox" : "wysihtml5-sandbox";
    this._loadElement(a, !0);
    return a
  }, _loadElement: function (a, b) {
    var e = this;
    if (!b) {
      var d = this._getHtml();
      a.innerHTML = d
    }
    this.getWindow = function () {
      return a.ownerDocument.defaultView
    };
    this.getDocument = function () {
      return a.ownerDocument
    };
    this.loaded = !0;
    setTimeout(function () {
      e.callback(e)
    }, 0)
  }, _getHtml: function (a) {
    return""
  }})
})(wysihtml5);
(function () {
  var d = {className: "class"};
  wysihtml5.dom.setAttributes = function (a) {
    return{on: function (f) {
      for (var b in a)f.setAttribute(d[b] || b, a[b])
    }}
  }
})();
wysihtml5.dom.setStyles = function (d) {
  return{on: function (a) {
    a = a.style;
    if ("string" === typeof d)a.cssText += ";" + d; else for (var f in d)"float" === f ? (a.cssFloat = d[f], a.styleFloat = d[f]) : a[f] = d[f]
  }}
};
(function (d) {
  d.simulatePlaceholder = function (a, f, b) {
    var e = function () {
      f.hasPlaceholderSet() && f.clear();
      f.placeholderSet = !1;
      d.removeClass(f.element, "placeholder")
    }, g = function () {
      f.isEmpty() && (f.placeholderSet = !0, f.setValue(b), d.addClass(f.element, "placeholder"))
    };
    a.on("set_placeholder", g).on("unset_placeholder", e).on("focus:composer", e).on("paste:composer", e).on("blur:composer", g);
    g()
  }
})(wysihtml5.dom);
(function (d) {
  var a = document.documentElement;
  "textContent"in a ? (d.setTextContent = function (a, b) {
    a.textContent = b
  }, d.getTextContent = function (a) {
    return a.textContent
  }) : "innerText"in a ? (d.setTextContent = function (a, b) {
    a.innerText = b
  }, d.getTextContent = function (a) {
    return a.innerText
  }) : (d.setTextContent = function (a, b) {
    a.nodeValue = b
  }, d.getTextContent = function (a) {
    return a.nodeValue
  })
})(wysihtml5.dom);
wysihtml5.dom.getAttribute = function (d, a) {
  var f = !wysihtml5.browser.supportsGetAttributeCorrectly();
  a = a.toLowerCase();
  return"IMG" == d.nodeName && "src" == a && !0 === _isLoadedImage(d) ? d.src : f && "outerHTML"in d ? -1 != d.outerHTML.toLowerCase().indexOf(" " + a + "=") ? d.getAttribute(a) : null : d.getAttribute(a)
};
(function (d) {
  function a(a, b) {
    for (var e = [], d, f = 0, g = a.length; f < g; f++)if (d = a[f].querySelectorAll(b))for (var k = d.length; k--; e.unshift(d[k]));
    return e
  }

  function f(a) {
    a.parentNode.removeChild(a)
  }

  function b(a, b) {
    a.parentNode.insertBefore(b, a.nextSibling)
  }

  var e = d.dom, g = function (a) {
    this.el = a;
    this.isRowspan = this.isColspan = !1;
    this.isReal = this.lastRow = this.firstRow = this.lastCol = this.firstCol = !0;
    this.spanCollection = [];
    this.modified = !1
  }, k = function (a, b) {
    a ? (this.cell = a, this.table = e.getParentElement(a, {nodeName: ["TABLE"]})) :
      b && (this.table = b, this.cell = this.table.querySelectorAll("th, td")[0])
  };
  k.prototype = {addSpannedCellToMap: function (a, b, e, d, f, k) {
    for (var t = [], v = e + (k ? parseInt(k, 10) - 1 : 0), p = d + (f ? parseInt(f, 10) - 1 : 0), x = e; x <= v; x++) {
      "undefined" == typeof b[x] && (b[x] = []);
      for (var B = d; B <= p; B++)b[x][B] = new g(a), b[x][B].isColspan = f && 1 < parseInt(f, 10), b[x][B].isRowspan = k && 1 < parseInt(k, 10), b[x][B].firstCol = B == d, b[x][B].lastCol = B == p, b[x][B].firstRow = x == e, b[x][B].lastRow = x == v, b[x][B].isReal = B == d && x == e, b[x][B].spanCollection = t, t.push(b[x][B])
    }
  },
    setCellAsModified: function (a) {
      a.modified = !0;
      if (0 < a.spanCollection.length)for (var b = 0, e = a.spanCollection.length; b < e; b++)a.spanCollection[b].modified = !0
    }, setTableMap: function () {
      var a = [], b = this.getTableRows(), d, f, k, r, t, v, p;
      for (d = 0; d < b.length; d++)for (f = b[d], f = this.getRowCells(f), t = 0, "undefined" == typeof a[d] && (a[d] = []), k = 0; k < f.length; k++) {
        for (r = f[k]; "undefined" != typeof a[d][t];)t++;
        v = e.getAttribute(r, "colspan");
        p = e.getAttribute(r, "rowspan");
        v || p ? (this.addSpannedCellToMap(r, a, d, t, v, p), t += v ? parseInt(v, 10) :
          1) : (a[d][t] = new g(r), t++)
      }
      return this.map = a
    }, getRowCells: function (b) {
      var e = this.table.querySelectorAll("table"), e = e ? a(e, "th, td") : [];
      b = b.querySelectorAll("th, td");
      return 0 < e.length ? d.lang.array(b).without(e) : b
    }, getTableRows: function () {
      var b = this.table.querySelectorAll("table"), b = b ? a(b, "tr") : [], e = this.table.querySelectorAll("tr");
      return 0 < b.length ? d.lang.array(e).without(b) : e
    }, getMapIndex: function (a) {
      for (var b = this.map.length, e = this.map && this.map[0] ? this.map[0].length : 0, d = 0; d < b; d++)for (var f = 0; f <
        e; f++)if (this.map[d][f].el === a)return{row: d, col: f};
      return!1
    }, getElementAtIndex: function (a) {
      this.setTableMap();
      return this.map[a.row] && this.map[a.row][a.col] && this.map[a.row][a.col].el ? this.map[a.row][a.col].el : null
    }, getMapElsTo: function (a) {
      var b = [];
      this.setTableMap();
      this.idx_start = this.getMapIndex(this.cell);
      this.idx_end = this.getMapIndex(a);
      if (this.idx_start.row > this.idx_end.row || this.idx_start.row == this.idx_end.row && this.idx_start.col > this.idx_end.col)a = this.idx_start, this.idx_start = this.idx_end,
        this.idx_end = a;
      this.idx_start.col > this.idx_end.col && (a = this.idx_start.col, this.idx_start.col = this.idx_end.col, this.idx_end.col = a);
      if (null != this.idx_start && null != this.idx_end) {
        a = this.idx_start.row;
        for (var e = this.idx_end.row; a <= e; a++)for (var d = this.idx_start.col, f = this.idx_end.col; d <= f; d++)b.push(this.map[a][d].el)
      }
      return b
    }, orderSelectionEnds: function (a) {
      this.setTableMap();
      this.idx_start = this.getMapIndex(this.cell);
      this.idx_end = this.getMapIndex(a);
      if (this.idx_start.row > this.idx_end.row || this.idx_start.row ==
        this.idx_end.row && this.idx_start.col > this.idx_end.col)a = this.idx_start, this.idx_start = this.idx_end, this.idx_end = a;
      this.idx_start.col > this.idx_end.col && (a = this.idx_start.col, this.idx_start.col = this.idx_end.col, this.idx_end.col = a);
      return{start: this.map[this.idx_start.row][this.idx_start.col].el, end: this.map[this.idx_end.row][this.idx_end.col].el}
    }, createCells: function (a, b, e) {
      for (var d = this.table.ownerDocument, f = d.createDocumentFragment(), g, k = 0; k < b; k++) {
        g = d.createElement(a);
        if (e)for (var v in e)e.hasOwnProperty(v) &&
        g.setAttribute(v, e[v]);
        g.appendChild(document.createTextNode(""));
        f.appendChild(g)
      }
      return f
    }, correctColIndexForUnreals: function (a, b) {
      for (var e = this.map[b], d = -1, f = 0; f < a; f++)e[f].isReal && d++;
      return d
    }, getLastNewCellOnRow: function (a, b) {
      for (var e = this.getRowCells(a), d, f, g = 0, k = e.length; g < k; g++)if (d = e[g], f = this.getMapIndex(d), !1 === f || "undefined" != typeof b && f.row != b)return d;
      return null
    }, removeEmptyTable: function () {
      var a = this.table.querySelectorAll("td, th");
      if (a && 0 != a.length)return!1;
      f(this.table);
      return!0
    },
    splitRowToCells: function (a) {
      if (a.isColspan) {
        var d = parseInt(e.getAttribute(a.el, "colspan") || 1, 10), f = a.el.tagName.toLowerCase();
        1 < d && (d = this.createCells(f, d - 1), b(a.el, d));
        a.el.removeAttribute("colspan")
      }
    }, getRealRowEl: function (a, b) {
      var d = null, f = null;
      b = b || this.idx;
      for (var g = 0, k = this.map[b.row].length; g < k; g++)if (f = this.map[b.row][g], f.isReal && (d = e.getParentElement(f.el, {nodeName: ["TR"]})))return d;
      null === d && a && (d = e.getParentElement(this.map[b.row][b.col].el, {nodeName: ["TR"]}) || null);
      return d
    }, injectRowAt: function (a, d, f, g, k) {
      var r = this.getRealRowEl(!1, {row: a, col: d});
      f = this.createCells(g, f);
      r ? (k = this.correctColIndexForUnreals(d, a), 0 <= k ? b(this.getRowCells(r)[k], f) : r.insertBefore(f, r.firstChild)) : (r = this.table.ownerDocument.createElement("tr"), r.appendChild(f), b(e.getParentElement(k.el, {nodeName: ["TR"]}), r))
    }, canMerge: function (a) {
      this.to = a;
      this.setTableMap();
      this.idx_start = this.getMapIndex(this.cell);
      this.idx_end = this.getMapIndex(this.to);
      if (this.idx_start.row > this.idx_end.row || this.idx_start.row == this.idx_end.row &&
        this.idx_start.col > this.idx_end.col)a = this.idx_start, this.idx_start = this.idx_end, this.idx_end = a;
      this.idx_start.col > this.idx_end.col && (a = this.idx_start.col, this.idx_start.col = this.idx_end.col, this.idx_end.col = a);
      a = this.idx_start.row;
      for (var b = this.idx_end.row; a <= b; a++)for (var e = this.idx_start.col, d = this.idx_end.col; e <= d; e++)if (this.map[a][e].isColspan || this.map[a][e].isRowspan)return!1;
      return!0
    }, decreaseCellSpan: function (a, b) {
      var d = parseInt(e.getAttribute(a.el, b), 10) - 1;
      1 <= d ? a.el.setAttribute(b, d) :
        (a.el.removeAttribute(b), "colspan" == b && (a.isColspan = !1), "rowspan" == b && (a.isRowspan = !1), a.firstCol = !0, a.lastCol = !0, a.firstRow = !0, a.lastRow = !0, a.isReal = !0)
    }, removeSurplusLines: function () {
      var a, b, d, g, k, r, t;
      this.setTableMap();
      if (this.map) {
        d = 0;
        for (g = this.map.length; d < g; d++) {
          a = this.map[d];
          t = !0;
          k = 0;
          for (r = a.length; k < r; k++)if (b = a[k], !(e.getAttribute(b.el, "rowspan") && 1 < parseInt(e.getAttribute(b.el, "rowspan"), 10) && !0 !== b.firstRow)) {
            t = !1;
            break
          }
          if (t)for (k = 0; k < r; k++)this.decreaseCellSpan(a[k], "rowspan")
        }
        b = this.getTableRows();
        d = 0;
        for (g = b.length; d < g; d++)a = b[d], 0 == a.childNodes.length && /^\s*$/.test(a.textContent || a.innerText) && f(a)
      }
    }, fillMissingCells: function () {
      var a = 0, e = 0, d = null;
      this.setTableMap();
      if (this.map) {
        a = this.map.length;
        for (d = 0; d < a; d++)this.map[d].length > e && (e = this.map[d].length);
        for (var f = 0; f < a; f++)for (var k = 0; k < e; k++)this.map[f] && !this.map[f][k] && 0 < k && (this.map[f][k] = new g(this.createCells("td", 1)), (d = this.map[f][k - 1]) && d.el && d.el.parent && b(this.map[f][k - 1].el, this.map[f][k].el))
      }
    }, rectify: function () {
      if (this.removeEmptyTable())return!1;
      this.removeSurplusLines();
      this.fillMissingCells();
      return!0
    }, unmerge: function () {
      if (this.rectify() && (this.setTableMap(), this.idx = this.getMapIndex(this.cell))) {
        var a = this.map[this.idx.row][this.idx.col], b = e.getAttribute(a.el, "colspan") ? parseInt(e.getAttribute(a.el, "colspan"), 10) : 1, d = a.el.tagName.toLowerCase();
        if (a.isRowspan) {
          var f = parseInt(e.getAttribute(a.el, "rowspan"), 10);
          if (1 < f)for (var g = 1, f = f - 1; g <= f; g++)this.injectRowAt(this.idx.row + g, this.idx.col, b, d, a);
          a.el.removeAttribute("rowspan")
        }
        this.splitRowToCells(a)
      }
    },
    merge: function (a) {
      if (this.rectify())if (this.canMerge(a)) {
        a = this.idx_end.row - this.idx_start.row + 1;
        for (var b = this.idx_end.col - this.idx_start.col + 1, e = this.idx_start.row, d = this.idx_end.row; e <= d; e++)for (var g = this.idx_start.col, k = this.idx_end.col; g <= k; g++)e == this.idx_start.row && g == this.idx_start.col ? (1 < a && this.map[e][g].el.setAttribute("rowspan", a), 1 < b && this.map[e][g].el.setAttribute("colspan", b)) : (/^\s*<br\/?>\s*$/.test(this.map[e][g].el.innerHTML.toLowerCase()) || (this.map[this.idx_start.row][this.idx_start.col].el.innerHTML +=
          " " + this.map[e][g].el.innerHTML), f(this.map[e][g].el));
        this.rectify()
      } else window.console && console.log("Do not know how to merge allready merged cells.")
    }, collapseCellToNextRow: function (a) {
      var d = this.getMapIndex(a.el), f = d.row + 1, g = {row: f, col: d.col};
      f < this.map.length && (d = this.getRealRowEl(!1, g), null !== d && (g = this.correctColIndexForUnreals(g.col, g.row), 0 <= g ? b(this.getRowCells(d)[g], a.el) : (f = this.getLastNewCellOnRow(d, f), null !== f ? b(f, a.el) : d.insertBefore(a.el, d.firstChild)), 2 < parseInt(e.getAttribute(a.el,
        "rowspan"), 10) ? a.el.setAttribute("rowspan", parseInt(e.getAttribute(a.el, "rowspan"), 10) - 1) : a.el.removeAttribute("rowspan")))
    }, removeRowCell: function (a) {
      a.isReal ? a.isRowspan ? this.collapseCellToNextRow(a) : f(a.el) : 2 < parseInt(e.getAttribute(a.el, "rowspan"), 10) ? a.el.setAttribute("rowspan", parseInt(e.getAttribute(a.el, "rowspan"), 10) - 1) : a.el.removeAttribute("rowspan")
    }, getRowElementsByCell: function () {
      var a = [];
      this.setTableMap();
      this.idx = this.getMapIndex(this.cell);
      if (!1 !== this.idx)for (var b = this.map[this.idx.row],
                                 e = 0, d = b.length; e < d; e++)b[e].isReal && a.push(b[e].el);
      return a
    }, getColumnElementsByCell: function () {
      var a = [];
      this.setTableMap();
      this.idx = this.getMapIndex(this.cell);
      if (!1 !== this.idx)for (var b = 0, e = this.map.length; b < e; b++)this.map[b][this.idx.col] && this.map[b][this.idx.col].isReal && a.push(this.map[b][this.idx.col].el);
      return a
    }, removeRow: function () {
      var a = e.getParentElement(this.cell, {nodeName: ["TR"]});
      if (a) {
        this.setTableMap();
        this.idx = this.getMapIndex(this.cell);
        if (!1 !== this.idx)for (var b = this.map[this.idx.row],
                                   d = 0, g = b.length; d < g; d++)b[d].modified || (this.setCellAsModified(b[d]), this.removeRowCell(b[d]));
        f(a)
      }
    }, removeColCell: function (a) {
      a.isColspan ? 2 < parseInt(e.getAttribute(a.el, "colspan"), 10) ? a.el.setAttribute("colspan", parseInt(e.getAttribute(a.el, "colspan"), 10) - 1) : a.el.removeAttribute("colspan") : a.isReal && f(a.el)
    }, removeColumn: function () {
      this.setTableMap();
      this.idx = this.getMapIndex(this.cell);
      if (!1 !== this.idx)for (var a = 0, b = this.map.length; a < b; a++)this.map[a][this.idx.col].modified || (this.setCellAsModified(this.map[a][this.idx.col]),
        this.removeColCell(this.map[a][this.idx.col]))
    }, remove: function (a) {
      if (this.rectify()) {
        switch (a) {
          case "row":
            this.removeRow();
            break;
          case "column":
            this.removeColumn()
        }
        this.rectify()
      }
    }, addRow: function (a) {
      var d = this.table.ownerDocument;
      this.setTableMap();
      this.idx = this.getMapIndex(this.cell);
      "below" == a && e.getAttribute(this.cell, "rowspan") && (this.idx.row = this.idx.row + parseInt(e.getAttribute(this.cell, "rowspan"), 10) - 1);
      if (!1 !== this.idx) {
        for (var f = this.map[this.idx.row], d = d.createElement("tr"), g = 0, k = f.length; g <
          k; g++)f[g].modified || (this.setCellAsModified(f[g]), this.addRowCell(f[g], d, a));
        switch (a) {
          case "below":
            b(this.getRealRowEl(!0), d);
            break;
          case "above":
            (a = e.getParentElement(this.map[this.idx.row][this.idx.col].el, {nodeName: ["TR"]})) && a.parentNode.insertBefore(d, a)
        }
      }
    }, addRowCell: function (a, b, d) {
      var f = a.isColspan ? {colspan: e.getAttribute(a.el, "colspan")} : null;
      a.isReal ? "above" != d && a.isRowspan ? a.el.setAttribute("rowspan", parseInt(e.getAttribute(a.el, "rowspan"), 10) + 1) : b.appendChild(this.createCells("td", 1,
        f)) : "above" != d && a.isRowspan && a.lastRow ? b.appendChild(this.createCells("td", 1, f)) : c.isRowspan && a.el.attr("rowspan", parseInt(e.getAttribute(a.el, "rowspan"), 10) + 1)
    }, add: function (a) {
      this.rectify() && ("below" != a && "above" != a || this.addRow(a), "before" != a && "after" != a || this.addColumn(a))
    }, addColCell: function (a, d, f) {
      var g, k = a.el.tagName.toLowerCase();
      switch (f) {
        case "before":
          g = !a.isColspan || a.firstCol;
          break;
        case "after":
          g = !a.isColspan || a.lastCol || a.isColspan && c.el == this.cell
      }
      if (g) {
        switch (f) {
          case "before":
            a.el.parentNode.insertBefore(this.createCells(k,
              1), a.el);
            break;
          case "after":
            b(a.el, this.createCells(k, 1))
        }
        a.isRowspan && this.handleCellAddWithRowspan(a, d + 1, f)
      } else a.el.setAttribute("colspan", parseInt(e.getAttribute(a.el, "colspan"), 10) + 1)
    }, addColumn: function (a) {
      var b;
      this.setTableMap();
      this.idx = this.getMapIndex(this.cell);
      "after" == a && e.getAttribute(this.cell, "colspan") && (this.idx.col = this.idx.col + parseInt(e.getAttribute(this.cell, "colspan"), 10) - 1);
      if (!1 !== this.idx)for (var d = 0, f = this.map.length; d < f; d++)b = this.map[d], b[this.idx.col] && (b = b[this.idx.col],
        b.modified || (this.setCellAsModified(b), this.addColCell(b, d, a)))
    }, handleCellAddWithRowspan: function (a, d, f) {
      var g = parseInt(e.getAttribute(this.cell, "rowspan"), 10) - 1, k = e.getParentElement(a.el, {nodeName: ["TR"]});
      a = a.el.tagName.toLowerCase();
      for (var r, t, v = this.table.ownerDocument, p = 0; p < g; p++) {
        r = this.correctColIndexForUnreals(this.idx.col, d + p);
        a:{
          for (k = k.nextSibling; 1 != k.nodeType;)if (k = k.nextSibling, "tr" == k.tagName.toLowerCase())break a;
          k = null
        }
        if (k)if (0 < r)switch (f) {
          case "before":
            t = this.getRowCells(k);
            0 <
              r && this.map[d + p][this.idx.col].el != t[r] && r == t.length - 1 ? b(t[r], this.createCells(a, 1)) : t[r].parentNode.insertBefore(this.createCells(a, 1), t[r]);
            break;
          case "after":
            b(this.getRowCells(k)[r], this.createCells(a, 1))
        } else k.insertBefore(this.createCells(a, 1), k.firstChild); else r = v.createElement("tr"), r.appendChild(this.createCells(a, 1)), this.table.appendChild(r)
      }
    }};
  e.table = {getCellsBetween: function (a, b) {
    return(new k(a)).getMapElsTo(b)
  }, addCells: function (a, b) {
    (new k(a)).add(b)
  }, removeCells: function (a, b) {
    (new k(a)).remove(b)
  },
    mergeCellsBetween: function (a, b) {
      (new k(a)).merge(b)
    }, unmergeCell: function (a) {
      (new k(a)).unmerge()
    }, orderSelectionEnds: function (a, b) {
      return(new k(a)).orderSelectionEnds(b)
    }, indexOf: function (a) {
      var b = new k(a);
      b.setTableMap();
      return b.getMapIndex(a)
    }, findCell: function (a, b) {
      return(new k(null, a)).getElementAtIndex(b)
    }, findRowByCell: function (a) {
      return(new k(a)).getRowElementsByCell()
    }, findColumnByCell: function (a) {
      return(new k(a)).getColumnElementsByCell()
    }, canMerge: function (a, b) {
      return(new k(a)).canMerge(b)
    }}
})(wysihtml5);
wysihtml5.dom.query = function (d, a) {
  var f = [], b;
  d.nodeType && (d = [d]);
  for (var e = 0, g = d.length; e < g; e++)if (b = d[e].querySelectorAll(a))for (var k = b.length; k--; f.unshift(b[k]));
  return f
};
wysihtml5.quirks.cleanPastedHTML = function () {
  var d = {"a u": wysihtml5.dom.replaceWithChildNodes};
  return function (a, f, b) {
    f = f || d;
    b = b || a.ownerDocument || document;
    var e = "string" === typeof a, g, k, h, l = 0;
    a = e ? wysihtml5.dom.getAsDom(a, b) : a;
    for (h in f)for (g = a.querySelectorAll(h), b = f[h], k = g.length; l < k; l++)b(g[l]);
    return e ? a.innerHTML : a
  }
}();
wysihtml5.quirks.ensureProperClearing = function () {
  var d = function () {
    var a = this;
    setTimeout(function () {
      var d = a.innerHTML.toLowerCase();
      if ("<p>&nbsp;</p>" == d || "<p>&nbsp;</p><p>&nbsp;</p>" == d)a.innerHTML = ""
    }, 0)
  };
  return function (a) {
    wysihtml5.dom.observe(a.element, ["cut", "keydown"], d)
  }
}();
(function (d) {
  d.quirks.getCorrectInnerHTML = function (a) {
    var f = a.innerHTML;
    if (-1 === f.indexOf("%7E"))return f;
    a = a.querySelectorAll("[href*='~'], [src*='~']");
    var b, e, g, k;
    k = 0;
    for (g = a.length; k < g; k++)b = a[k].href || a[k].src, e = d.lang.string(b).replace("~").by("%7E"), f = d.lang.string(f).replace(e).by(b);
    return f
  }
})(wysihtml5);
(function (d) {
  d.quirks.redraw = function (a) {
    d.dom.addClass(a, "wysihtml5-quirks-redraw");
    d.dom.removeClass(a, "wysihtml5-quirks-redraw");
    try {
      var f = a.ownerDocument;
      f.execCommand("italic", !1, null);
      f.execCommand("italic", !1, null)
    } catch (b) {
    }
  }
})(wysihtml5);
wysihtml5.quirks.tableCellsSelection = function (d, a) {
  function f() {
    if (d) {
      var a = d.querySelectorAll("." + n);
      if (0 < a.length)for (var b = 0; b < a.length; b++)h.removeClass(a[b], n)
    }
  }

  function b(a) {
    for (var b = 0; b < a.length; b++)h.addClass(a[b], n)
  }

  function e(e) {
    var d = null;
    (e = h.getParentElement(e.target, {nodeName: ["TD", "TH"]})) && l.table && l.start && (d = h.getParentElement(e, {nodeName: ["TABLE"]})) && d === l.table && (f(), d = l.end, l.end = e, l.cells = h.table.getCellsBetween(l.start, e), 1 < l.cells.length && a.composer.selection.deselect(),
      b(l.cells), l.end !== d && a.fire("tableselectchange").fire("tableselectchange:composer"))
  }

  function g(b) {
    m.stop();
    s.stop();
    a.fire("tableselect").fire("tableselect:composer");
    setTimeout(function () {
      k()
    }, 0)
  }

  function k() {
    var b = h.observe(d.ownerDocument, "click", function (e) {
      b.stop();
      h.getParentElement(e.target, {nodeName: ["TABLE"]}) != l.table && (f(), l.table = null, l.start = null, l.end = null, a.fire("tableunselect").fire("tableunselect:composer"))
    })
  }

  var h = wysihtml5.dom, l = {table: null, start: null, end: null, cells: null, select: function (e, d) {
    l.start = e;
    l.end = d;
    l.table = h.getParentElement(l.start, {nodeName: ["TABLE"]});
    selectedCells = h.table.getCellsBetween(l.start, l.end);
    b(selectedCells);
    k();
    a.fire("tableselect").fire("tableselect:composer")
  }}, n = "wysiwyg-tmp-selected-cell", m = null, s = null;
  return function () {
    h.observe(d, "mousedown", function (b) {
      if (b = wysihtml5.dom.getParentElement(b.target, {nodeName: ["TD", "TH"]}))l.start = b, l.end = b, l.cells = [b], l.table = h.getParentElement(l.start, {nodeName: ["TABLE"]}), l.table && (f(), h.addClass(b, n), m = h.observe(d,
        "mousemove", e), s = h.observe(d, "mouseup", g), a.fire("tableselectstart").fire("tableselectstart:composer"))
    });
    return l
  }()
};
(function (d) {
  var a = /^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]+)\s*\)/i, f = /^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/i, b = /^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])/i, e = /^#([0-9a-f])([0-9a-f])([0-9a-f])/i, g = function (a) {
    return RegExp("(^|\\s|;)" + a + "\\s*:\\s*[^;$]+", "gi")
  };
  d.quirks.styleParser = {parseColor: function (k, h) {
    var l = g(h), l = k.match(l), n = 10, m;
    if (l) {
      for (var s = l.length; s--;)l[s] = d.lang.string(l[s].split(":")[1]).trim();
      l = l[l.length - 1];
      if (a.test(l))m =
        l.match(a); else if (f.test(l))m = l.match(f); else if (b.test(l))m = l.match(b), n = 16; else if (e.test(l))return m = l.match(e), m.shift(), m.push(1), d.lang.array(m).map(function (a, b) {
        return 3 > b ? 16 * parseInt(a, 16) + parseInt(a, 16) : parseFloat(a)
      });
      if (m)return m.shift(), m[3] || m.push(1), d.lang.array(m).map(function (a, b) {
        return 3 > b ? parseInt(a, n) : parseFloat(a)
      })
    }
    return!1
  }, unparseColor: function (a, b) {
    if (b) {
      if ("hex" == b)return a[0].toString(16).toUpperCase() + a[1].toString(16).toUpperCase() + a[2].toString(16).toUpperCase();
      if ("hash" == b)return"#" + a[0].toString(16).toUpperCase() + a[1].toString(16).toUpperCase() + a[2].toString(16).toUpperCase();
      if ("rgb" == b)return"rgb(" + a[0] + "," + a[1] + "," + a[2] + ")";
      if ("rgba" == b)return"rgba(" + a[0] + "," + a[1] + "," + a[2] + "," + a[3] + ")";
      if ("csv" == b)return a[0] + "," + a[1] + "," + a[2] + "," + a[3]
    }
    return a[3] && 1 !== a[3] ? "rgba(" + a[0] + "," + a[1] + "," + a[2] + "," + a[3] + ")" : "rgb(" + a[0] + "," + a[1] + "," + a[2] + ")"
  }, parseFontSize: function (a) {
    return(a = a.match(g("font-size"))) ? d.lang.string(a[a.length - 1].split(":")[1]).trim() : !1
  }}
})(wysihtml5);
(function (d) {
  var a = d.dom;
  d.Selection = Base.extend({constructor: function (a, b, e) {
    window.rangy.init();
    this.editor = a;
    this.composer = a.composer;
    this.doc = this.composer.doc;
    this.contain = b;
    this.unselectableClass = e || !1
  }, getBookmark: function () {
    var a = this.getRange();
    return a && a.cloneRange()
  }, setBookmark: function (a) {
    a && this.setSelection(a)
  }, setBefore: function (a) {
    var b = rangy.createRange(this.doc);
    b.setStartBefore(a);
    b.setEndBefore(a);
    return this.setSelection(b)
  }, setAfter: function (a) {
    var b = rangy.createRange(this.doc);
    b.setStartAfter(a);
    b.setEndAfter(a);
    return this.setSelection(b)
  }, selectNode: function (f, b) {
    var e = rangy.createRange(this.doc), g = f.nodeType === d.ELEMENT_NODE, k = "canHaveHTML"in f ? f.canHaveHTML : "IMG" !== f.nodeName, h = g ? f.innerHTML : f.data, h = "" === h || h === d.INVISIBLE_SPACE, l = a.getStyle("display").from(f), l = "block" === l || "list-item" === l;
    if (h && g && k && !b)try {
      f.innerHTML = d.INVISIBLE_SPACE
    } catch (n) {
    }
    k ? e.selectNodeContents(f) : e.selectNode(f);
    k && h && g ? e.collapse(l) : k && h && (e.setStartAfter(f), e.setEndAfter(f));
    this.setSelection(e)
  },
    getSelectedNode: function (a) {
      if (a && this.doc.selection && "Control" === this.doc.selection.type && (a = this.doc.selection.createRange()) && a.length)return a.item(0);
      a = this.getSelection(this.doc);
      return a.focusNode === a.anchorNode ? a.focusNode : (a = this.getRange(this.doc)) ? a.commonAncestorContainer : this.doc.body
    }, getSelectedOwnNodes: function (a) {
      a = this.getOwnRanges();
      for (var b = [], e = 0, d = a.length; e < d; e++)b.push(a[e].commonAncestorContainer || this.doc.body);
      return b
    }, findNodesInSelection: function (a) {
      for (var b = this.getOwnRanges(),
             e = [], g, k = 0, h = b.length; k < h; k++)g = b[k].getNodes([1], function (b) {
        return d.lang.array(a).contains(b.nodeName)
      }), e = e.concat(g);
      return e
    }, containsUneditable: function () {
      for (var a = this.getOwnUneditables(), b = this.getSelection(), e = 0, d = a.length; e < d; e++)if (b.containsNode(a[e]))return!0;
      return!1
    }, deleteContents: function () {
      for (var a = this.getOwnRanges(), b = a.length; b--;)a[b].deleteContents();
      this.setSelection(a[0])
    }, getPreviousNode: function (a, b) {
      a || (a = this.getSelection().anchorNode);
      if (a === this.contain)return!1;
      var e = a.previousSibling, g;
      if (e === this.contain)return!1;
      e && 3 !== e.nodeType && 1 !== e.nodeType ? e = this.getPreviousNode(e, b) : e && 3 === e.nodeType && /^\s*$/.test(e.textContent) ? e = this.getPreviousNode(e, b) : b && e && 1 === e.nodeType && !d.lang.array(["BR", "HR", "IMG"]).contains(e.nodeName) && /^[\s]*$/.test(e.innerHTML) ? e = this.getPreviousNode(e, b) : e || a === this.contain || (g = a.parentNode, g !== this.contain && (e = this.getPreviousNode(g, b)));
      return e !== this.contain ? e : !1
    }, caretIsInTheBeginnig: function () {
      var a = this.getSelection(), b =
        a.anchorNode;
      return 0 === a.anchorOffset && !this.getPreviousNode(b, !0)
    }, caretIsBeforeUneditable: function () {
      var a = this.getSelection(), b = a.anchorNode;
      if (0 === a.anchorOffset && (a = this.getPreviousNode(b, !0)))for (var b = this.getOwnUneditables(), e = 0, d = b.length; e < d; e++)if (a === b[e])return b[e];
      return!1
    }, executeAndRestore: function (f, b) {
      var e = this.doc.body, g = b && e.scrollTop, k = b && e.scrollLeft, h = '<span class="_wysihtml5-temp-placeholder">' + d.INVISIBLE_SPACE + "</span>", l = this.getRange(!0), n, m, s;
      if (l) {
        l.collapsed || (s =
          l.cloneRange(), n = s.createContextualFragment(h), s.collapse(!1), s.insertNode(n), s.detach());
        h = l.createContextualFragment(h);
        l.insertNode(h);
        n && (n = this.contain.querySelectorAll("._wysihtml5-temp-placeholder"), l.setStartBefore(n[0]), l.setEndAfter(n[n.length - 1]));
        this.setSelection(l);
        try {
          f(l.startContainer, l.endContainer)
        } catch (r) {
          setTimeout(function () {
            throw r;
          }, 0)
        }
        if ((n = this.contain.querySelectorAll("._wysihtml5-temp-placeholder")) && n.length)for (l = rangy.createRange(this.doc), h = n[0].nextSibling, 1 < n.length &&
          (m = n[n.length - 1].previousSibling), m && h ? l.setStartBefore(h) : (m = this.doc.createTextNode(d.INVISIBLE_SPACE), a.insert(m).before(n[0]), l.setStartAfter(m)), l.setEndAfter(m), this.setSelection(l), m = n.length; m--;)n[m].parentNode.removeChild(n[m]); else this.contain.focus();
        b && (e.scrollTop = g, e.scrollLeft = k);
        try {
          n.parentNode.removeChild(n)
        } catch (t) {
        }
      } else f(e, e)
    }, executeAndRestoreSimple: function (a) {
      var b, e, d = this.getRange(), k = this.doc.body, h;
      if (d) {
        b = d.getNodes([3]);
        k = b[0] || d.startContainer;
        h = b[b.length - 1] || d.endContainer;
        b = k === d.startContainer ? d.startOffset : 0;
        e = h === d.endContainer ? d.endOffset : h.length;
        try {
          a(d.startContainer, d.endContainer)
        } catch (l) {
          setTimeout(function () {
            throw l;
          }, 0)
        }
        a = rangy.createRange(this.doc);
        try {
          a.setStart(k, b)
        } catch (n) {
        }
        try {
          a.setEnd(h, e)
        } catch (m) {
        }
        try {
          this.setSelection(a)
        } catch (s) {
        }
      } else a(k, k)
    }, set: function (a, b) {
      var e = rangy.createRange(this.doc);
      e.setStart(a, b || 0);
      this.setSelection(e)
    }, insertHTML: function (a) {
      a = rangy.createRange(this.doc).createContextualFragment(a);
      var b = a.lastChild;
      this.insertNode(a);
      b && this.setAfter(b)
    }, insertNode: function (a) {
      var b = this.getRange();
      b && b.insertNode(a)
    }, surround: function (a) {
      var b = this.getOwnRanges(), e, d = [];
      if (0 == b.length)return d;
      for (var k = b.length; k--;) {
        e = this.doc.createElement(a.nodeName);
        d.push(e);
        a.className && (e.className = a.className);
        try {
          b[k].surroundContents(e), this.selectNode(e)
        } catch (h) {
          e.appendChild(b[k].extractContents()), b[k].insertNode(e)
        }
      }
      return d
    }, deblockAndSurround: function (a) {
      var b = this.doc.createElement("div"), e = rangy.createRange(this.doc), g;
      b.className =
        a.className;
      this.composer.commands.exec("formatBlock", a.nodeName, a.className);
      g = this.contain.querySelectorAll("." + a.className);
      if (g[0])for (g[0].parentNode.insertBefore(b, g[0]), e.setStartBefore(g[0]), e.setEndAfter(g[g.length - 1]), e = e.extractContents(); e.firstChild;)if (g = e.firstChild, 1 == g.nodeType && d.dom.hasClass(g, a.className)) {
        for (; g.firstChild;)b.appendChild(g.firstChild);
        "BR" !== g.nodeName && b.appendChild(this.doc.createElement("br"));
        e.removeChild(g)
      } else b.appendChild(g); else b = null;
      return b
    }, scrollIntoView: function () {
      var a =
        this.doc, b = a.documentElement.scrollHeight > a.documentElement.offsetHeight, e;
      (e = a._wysihtml5ScrollIntoViewElement) || (e = a.createElement("span"), e.innerHTML = d.INVISIBLE_SPACE);
      e = a._wysihtml5ScrollIntoViewElement = e;
      if (b) {
        this.insertNode(e);
        var b = e, g = 0;
        if (b.parentNode) {
          do g += b.offsetTop || 0, b = b.offsetParent; while (b)
        }
        b = g;
        e.parentNode.removeChild(e);
        b >= a.body.scrollTop + a.documentElement.offsetHeight - 5 && (a.body.scrollTop = b)
      }
    }, selectLine: function () {
      d.browser.supportsSelectionModify() ? this._selectLine_W3C() :
        this.doc.selection && this._selectLine_MSIE()
    }, _selectLine_W3C: function () {
      var a = this.doc.defaultView.getSelection();
      a.modify("move", "left", "lineboundary");
      a.modify("extend", "right", "lineboundary")
    }, _selectLine_MSIE: function () {
      var a = this.doc.selection.createRange(), b = a.boundingTop, e = this.doc.body.scrollWidth, d;
      if (a.moveToPoint) {
        0 === b && (d = this.doc.createElement("span"), this.insertNode(d), b = d.offsetTop, d.parentNode.removeChild(d));
        b += 1;
        for (d = -10; d < e; d += 2)try {
          a.moveToPoint(d, b);
          break
        } catch (k) {
        }
        for (d = this.doc.selection.createRange(); 0 <=
          e; e--)try {
          d.moveToPoint(e, b);
          break
        } catch (h) {
        }
        a.setEndPoint("EndToEnd", d);
        a.select()
      }
    }, getText: function () {
      var a = this.getSelection();
      return a ? a.toString() : ""
    }, getNodes: function (a, b) {
      var e = this.getRange();
      return e ? e.getNodes([a], b) : []
    }, fixRangeOverflow: function (a) {
      if (this.contain && this.contain.firstChild && a) {
        var b = a.compareNode(this.contain);
        2 !== b ? (1 === b && a.setStartBefore(this.contain.firstChild), 0 === b && a.setEndAfter(this.contain.lastChild), 3 === b && (a.setStartBefore(this.contain.firstChild), a.setEndAfter(this.contain.lastChild))) :
          this._detectInlineRangeProblems(a) && (b = a.endContainer.previousElementSibling) && a.setEnd(b, this._endOffsetForNode(b))
      }
    }, _endOffsetForNode: function (a) {
      var b = document.createRange();
      b.selectNodeContents(a);
      return b.endOffset
    }, _detectInlineRangeProblems: function (a) {
      position = a.startContainer.compareDocumentPosition(a.endContainer);
      return 0 == a.endOffset && position & Node.DOCUMENT_POSITION_FOLLOWING
    }, getRange: function (a) {
      var b = this.getSelection(), b = b && b.rangeCount && b.getRangeAt(0);
      !0 !== a && this.fixRangeOverflow(b);
      return b
    }, getOwnUneditables: function () {
      var f = a.query(this.contain, "." + this.unselectableClass), b = a.query(f, "." + this.unselectableClass);
      return d.lang.array(f).without(b)
    }, getOwnRanges: function () {
      var a = [], b = this.getRange();
      b && a.push(b);
      if (this.unselectableClass && this.contain && b) {
        var e = this.getOwnUneditables(), d;
        if (0 < e.length)for (var k = 0, h = e.length; k < h; k++)for (var b = [], l = 0, n = a.length; l < n; l++) {
          if (a[l])switch (a[l].compareNode(e[k])) {
            case 2:
              break;
            case 3:
              d = a[l].cloneRange();
              d.setEndBefore(e[k]);
              b.push(d);
              d = a[l].cloneRange();
              d.setStartAfter(e[k]);
              b.push(d);
              break;
            default:
              b.push(a[l])
          }
          a = b
        }
      }
      return a
    }, getSelection: function () {
      return rangy.getSelection(this.doc.defaultView || this.doc.parentWindow)
    }, setSelection: function (a) {
      return rangy.getSelection(this.doc.defaultView || this.doc.parentWindow).setSingleRange(a)
    }, createRange: function () {
      return rangy.createRange(this.doc)
    }, isCollapsed: function () {
      return this.getSelection().isCollapsed
    }, deselect: function () {
      var a = this.getSelection();
      a && a.removeAllRanges()
    }})
})(wysihtml5);
(function (d, a) {
  function f(a, b) {
    var e, d = [];
    if (a.getAttribute("style")) {
      e = a.getAttribute("style").split(";");
      for (var f = e.length; f--;)e[f].match(b) || /\s/.test(e[f]) || d.push(e[f]);
      d.length ? a.setAttribute("style", d.join(";")) : a.removeAttribute("style")
    }
  }

  function b(b, e) {
    return a.dom.isCharacterDataNode(b) ? 0 == e ? !!b.previousSibling : e == b.length ? !!b.nextSibling : !0 : 0 < e && e < b.childNodes.length
  }

  function e(b, d, f) {
    var g;
    a.dom.isCharacterDataNode(d) && (0 == f ? (f = a.dom.getNodeIndex(d), d = d.parentNode) : f == d.length ? (f = a.dom.getNodeIndex(d) +
      1, d = d.parentNode) : g = a.dom.splitDataNode(d, f));
    if (!g) {
      g = d.cloneNode(!1);
      g.id && g.removeAttribute("id");
      for (var h; h = d.childNodes[f];)g.appendChild(h);
      a.dom.insertAfter(g, d)
    }
    return d == b ? g : e(b, g.parentNode, a.dom.getNodeIndex(g))
  }

  function g(a) {
    this.firstTextNode = (this.isElementMerge = a.nodeType == d.ELEMENT_NODE) ? a.lastChild : a;
    this.textNodes = [this.firstTextNode]
  }

  function k(a, b, e, d, f, g) {
    this.tagNames = a || [h];
    this.cssClass = b || (!1 === b ? !1 : "");
    this.similarClassRegExp = e;
    this.cssStyle = f || "";
    this.similarStyleRegExp =
      g;
    this.normalize = d;
    this.applyToAnyTagName = !1
  }

  var h = "span", l = /\s+/g;
  g.prototype = {doMerge: function () {
    for (var a = [], b, e, d = 0, f = this.textNodes.length; d < f; ++d)b = this.textNodes[d], e = b.parentNode, a[d] = b.data, d && (e.removeChild(b), e.hasChildNodes() || e.parentNode.removeChild(e));
    return this.firstTextNode.data = a = a.join("")
  }, getLength: function () {
    for (var a = this.textNodes.length, b = 0; a--;)b += this.textNodes[a].length;
    return b
  }, toString: function () {
    for (var a = [], b = 0, e = this.textNodes.length; b < e; ++b)a[b] = "'" + this.textNodes[b].data +
      "'";
    return"[Merge(" + a.join(",") + ")]"
  }};
  k.prototype = {getAncestorWithClass: function (b) {
    for (var e; b;) {
      if (this.cssClass)if (e = this.cssClass, b.className) {
        var f = b.className.match(this.similarClassRegExp) || [];
        e = f[f.length - 1] === e
      } else e = !1; else e = "" !== this.cssStyle ? !1 : !0;
      if (b.nodeType == d.ELEMENT_NODE && "false" != b.getAttribute("contenteditable") && a.dom.arrayContains(this.tagNames, b.tagName.toLowerCase()) && e)return b;
      b = b.parentNode
    }
    return!1
  }, getAncestorWithStyle: function (b) {
    for (var e; b;) {
      if (this.cssStyle) {
        e =
          b;
        var f = this.similarStyleRegExp;
        e.getAttribute && e.getAttribute("style") ? (e.getAttribute("style").match(f), e = e.getAttribute("style").match(f) ? !0 : !1) : e = !1
      } else e = !1;
      if (b.nodeType == d.ELEMENT_NODE && "false" != b.getAttribute("contenteditable") && a.dom.arrayContains(this.tagNames, b.tagName.toLowerCase()) && e)return b;
      b = b.parentNode
    }
    return!1
  }, postApply: function (a, b) {
    for (var e = a[0], d = a[a.length - 1], f = [], h, k = e, l = d, B = 0, C = d.length, z, A, u = 0, w = a.length; u < w; ++u)z = a[u], A = null, z && z.parentNode && (A = this.getAdjacentMergeableTextNode(z.parentNode,
      !1)), A ? (h || (h = new g(A), f.push(h)), h.textNodes.push(z), z === e && (k = h.firstTextNode, B = k.length), z === d && (l = h.firstTextNode, C = h.getLength())) : h = null;
    d && d.parentNode && (e = this.getAdjacentMergeableTextNode(d.parentNode, !0)) && (h || (h = new g(d), f.push(h)), h.textNodes.push(e));
    if (f.length) {
      u = 0;
      for (w = f.length; u < w; ++u)f[u].doMerge();
      b.setStart(k, B);
      b.setEnd(l, C)
    }
  }, getAdjacentMergeableTextNode: function (a, b) {
    var e = a.nodeType == d.TEXT_NODE, f = e ? a.parentNode : a, g = b ? "nextSibling" : "previousSibling";
    if (e) {
      if ((e = a[g]) && e.nodeType ==
        d.TEXT_NODE)return e
    } else if ((e = f[g]) && this.areElementsMergeable(a, e))return e[b ? "firstChild" : "lastChild"];
    return null
  }, areElementsMergeable: function (b, e) {
    var d;
    if (d = a.dom.arrayContains(this.tagNames, (b.tagName || "").toLowerCase()))if (d = a.dom.arrayContains(this.tagNames, (e.tagName || "").toLowerCase()))if (d = b.className.replace(l, " ") == e.className.replace(l, " "))a:if (b.attributes.length != e.attributes.length)d = !1; else {
      d = 0;
      for (var f = b.attributes.length, g, h; d < f; ++d)if (g = b.attributes[d], h = g.name, "class" !=
        h && (h = e.attributes.getNamedItem(h), g.specified != h.specified || g.specified && g.nodeValue !== h.nodeValue)) {
        d = !1;
        break a
      }
      d = !0
    }
    return d
  }, createContainer: function (a) {
    a = a.createElement(this.tagNames[0]);
    this.cssClass && (a.className = this.cssClass);
    this.cssStyle && a.setAttribute("style", this.cssStyle);
    return a
  }, applyToTextNode: function (b) {
    var e = b.parentNode;
    1 == e.childNodes.length && a.dom.arrayContains(this.tagNames, e.tagName.toLowerCase()) ? this.cssClass && (b = this.cssClass, e.className ? (e.className && (e.className =
      e.className.replace(this.similarClassRegExp, "")), e.className += " " + b) : e.className = b) : (e = this.createContainer(a.dom.getDocument(b)), b.parentNode.insertBefore(e, b), e.appendChild(b))
  }, isRemovable: function (b) {
    return a.dom.arrayContains(this.tagNames, b.tagName.toLowerCase()) && d.lang.string(b.className).trim() == this.cssClass
  }, undoToTextNode: function (a, d, g, h) {
    a = g ? !1 : !0;
    g = g || h;
    h = !1;
    if (!d.containsNode(g)) {
      var k = d.cloneRange();
      k.selectNode(g);
      k.isPointInRange(d.endContainer, d.endOffset) && b(d.endContainer, d.endOffset) &&
      (e(g, d.endContainer, d.endOffset), d.setEndAfter(g));
      k.isPointInRange(d.startContainer, d.startOffset) && b(d.startContainer, d.startOffset) && (g = e(g, d.startContainer, d.startOffset))
    }
    !a && this.similarClassRegExp && g.className && (g.className = g.className.replace(this.similarClassRegExp, ""));
    if (a && this.similarStyleRegExp) {
      d = g;
      a = this.cssStyle;
      h = this.similarStyleRegExp;
      b:{
        var k = [], l = a.split(";"), p = d.getAttribute("style");
        if (p) {
          p = p.replace(/\s/gi, "").toLowerCase();
          k.push(RegExp("(^|\\s|;)" + a.replace(/\s/gi, "").replace(/([\(\)])/gi,
            "\\$1").toLowerCase().replace(";", ";?"), "gi"));
          for (var x = l.length; 0 < x--;)/^\s*$/.test(l[x]) || k.push(RegExp("(^|\\s|;)" + l[x].replace(/\s/gi, "").replace(/([\(\)])/gi, "\\$1").toLowerCase().replace(";", ";?"), "gi"));
          l = 0;
          for (x = k.length; l < x; l++)if (p.match(k[l])) {
            k = k[l];
            break b
          }
        }
        k = !1
      }
      k ? (f(d, k), d = "remove") : (d.getAttribute("style") ? (f(d, h), d.getAttribute("style") && !/\s+/.test(d.getAttribute("style")) ? d.setAttribute("style", a + ";" + d.getAttribute("style")) : d.setAttribute("style", a)) : d.setAttribute("style", a),
        d = "change");
      h = "change" === d
    }
    if (this.isRemovable(g) && !h) {
      for (d = g.parentNode; g.firstChild;)d.insertBefore(g.firstChild, g);
      d.normalize && d.normalize();
      d.removeChild(g)
    }
  }, applyToRange: function (a) {
    for (var b, e = a.length; e--;) {
      b = a[e].getNodes([d.TEXT_NODE]);
      if (!b.length)try {
        var f = this.createContainer(a[e].endContainer.ownerDocument);
        a[e].surroundContents(f);
        this.selectNode(a[e], f);
        break
      } catch (g) {
      }
      a[e].splitBoundaries();
      b = a[e].getNodes([d.TEXT_NODE]);
      if (b.length) {
        for (var h, k = 0, l = b.length; k < l; ++k)h = b[k], this.getAncestorWithClass(h) ||
          this.applyToTextNode(h);
        a[e].setStart(b[0], 0);
        h = b[b.length - 1];
        a[e].setEnd(h, h.length);
        this.normalize && this.postApply(b, a[e])
      }
    }
  }, undoToRange: function (a) {
    for (var b, e, f, g, h = a.length; h--;) {
      b = a[h].getNodes([d.TEXT_NODE]);
      b.length ? (a[h].splitBoundaries(), b = a[h].getNodes([d.TEXT_NODE])) : (b = a[h].endContainer.ownerDocument.createTextNode(d.INVISIBLE_SPACE), a[h].insertNode(b), a[h].selectNode(b), b = [b]);
      for (var k = 0, l = b.length; k < l; ++k)a[h].isValid() && (e = b[k], f = this.getAncestorWithClass(e), g = this.getAncestorWithStyle(e),
        f ? this.undoToTextNode(e, a[h], f) : g && this.undoToTextNode(e, a[h], !1, g));
      1 == l ? this.selectNode(a[h], b[0]) : (a[h].setStart(b[0], 0), e = b[b.length - 1], a[h].setEnd(e, e.length), this.normalize && this.postApply(b, a[h]))
    }
  }, selectNode: function (a, b) {
    var e = b.nodeType === d.ELEMENT_NODE, f = "canHaveHTML"in b ? b.canHaveHTML : !0, g = e ? b.innerHTML : b.data;
    if ((g = "" === g || g === d.INVISIBLE_SPACE) && e && f)try {
      b.innerHTML = d.INVISIBLE_SPACE
    } catch (h) {
    }
    a.selectNodeContents(b);
    g && e ? a.collapse(!1) : g && (a.setStartAfter(b), a.setEndAfter(b))
  }, getTextSelectedByRange: function (a, b) {
    var e = b.cloneRange();
    e.selectNodeContents(a);
    var d = e.intersection(b), d = d ? d.toString() : "";
    e.detach();
    return d
  }, isAppliedToRange: function (a) {
    for (var b = [], e, f, g = a.length; g--;) {
      f = a[g].getNodes([d.TEXT_NODE]);
      if (!f.length)return(e = this.getAncestorWithClass(a[g].startContainer)) || (e = this.getAncestorWithStyle(a[g].startContainer)), e ? [e] : !1;
      for (var h = 0, k = f.length, l; h < k; ++h)l = this.getTextSelectedByRange(f[h], a[g]), (e = this.getAncestorWithClass(f[h])) || (e = this.getAncestorWithStyle(f[h])), ("" == l || e) && b.push(e)
    }
    return b.length ?
      b : !1
  }, toggleRange: function (a) {
    this.isAppliedToRange(a) ? this.undoToRange(a) : this.applyToRange(a)
  }};
  d.selection.HTMLApplier = k
})(wysihtml5, rangy);
wysihtml5.Commands = Base.extend({constructor: function (d) {
  this.editor = d;
  this.composer = d.composer;
  this.doc = this.composer.doc
}, support: function (d) {
  return wysihtml5.browser.supportsCommand(this.doc, d)
}, exec: function (d, a) {
  var f = wysihtml5.commands[d], b = wysihtml5.lang.array(arguments).get(), e = f && f.exec, g = null;
  this.editor.fire("beforecommand:composer");
  if (e)b.unshift(this.composer), g = e.apply(f, b); else try {
    g = this.doc.execCommand(d, !1, a)
  } catch (k) {
  }
  this.editor.fire("aftercommand:composer");
  return g
}, state: function (d, a) {
  var f = wysihtml5.commands[d], b = wysihtml5.lang.array(arguments).get(), e = f && f.state;
  if (e)return b.unshift(this.composer), e.apply(f, b);
  try {
    return this.doc.queryCommandState(d)
  } catch (g) {
    return!1
  }
}, stateValue: function (d) {
  var a = wysihtml5.commands[d], f = wysihtml5.lang.array(arguments).get(), b = a && a.stateValue;
  return b ? (f.unshift(this.composer), b.apply(a, f)) : !1
}});
wysihtml5.commands.bold = {exec: function (d, a) {
  wysihtml5.commands.formatInline.execWithToggle(d, a, "b")
}, state: function (d, a) {
  return wysihtml5.commands.formatInline.state(d, a, "b")
}};
(function (d) {
  function a(a, k) {
    var h = a.doc, l = "_wysihtml5-temp-" + +new Date, n = 0, m, s, r;
    d.commands.formatInline.exec(a, f, b, l, /non-matching-class/g, f, f, f, !0);
    m = h.querySelectorAll(b + "." + l);
    for (l = m.length; n < l; n++)for (r in s = m[n], s.removeAttribute("class"), k)"text" !== r && s.setAttribute(r, k[r]);
    n = s;
    1 === l && (r = e.getTextContent(s), l = !!s.querySelector("*"), r = "" === r || r === d.INVISIBLE_SPACE, !l && r && (e.setTextContent(s, k.text || s.href), h = h.createTextNode(" "), a.selection.setAfter(s), e.insert(h).after(s), n = h));
    a.selection.setAfter(n)
  }

  var f, b = "A", e = d.dom;
  d.commands.createLink = {exec: function (b, e, d) {
    var f = this.state(b, e);
    f ? b.selection.executeAndRestore(function () {
      for (var a = d, b, e = f.length; e--;) {
        b = f[e].attributes;
        for (var g = b.length; g--;)f[e].removeAttribute(b.item(g).name);
        for (var k in a)a.hasOwnProperty(k) && f[e].setAttribute(k, a[k])
      }
    }) : (d = "object" === typeof d ? d : {href: d}, a(b, d))
  }, state: function (a, b) {
    return d.commands.formatInline.state(a, b, "A")
  }}
})(wysihtml5);
(function (d) {
  var a = d.dom;
  d.commands.removeLink = {exec: function (d, b) {
    var e = this.state(d, b);
    e && d.selection.executeAndRestore(function () {
      for (var b = e.length, d = 0, f, l, n; d < b; d++)f = e[d], l = a.getParentElement(f, {nodeName: "code"}), n = a.getTextContent(f), n.match(a.autoLink.URL_REG_EXP) && !l ? a.renameElement(f, "code") : a.replaceWithChildNodes(f)
    })
  }, state: function (a, b) {
    return d.commands.formatInline.state(a, b, "A")
  }}
})(wysihtml5);
(function (d) {
  var a = /wysiwyg-font-size-[0-9a-z\-]+/g;
  d.commands.fontSize = {exec: function (f, b, e) {
    d.commands.formatInline.execWithToggle(f, b, "span", "wysiwyg-font-size-" + e, a)
  }, state: function (f, b, e) {
    return d.commands.formatInline.state(f, b, "span", "wysiwyg-font-size-" + e, a)
  }}
})(wysihtml5);
(function (d) {
  var a = /(\s|^)font-size\s*:\s*[^;\s]+;?/gi;
  d.commands.fontSizeStyle = {exec: function (f, b, e) {
    e = "object" == typeof e ? e.size : e;
    /^\s*$/.test(e) || d.commands.formatInline.execWithToggle(f, b, "span", !1, !1, "font-size:" + e, a)
  }, state: function (f, b, e) {
    return d.commands.formatInline.state(f, b, "span", !1, !1, "font-size", a)
  }, stateValue: function (a, b) {
    var e = this.state(a, b);
    e && d.lang.object(e).isArray() && (e = e[0]);
    return e && (e = e.getAttribute("style")) ? d.quirks.styleParser.parseFontSize(e) : !1
  }}
})(wysihtml5);
(function (d) {
  var a = /wysiwyg-color-[0-9a-z]+/g;
  d.commands.foreColor = {exec: function (f, b, e) {
    d.commands.formatInline.execWithToggle(f, b, "span", "wysiwyg-color-" + e, a)
  }, state: function (f, b, e) {
    return d.commands.formatInline.state(f, b, "span", "wysiwyg-color-" + e, a)
  }}
})(wysihtml5);
(function (d) {
  var a = /(\s|^)color\s*:\s*[^;\s]+;?/gi;
  d.commands.foreColorStyle = {exec: function (f, b, e) {
    e = d.quirks.styleParser.parseColor("object" == typeof e ? "color:" + e.color : "color:" + e, "color");
    var g;
    e && (g = "color: rgb(" + e[0] + "," + e[1] + "," + e[2] + ");", 1 !== e[3] && (g += "color: rgba(" + e[0] + "," + e[1] + "," + e[2] + "," + e[3] + ");"), d.commands.formatInline.execWithToggle(f, b, "span", !1, !1, g, a))
  }, state: function (f, b) {
    return d.commands.formatInline.state(f, b, "span", !1, !1, "color", a)
  }, stateValue: function (a, b, e) {
    (a = this.state(a,
      b)) && d.lang.object(a).isArray() && (a = a[0]);
    return a && (a = a.getAttribute("style")) && a ? (val = d.quirks.styleParser.parseColor(a, "color"), d.quirks.styleParser.unparseColor(val, e)) : !1
  }}
})(wysihtml5);
(function (d) {
  var a = /(\s|^)background-color\s*:\s*[^;\s]+;?/gi;
  d.commands.bgColorStyle = {exec: function (f, b, e) {
    e = d.quirks.styleParser.parseColor("object" == typeof e ? "background-color:" + e.color : "background-color:" + e, "background-color");
    var g;
    e && (g = "background-color: rgb(" + e[0] + "," + e[1] + "," + e[2] + ");", 1 !== e[3] && (g += "background-color: rgba(" + e[0] + "," + e[1] + "," + e[2] + "," + e[3] + ");"), d.commands.formatInline.execWithToggle(f, b, "span", !1, !1, g, a))
  }, state: function (f, b) {
    return d.commands.formatInline.state(f, b, "span",
      !1, !1, "background-color", a)
  }, stateValue: function (a, b, e) {
    a = this.state(a, b);
    b = !1;
    a && d.lang.object(a).isArray() && (a = a[0]);
    return a && (a = a.getAttribute("style")) ? (b = d.quirks.styleParser.parseColor(a, "background-color"), d.quirks.styleParser.unparseColor(b, e)) : !1
  }}
})(wysihtml5);
(function (d) {
  function a(a, b) {
    var e = b.test(a.className);
    a.className = a.className.replace(b, "");
    "" == d.lang.string(a.className).trim() && a.removeAttribute("class");
    return e
  }

  function f(a) {
    for (a = a.previousSibling; a && a.nodeType === d.TEXT_NODE && !d.lang.string(a.data).trim();)a = a.previousSibling;
    return a
  }

  function b(a) {
    for (a = a.nextSibling; a && a.nodeType === d.TEXT_NODE && !d.lang.string(a.data).trim();)a = a.nextSibling;
    return a
  }

  function e(a) {
    return"BR" === a.nodeName || "block" === h.getStyle("display").from(a) ? !0 : !1
  }

  function g(a, b, e, f, g) {
    for (var k = b.selection.getOwnRanges(), p = k.length; p--;) {
      b.selection.getSelection().removeAllRanges();
      b.selection.setSelection(k[p]);
      if (g)var l = h.observe(a, "DOMNodeInserted", function (a) {
        a = a.target;
        var b;
        a.nodeType === d.ELEMENT_NODE && (b = h.getStyle("display").from(a), "inline" !== b.substr(0, 6) && (a.className += " " + g))
      });
      a.execCommand(e, !1, f);
      l && l.stop()
    }
  }

  function k(a, e) {
    a.selection.isCollapsed() && a.selection.selectLine();
    for (var d = a.selection.surround(e), g = 0, h = d.length; g < h; g++) {
      var k = d[g], p = b(k), k =
        f(k);
      p && "BR" === p.nodeName && p.parentNode.removeChild(p);
      k && "BR" === k.nodeName && k.parentNode.removeChild(k);
      (p = d[g].lastChild) && "BR" === p.nodeName && p.parentNode.removeChild(p)
    }
  }

  var h = d.dom, l = "H1 H2 H3 H4 H5 H6 P PRE BLOCKQUOTE DIV".split(" ");
  d.commands.formatBlock = {exec: function (n, m, s, r, t) {
    var v = n.doc, p = this.state(n, m, s, r, t), x = n.config.useLineBreaks, B = x ? "DIV" : "P", C, z, A;
    s = "string" === typeof s ? s.toUpperCase() : s;
    if (p.length)n.selection.executeAndRestoreSimple(function () {
      for (var g = p.length; g--;) {
        t && (z = a(p[g],
          t));
        if (z && null === s && p[g].nodeName != B)break;
        if (d.lang.string(p[g].className).trim() || !x && "P" !== s)h.renameElement(p[g], "P" === s ? "DIV" : B); else {
          var k = p[g], l = k.ownerDocument, m = b(k), r = f(k);
          m && !e(m) && k.parentNode.insertBefore(l.createElement("br"), m);
          r && !e(r) && k.parentNode.insertBefore(l.createElement("br"), k);
          h.replaceWithChildNodes(p[g])
        }
      }
    }); else {
      if (null === s || d.lang.array(l).contains(s))if (C = n.selection.findNodesInSelection(l).concat(n.selection.getSelectedOwnNodes()), n.selection.executeAndRestoreSimple(function () {
        for (var b =
          C.length; b--;)if (blockElement = h.getParentElement(C[b], {nodeName: l}), blockElement == n.element && (blockElement = null), blockElement) {
          s && (blockElement = h.renameElement(blockElement, s));
          if (r) {
            var e = blockElement, f = r;
            e.className ? (a(e, t), e.className = d.lang.string(e.className + " " + f).trim()) : e.className = f
          }
          A = !0
        }
      }), A)return;
      d.browser.supportsSelectLine() ? k(n, {nodeName: s || B, className: r || null}) : n.commands.support(m) && g(v, n, m, s || B, r)
    }
  }, state: function (a, b, e, f, g) {
    a = a.selection.getSelectedOwnNodes();
    b = [];
    var k;
    e = "string" === typeof e ? e.toUpperCase() : e;
    for (var p = 0, l = a.length; p < l; p++)(k = h.getParentElement(a[p], {nodeName: e, className: f, classRegExp: g})) && -1 == d.lang.array(b).indexOf(k) && b.push(k);
    return 0 == b.length ? !1 : b
  }}
})(wysihtml5);
(function (d) {
  function a(a, g, k, h, l) {
    var n = a + ":" + g;
    h && (n += ":" + h);
    if (!b[n]) {
      var m = b, s = n, r = d.selection.HTMLApplier, t = f[a];
      a = t ? [a.toLowerCase(), t.toLowerCase()] : [a.toLowerCase()];
      m[s] = new r(a, g, k, !0, h, l)
    }
    return b[n]
  }

  var f = {strong: "b", em: "i", b: "strong", i: "em"}, b = {};
  d.commands.formatInline = {exec: function (b, d, f, h, l, n, m, s, r) {
    d = b.selection.createRange();
    ownRanges = b.selection.getOwnRanges();
    if (!ownRanges || 0 == ownRanges.length)return!1;
    b.selection.getSelection().removeAllRanges();
    a(f, h, l, n, m).toggleRange(ownRanges);
    d.setStart(ownRanges[0].startContainer, ownRanges[0].startOffset);
    d.setEnd(ownRanges[ownRanges.length - 1].endContainer, ownRanges[ownRanges.length - 1].endOffset);
    r || (s ? b.cleanUp() : (b.selection.setSelection(d), b.selection.executeAndRestore(function () {
      b.cleanUp()
    }, !0, !0)))
  }, execWithToggle: function (a, b, f, h, l, n, m) {
    if (this.state(a, b, f, h, l, n, m) && a.selection.isCollapsed()) {
      var s = this.state(a, b, f, h, l)[0];
      a.selection.executeAndRestoreSimple(function () {
        a.selection.selectNode(s, !0);
        d.commands.formatInline.exec(a,
          b, f, h, l, n, m, !0, !0)
      })
    } else d.commands.formatInline.exec(a, b, f, h, l, n, m)
  }, state: function (b, g, k, h, l, n, m) {
    g = b.doc;
    var s = f[k] || k;
    if (!d.dom.hasElementWithTagName(g, k) && !d.dom.hasElementWithTagName(g, s) || h && !d.dom.hasElementWithClassName(g, h))return!1;
    b = b.selection.getOwnRanges();
    return 0 == b.length ? !1 : a(k, h, l, n, m).isAppliedToRange(b)
  }}
})(wysihtml5);
wysihtml5.commands.insertHTML = {exec: function (d, a, f) {
  d.commands.support(a) ? d.doc.execCommand(a, !1, f) : d.selection.insertHTML(f)
}, state: function () {
  return!1
}};
(function (d) {
  d.commands.insertImage = {exec: function (a, f, b) {
    b = "object" === typeof b ? b : {src: b};
    var e = a.doc;
    if (f = this.state(a))a.selection.setBefore(f), b = f.parentNode, b.removeChild(f), d.dom.removeEmptyTextNodes(b), "A" !== b.nodeName || b.firstChild || (a.selection.setAfter(b), b.parentNode.removeChild(b)), d.quirks.redraw(a.element); else {
      f = e.createElement("IMG");
      for (var g in b)f.setAttribute("className" === g ? "class" : g, b[g]);
      a.selection.insertNode(f);
      d.browser.hasProblemsSettingCaretAfterImg() ? (b = e.createTextNode(d.INVISIBLE_SPACE),
        a.selection.insertNode(b), a.selection.setAfter(b)) : a.selection.setAfter(f)
    }
  }, state: function (a) {
    var f;
    if (!d.dom.hasElementWithTagName(a.doc, "IMG"))return!1;
    f = a.selection.getSelectedNode();
    if (!f)return!1;
    if ("IMG" === f.nodeName)return f;
    if (f.nodeType !== d.ELEMENT_NODE)return!1;
    f = a.selection.getText();
    if (f = d.lang.string(f).trim())return!1;
    a = a.selection.getNodes(d.ELEMENT_NODE, function (a) {
      return"IMG" === a.nodeName
    });
    return 1 !== a.length ? !1 : a[0]
  }}
})(wysihtml5);
(function (d) {
  var a = "<br>" + (d.browser.needsSpaceAfterLineBreak() ? " " : "");
  d.commands.insertLineBreak = {exec: function (f, b) {
    f.commands.support(b) ? (f.doc.execCommand(b, !1, null), d.browser.autoScrollsToCaret() || f.selection.scrollIntoView()) : f.commands.exec("insertHTML", a)
  }, state: function () {
    return!1
  }}
})(wysihtml5);
wysihtml5.commands.insertOrderedList = {exec: function (d, a) {
  var f = d.doc, b = d.selection.getSelectedNode(), e = wysihtml5.dom.getParentElement(b, {nodeName: "OL"}), g = wysihtml5.dom.getParentElement(b, {nodeName: "UL"}), b = "_wysihtml5-temp-" + (new Date).getTime(), k;
  e && !d.element.contains(e) && (e = null);
  g && !d.element.contains(g) && (g = null);
  if (e || g || !d.commands.support(a))if (e)d.selection.executeAndRestore(function () {
    wysihtml5.dom.resolveList(e, d.config.useLineBreaks)
  }); else if (g)d.selection.executeAndRestore(function () {
    wysihtml5.dom.renameElement(g,
      "ol")
  }); else {
    if (k = d.selection.deblockAndSurround({nodeName: "div", className: b}))f = "" === k.innerHTML || k.innerHTML === wysihtml5.INVISIBLE_SPACE || "<br>" === k.innerHTML, d.selection.executeAndRestore(function () {
      e = wysihtml5.dom.convertToList(k, "ol", d.parent.config.uneditableContainerClassname)
    }), f && d.selection.selectNode(e.querySelector("li"), !0)
  } else f.execCommand(a, !1, null)
}, state: function (d) {
  var a = d.selection.getSelectedNode(), a = wysihtml5.dom.getParentElement(a, {nodeName: "OL"});
  return d.element.contains(a) ?
    a : !1
}};
wysihtml5.commands.insertUnorderedList = {exec: function (d, a) {
  var f = d.doc, b = d.selection.getSelectedNode(), e = wysihtml5.dom.getParentElement(b, {nodeName: "UL"}), g = wysihtml5.dom.getParentElement(b, {nodeName: "OL"}), b = "_wysihtml5-temp-" + (new Date).getTime(), k;
  e && !d.element.contains(e) && (e = null);
  g && !d.element.contains(g) && (g = null);
  if (e || g || !d.commands.support(a))if (e)d.selection.executeAndRestore(function () {
    wysihtml5.dom.resolveList(e, d.config.useLineBreaks)
  }); else if (g)d.selection.executeAndRestore(function () {
    wysihtml5.dom.renameElement(g, "ul")
  });
  else {
    if (k = d.selection.deblockAndSurround({nodeName: "div", className: b}))f = "" === k.innerHTML || k.innerHTML === wysihtml5.INVISIBLE_SPACE || "<br>" === k.innerHTML, d.selection.executeAndRestore(function () {
      e = wysihtml5.dom.convertToList(k, "ul", d.parent.config.uneditableContainerClassname)
    }), f && d.selection.selectNode(e.querySelector("li"), !0)
  } else f.execCommand(a, !1, null)
}, state: function (d) {
  var a = d.selection.getSelectedNode(), a = wysihtml5.dom.getParentElement(a, {nodeName: "UL"});
  return d.element.contains(a) ? a : !1
}};
wysihtml5.commands.italic = {exec: function (d, a) {
  wysihtml5.commands.formatInline.execWithToggle(d, a, "i")
}, state: function (d, a) {
  return wysihtml5.commands.formatInline.state(d, a, "i")
}};
(function (d) {
  var a = /wysiwyg-text-align-[0-9a-z]+/g;
  d.commands.justifyCenter = {exec: function (f, b) {
    return d.commands.formatBlock.exec(f, "formatBlock", null, "wysiwyg-text-align-center", a)
  }, state: function (f, b) {
    return d.commands.formatBlock.state(f, "formatBlock", null, "wysiwyg-text-align-center", a)
  }}
})(wysihtml5);
(function (d) {
  var a = /wysiwyg-text-align-[0-9a-z]+/g;
  d.commands.justifyLeft = {exec: function (f, b) {
    return d.commands.formatBlock.exec(f, "formatBlock", null, "wysiwyg-text-align-left", a)
  }, state: function (f, b) {
    return d.commands.formatBlock.state(f, "formatBlock", null, "wysiwyg-text-align-left", a)
  }}
})(wysihtml5);
(function (d) {
  var a = /wysiwyg-text-align-[0-9a-z]+/g;
  d.commands.justifyRight = {exec: function (f, b) {
    return d.commands.formatBlock.exec(f, "formatBlock", null, "wysiwyg-text-align-right", a)
  }, state: function (f, b) {
    return d.commands.formatBlock.state(f, "formatBlock", null, "wysiwyg-text-align-right", a)
  }}
})(wysihtml5);
(function (d) {
  var a = /wysiwyg-text-align-[0-9a-z]+/g;
  d.commands.justifyFull = {exec: function (f, b) {
    return d.commands.formatBlock.exec(f, "formatBlock", null, "wysiwyg-text-align-justify", a)
  }, state: function (f, b) {
    return d.commands.formatBlock.state(f, "formatBlock", null, "wysiwyg-text-align-justify", a)
  }}
})(wysihtml5);
wysihtml5.commands.redo = {exec: function (d) {
  return d.undoManager.redo()
}, state: function (d) {
  return!1
}};
wysihtml5.commands.underline = {exec: function (d, a) {
  wysihtml5.commands.formatInline.execWithToggle(d, a, "u")
}, state: function (d, a) {
  return wysihtml5.commands.formatInline.state(d, a, "u")
}};
wysihtml5.commands.undo = {exec: function (d) {
  return d.undoManager.undo()
}, state: function (d) {
  return!1
}};
wysihtml5.commands.createTable = {exec: function (d, a, f) {
  var b, e;
  if (f && f.cols && f.rows && 0 < parseInt(f.cols, 10) && 0 < parseInt(f.rows, 10)) {
    e = f.tableStyle ? '<table style="' + f.tableStyle + '">' : "<table>";
    e += "<tbody>";
    for (b = 0; b < f.rows; b++) {
      e += "<tr>";
      for (a = 0; a < f.cols; a++)e += "<td>&nbsp;</td>";
      e += "</tr>"
    }
    d.commands.exec("insertHTML", e + "</tbody></table>")
  }
}, state: function (d, a) {
  return!1
}};
wysihtml5.commands.mergeTableCells = {exec: function (d, a) {
  d.tableSelection && d.tableSelection.start && d.tableSelection.end && (this.state(d, a) ? wysihtml5.dom.table.unmergeCell(d.tableSelection.start) : wysihtml5.dom.table.mergeCellsBetween(d.tableSelection.start, d.tableSelection.end))
}, state: function (d, a) {
  if (d.tableSelection) {
    var f = d.tableSelection.start, b = d.tableSelection.end;
    if (f && b && f == b && (wysihtml5.dom.getAttribute(f, "colspan") && 1 < parseInt(wysihtml5.dom.getAttribute(f, "colspan"), 10) || wysihtml5.dom.getAttribute(f,
      "rowspan") && 1 < parseInt(wysihtml5.dom.getAttribute(f, "rowspan"), 10)))return[f]
  }
  return!1
}};
wysihtml5.commands.addTableCells = {exec: function (d, a, f) {
  if (d.tableSelection && d.tableSelection.start && d.tableSelection.end) {
    var b = wysihtml5.dom.table.orderSelectionEnds(d.tableSelection.start, d.tableSelection.end);
    "before" == f || "above" == f ? wysihtml5.dom.table.addCells(b.start, f) : "after" != f && "below" != f || wysihtml5.dom.table.addCells(b.end, f);
    setTimeout(function () {
      d.tableSelection.select(b.start, b.end)
    }, 0)
  }
}, state: function (d, a) {
  return!1
}};
wysihtml5.commands.deleteTableCells = {exec: function (d, a, f) {
  if (d.tableSelection && d.tableSelection.start && d.tableSelection.end) {
    a = wysihtml5.dom.table.orderSelectionEnds(d.tableSelection.start, d.tableSelection.end);
    var b = wysihtml5.dom.table.indexOf(a.start), e, g = d.tableSelection.table;
    wysihtml5.dom.table.removeCells(a.start, f);
    setTimeout(function () {
      e = wysihtml5.dom.table.findCell(g, b);
      e || ("row" == f && (e = wysihtml5.dom.table.findCell(g, {row: b.row - 1, col: b.col})), "column" == f && (e = wysihtml5.dom.table.findCell(g,
        {row: b.row, col: b.col - 1})));
      e && d.tableSelection.select(e, e)
    }, 0)
  }
}, state: function (d, a) {
  return!1
}};
(function (d) {
  var a = d.dom;
  d.UndoManager = d.lang.Dispatcher.extend({constructor: function (a) {
    this.editor = a;
    this.composer = a.composer;
    this.element = this.composer.element;
    this.position = 0;
    this.historyStr = [];
    this.historyDom = [];
    this.transact();
    this._observe()
  }, _observe: function () {
    var d = this;
    this.composer.sandbox.getDocument();
    var b;
    a.observe(this.element, "keydown", function (a) {
      if (!a.altKey && (a.ctrlKey || a.metaKey)) {
        var b = a.keyCode, k = 90 === b && a.shiftKey || 89 === b;
        90 !== b || a.shiftKey ? k && (d.redo(), a.preventDefault()) :
          (d.undo(), a.preventDefault())
      }
    });
    a.observe(this.element, "keydown", function (a) {
      a = a.keyCode;
      a !== b && (b = a, 8 !== a && 46 !== a || d.transact())
    });
    this.editor.on("newword:composer",function () {
      d.transact()
    }).on("beforecommand:composer", function () {
      d.transact()
    })
  }, transact: function () {
    var a = this.historyStr[this.position - 1], b = this.composer.getValue();
    if (b !== a) {
      25 < (this.historyStr.length = this.historyDom.length = this.position) && (this.historyStr.shift(), this.historyDom.shift(), this.position--);
      this.position++;
      var e = this.composer.selection.getRange(),
        a = e && e.startContainer ? e.startContainer : this.element, g = e && e.startOffset ? e.startOffset : 0, k;
      a.nodeType === d.ELEMENT_NODE ? e = a : (e = a.parentNode, k = this.getChildNodeIndex(e, a));
      e.setAttribute("data-wysihtml5-selection-offset", g);
      "undefined" !== typeof k && e.setAttribute("data-wysihtml5-selection-node", k);
      k = this.element.cloneNode(!!b);
      this.historyDom.push(k);
      this.historyStr.push(b);
      e.removeAttribute("data-wysihtml5-selection-offset");
      e.removeAttribute("data-wysihtml5-selection-node")
    }
  }, undo: function () {
    this.transact();
    this.undoPossible() && (this.set(this.historyDom[--this.position - 1]), this.editor.fire("undo:composer"))
  }, redo: function () {
    this.redoPossible() && (this.set(this.historyDom[++this.position - 1]), this.editor.fire("redo:composer"))
  }, undoPossible: function () {
    return 1 < this.position
  }, redoPossible: function () {
    return this.position < this.historyStr.length
  }, set: function (a) {
    this.element.innerHTML = "";
    for (var b = 0, e = a.childNodes, d = a.childNodes.length; b < d; b++)this.element.appendChild(e[b].cloneNode(!0));
    a.hasAttribute("data-wysihtml5-selection-offset") ?
      (b = a.getAttribute("data-wysihtml5-selection-offset"), e = a.getAttribute("data-wysihtml5-selection-node"), a = this.element) : (a = this.element.querySelector("[data-wysihtml5-selection-offset]") || this.element, b = a.getAttribute("data-wysihtml5-selection-offset"), e = a.getAttribute("data-wysihtml5-selection-node"), a.removeAttribute("data-wysihtml5-selection-offset"), a.removeAttribute("data-wysihtml5-selection-node"));
    null !== e && (a = this.getChildNodeByIndex(a, +e));
    this.composer.selection.set(a, b)
  }, getChildNodeIndex: function (a, b) {
    for (var e = 0, d = a.childNodes, k = d.length; e < k; e++)if (d[e] === b)return e
  }, getChildNodeByIndex: function (a, b) {
    return a.childNodes[b]
  }})
})(wysihtml5);
wysihtml5.views.View = Base.extend({constructor: function (d, a, f) {
  this.parent = d;
  this.element = a;
  this.config = f;
  this.config.noTextarea || this._observeViewChange()
}, _observeViewChange: function () {
  var d = this;
  this.parent.on("beforeload", function () {
    d.parent.on("change_view", function (a) {
      a === d.name ? (d.parent.currentView = d, d.show(), setTimeout(function () {
        d.focus()
      }, 0)) : d.hide()
    })
  })
}, focus: function () {
  if (this.element.ownerDocument.querySelector(":focus") !== this.element)try {
    this.element.focus()
  } catch (d) {
  }
}, hide: function () {
  this.element.style.display =
    "none"
}, show: function () {
  this.element.style.display = ""
}, disable: function () {
  this.element.setAttribute("disabled", "disabled")
}, enable: function () {
  this.element.removeAttribute("disabled")
}});
(function (d) {
  var a = d.dom, f = d.browser;
  d.views.Composer = d.views.View.extend({name: "composer", CARET_HACK: "<br>", constructor: function (a, e, d) {
    this.base(a, e, d);
    this.config.noTextarea ? this.editableArea = e : this.textarea = this.parent.textarea;
    this.config.contentEditableMode ? this._initContentEditableArea() : this._initSandbox()
  }, clear: function () {
    this.element.innerHTML = f.displaysCaretInEmptyContentEditableCorrectly() ? "" : this.CARET_HACK
  }, getValue: function (a) {
    var e = this.isEmpty() ? "" : d.quirks.getCorrectInnerHTML(this.element);
    a && (e = this.parent.parse(e));
    return e
  }, setValue: function (a, e) {
    e && (a = this.parent.parse(a));
    try {
      this.element.innerHTML = a
    } catch (d) {
      this.element.innerText = a
    }
  }, cleanUp: function () {
    this.parent.parse(this.element)
  }, show: function () {
    this.editableArea.style.display = this._displayStyle || "";
    this.config.noTextarea || this.textarea.element.disabled || (this.disable(), this.enable())
  }, hide: function () {
    this._displayStyle = a.getStyle("display").from(this.editableArea);
    "none" === this._displayStyle && (this._displayStyle = null);
    this.editableArea.style.display = "none"
  }, disable: function () {
    this.parent.fire("disable:composer");
    this.element.removeAttribute("contentEditable")
  }, enable: function () {
    this.parent.fire("enable:composer");
    this.element.setAttribute("contentEditable", "true")
  }, focus: function (a) {
    d.browser.doesAsyncFocus() && this.hasPlaceholderSet() && this.clear();
    this.base();
    var e = this.element.lastChild;
    a && e && this.selection && ("BR" === e.nodeName ? this.selection.setBefore(this.element.lastChild) : this.selection.setAfter(this.element.lastChild))
  },
    getTextContent: function () {
      return a.getTextContent(this.element)
    }, hasPlaceholderSet: function () {
      return this.getTextContent() == (this.config.noTextarea ? this.editableArea.getAttribute("data-placeholder") : this.textarea.element.getAttribute("placeholder")) && this.placeholderSet
    }, isEmpty: function () {
      var a = this.element.innerHTML.toLowerCase();
      return"" === a || "<br>" === a || "<p></p>" === a || "<p><br></p>" === a || this.hasPlaceholderSet()
    }, _initContentEditableArea: function () {
      var b = this;
      this.config.noTextarea ? this.sandbox =
        new a.ContentEditableArea(function () {
          b._create()
        }, {}, this.editableArea) : (this.sandbox = new a.ContentEditableArea(function () {
        b._create()
      }), this.editableArea = this.sandbox.getContentEditable(), a.insert(this.editableArea).after(this.textarea.element), this._createWysiwygFormField())
    }, _initSandbox: function () {
      var b = this;
      this.sandbox = new a.Sandbox(function () {
        b._create()
      }, {stylesheets: this.config.stylesheets});
      this.editableArea = this.sandbox.getIframe();
      var e = this.textarea.element;
      a.insert(this.editableArea).after(e);
      this._createWysiwygFormField()
    }, _createWysiwygFormField: function () {
      if (this.textarea.element.form) {
        var b = document.createElement("input");
        b.type = "hidden";
        b.name = "_wysihtml5_mode";
        b.value = 1;
        a.insert(b).after(this.textarea.element)
      }
    }, _create: function () {
      var b = this;
      this.doc = this.sandbox.getDocument();
      this.element = this.config.contentEditableMode ? this.sandbox.getContentEditable() : this.doc.body;
      this.config.noTextarea ? this.cleanUp() : (this.textarea = this.parent.textarea, this.element.innerHTML = this.textarea.getValue(!0));
      this.selection = new d.Selection(this.parent, this.element, this.config.uneditableContainerClassname);
      this.commands = new d.Commands(this.parent);
      this.config.noTextarea || a.copyAttributes("className spellcheck title lang dir accessKey".split(" ")).from(this.textarea.element).to(this.element);
      a.addClass(this.element, this.config.composerClassName);
      this.config.style && !this.config.contentEditableMode && this.style();
      this.observe();
      var e = this.config.name;
      e && (a.addClass(this.element, e), this.config.contentEditableMode ||
        a.addClass(this.editableArea, e));
      this.enable();
      !this.config.noTextarea && this.textarea.element.disabled && this.disable();
      (e = "string" === typeof this.config.placeholder ? this.config.placeholder : this.config.noTextarea ? this.editableArea.getAttribute("data-placeholder") : this.textarea.element.getAttribute("placeholder")) && a.simulatePlaceholder(this.parent, this, e);
      this.commands.exec("styleWithCSS", !1);
      this._initAutoLinking();
      this._initObjectResizing();
      this._initUndoManager();
      this._initLineBreaking();
      this.config.noTextarea ||
        !this.textarea.element.hasAttribute("autofocus") && document.querySelector(":focus") != this.textarea.element || f.isIos() || setTimeout(function () {
        b.focus(!0)
      }, 100);
      f.clearsContentEditableCorrectly() || d.quirks.ensureProperClearing(this);
      this.initSync && this.config.sync && this.initSync();
      this.config.noTextarea || this.textarea.hide();
      this.parent.fire("beforeload").fire("load")
    }, _initAutoLinking: function () {
      var b = this, e = f.canDisableAutoLinking(), g = f.doesAutoLinkingInContentEditable();
      e && this.commands.exec("autoUrlDetect",
        !1);
      if (this.config.autoLink) {
        if (!g || g && e)this.parent.on("newword:composer", function () {
          a.getTextContent(b.element).match(a.autoLink.URL_REG_EXP) && b.selection.executeAndRestore(function (b, e) {
            a.autoLink(e.parentNode)
          })
        }), a.observe(this.element, "blur", function () {
          a.autoLink(b.element)
        });
        var k = this.sandbox.getDocument().getElementsByTagName("a"), h = a.autoLink.URL_REG_EXP, l = function (b) {
          b = d.lang.string(a.getTextContent(b)).trim();
          "www." === b.substr(0, 4) && (b = "http://" + b);
          return b
        };
        a.observe(this.element, "keydown",
          function (e) {
            if (k.length) {
              e = b.selection.getSelectedNode(e.target.ownerDocument);
              var d = a.getParentElement(e, {nodeName: "A"}, 4), f;
              d && (f = l(d), setTimeout(function () {
                var a = l(d);
                a !== f && a.match(h) && d.setAttribute("href", a)
              }, 0))
            }
          })
      }
    }, _initObjectResizing: function () {
      this.commands.exec("enableObjectResizing", !0);
      if (f.supportsEvent("resizeend")) {
        var b = ["width", "height"], e = b.length, g = this.element;
        a.observe(g, "resizeend", function (a) {
          a = a.target || a.srcElement;
          var f = a.style, l = 0, n;
          if ("IMG" === a.nodeName) {
            for (; l < e; l++)n =
              b[l], f[n] && (a.setAttribute(n, parseInt(f[n], 10)), f[n] = "");
            d.quirks.redraw(g)
          }
        })
      }
    }, _initUndoManager: function () {
      this.undoManager = new d.UndoManager(this.parent)
    }, _initLineBreaking: function () {
      function b(b) {
        var d = a.getParentElement(b, {nodeName: ["P", "DIV"]}, 2);
        d && a.contains(e.element, d) && e.selection.executeAndRestore(function () {
          e.config.useLineBreaks ? a.replaceWithChildNodes(d) : "P" !== d.nodeName && a.renameElement(d, "p")
        })
      }

      var e = this, g = "LI P H1 H2 H3 H4 H5 H6".split(" "), k = ["UL", "OL", "MENU"];
      this.config.useLineBreaks ||
      a.observe(this.element, ["focus", "keydown"], function () {
        if (e.isEmpty()) {
          var a = e.doc.createElement("P");
          e.element.innerHTML = "";
          e.element.appendChild(a);
          f.displaysCaretInEmptyContentEditableCorrectly() ? e.selection.selectNode(a, !0) : (a.innerHTML = "<br>", e.selection.setBefore(a.firstChild))
        }
      });
      a.observe(this.element, "keydown", function (f) {
        var l = f.keyCode;
        if (!f.shiftKey && (l === d.ENTER_KEY || l === d.BACKSPACE_KEY)) {
          var n = a.getParentElement(e.selection.getSelectedNode(), {nodeName: g}, 4);
          n ? setTimeout(function () {
            var f =
              e.selection.getSelectedNode(), g;
            if ("LI" === n.nodeName) {
              if (!f)return;
              (g = a.getParentElement(f, {nodeName: k}, 2)) || b(f)
            }
            l === d.ENTER_KEY && n.nodeName.match(/^H[1-6]$/) && b(f)
          }, 0) : e.config.useLineBreaks && l === d.ENTER_KEY && !d.browser.insertsLineBreaksOnReturn() && (f.preventDefault(), e.commands.exec("insertLineBreak"))
        }
      })
    }})
})(wysihtml5);
(function (d) {
  var a = d.dom, f = document, b = window, e = f.createElement("div"), g = "background-color color cursor font-family font-size font-style font-variant font-weight line-height letter-spacing text-align text-decoration text-indent text-rendering word-break word-wrap word-spacing".split(" "), k = "background-color border-collapse border-bottom-color border-bottom-style border-bottom-width border-left-color border-left-style border-left-width border-right-color border-right-style border-right-width border-top-color border-top-style border-top-width clear display float margin-bottom margin-left margin-right margin-top outline-color outline-offset outline-width outline-style padding-left padding-right padding-top padding-bottom position top left right bottom z-index vertical-align text-align -webkit-box-sizing -moz-box-sizing -ms-box-sizing box-sizing -webkit-box-shadow -moz-box-shadow -ms-box-shadow box-shadow -webkit-border-top-right-radius -moz-border-radius-topright border-top-right-radius -webkit-border-bottom-right-radius -moz-border-radius-bottomright border-bottom-right-radius -webkit-border-bottom-left-radius -moz-border-radius-bottomleft border-bottom-left-radius -webkit-border-top-left-radius -moz-border-radius-topleft border-top-left-radius width height".split(" "),
    h = ["html                 { height: 100%; }", "body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }", "body > p:first-child { margin-top: 0; }", "._wysihtml5-temp     { display: none; }", d.browser.isGecko ? "body.placeholder { color: graytext !important; }" : "body.placeholder { color: #a9a9a9 !important; }", "img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"], l = function (e) {
      if (e.setActive)try {
        e.setActive()
      } catch (d) {
      } else {
        var g = e.style, h = f.documentElement.scrollTop ||
          f.body.scrollTop, k = f.documentElement.scrollLeft || f.body.scrollLeft, g = {position: g.position, top: g.top, left: g.left, WebkitUserSelect: g.WebkitUserSelect};
        a.setStyles({position: "absolute", top: "-99999px", left: "-99999px", WebkitUserSelect: "none"}).on(e);
        e.focus();
        a.setStyles(g).on(e);
        b.scrollTo && b.scrollTo(k, h)
      }
    };
  d.views.Composer.prototype.style = function () {
    var b = this, m = f.querySelector(":focus"), s = this.textarea.element, r = s.hasAttribute("placeholder"), t = r && s.getAttribute("placeholder"), v = s.style.display, p = s.disabled,
      x;
    this.focusStylesHost = e.cloneNode(!1);
    this.blurStylesHost = e.cloneNode(!1);
    this.disabledStylesHost = e.cloneNode(!1);
    r && s.removeAttribute("placeholder");
    s === m && s.blur();
    s.disabled = !1;
    s.style.display = x = "none";
    if (s.getAttribute("rows") && "auto" === a.getStyle("height").from(s) || s.getAttribute("cols") && "auto" === a.getStyle("width").from(s))s.style.display = x = v;
    a.copyStyles(k).from(s).to(this.editableArea).andTo(this.blurStylesHost);
    a.copyStyles(g).from(s).to(this.element).andTo(this.blurStylesHost);
    a.insertCSS(h).into(this.element.ownerDocument);
    s.disabled = !0;
    a.copyStyles(k).from(s).to(this.disabledStylesHost);
    a.copyStyles(g).from(s).to(this.disabledStylesHost);
    s.disabled = p;
    s.style.display = v;
    l(s);
    s.style.display = x;
    a.copyStyles(k).from(s).to(this.focusStylesHost);
    a.copyStyles(g).from(s).to(this.focusStylesHost);
    s.style.display = v;
    a.copyStyles(["display"]).from(s).to(this.editableArea);
    var B = d.lang.array(k).without(["display"]);
    m ? m.focus() : s.blur();
    r && s.setAttribute("placeholder", t);
    this.parent.on("focus:composer", function () {
      a.copyStyles(B).from(b.focusStylesHost).to(b.editableArea);
      a.copyStyles(g).from(b.focusStylesHost).to(b.element)
    });
    this.parent.on("blur:composer", function () {
      a.copyStyles(B).from(b.blurStylesHost).to(b.editableArea);
      a.copyStyles(g).from(b.blurStylesHost).to(b.element)
    });
    this.parent.observe("disable:composer", function () {
      a.copyStyles(B).from(b.disabledStylesHost).to(b.editableArea);
      a.copyStyles(g).from(b.disabledStylesHost).to(b.element)
    });
    this.parent.observe("enable:composer", function () {
      a.copyStyles(B).from(b.blurStylesHost).to(b.editableArea);
      a.copyStyles(g).from(b.blurStylesHost).to(b.element)
    });
    return this
  }
})(wysihtml5);
(function (d) {
  var a = d.dom, f = d.browser, b = {66: "bold", 73: "italic", 85: "underline"};
  d.views.Composer.prototype.observe = function () {
    var e = this, g = this.getValue(), k = this.sandbox.getIframe ? this.sandbox.getIframe() : this.sandbox.getContentEditable(), h = this.element, l = f.supportsEventsInIframeCorrectly() || this.sandbox.getContentEditable ? h : this.sandbox.getWindow();
    a.observe(k, "DOMNodeRemoved", function () {
      clearInterval(n);
      e.parent.fire("destroy:composer")
    });
    if (!f.supportsMutationEvents())var n = setInterval(function () {
      a.contains(document.documentElement,
        k) || (clearInterval(n), e.parent.fire("destroy:composer"))
    }, 250);
    a.observe(l, ["drop", "paste", "mouseup", "focus", "keyup"], function () {
      setTimeout(function () {
        e.parent.fire("interaction").fire("interaction:composer")
      }, 0)
    });
    this.config.handleTables && (this.tableSelection = d.quirks.tableCellsSelection(h, e.parent));
    a.observe(l, "focus", function () {
      e.parent.fire("focus").fire("focus:composer");
      setTimeout(function () {
        g = e.getValue()
      }, 0)
    });
    a.observe(l, "blur", function () {
      g !== e.getValue() && e.parent.fire("change").fire("change:composer");
      e.parent.fire("blur").fire("blur:composer")
    });
    a.observe(h, "dragenter", function () {
      e.parent.fire("unset_placeholder")
    });
    a.observe(h, ["drop", "paste"], function () {
      setTimeout(function () {
        e.parent.fire("paste").fire("paste:composer")
      }, 0)
    });
    a.observe(h, "keyup", function (a) {
      a = a.keyCode;
      a !== d.SPACE_KEY && a !== d.ENTER_KEY || e.parent.fire("newword:composer")
    });
    this.parent.on("paste:composer", function () {
      setTimeout(function () {
        e.parent.fire("newword:composer")
      }, 0)
    });
    f.canSelectImagesInContentEditable() || a.observe(h,
      "mousedown", function (a) {
        a = a.target;
        var b = h.querySelectorAll("img"), f = h.querySelectorAll("." + e.config.uneditableContainerClassname + " img"), b = d.lang.array(b).without(f);
        "IMG" === a.nodeName && d.lang.array(b).contains(a) && e.selection.selectNode(a)
      });
    f.canSelectImagesInContentEditable() || a.observe(h, "drop", function (a) {
      setTimeout(function () {
        e.selection.getSelection().removeAllRanges()
      }, 0)
    });
    f.hasHistoryIssue() && f.supportsSelectionModify() && a.observe(h, "keydown", function (a) {
      if (a.metaKey || a.ctrlKey) {
        var b =
          a.keyCode, e = h.ownerDocument.defaultView.getSelection();
        if (37 === b || 39 === b)37 === b && (e.modify("extend", "left", "lineboundary"), a.shiftKey || e.collapseToStart()), 39 === b && (e.modify("extend", "right", "lineboundary"), a.shiftKey || e.collapseToEnd()), a.preventDefault()
      }
    });
    a.observe(h, "keydown", function (a) {
      var d = a.keyCode, f = b[d];
      (a.ctrlKey || a.metaKey) && !a.altKey && f && (e.commands.exec(f), a.preventDefault());
      if (8 == d)if (e.selection.isCollapsed())if (e.selection.caretIsInTheBeginnig())a.preventDefault(); else {
        if (d = e.selection.caretIsBeforeUneditable())if (a.preventDefault(),
          a = e.selection.getPreviousNode(d, !0), f = e.selection.getSelectedNode(), 1 !== f.nodeType && f.parentNode !== h && (f = f.parentNode), a)if (1 == f.nodeType) {
          var g = f.firstChild;
          if (1 == a.nodeType)for (; f.firstChild;)a.appendChild(f.firstChild); else for (; f.firstChild;)d.parentNode.insertBefore(f.firstChild, d);
          f.parentNode && f.parentNode.removeChild(f);
          e.selection.setBefore(g)
        } else 1 == a.nodeType ? a.appendChild(f) : d.parentNode.insertBefore(f, d), e.selection.setBefore(f)
      } else e.selection.containsUneditable() && (a.preventDefault(),
        e.selection.deleteContents())
    });
    a.observe(h, "keydown", function (a) {
      var b = e.selection.getSelectedNode(!0), f = a.keyCode;
      !b || "IMG" !== b.nodeName || f !== d.BACKSPACE_KEY && f !== d.DELETE_KEY || (f = b.parentNode, f.removeChild(b), "A" !== f.nodeName || f.firstChild || f.parentNode.removeChild(f), setTimeout(function () {
        d.quirks.redraw(h)
      }, 0), a.preventDefault())
    });
    !this.config.contentEditableMode && f.hasIframeFocusIssue() && (a.observe(this.iframe, "focus", function () {
      setTimeout(function () {
        e.doc.querySelector(":focus") !== e.element &&
        e.focus()
      }, 0)
    }), a.observe(this.element, "blur", function () {
      setTimeout(function () {
        e.selection.getSelection().removeAllRanges()
      }, 0)
    }));
    var m = {IMG: "Image: ", A: "Link: "};
    a.observe(h, "mouseover", function (a) {
      a = a.target;
      var b = a.nodeName;
      "A" !== b && "IMG" !== b || a.hasAttribute("title") || (b = m[b] + (a.getAttribute("href") || a.getAttribute("src")), a.setAttribute("title", b))
    })
  }
})(wysihtml5);
(function (d) {
  d.views.Synchronizer = Base.extend({constructor: function (a, d, b) {
    this.editor = a;
    this.textarea = d;
    this.composer = b;
    this._observe()
  }, fromComposerToTextarea: function (a) {
    this.textarea.setValue(d.lang.string(this.composer.getValue()).trim(), a)
  }, fromTextareaToComposer: function (a) {
    var d = this.textarea.getValue();
    d ? this.composer.setValue(d, a) : (this.composer.clear(), this.editor.fire("set_placeholder"))
  }, sync: function (a) {
    "textarea" === this.editor.currentView.name ? this.fromTextareaToComposer(a) : this.fromComposerToTextarea(a)
  },
    _observe: function () {
      var a, f = this, b = this.textarea.element.form, e = function () {
        a = setInterval(function () {
          f.fromComposerToTextarea()
        }, 400)
      }, g = function () {
        clearInterval(a);
        a = null
      };
      e();
      b && (d.dom.observe(b, "submit", function () {
        f.sync(!0)
      }), d.dom.observe(b, "reset", function () {
        setTimeout(function () {
          f.fromTextareaToComposer()
        }, 0)
      }));
      this.editor.on("change_view", function (b) {
        "composer" !== b || a ? "textarea" === b && (f.fromComposerToTextarea(!0), g()) : (f.fromTextareaToComposer(!0), e())
      });
      this.editor.on("destroy:composer",
        g)
    }})
})(wysihtml5);
wysihtml5.views.Textarea = wysihtml5.views.View.extend({name: "textarea", constructor: function (d, a, f) {
  this.base(d, a, f);
  this._observe()
}, clear: function () {
  this.element.value = ""
}, getValue: function (d) {
  var a = this.isEmpty() ? "" : this.element.value;
  d && (a = this.parent.parse(a));
  return a
}, setValue: function (d, a) {
  a && (d = this.parent.parse(d));
  this.element.value = d
}, cleanUp: function () {
  var d = this.parent.parse(this.element.value);
  this.element.value = d
}, hasPlaceholderSet: function () {
  var d = wysihtml5.browser.supportsPlaceholderAttributeOn(this.element), a =
    this.element.getAttribute("placeholder") || null, f = this.element.value;
  return d && !f || f === a
}, isEmpty: function () {
  return!wysihtml5.lang.string(this.element.value).trim() || this.hasPlaceholderSet()
}, _observe: function () {
  var d = this.element, a = this.parent, f = {focusin: "focus", focusout: "blur"}, b = wysihtml5.browser.supportsEvent("focusin") ? ["focusin", "focusout", "change"] : ["focus", "blur", "change"];
  a.on("beforeload", function () {
    wysihtml5.dom.observe(d, b, function (b) {
      b = f[b.type] || b.type;
      a.fire(b).fire(b + ":textarea")
    });
    wysihtml5.dom.observe(d, ["paste", "drop"], function () {
      setTimeout(function () {
        a.fire("paste").fire("paste:textarea")
      }, 0)
    })
  })
}});
(function (d) {
  var a = d.dom;
  d.toolbar.Dialog = d.lang.Dispatcher.extend({constructor: function (a, b) {
    this.link = a;
    this.container = b
  }, _observe: function () {
    if (!this._observed) {
      var f = this, b = function (a) {
        var b = f._serialize();
        b == f.elementToChange ? f.fire("edit", b) : f.fire("save", b);
        f.hide();
        a.preventDefault();
        a.stopPropagation()
      };
      a.observe(f.link, "click", function () {
        a.hasClass(f.link, "wysihtml5-command-dialog-opened") && setTimeout(function () {
          f.hide()
        }, 0)
      });
      a.observe(this.container, "keydown", function (a) {
        var e = a.keyCode;
        e === d.ENTER_KEY && b(a);
        e === d.ESCAPE_KEY && (f.fire("cancel"), f.hide())
      });
      a.delegate(this.container, "[data-wysihtml5-dialog-action=save]", "click", b);
      a.delegate(this.container, "[data-wysihtml5-dialog-action=cancel]", "click", function (a) {
        f.fire("cancel");
        f.hide();
        a.preventDefault();
        a.stopPropagation()
      });
      for (var e = this.container.querySelectorAll("input, select, textarea"), g = 0, k = e.length, h = function () {
        clearInterval(f.interval)
      }; g < k; g++)a.observe(e[g], "change", h);
      this._observed = !0
    }
  }, _serialize: function () {
    for (var a =
      this.elementToChange || {}, b = this.container.querySelectorAll("[data-wysihtml5-dialog-field]"), e = b.length, d = 0; d < e; d++)a[b[d].getAttribute("data-wysihtml5-dialog-field")] = b[d].value;
    return a
  }, _interpolate: function (a) {
    for (var b, e, d = document.querySelector(":focus"), k = this.container.querySelectorAll("[data-wysihtml5-dialog-field]"), h = k.length, l = 0; l < h; l++)b = k[l], b === d || a && "hidden" === b.type || (e = b.getAttribute("data-wysihtml5-dialog-field"), e = this.elementToChange ? this.elementToChange.getAttribute(e) || "" : b.defaultValue,
      b.value = e)
  }, show: function (d) {
    if (!a.hasClass(this.link, "wysihtml5-command-dialog-opened")) {
      var b = this, e = this.container.querySelector("input, select, textarea");
      this.elementToChange = d;
      this._observe();
      this._interpolate();
      d && (this.interval = setInterval(function () {
        b._interpolate(!0)
      }, 500));
      a.addClass(this.link, "wysihtml5-command-dialog-opened");
      this.container.style.display = "";
      this.fire("show");
      if (e && !d)try {
        e.focus()
      } catch (g) {
      }
    }
  }, hide: function () {
    clearInterval(this.interval);
    this.elementToChange = null;
    a.removeClass(this.link,
      "wysihtml5-command-dialog-opened");
    this.container.style.display = "none";
    this.fire("hide")
  }})
})(wysihtml5);
(function (d) {
  var a = d.dom, f = {position: "relative"}, b = {left: 0, margin: 0, opacity: 0, overflow: "hidden", padding: 0, position: "absolute", top: 0, zIndex: 1}, e = {cursor: "inherit", fontSize: "50px", height: "50px", marginTop: "-25px", outline: 0, padding: 0, position: "absolute", right: "-4px", top: "50%"}, g = {"x-webkit-speech": "", speech: ""};
  d.toolbar.Speech = function (k, h) {
    var l = document.createElement("input");
    if (d.browser.supportsSpeechApiOn(l)) {
      var n = k.editor.textarea.element.getAttribute("lang");
      n && (g.lang = n);
      n = document.createElement("div");
      d.lang.object(b).merge({width: h.offsetWidth + "px", height: h.offsetHeight + "px"});
      a.insert(l).into(n);
      a.insert(n).into(h);
      a.setStyles(e).on(l);
      a.setAttributes(g).on(l);
      a.setStyles(b).on(n);
      a.setStyles(f).on(h);
      a.observe(l, "onwebkitspeechchange"in l ? "webkitspeechchange" : "speechchange", function () {
        k.execCommand("insertText", l.value);
        l.value = ""
      });
      a.observe(l, "click", function (b) {
        a.hasClass(h, "wysihtml5-command-disabled") && b.preventDefault();
        b.stopPropagation()
      })
    } else h.style.display = "none"
  }
})(wysihtml5);
(function (d) {
  var a = d.dom;
  d.toolbar.Toolbar = Base.extend({constructor: function (a, b, e) {
    this.editor = a;
    this.container = "string" === typeof b ? document.getElementById(b) : b;
    this.composer = a.composer;
    this._getLinks("command");
    this._getLinks("action");
    this._observe();
    e && this.show();
    a = this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]");
    b = a.length;
    for (e = 0; e < b; e++)new d.toolbar.Speech(this, a[e])
  }, _getLinks: function (a) {
    for (var b = this[a + "Links"] = d.lang.array(this.container.querySelectorAll("[data-wysihtml5-" +
      a + "]")).get(), e = b.length, g = 0, k = this[a + "Mapping"] = {}, h, l, n, m, s; g < e; g++)h = b[g], n = h.getAttribute("data-wysihtml5-" + a), m = h.getAttribute("data-wysihtml5-" + a + "-value"), l = this.container.querySelector("[data-wysihtml5-" + a + "-group='" + n + "']"), s = this._getDialog(h, n), k[n + ":" + m] = {link: h, group: l, name: n, value: m, dialog: s, state: !1}
  }, _getDialog: function (a, b) {
    var e = this, g = this.container.querySelector("[data-wysihtml5-dialog='" + b + "']"), k, h;
    g && (k = d.toolbar["Dialog_" + b] ? new d.toolbar["Dialog_" + b](a, g) : new d.toolbar.Dialog(a,
      g), k.on("show", function () {
      h = e.composer.selection.getBookmark();
      e.editor.fire("show:dialog", {command: b, dialogContainer: g, commandLink: a})
    }), k.on("save", function (d) {
      h && e.composer.selection.setBookmark(h);
      e._execCommand(b, d);
      e.editor.fire("save:dialog", {command: b, dialogContainer: g, commandLink: a})
    }), k.on("cancel", function () {
      e.editor.focus(!1);
      e.editor.fire("cancel:dialog", {command: b, dialogContainer: g, commandLink: a})
    }));
    return k
  }, execCommand: function (a, b) {
    if (!this.commandsDisabled) {
      var e = this.commandMapping[a +
        ":" + b];
      e && e.dialog && !e.state ? e.dialog.show() : this._execCommand(a, b)
    }
  }, _execCommand: function (a, b) {
    this.editor.focus(!1);
    this.composer.commands.exec(a, b);
    this._updateLinkStates()
  }, execAction: function (a) {
    var b = this.editor;
    "change_view" === a && b.textarea && (b.currentView === b.textarea ? b.fire("change_view", "composer") : b.fire("change_view", "textarea"));
    "showSource" == a && b.fire("showSource")
  }, _observe: function () {
    for (var d = this, b = this.editor, e = this.container, g = this.commandLinks.concat(this.actionLinks), k = g.length,
           h = 0; h < k; h++)if ("A" === g[h].nodeName)a.setAttributes({href: "javascript:;", unselectable: "on"}).on(g[h]); else a.setAttributes({unselectable: "on"}).on(g[h]);
    a.delegate(e, "[data-wysihtml5-command], [data-wysihtml5-action]", "mousedown", function (a) {
      a.preventDefault()
    });
    a.delegate(e, "[data-wysihtml5-command]", "click", function (a) {
      var b = this.getAttribute("data-wysihtml5-command"), e = this.getAttribute("data-wysihtml5-command-value");
      d.execCommand(b, e);
      a.preventDefault()
    });
    a.delegate(e, "[data-wysihtml5-action]",
      "click", function (a) {
        var b = this.getAttribute("data-wysihtml5-action");
        d.execAction(b);
        a.preventDefault()
      });
    b.on("interaction:composer", function () {
      d._updateLinkStates()
    });
    b.on("focus:composer", function () {
      d.bookmark = null
    });
    this.editor.config.handleTables && (b.on("tableselect:composer", function () {
      d.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display = ""
    }), b.on("tableunselect:composer", function () {
      d.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display =
        "none"
    }));
    b.on("change_view", function (g) {
      b.textarea && setTimeout(function () {
        d.commandsDisabled = "composer" !== g;
        d._updateLinkStates();
        d.commandsDisabled ? a.addClass(e, "wysihtml5-commands-disabled") : a.removeClass(e, "wysihtml5-commands-disabled")
      }, 0)
    })
  }, _updateLinkStates: function () {
    var f = this.commandMapping, b = this.actionMapping, e, g, k;
    for (e in f)k = f[e], this.commandsDisabled ? (g = !1, a.removeClass(k.link, "wysihtml5-command-active"), k.group && a.removeClass(k.group, "wysihtml5-command-active"), k.dialog && k.dialog.hide()) :
      (g = this.composer.commands.state(k.name, k.value), a.removeClass(k.link, "wysihtml5-command-disabled"), k.group && a.removeClass(k.group, "wysihtml5-command-disabled")), k.state !== g && ((k.state = g) ? (a.addClass(k.link, "wysihtml5-command-active"), k.group && a.addClass(k.group, "wysihtml5-command-active"), k.dialog && ("object" === typeof g || d.lang.object(g).isArray() ? (!k.dialog.multiselect && d.lang.object(g).isArray() && (g = 1 === g.length ? g[0] : !0, k.state = g), k.dialog.show(g)) : k.dialog.hide())) : (a.removeClass(k.link, "wysihtml5-command-active"),
      k.group && a.removeClass(k.group, "wysihtml5-command-active"), k.dialog && k.dialog.hide()));
    for (e in b)f = b[e], "change_view" === f.name && (f.state = this.editor.currentView === this.editor.textarea, f.state ? a.addClass(f.link, "wysihtml5-action-active") : a.removeClass(f.link, "wysihtml5-action-active"))
  }, show: function () {
    this.container.style.display = ""
  }, hide: function () {
    this.container.style.display = "none"
  }})
})(wysihtml5);
(function (d) {
  d.toolbar.Dialog_createTable = d.toolbar.Dialog.extend({show: function (a) {
    this.base(a)
  }})
})(wysihtml5);
(function (d) {
  d.toolbar.Dialog_foreColorStyle = d.toolbar.Dialog.extend({multiselect: !0, _serialize: function () {
    for (var a = {}, d = this.container.querySelectorAll("[data-wysihtml5-dialog-field]"), b = d.length, e = 0; e < b; e++)a[d[e].getAttribute("data-wysihtml5-dialog-field")] = d[e].value;
    return a
  }, _interpolate: function (a) {
    for (var f, b = document.querySelector(":focus"), e = this.container.querySelectorAll("[data-wysihtml5-dialog-field]"), g = e.length, k = 0, h = (f = (f = this.elementToChange ? d.lang.object(this.elementToChange).isArray() ?
      this.elementToChange[0] : this.elementToChange : null) ? f.getAttribute("style") : null) ? d.quirks.styleParser.parseColor(f, "color") : null; k < g; k++)f = e[k], f === b || a && "hidden" === f.type || "color" !== f.getAttribute("data-wysihtml5-dialog-field") || (f.value = h ? h[3] && 1 != h[3] ? "rgba(" + h[0] + "," + h[1] + "," + h[2] + "," + h[3] + ");" : "rgb(" + h[0] + "," + h[1] + "," + h[2] + ");" : "rgb(0,0,0);")
  }})
})(wysihtml5);
(function (d) {
  d.toolbar.Dialog_fontSizeStyle = d.toolbar.Dialog.extend({multiselect: !0, _serialize: function () {
    return{size: this.container.querySelector('[data-wysihtml5-dialog-field="size"]').value}
  }, _interpolate: function (a) {
    a = document.querySelector(":focus");
    var f = this.container.querySelector("[data-wysihtml5-dialog-field='size']"), b = this.elementToChange ? d.lang.object(this.elementToChange).isArray() ? this.elementToChange[0] : this.elementToChange : null, b = (b = b ? b.getAttribute("style") : null) ? d.quirks.styleParser.parseFontSize(b) :
      null;
    f && f !== a && b && !/^\s*$/.test(b) && (f.value = b)
  }})
})(wysihtml5);
(function (d) {
  var a = {name: void 0, style: !0, toolbar: void 0, showToolbarAfterInit: !0, autoLink: !0, handleTables: !0, parserRules: {tags: {br: {}, span: {}, div: {}, p: {}}, classes: {}}, parser: d.dom.parse, composerClassName: "wysihtml5-editor", bodyClassName: "wysihtml5-supported", useLineBreaks: !0, stylesheets: [], placeholderText: void 0, supportTouchDevices: !0, cleanUp: !0, contentEditableMode: !1, xingAlert: !1, uneditableContainerClassname: "wysihtml5-uneditable-container"};
  d.Editor = d.lang.Dispatcher.extend({constructor: function (f, b) {
    this.editableElement = "string" === typeof f ? document.getElementById(f) : f;
    this.config = d.lang.object({}).merge(a).merge(b).get();
    this._isCompatible = d.browser.supported();
    "textarea" != this.editableElement.nodeName.toLowerCase() && (this.config.contentEditableMode = !0, this.config.noTextarea = !0);
    this.config.noTextarea || (this.currentView = this.textarea = new d.views.Textarea(this, this.editableElement, this.config));
    if (!this._isCompatible || !this.config.supportTouchDevices && d.browser.isTouchDevice()) {
      var e = this;
      setTimeout(function () {
        e.fire("beforeload").fire("load")
      }, 0)
    } else if (d.dom.addClass(document.body, this.config.bodyClassName), this.currentView = this.composer = new d.views.Composer(this, this.editableElement, this.config), "function" === typeof this.config.parser && this._initParser(), this.on("beforeload", this.handleBeforeLoad), this.config.xingAlert)try {
      console.log("Heya! This page is using wysihtml5 for rich text editing. Check out https://github.com/xing/wysihtml5")
    } catch (g) {
    }
  }, handleBeforeLoad: function () {
    this.config.noTextarea ||
    (this.synchronizer = new d.views.Synchronizer(this, this.textarea, this.composer));
    this.config.toolbar && (this.toolbar = new d.toolbar.Toolbar(this, this.config.toolbar, this.config.showToolbarAfterInit))
  }, isCompatible: function () {
    return this._isCompatible
  }, clear: function () {
    this.currentView.clear();
    return this
  }, getValue: function (a) {
    return this.currentView.getValue(a)
  }, setValue: function (a, b) {
    this.fire("unset_placeholder");
    if (!a)return this.clear();
    this.currentView.setValue(a, b);
    return this
  }, cleanUp: function () {
    this.currentView.cleanUp()
  },
    focus: function (a) {
      this.currentView.focus(a);
      return this
    }, disable: function () {
      this.currentView.disable();
      return this
    }, enable: function () {
      this.currentView.enable();
      return this
    }, isEmpty: function () {
      return this.currentView.isEmpty()
    }, hasPlaceholderSet: function () {
      return this.currentView.hasPlaceholderSet()
    }, parse: function (a) {
      var b = this.config.contentEditableMode ? document : this.composer.sandbox.getDocument(), b = this.config.parser(a, {rules: this.config.parserRules, cleanUp: this.config.cleanUp, context: b, uneditableClass: this.config.uneditableContainerClassname});
      "object" === typeof a && d.quirks.redraw(a);
      return b
    }, _initParser: function () {
      this.on("paste:composer", function () {
        var a = this;
        a.composer.selection.executeAndRestore(function () {
          d.quirks.cleanPastedHTML(a.composer.element);
          a.parse(a.composer.element)
        }, !0)
      })
    }})
})(wysihtml5);
define("wysihtml5", function (d) {
  return function () {
    return d.wysihtml5
  }
}(this));
var wysihtml5ParserRules = {classes: {"wysiwyg-clear-both": 1, "wysiwyg-clear-left": 1, "wysiwyg-clear-right": 1, "wysiwyg-color-aqua": 1, "wysiwyg-color-black": 1, "wysiwyg-color-blue": 1, "wysiwyg-color-fuchsia": 1, "wysiwyg-color-gray": 1, "wysiwyg-color-green": 1, "wysiwyg-color-lime": 1, "wysiwyg-color-maroon": 1, "wysiwyg-color-navy": 1, "wysiwyg-color-olive": 1, "wysiwyg-color-purple": 1, "wysiwyg-color-red": 1, "wysiwyg-color-silver": 1, "wysiwyg-color-teal": 1, "wysiwyg-color-white": 1, "wysiwyg-color-yellow": 1, "wysiwyg-float-left": 1,
  "wysiwyg-float-right": 1, "wysiwyg-font-size-large": 1, "wysiwyg-font-size-larger": 1, "wysiwyg-font-size-medium": 1, "wysiwyg-font-size-small": 1, "wysiwyg-font-size-smaller": 1, "wysiwyg-font-size-x-large": 1, "wysiwyg-font-size-x-small": 1, "wysiwyg-font-size-xx-large": 1, "wysiwyg-font-size-xx-small": 1, "wysiwyg-text-align-center": 1, "wysiwyg-text-align-justify": 1, "wysiwyg-text-align-left": 1, "wysiwyg-text-align-right": 1}, type_definitions: {alignment_object: {classes: {"wysiwyg-text-align-center": 1, "wysiwyg-text-align-justify": 1,
  "wysiwyg-text-align-left": 1, "wysiwyg-text-align-right": 1, "wysiwyg-float-left": 1, "wysiwyg-float-right": 1}, styles: {"float": ["left", "right"], textAlign: ["left", "right", "center"]}}, valid_image_src: {attrs: {src: /^[^data\:]/i}}, text_color_object: {styles: {color: !0, "background-color": !0}}, text_fontsize_object: {styles: {"font-size": !0}}, text_formatting_object: {classes: {"wysiwyg-color-aqua": 1, "wysiwyg-color-black": 1, "wysiwyg-color-blue": 1, "wysiwyg-color-fuchsia": 1, "wysiwyg-color-gray": 1, "wysiwyg-color-green": 1,
  "wysiwyg-color-lime": 1, "wysiwyg-color-maroon": 1, "wysiwyg-color-navy": 1, "wysiwyg-color-olive": 1, "wysiwyg-color-purple": 1, "wysiwyg-color-red": 1, "wysiwyg-color-silver": 1, "wysiwyg-color-teal": 1, "wysiwyg-color-white": 1, "wysiwyg-color-yellow": 1, "wysiwyg-font-size-large": 1, "wysiwyg-font-size-larger": 1, "wysiwyg-font-size-medium": 1, "wysiwyg-font-size-small": 1, "wysiwyg-font-size-smaller": 1, "wysiwyg-font-size-x-large": 1, "wysiwyg-font-size-x-small": 1, "wysiwyg-font-size-xx-large": 1, "wysiwyg-font-size-xx-small": 1}}},
  tags: {tr: {add_class: {align: "align_text"}}, strike: {unwrap: 1}, form: {unwrap: 1}, rt: {rename_tag: "span"}, code: {}, acronym: {rename_tag: "span"}, br: {add_class: {clear: "clear_br"}}, details: {unwrap: 1}, h4: {add_class: {align: "align_text"}}, em: {}, title: {remove: 1}, multicol: {unwrap: 1}, figure: {unwrap: 1}, xmp: {unwrap: 1}, small: {rename_tag: "span", set_class: "wysiwyg-font-size-smaller"}, area: {remove: 1}, time: {unwrap: 1}, dir: {rename_tag: "ul"}, bdi: {unwrap: 1}, command: {unwrap: 1}, ul: {}, progress: {rename_tag: "span"}, dfn: {unwrap: 1},
    iframe: {remove: 1}, figcaption: {unwrap: 1}, a: {check_attributes: {href: "href", target: "any"}, set_attributes: {rel: "nofollow"}}, img: {one_of_type: {valid_image_src: 1}, check_attributes: {width: "numbers", alt: "alt", src: "src", height: "numbers"}, add_class: {align: "align_img"}}, rb: {unwrap: 1}, footer: {rename_tag: "div"}, noframes: {remove: 1}, abbr: {unwrap: 1}, u: {}, bgsound: {remove: 1}, sup: {unwrap: 1}, address: {unwrap: 1}, basefont: {remove: 1}, nav: {unwrap: 1}, h1: {add_class: {align: "align_text"}}, head: {unwrap: 1}, tbody: {add_class: {align: "align_text"}},
    dd: {unwrap: 1}, s: {unwrap: 1}, li: {}, td: {check_attributes: {rowspan: "numbers", colspan: "numbers", valign: "any", align: "any"}, add_class: {align: "align_text"}}, object: {remove: 1}, div: {one_of_type: {alignment_object: 1}, remove_action: "unwrap", keep_styles: {textAlign: 1, "float": 1}, add_class: {align: "align_text"}}, option: {remove: 1}, select: {remove: 1}, i: {}, track: {remove: 1}, wbr: {remove: 1}, fieldset: {unwrap: 1}, big: {rename_tag: "span", set_class: "wysiwyg-font-size-larger"}, button: {unwrap: 1}, noscript: {remove: 1}, svg: {remove: 1},
    input: {remove: 1}, table: {}, keygen: {remove: 1}, h5: {add_class: {align: "align_text"}}, meta: {remove: 1}, map: {remove: 1}, isindex: {remove: 1}, mark: {unwrap: 1}, caption: {add_class: {align: "align_text"}}, tfoot: {add_class: {align: "align_text"}}, base: {remove: 1}, video: {remove: 1}, strong: {}, canvas: {remove: 1}, output: {unwrap: 1}, marquee: {unwrap: 1}, b: {}, q: {check_attributes: {cite: "url"}}, applet: {remove: 1}, span: {one_of_type: {text_formatting_object: 1, text_color_object: 1, text_fontsize_object: 1}, keep_styles: {color: 1, backgroundColor: 1,
      fontSize: 1}, remove_action: "unwrap"}, rp: {unwrap: 1}, spacer: {remove: 1}, source: {remove: 1}, aside: {rename_tag: "div"}, frame: {remove: 1}, section: {rename_tag: "div"}, body: {unwrap: 1}, ol: {}, nobr: {unwrap: 1}, html: {unwrap: 1}, summary: {unwrap: 1}, "var": {unwrap: 1}, del: {unwrap: 1}, blockquote: {check_attributes: {cite: "url"}}, style: {remove: 1}, device: {remove: 1}, meter: {unwrap: 1}, h3: {add_class: {align: "align_text"}}, textarea: {unwrap: 1}, embed: {remove: 1}, hgroup: {unwrap: 1}, font: {rename_tag: "span", add_class: {size: "size_font"}}, tt: {unwrap: 1},
    noembed: {remove: 1}, thead: {add_class: {align: "align_text"}}, blink: {unwrap: 1}, plaintext: {unwrap: 1}, xml: {remove: 1}, h6: {add_class: {align: "align_text"}}, param: {remove: 1}, th: {check_attributes: {rowspan: "numbers", colspan: "numbers"}, add_class: {align: "align_text"}}, legend: {unwrap: 1}, hr: {}, label: {unwrap: 1}, dl: {unwrap: 1}, kbd: {unwrap: 1}, listing: {unwrap: 1}, dt: {unwrap: 1}, nextid: {remove: 1}, pre: {}, center: {rename_tag: "div", set_class: "wysiwyg-text-align-center"}, audio: {remove: 1}, datalist: {unwrap: 1}, samp: {unwrap: 1}, col: {remove: 1},
    article: {rename_tag: "div"}, cite: {}, link: {remove: 1}, script: {remove: 1}, bdo: {unwrap: 1}, menu: {rename_tag: "ul"}, colgroup: {remove: 1}, ruby: {unwrap: 1}, h2: {add_class: {align: "align_text"}}, ins: {unwrap: 1}, p: {add_class: {align: "align_text"}}, sub: {unwrap: 1}, comment: {remove: 1}, frameset: {remove: 1}, optgroup: {unwrap: 1}, header: {rename_tag: "div"}}};
define("wysihtml5_rules", function (d) {
  return function () {
    return d.wysihtml5ParserRules
  }
}(this));
define("views/wall/post-editor/templates/basic", [], function () {
  return function (d) {
    return'<div class="post-editor-title"> <input class="post-title-input form-control" placeholder="..."/></div><div class="post-editor-content"> <div class="post-editor-toolbar" style="display: none;"> <div class="block"> <a class="icon icon-bold" data-wysihtml5-command="bold" title="CTRL+B"></a> <a class="icon icon-italic" data-wysihtml5-command="italic" title="CTRL+I"></a> <a class="icon icon-underline" data-wysihtml5-command="underline"></a> </div> <div class="block"> <a class="icon icon-heading" data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h3"></a> <a class="icon icon-quote" data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="blockquote"></a> <a class="icon icon-pre" data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="pre"></a> <a class="icon icon-ul" data-wysihtml5-command="insertUnorderedList"></a> <a class="icon icon-ol" data-wysihtml5-command="insertOrderedList"></a> </div> <div class="block"> <a class="icon icon-link" data-wysihtml5-command="createLink"></a> <a class="add-work-handler icon icon-image"></a> </div> <div class="toolbar-dialog" data-wysihtml5-dialog="createLink" style="display: none;"> <label> URL: <input data-wysihtml5-dialog-field="href" value="http://"> </label> <a data-wysihtml5-dialog-action="save"></a>&nbsp;<a data-wysihtml5-dialog-action="cancel"></a> </div> </div> <div class="post-editor-textarea readable" contenteditable="true" data-placeholder="' + teambition.user.attributes.name +
      '(Ctrl+)"></div></div><ul class="attachments-list thin-scroll clearfix"></ul>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/wall/post-editor/index", "view views/work/work/index views/work/work-uploader/index warehouse models/post collections/posts collections/works collections/collections util store markdown wysihtml5 wysihtml5_rules ./templates/basic essage".split(" "), function (d, b, e, g, k, h, l, n, m, s, r, t, v, p) {
    var x,
      B;
    x = teambition.user;
    return function (d) {
      function f() {
        return B = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "PostEditorView";
      f.prototype.tagName = "form";
      f.prototype.className = "post-editor";
      f.prototype.events = {"click li.work": "clickToInsertImage", "change .post-title-input": "checkTitle"};
      f.prototype.initialize = function (a) {
        if (null == a || !a._projectId || null == a || !a.postModel)return!1;
        this.options = a;
        this._projectId = a._projectId;
        this.postModel = a.postModel;
        this.localCache = s.namespace("posts_wall");
        a.postModel.id || (this.localCacheId = "" + a._projectId + "_" + x.id);
        this.attachments = g.createCollection(l, this.postModel.get("attachments"), {boundToObjectType: "project", _boundToObjectId: this._projectId});
        this.renderBasic().initUploader();
        a.onOpen || this.initEditor();
        return this
      };
      f.prototype.listen = function () {
        var a = this;
        this.listenTo(this.attachments, "add", function (b) {
          a.insertImage(b);
          return a.renderAttachment(b)
        });
        this.listenTo(this.attachments, "add change", function (b) {
          return a.storePost()
        });
        this.listenTo(this.attachments,
          "change:thumbnail", this.refreshImage);
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(p());
        this.$postTitleInput = this.$(".post-title-input");
        this.$divCreator = this.$("div.post-editor-textarea");
        this.$postCreatorToolbar = this.$(".post-editor-toolbar");
        this.$attachmentsList = this.$(".attachments-list");
        this.$linkDialog = this.$("[data-wysihtml5-dialog=createLink]");
        return this
      };
      f.prototype.renderAttachment = function (a) {
        this.requestSubView(b, {workModel: a}).$el.appendTo(this.$attachmentsList);
        return this
      };
      f.prototype.initEditor = function () {
        var a = this;
        _.delay(function () {
          var b, e, d;
          a.editor = (new t.Editor(a.$divCreator[0], {style: !1, toolbar: a.$postCreatorToolbar[0], parserRules: v, contentEditableMode: !0, handleTables: !1})).on("focus",function () {
            a.$divCreator.addClass("active");
            a.$divCreator.on("keypress.mark mouseup.mark click.mark", function () {
              return e()
            });
            return e()
          }).on("blur",function () {
            a.$divCreator.removeClass("active");
            return a.$divCreator.off(".mark")
          }).on("change",function () {
            return a.storePost()
          }).on("show:dialog",
            function (b) {
              if ("createLink" === b.command)return a.showDialog(b.dialogContainer)
            });
          e = function () {
            return _.delay(function () {
              var b, e;
              if (b = null != (e = a.editor) ? e.composer.selection.getBookmark() : void 0)return a.caretBookmark = b
            }, 10)
          };
          d = a.localCache(a.localCacheId) || {};
          (b = _.unescape(a.postModel.get("content"))) && "html" !== a.postModel.get("postMode") && (b = r(b));
          b && (d.content = b);
          d.title = a.postModel.get("title") || d.title;
          a.$postTitleInput.val(d.title);
          a.editor.setValue(d.content);
          a.attachments.add(d.attachments,
            {silent: !0});
          a.attachments.each(function (b) {
            return a.renderAttachment(b)
          });
          a.storePost();
          a.$postTitleInput.focus();
          return a.listen()
        }, 50);
        return this
      };
      f.prototype.initUploader = function () {
        var a = this;
        this.requestSubView(e, {_projectId: this._projectId, collection: this.attachments, noDialog: !0, pick: {id: this.$(".add-work-handler"), multiple: !0}, dnd: this.$(".post-editor-content"), paste: this.$divCreator, onFinish: function () {
          return a.attachments.addWorks(a.attachments.toJSON(), {success: function (b) {
            return a.attachments.set(b,
              {remove: !1})
          }})
        }});
        return this
      };
      f.prototype.focus = function () {
        this.editor.focus();
        return this
      };
      f.prototype.checkTitle = function () {
        var a;
        a = this.$postTitleInput.val().trim();
        a = m.cutString(a, 60, "...");
        this.$postTitleInput.val(a);
        this.storePost();
        return this
      };
      f.prototype.insertImage = function (a) {
        var b, e;
        e = this.getPreviewUrl(a);
        b = this.editor;
        e && b && (a = a.get("fileName"), this.$divCreator.hasClass("active") || b.composer.selection.setBookmark(this.caretBookmark), this.editor.focus(), b.composer.commands.exec("insertImage",
          {src: e, alt: a, title: a}));
        return this
      };
      f.prototype.refreshImage = function (a) {
        var b, e;
        b = a.previous("thumbnail");
        e = this.getPreviewUrl(a);
        b && this.editor && e && this.$divCreator.find("img").each(function () {
          if (this.src === b)return this.src = e
        });
        return this
      };
      f.prototype.getPreviewUrl = function (a) {
        var b;
        b = a.get("thumbnail") || "";
        a = a.get("imageWidth") || 800;
        800 < a && (a = 800);
        return b = b.replace("w/200/h/200", "w/" + a + "/h/" + a)
      };
      f.prototype.clickToInsertImage = function (a) {
        a = $(a.currentTarget).data("id");
        (a = this.attachments.get(a)) &&
        this.insertImage(a);
        return this
      };
      f.prototype.showDialog = function () {
        var a, b;
        if (this.editor)return b = this.editor.composer.selection.getRange(), (a = b.nativeRange.getBoundingClientRect()) && a.top && a.left || (a = b.nativeRange.getClientRects()[0]), a && a.top && a.left || (a = this.$divCreator[0].getBoundingClientRect()), b = a.top - this.$linkDialog.outerHeight(!0) - 10, a = a.left + a.width / 2 - this.$linkDialog.outerWidth(!0) / 2, this.$linkDialog.css({top: 0 < b ? b : 1, left: 0 < a ? a : 1})
      };
      f.prototype.storePost = function () {
        this.localCacheId &&
        this.localCache(this.localCacheId, {title: this.$postTitleInput.val().trim(), content: this.editor.getValue(), attachments: this.attachments.toJSON()});
        return this
      };
      f.prototype.save = function () {
        var a, b, e;
        a = this.editor.getValue();
        if (b = this.attachments.getUploadingCount())Essage.show({message: "" + b + "...", status: "warning"}, 2E3); else if (a) {
          if (this.localCache.remove(this.localCacheId), b = {}, e = this.$postTitleInput.val().trim(), e !== this.postModel.get("title") && (b.title = e), a !== this.postModel.get("content") &&
            (b.content = a), a = this.attachments.pluck("_id"), e = _.pluck(this.postModel.get("attachments"), "_id"), _.isEqual(a, e) || (b.attachments = a), !_.isEmpty(b))return b.postMode = "html", b
        } else Essage.show({message: "", status: "warning"}, 2E3);
        return null
      };
      return f
    }(d)
  })
}).call(this);
define("views/wall/post-menu/templates/basic", [], function () {
  return function (d) {
    var a = "";
    0 < d.hasRight ? (a += ' <ul class="list"> ', 1 == d.hasRight && (a += ' <li> <a class="pin-handler ', d.pin && (a += "pin"), a += '" data-gta="event" data-label="pin post"> <span class="icon icon-pin"></span> ', a = d.pin ? a + "  " : a + "  ", a += " </a> </li> "), a += ' <li> <a class="delete-handler" data-gta="event" data-label="delete post"> <span class="icon icon-trash"></span>  </a> </li> </ul>') : (a += ' <p class="muted"> . ',
      d.hasRightMembers && (a += "" + d.hasRightMembers + "."), a += " </p>");
    return a
  }
});
define("views/wall/post-menu/templates/delete", [], function () {
  return function (d) {
    return'<form class="delete-form"> <p></p> <button class="btn btn-danger" type="submit"></button></form>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/wall/post-menu/index", ["popover-view", "./templates/basic", "./templates/delete"], function (d, b, e) {
    var g;
    return function (d) {
      function f() {
        return g = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "PostMenuView";
      f.prototype.popoverTitle = "";
      f.prototype.events = {"click .pin-handler": "pinPost",
        "click .delete-handler": "enterDeleteSubMenu", "submit .delete-form": "submitDeleteForm"};
      f.prototype.render = function () {
        var a;
        a = this.options.postModel.toJSON();
        a.hasRight = this.options.postModel.hasRight();
        this.$el.html(b(a));
        return this
      };
      f.prototype.pinPost = function () {
        var a;
        a = this.options.postModel.get("pin");
        this.options.postModel.save({pin: !a});
        this.render();
        this.hide();
        return this
      };
      f.prototype.enterDeleteSubMenu = function () {
        var a = this;
        this.enterSubMenu("", function () {
          return a.$el.html(e())
        });
        return this
      };
      f.prototype.submitDeleteForm = function (a) {
        var b = this;
        a.preventDefault();
        this.options.postModel.destroy({success: function () {
          return b.hide()
        }});
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/wall/post-detail/templates/basic", [], function () {
  return function (d) {
    return'<div class="post-detail-header"></div><div class="post-edit-wrapper scrollable thin-scroll"> <div class="post-editor-handler-set clearfix"> <button class="btn btn-primary submit-handler" data-gta="event" data-label="submit post">  </button> <a class="btn btn-link cancel-handler"></a> </div></div><div class="post-detail-content scrollable thin-scroll"> <div class="post-content readable"></div> <div class="post-attachments"></div> <div class="involve-set"> <ul class="involve-members"></ul> </div></div><div class="activity-creator-wrapper clearfix"></div>'
  }
});
define("views/wall/post-detail/templates/header", [], function () {
  return function (d) {
    var a = "";
    0 < d.hasRight && (a += '<div class="pull-right"> <a class="post-edit-handler" data-gta="event" data-label="edit post"></a> <a class="post-menu-toggler" data-gta="event" data-label="open post menu"><span class="caret"></span></a></div>');
    return a += '<h4 class="post-title"><span class="post-edit-title"></span>' + (d.title || "") + "</h4>"
  }
});
define("views/wall/post-detail/templates/content", [], function () {
  return function (d) {
    var a = "" + d.content;
    if (0 < d.links.length) {
      a += " <ul> ";
      if (d = d.links)for (var f, b = -1, e = d.length - 1; b < e;)f = d[b += 1], a += ' <li> <a href="' + f.shortUrl + '" target="_blank" title="' + f.title + '"> ' + f.shortUrl + " </a> </li> ";
      a += " </ul>"
    }
    return a
  }
});
define("views/wall/post-detail/templates/attachments", [], function () {
  return function (d) {
    var a = '<ul class="attachments-list post-previewer-handler clearfix"> ';
    if (d = d.attachments)for (var f, b = -1, e = d.length - 1; b < e;)f = d[b += 1], a += ' <li class="work"> ', a = "image" === f.fileCategory ? a + (' <div class="work-thumbnail image" style="background-image: url(' + f.thumbnail + ');"></div> ') : a + (' <div class="work-thumbnail ' + f.fileType + '">' + f.fileType + "</div> "), a += ' <strong class="attachment-title hinted" data-title="' + f.fileName +
      '"> ' + f.fileNameFix + '</strong> <span class="attachment-size">(' + f.fileSizeFix + ")</span> </li> ";
    return a + "</ul>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/wall/post-detail/index", "view lib/window/index views/library/previewer/index views/wall/post-editor/index views/member/member-involve/index views/activity/activity-timeline/index views/wall/post-menu/index warehouse models/work models/activity collections/posts collections/members collections/works util thenjs highlight ./templates/basic ./templates/header ./templates/content ./templates/attachments jqueryui/droppable".split(" "), function (d, b, e, g, k, h, l, n, m, s, r, t, v, p, x, B, C, z, A, u) {
    var w, y, J;
    y = teambition.user;
    w = teambition.router;
    return function (d) {
      function f() {
        return J = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "PostView";
      f.prototype.tagName = "article";
      f.prototype.className = "post-detail-view toggler-parent";
      f.prototype.events = {"click .post-menu-toggler": "togglePostMenu", "click .submit-handler": "updatePost", "click .cancel-handler": "cancelEditor", "click .post-edit-handler": "editPost", "click .post-previewer-handler": "openPreviewer"};
      f.prototype.initialize = function (a) {
        var b, e = this;
        if (null != a && a.postModel || a._postId && a._projectId)return this.options = a, b = function () {
          e.membersCollection = e.options.membersCollection ? e.options.membersCollection : n.get(t, a._projectId);
          e.memberModel = e.membersCollection.get(e.postModel.get("_creatorId"));
          e.renderBasic().renderPost().renderActivities();
          e.initInvolve();
          e.listen();
          return"function" === typeof a.success ? a.success(e) : void 0
        }, a.postModel ? (a._projectId || (a._projectId = a.postModel.get("_projectId")),
          this.postModel = a.postModel, b()) : n.request(r, a._projectId, a._postId, {success: function (a) {
          e.postModel = a;
          return b()
        }}), this
      };
      f.prototype.listen = function () {
        this.listenTo(this.postModel, "destroy remove", this.close);
        this.listenTo(this.postModel, "change", this.renderPost);
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(C());
        this.$el.attr("id", this.postModel.id);
        this.$header = this.$(".post-detail-header");
        this.$postEdit = this.$(".post-edit-wrapper");
        this.$postDetail = this.$(".post-detail-content");
        this.$activityCreator = this.$(".activity-creator");
        this.$content = this.$(".post-content");
        this.$attachments = this.$(".post-attachments");
        this.$involveSet = this.$(".involve-set");
        this.$submit = this.$(".submit-handler");
        return this
      };
      f.prototype.renderPost = function () {
        var a, b;
        a = this.postModel.toJSON();
        a.content = this.postModel.getContent();
        a.hasRight = this.postModel.hasRight();
        this.$header.html(z(a));
        this.$header.find(".time-stamp").timesince();
        this.$content.html(A(a));
        null != (b = a.attachments) && b.length && (_.each(a.attachments,
          function (a) {
            var b;
            a.fileSizeFix = p.formatFileSize(a.fileSize);
            return a.fileNameFix = null != (b = a.fileName) ? b.replace(/\.[^.]*$/, "") : void 0
          }), this.$attachments.html(u(a)));
        this.$content.find("pre code").each(function () {
          return B.highlightBlock(this)
        });
        return this
      };
      f.prototype.initInvolve = function () {
        this.$involveSet.find(".involve-view").remove();
        this.requestSubView(k, {objectModel: this.postModel, membersCollection: this.membersCollection, $list: this.$(".involve-members"), dropArea: this.$el, undeletable: !1, type: "post"}).$el.prependTo(this.$involveSet);
        return this
      };
      f.prototype.renderActivities = function () {
        var a, b;
        this.$(".activities-timeline").remove();
        this.postModel.get("activitiesCount") ? (b = this.postModel.get("latestActivity"), b = n.createModel(s, b)) : b = null;
        this.activityTimelineView = this.requestSubView(h, {_objectId: this.postModel.id, boundToObjectType: "post", _projectId: this.membersCollection._boundToObjectId, activityModel: b, activitiesCount: this.postModel.get("activitiesCount"), type: "post", noCreator: !0});
        this.activityTimelineView.$el.insertAfter(this.$involveSet);
        a = this.$activityCreator = this.$(".activity-creator-wrapper");
        a.slideHide = function () {
          a.css("height", 74);
          return a.transition({height: 0}, 300, "ease", function () {
            return a.hide()
          })
        };
        a.slideShow = function () {
          a.show();
          return a.transition({height: 74}, 350, "ease", function () {
            return a.css("height", "auto")
          })
        };
        this.options.hideActivityCreator ? a.hide() : this.activityTimelineView.renderCreator(a);
        return this
      };
      f.prototype.editPost = function () {
        var a;
        if (!this.postEditorView)return this.$el.addClass("editing"), this.postEditorView =
          this.requestSubView(g, {_projectId: this.postModel.get("_projectId"), postModel: this.postModel.clone()}), this.postEditorView.$el.prependTo(this.$postEdit), "function" === typeof(a = this.$activityCreator).slideHide && a.slideHide(), this
      };
      f.prototype.cancelEditor = function () {
        var a, b;
        null != (b = this.postEditorView) && b.remove();
        this.postEditorView = null;
        this.$el.removeClass("editing");
        "function" === typeof(a = this.$activityCreator).slideShow && a.slideShow();
        return this
      };
      f.prototype.updatePost = function (a) {
        var b = this;
        if (!this.$submit.prop("disabled"))return(a =
          this.postEditorView.save()) ? (this.disableSubmit(!0), this.postModel.save(a, {patch: !0, wait: !0, error: function () {
          b.disableSubmit(!1);
          return b.postEditorView.focus()
        }, success: function () {
          b.disableSubmit(!1);
          return"function" === typeof b.cancelEditor ? b.cancelEditor() : void 0
        }})) : this.postEditorView.focus(), this
      };
      f.prototype.disableSubmit = function (a) {
        this.$submit.prop("disabled", a);
        this.$submit[a ? "addClass" : "removeClass"]("disabled");
        return this
      };
      f.prototype.togglePostMenu = function (a) {
        a = $(a.currentTarget);
        a.data("bs.popover") ||
        this.requestSubView(l, {$toggler: a, _projectId: this._projectId, postModel: this.postModel, permission: this.postModel.get("_creatorId") === y.id}).show();
        return this
      };
      f.prototype.openPreviewer = function () {
        var a;
        a = this.postModel.get("attachments") || [];
        if (!a.length)return this;
        this.requestSubView(b).open(e, {_projectId: this.postModel.get("_projectId"), thumbnailModel: this.postModel, workModels: n.createCollection(v, a).models});
        return this
      };
      f.prototype.close = function () {
        var a, b;
        "PostPanelView" === (null != (b = this.parentView) ?
          b.viewName : void 0) ? "function" === typeof(a = this.parentView).back && a.back() : this.remove();
        return this
      };
      f.prototype.remove = function () {
        var a;
        null != (a = this.$activityCreator) && a.remove();
        this.postModel && (a = w.getUrl().replace("/post/" + this.postModel.id, ""), w.navigate(a, {trigger: !1}));
        return f.__super__.remove.apply(this, arguments)
      };
      return f
    }(d)
  })
}).call(this);
define("views/events/event-creator/templates/basic", [], function () {
  return function (d) {
    var a = '<form class="event-create-form"> <input class="form-control event-title" type="text" placeholder="" ';
    d.isEdit && (a += ' value="' + d.title + '" ');
    a += '/> <input class="form-control event-location" ';
    d.isEdit && (a += ' value="' + d.location + '" ');
    a += 'placeholder="()"></textarea> <div class="form-group event-start-time-group"> <label class="start-date-label">  </label><a class="btn start-date-picker-toggler"> </a><select class="btn start-hour-select hour-select" data-type="start"> </select><select class="btn start-min-select min-select" data-type="start"></select> </div> <div class="form-group event-end-time-setter ';
    d.hasEndTime && (a += "show");
    a += '"> <label class="end-date-label">  </label><a class="btn end-date-picker-toggler"> </a><select class="btn end-hour-select hour-select" data-type="end"> </select><select class="btn end-min-select min-select" data-type="end"></select> </div> <div class="form-group event-note-editor ';
    d.hasNote && (a += "show");
    a += '"> <textarea class="form-control event-content" placeholder="">';
    d.isEdit && (a += d.content);
    a += '</textarea> </div> <div class="form-group event-item-togglers"> <a class="end-time-toggler"> ';
    a = d.hasEndTime ? a + "  " : a + "  ";
    a += ' </a><a class="note-toggler"> ';
    a = d.hasNote ? a + "  " : a + "  ";
    a += ' </a> </div> <button class="btn btn-primary event-creator-submit" data-gta="event" data-label="creator or save a event" type="submit"> ';
    a = d.isEdit ? a + "  " : a + "  ";
    a += " </button> ";
    d.isEdit && (a += ' <hr> <button class="btn event-creator-delete" data-gta="event" data-label="want to delete event" type="button"></button> ');
    return a + "</form>"
  }
});
define("views/events/event-creator/templates/hours", [], function () {
  return function (d) {
    var a = "", f = d.hours;
    if (f)for (var b, e = -1, g = f.length - 1; e < g;)b = f[e += 1], a += ' <option value="' + b.value + '" ', b.value === d.selectedHour && (a += "selected"), a += ">" + b.label + "</option>";
    return a
  }
});
define("views/events/event-creator/templates/minutes", [], function () {
  return function (d) {
    var a = "", f = d.mins;
    if (f)for (var b, e = -1, g = f.length - 1; e < g;)b = f[e += 1], a += ' <option value="' + b.value + '" ', b.value === d.selectedMin && (a += "selected"), a += ">" + b.label + "</option>";
    return a
  }
});
(function () {
  var d = function (a, e) {
    return function () {
      return a.apply(e, arguments)
    }
  }, a = {}.hasOwnProperty, f = function (b, e) {
    function d() {
      this.constructor = b
    }

    for (var f in e)a.call(e, f) && (b[f] = e[f]);
    d.prototype = e.prototype;
    b.prototype = new d;
    b.__super__ = e.prototype;
    return b
  };
  define("views/events/event-creator/index", "view warehouse models/event util moment ./templates/basic ./templates/hours ./templates/minutes".split(" "), function (a, e, g, k, h, l, n, m) {
    var s, r;
    s = teambition.user;
    return function (a) {
      function b() {
        this.onMinChange =
          d(this.onMinChange, this);
        this.onHourChange = d(this.onHourChange, this);
        return r = b.__super__.constructor.apply(this, arguments)
      }

      f(b, a);
      b.prototype.viewName = "EventCreator";
      b.prototype.className = "event-creator";
      b.prototype.events = {"click .end-time-toggler": "toggleEndTimeSetter", "click .note-toggler": "toggleNoteEditor", "click .event-creator-submit": "onSubmit", "change .hour-select": "onHourChange", "change .min-select": "onMinChange"};
      b.prototype.initialize = function (a) {
        this.options = _.extend({}, a);
        this.reset().render();
        return this
      };
      b.prototype.reset = function () {
        var a, b;
        this.stopListening();
        this.hasNote = this.hasEndTime = !1;
        (this.isEdit = this.options.isEdit) ? (this.options.title = "", this.eventModel = this.options.eventModel.clone(), this.eventModel.set("startDate", new Date(this.eventModel.get("startDate"))), null != this.eventModel.get("endDate") ? (this.eventModel.set("endDate", new Date(this.eventModel.get("endDate"))), this.hasEndTime = !0) : this.eventModel.set("endDate", new Date(h(this.eventModel.get("startDate")).add("hour",
          1).format())), this.eventModel.get("content") && (this.hasNote = !0)) : (b = this.options.startDate, this.isSameDay(b, k.getDay()) ? (b = h().add("minutes", 1).toDate(), a = h().minute(0).add("hours", 1).toDate()) : a = new Date(b.getTime()), this.eventModel = e.createModel(g, {startDate: b, endDate: a, _createId: s.id, _projectId: this.options._projectId}));
        this.listenTo(this.eventModel, "change:startDate", this.onStartDateChange);
        this.listenTo(this.eventModel, "change:endDate", this.onEndDateChange);
        return this
      };
      b.prototype.onStartDateChange =
        function () {
          var a;
          a = this.eventModel.get("startDate");
          this.eventModel.get("endDate").getTime() <= a.getTime() && this.eventModel.set("endDate", new Date(h(a).add("hour", 1).format()));
          this.$endDatePickerToggler.datepicker("setStartDate", a);
          this.$endDatePickerToggler.datepicker("setDate", a);
          this.renderTime("start");
          this.renderTime("end");
          return this
        };
      b.prototype.onEndDateChange = function () {
        var a;
        a = this.eventModel.get("endDate");
        a.getTime() <= this.eventModel.get("startDate").getTime() && this.eventModel.set("endDate",
          new Date(h(a).add("hour", 1).format()));
        this.renderTime("end");
        return this
      };
      b.prototype.render = function () {
        var a;
        a = this.eventModel.toJSON();
        a.hasNote = this.hasNote;
        a.hasEndTime = this.hasEndTime;
        a.isEdit = this.isEdit;
        this.$el.html(l(a));
        this.$eventTitle = this.$(".event-title");
        this.$startDatePickerToggler = this.$(".start-date-picker-toggler");
        this.$endDatePickerToggler = this.$(".end-date-picker-toggler");
        this.$eventTitle = this.$(".event-title");
        this.$submit = this.$(".event-creator-submit");
        this.setFocus();
        this.initDatePicker();
        this.renderTime("start");
        this.hasEndTime && this.renderTime("end");
        return this
      };
      b.prototype.setFocus = function () {
        var a = this;
        _.delay(function () {
          return a.$eventTitle.focus()
        }, 300);
        return this
      };
      b.prototype.renderTime = function (a) {
        this.renderDate(a);
        this.renderHourOptions(a);
        this.renderMinuteOptions(a);
        return this
      };
      b.prototype.renderDate = function (a) {
        var b;
        if ("start" !== a && "end" !== a)return this;
        b = k.formatDate(this.eventModel.get("" + a + "Date")).dateString;
        this.$("." + a + "-date-picker-toggler").text(b);
        return this
      };
      b.prototype.renderHourOptions = function (a) {
        var b, e, d, f, g, h, l, m;
        if ("start" !== a && "end" !== a)return this;
        b = this.eventModel.get("" + a + "Date");
        e = "start" === a && this.isSameDay(b, k.getDay()) ? function () {
          h = [];
          for (var a = f = (new Date).getHours(); 24 >= f ? 24 > a : 24 < a; 24 >= f ? a++ : a--)h.push(a);
          return h
        }.apply(this) : "end" === a && this.isSameDay(this.eventModel.get("startDate"), b) ? function () {
          l = [];
          for (var a = g = this.eventModel.get("startDate").getHours(); 24 >= g ? 24 > a : 24 < a; 24 >= g ? a++ : a--)l.push(a);
          return l
        }.apply(this) : function () {
          m = [];
          for (d = 0; 24 > d; d++)m.push(d);
          return m
        }.apply(this);
        this.$("." + a + "-hour-select").html(n({hours: this._generateHours(e), selectedHour: b.getHours()}));
        return this
      };
      b.prototype.renderMinuteOptions = function (a) {
        var b;
        if ("start" !== a && "end" !== a)return this;
        b = this.eventModel.get("" + a + "Date").getMinutes();
        b = 0 === b % 5 ? b : 5 * (Math.floor(b / 5) + 1);
        this.$("." + a + "-min-select").html(m({mins: this._generateMins([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]), selectedMin: b}));
        return this
      };
      b.prototype.initDatePicker = function () {
        var a = this;
        this.$startDatePickerToggler.datepicker({language: "zh-CN",
          startDate: new Date, placement: "left", autoclose: !0}).on("changeDate", function (b) {
            var e;
            e = b.date;
            b = new Date(a.eventModel.get("startDate"));
            b.setFullYear(e.getFullYear());
            b.setMonth(e.getMonth());
            b.setDate(e.getDate());
            return a.eventModel.set({startDate: b})
          });
        this.$endDatePickerToggler.datepicker({language: "zh-CN", startDate: new Date, placement: "left", autoclose: !0}).on("changeDate", function (b) {
          var e;
          e = b.date;
          b = new Date(a.eventModel.get("endDate"));
          b.setFullYear(e.getFullYear());
          b.setMonth(e.getMonth());
          b.setDate(e.getDate());
          return a.eventModel.set({endDate: b})
        });
        return this
      };
      b.prototype._generateHours = function (a) {
        var b, e, d, f;
        e = [];
        d = 0;
        for (f = a.length; d < f; d++)b = a[d], e.push({label: this._generateHourLabel(b), value: b});
        return e
      };
      b.prototype._generateHourLabel = function (a) {
        switch ("ZH") {
          case "ZH":
            return 12 > a ? "" + a + "" : 12 === a ? "" + a + "" : "" + (a - 12) + "";
          case "EN":
            return 12 > a ? "" + a + " AM" : 12 === a ? "" + a + " PM" : "" + (a - 12) + " PM"
        }
      };
      b.prototype._generateMins = function (a) {
        var b, e, d, f;
        e = [];
        d = 0;
        for (f = a.length; d < f; d++)b =
          a[d], e.push({label: this._generateMinLabel(b), value: 5 * b});
        return e
      };
      b.prototype._generateMinLabel = function (a) {
        return 0 === a ? "00" : 1 === a ? "05" : "" + 5 * a
      };
      b.prototype._generateStartTime = function () {
        var a;
        a = new Date;
        return{date: k.formatDate(a).dateString, hour: a.getHours() + 1, min: 0}
      };
      b.prototype.toggleEndTimeSetter = function () {
        this.hasEndTime = !this.hasEndTime;
        this.$(".event-end-time-setter").toggleClass("show", this.hasEndTime);
        return this.hasEndTime ? (this.$(".end-time-toggler").text(""), this.renderTime("end")) :
          this.$(".end-time-toggler").text("")
      };
      b.prototype.toggleNoteEditor = function () {
        this.hasNote = !this.hasNote;
        this.$(".event-note-editor").toggleClass("show", this.hasNote);
        return this.$(".note-toggler").text(this.hasNote ? "" : "")
      };
      b.prototype.onSubmit = function (a) {
        var b = this;
        a.preventDefault();
        if (!this.$submit.prop("disabled")) {
          if (!this.$eventTitle.val())return this.$eventTitle.focus();
          this.disableSubmit(!0);
          this.eventModel.set({title: this.$(".event-title").val().trim(), location: this.$(".event-location").val().trim()},
            {silent: !0});
          this.eventModel.get("startDate").setHours(this.$(".start-hour-select").val());
          this.eventModel.get("startDate").setMinutes(this.$(".start-min-select").val());
          this.eventModel.get("endDate").setHours(this.$(".end-hour-select").val());
          this.eventModel.get("endDate").setMinutes(this.$(".end-min-select").val());
          this.hasEndTime || this.eventModel.set({endDate: null}, {silent: !0});
          this.hasNote ? this.eventModel.set({content: this.$(".event-content").val()}, {silent: !0}) : this.eventModel.set({content: ""},
            {silent: !0});
          return this.isEdit ? this.options.eventModel.save(this.eventModel.toJSON(), {success: function (a) {
            b.disableSubmit(!1);
            return b.close()
          }, error: function () {
            return b.disableSubmit(!1)
          }}) : this.options.eventsCollection.create(this.eventModel.toJSON(), {wait: !0, success: function (a) {
            var e;
            b.disableSubmit(!1);
            "function" === typeof(e = b.options).success && e.success(a);
            return b.close()
          }, error: function () {
            return b.disableSubmit(!1)
          }})
        }
      };
      b.prototype.disableSubmit = function (a) {
        this.$submit.prop("disabled", a);
        this.$submit[a ? "addClass" : "removeClass"]("disabled");
        return this
      };
      b.prototype.onHourChange = function (a) {
        var b, e;
        a = $(a.target);
        e = a.attr("data-type");
        b = new Date(this.eventModel.get("" + e + "Date"));
        b.setHours(a.val());
        return this.eventModel.set("" + e + "Date", b)
      };
      b.prototype.onMinChange = function (a) {
        var b, e;
        a = $(a.target);
        e = a.attr("data-type");
        b = new Date(this.eventModel.get("" + e + "Date"));
        b.setMinutes(a.val());
        return this.eventModel.set("" + e + "Date", b)
      };
      b.prototype.isSameDay = function (a, b) {
        return k.getDay(a).getTime() ===
          k.getDay(b).getTime()
      };
      b.prototype.close = function () {
        var a, b, e;
        null != (b = this.parentView) && b.hide ? "function" === typeof(a = this.parentView).hide && a.hide() : null != (e = this.parentView) && e.remove();
        return this
      };
      return b
    }(a)
  })
}).call(this);
define("views/events/event-creator-popover/templates/delete", [], function () {
  return function (d) {
    return'<form class="delete-form"> <p></p> <button class="btn btn-danger delete-event" data-gta="event" data-label="delete event" type="submit"></button></form>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/events/event-creator-popover/index", ["popover-view", "views/events/event-creator/index", "./templates/delete"], function (d, b, e) {
    var g;
    return function (d) {
      function f() {
        return g = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "EventCreatorPopoverView";
      f.prototype.className =
        "event-creator-popover";
      f.prototype.width = 402;
      f.prototype.popoverTitle = "";
      f.prototype.events = {"click .event-creator-delete": "enterDeleteSubMenu", "click .delete-event": "removeEvent"};
      f.prototype.render = function () {
        this.$el.html(this.requestSubView(b, this.options).$el);
        return this
      };
      f.prototype.removeEvent = function (a) {
        a.preventDefault();
        this.hide();
        return this.options.eventModel.destroy({wait: !0})
      };
      f.prototype.enterDeleteSubMenu = function () {
        var a = this;
        return this.enterSubMenu("", function () {
          return a.$el.html(e())
        })
      };
      return f
    }(d)
  })
}).call(this);
define("views/events/event-detail/templates/basic", [], function () {
  return function (d) {
    return'<div class="event-detail-content"> <div class="event-detail-info-container"></div> <div class="event-detail-involve-set involve-set"> <ul class="involve-members"></ul> </div> <nav class="event-detail-navigation"> <ul class="section-switcher nav nav-tabs"> <li class="section-switcher-toggler active" data-toggle="event-detail-activities"> <a><span class="activities-number"></span></a> </li> <li class="section-switcher-toggler" data-toggle="event-detail-attachments"> <a><span class="attachments-number"></span></a> </li> </ul> </nav> <section class="event-detail-switcher-content"> <div class="event-detail-activities activities"></div> <div class="event-detail-attachments clearfix"> <div class="event-attachments-handler"> <button class="btn btn-primary add-work-handler" data-gta="event" data-label="event-detail|attachments tab|add works" type="button"></button> <span></span> </div> <ul class="activities-list"></ul> </div> </section></div><div class="activity-creator-wrapper"></div><a class="event-edit-trigger toggler" data-gta="event" data-label="open event editor"> <span class="icon icon-chevron-down"></span></a>'
  }
});
define("views/events/event-detail/templates/info", [], function () {
  return function (d) {
    var a = '<div class="event-detail-info ';
    if (4 < d.hour && 11 >= d.hour)a += " morning "; else if (11 < d.hour && 17 >= d.hour)a += " afternoon "; else if (17 < d.hour && 20 >= d.hour)a += " evening "; else if (20 < d.hour || 4 >= d.hour)a += " night ";
    a += '"> ';
    20 < d.hour || 4 >= d.hour ? a += ' <div class="twinkle-star"></div> ' : 17 < d.hour && 20 >= d.hour && (a += ' <div class="sun-light"></div> <div class="sunset"></div> ');
    a += ' <h3 class="event-title">' + d.title + '</h3> <p class="event-content">' +
      d.content + "</p> ";
    d.location && (a += ' <p class="event-location"> <span class="icon-location icon"></span> <span class="event-location">' + d.location + "</span> </p> ");
    a += ' <p class="event-date"> <span class="icon-clock icon"></span> <span class="event-start-date">' + d.startDateString + "</span> ";
    d.endDateString && (a += ' ~ <span class="event-end-date">' + d.endDateString + "</span> ");
    return a + " </p></div>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/events/event-detail/index", "view warehouse collections/events collections/members util moment views/member/member-involve/index views/activity/activity-timeline/index views/events/event-creator-popover/index ./templates/basic ./templates/info flexText".split(" "), function (d, b, e, g, k, h, l, n, m, s, r) {
    var t, v;
    t = teambition.router;
    return function (d) {
      function f() {
        return v = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "EventDetailView";
      f.prototype.tagName = "div";
      f.prototype.className = "event-detail toggler-parent";
      f.prototype.events = {"click .event-edit-trigger": "editEvent", "click .section-switcher-toggler": "switch"};
      f.prototype.initialize = function (a) {
        var b = this;
        if (null != a && a._projectId)return this.options = a, this._eventId = a._eventId, this._projectId = a._projectId, this.eventModel =
          this.options.eventModel, this.showLoadingIndicator(), this.load(function (e) {
          b.hideLoadingIndicator();
          b.eventModel = e;
          b.renderBasic();
          b.renderInfo();
          b.renderActivities();
          b.renderInvolve();
          b.listen();
          return"function" === typeof a.success ? a.success(b) : void 0
        }), this
      };
      f.prototype.load = function (a) {
        if (null != this.eventModel)return a(this.eventModel);
        b.request(e, this._projectId, this._eventId, {success: function (b) {
          return a(b)
        }});
        return this
      };
      f.prototype.listen = function () {
        var a = this;
        this.listenTo(this.eventModel,
          "destroy remove", function () {
            var b;
            if ("function" === typeof(b = a.options).onEventDelete)b.onEventDelete(a.eventModel);
            return a.close()
          });
        this.listenTo(this.eventModel, "change", function () {
          var b;
          return"function" === typeof(b = a.options).onEventChange ? b.onEventChange(a.eventModel) : void 0
        });
        this.listenTo(this.eventModel, "change:title change:startDate change:location change:content", this.renderInfo);
        return this
      };
      f.prototype.renderInfo = function () {
        var a;
        a = this.eventModel.toJSON();
        a.hour = (new Date(a.startDate)).getHours();
        a.startDateString = k.formatDate(new Date(a.startDate)).dateString + " " + h(a.startDate).format("A h:mm");
        a.endDateString = null != a.endDate ? "" + k.formatDate(new Date(a.endDate)).dateString + " " + h(a.endDate).format("A h:mm") : "";
        this.$eventDetailInfoContainer.html(r(a));
        this.$eventTitle = this.$(".event-title");
        return this
      };
      f.prototype["switch"] = function (a) {
        var b;
        a = $(a.currentTarget);
        if (!a.hasClass("active"))return b = a.attr("data-toggle"), this.$el.find(".event-detail-navigation li.active").removeClass("active"),
          a.addClass("active"), this.$el.find("." + b).show(), this.$el.find(".event-detail-switcher-content>div").not("." + b).hide(), "event-detail-activities" === b ? this.$activityCreator.slideShow() : this.$activityCreator.slideHide()
      };
      f.prototype.renderBasic = function () {
        this.$el.html(s());
        this.$eventDetailInfoContainer = this.$(".event-detail-info-container");
        this.$activities = this.$(".event-detail-activities");
        this.$involveSet = this.$(".involve-set");
        return this
      };
      f.prototype.renderInvolve = function () {
        this.requestSubView(l,
          {objectModel: this.eventModel, membersCollection: b.request(g, this.options._projectId), $list: this.$(".involve-members"), dropArea: this.$el, undeletable: !1, gta: {involveMemberLabel: "event detail|involve member"}}).$el.prependTo(this.$involveSet);
        return this
      };
      f.prototype.renderActivitiesNum = function (a) {
        return this.$(".activities-number").text(0 < a ? "  " + a : "")
      };
      f.prototype.renderAttachmentsNum = function (a) {
        return this.$(".attachments-number").text(0 < a ? "  " + a : "")
      };
      f.prototype.renderActivities = function () {
        var a =
          this;
        this.activityTimelineView = this.requestSubView(n, {_objectId: this.eventModel.id, boundToObjectType: "event", _projectId: this._projectId, noCreator: !0, activityCollectionChange: function (b) {
          a.renderActivitiesNum(b.length);
          return a.renderAttachmentsNum(b.reduce(function (a, b) {
            return b.get("attachments").length + a
          }, 0))
        }, $attachmentsContainer: this.$(".event-detail-attachments .activities-list"), secondUpload: {$uploadArea: this.$(".event-attachments-handler .add-work-handler"), $dropArea: this.$(".event-attachments-handler")}});
        this.activityTimelineView.$el.appendTo(this.$activities);
        this.$activityCreator = this.$(".activity-creator-wrapper");
        this.options.hideActivityCreator && this.$activityCreator.hide();
        return this
      };
      f.prototype.editEvent = function (a) {
        a = $(a.currentTarget);
        a.data("bs.popover") || this.requestSubView(m, {$toggler: a, eventsCollection: this.eventsCollection, eventModel: this.eventModel, isEdit: !0, _projectId: this._projectId, placement: "left"}).show();
        return this
      };
      f.prototype.close = function () {
        var a, b;
        "EventDetailPanel" ===
          (null != (b = this.parentView) ? b.viewName : void 0) ? "function" === typeof(a = this.parentView).back && a.back() : this.remove();
        return this
      };
      f.prototype.remove = function () {
        var a;
        null != (a = this.$activityCreator) && a.remove();
        this.eventModel && (a = t.getUrl().replace("/event/" + this.eventModel.id, ""), t.navigate(a, {trigger: !1}));
        return f.__super__.remove.apply(this, arguments)
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  define("lib/selectable", [], function () {
    return function (d) {
      return{setActive: function (a) {
        a.siblings().removeClass("active");
        a.addClass("active");
        return this
      }, getActive: function () {
        return this.$(d).filter(".active").first()
      }, prev: function (a) {
        var f, b, e;
        b = this.$(d);
        if (0 !== b.length)return f = b.filter(".active"), f.length ? (f.removeClass("active"), e = f.prev(), e.length || (e = f)) : e = b.first(), this.slideTo(e, !0, function () {
          e.addClass("active");
          return"function" === typeof a ? a() : void 0
        }), this
      }, next: function (a) {
        var f,
          b, e;
        b = this.$(d);
        if (0 !== b.length)return f = b.filter(".active"), f.length ? (f.removeClass("active"), e = f.next(d), e.length || (e = f)) : e = b.first(), this.slideTo(e, !0, function () {
          e.addClass("active");
          return"function" === typeof a ? a() : void 0
        }), this
      }}
    }
  })
}).call(this);
define("views/inbox/inbox/templates/basic", [], function () {
  return function (d) {
    return'<header class="inbox-header navbar navbar-inverse navbar-fixed-top" data-gta="event" data-label="close inbox"> <div class="navbar-inner"> <a class="brand central"></a> </div></header><div class="inbox-content"> <div class="messages-wrapper transparent-scroll"> <div class="messages-header"> <div class="messages-label pull-left"> <div class="messages-label-icon icon icon-white icon-inbox"></div> <span></span> </div> <div class="pull-right"> <a class="read-all-handler" data-gta="event" data-label="read all messages">  </a> <span class="divider-vertical"></span> <a class="clear-readed-handler" data-gta="event" data-label="clear readed messages">  </a> </div> </div> <ul class="messages"></ul> </div> <div class="message-detail-wrapper"> <div class="detail-header"></div> <div class="detail-panel"></div> </div> <div class="messages-placeholder"></div></div><footer class="inbox-footer" data-gta="event" data-label="close inbox"> <span class="icon icon-white icon-chevron-up"></span></footer>'
  }
});
define("views/inbox/inbox/templates/group", [], function () {
  return function (d) {
    return'<li class="message-group"><p class="message-group-title">' + d.name + '</p> <ul class="messages message-group-' + d._id + '"> </ul></li>'
  }
});
define("views/inbox/inbox/templates/title", [], function () {
  return function (d) {
    var a = '<div class="icon icon-white icon-project"></div><span class="item-name url-handler" data-url="' + d[0].id + '">' + d[0].name + "</span>";
    d[1] && (a += '<span class="icon icon-chevron-right"></span><span class="item-name url-handler" data-url="' + d[0].id + ":" + d[1].id + '">' + d[1].name + "</span>");
    return a
  }
});
(function (d, a, f) {
  function b(a) {
    return a
  }

  function e(a) {
    a = decodeURIComponent(a.replace(k, " "));
    0 === a.indexOf('"') && (a = a.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, "\\"));
    return a
  }

  function g(a) {
    return h.json ? JSON.parse(a) : a
  }

  var k = /\+/g, h = d.cookie = function (k, n, m) {
    if (n !== f) {
      m = d.extend({}, h.defaults, m);
      null === n && (m.expires = -1);
      if ("number" === typeof m.expires) {
        var s = m.expires, r = m.expires = new Date;
        r.setDate(r.getDate() + s)
      }
      n = h.json ? JSON.stringify(n) : String(n);
      return a.cookie = [encodeURIComponent(k), "=",
        h.raw ? n : encodeURIComponent(n), m.expires ? "; expires=" + m.expires.toUTCString() : "", m.path ? "; path=" + m.path : "", m.domain ? "; domain=" + m.domain : "", m.secure ? "; secure" : ""].join("")
    }
    n = h.raw ? b : e;
    m = a.cookie.split("; ");
    for (var s = k ? null : {}, r = 0, t = m.length; r < t; r++) {
      var v = m[r].split("="), p = n(v.shift()), v = n(v.join("="));
      if (k && k === p) {
        s = g(v);
        break
      }
      k || (s[p] = g(v))
    }
    return s
  };
  h.defaults = {};
  d.removeCookie = function (a, b) {
    return null !== d.cookie(a) ? (d.cookie(a, null, b), !0) : !1
  }
})(jQuery, document);
define("jquery.cookie", function () {
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/inbox/inbox/index", "view lib/window/index views/inbox/message/index views/board/task/task-detail/index views/wall/post-detail/index views/events/event-detail/index views/library/previewer/index lib/scrollable lib/selectable warehouse collections/messages collections/projects util ./templates/basic ./templates/group ./templates/title jquery.cookie".split(" "),
    function (d, b, e, g, k, h, l, n, m, s, r, t, v, p, x, B) {
      var C, z, A, u;
      C = teambition.APP;
      A = teambition.user;
      z = teambition.router;
      d = function (d) {
        function f() {
          return u = f.__super__.constructor.apply(this, arguments)
        }

        a(f, d);
        f.prototype.viewName = "InboxView";
        f.prototype.tagName = "div";
        f.prototype.className = "inbox-view float-view";
        f.prototype.title = "";
        f.prototype.settings = {animate_open: "dropout", animate_close: "slideup"};
        f.prototype.events = {"click .inbox-header": "clear", "click .inbox-footer": "clear", "click .clear-readed-handler": "clearReadMessages",
          "click .read-all-handler": "readAllMessages", "click .url-handler": "routeTo"};
        f.prototype.hotkeys = {esc: function (a) {
          a.preventDefault();
          return this.clear()
        }, j: "selectNext", k: "selectPrev", a: "handleDeleteMessage"};
        f.prototype.initialize = function (a) {
          this.collection = s.get(r, A.id);
          this.listen().render().load(a).setupScroll($(document), {noShadow: !0});
          return this
        };
        f.prototype.listen = function () {
          var a = this;
          this.listenTo(this.collection, "add", function (b) {
            return a.renderMessage(b, !0)
          });
          this.listenTo(this.collection,
            "change:isRead", this.moveNewMessageToTop);
          this.listenTo(this.collection, "remove change:isArchived", this.checkRenderPlaceholder);
          this.listenTo(A, "change:inbox", function () {
            if (a.collection.getUnreadCount() !== A.get("inbox"))return a.collection.pageIndex = 0, a.collection.fetch()
          });
          return this
        };
        f.prototype.render = function () {
          this.$el.html(p());
          this.$messagesWrapper = this.$(".messages-wrapper");
          this.$messages = this.$messagesWrapper.find(".messages");
          this.$detailWrapper = this.$(".message-detail-wrapper");
          this.$detailPanel =
            this.$(".detail-panel");
          this.$detailHeader = this.$(".detail-header");
          this.$emptyPlaceholder = this.$(".messages-placeholder");
          return this
        };
        f.prototype.load = function (a) {
          var b = this;
          this.collection.synced && this.collection.getUnreadCount() === A.get("inbox") ? (this.renderMessages(), a._messageId && this.showMessageDetail(a._messageId)) : (this.collection.pageIndex = 0, this.collection.fetch({silent: !0, beforeSend: function () {
            return b.showLoadingIndicator(b.$el, {isPrepend: !0})
          }, success: function () {
            b.hideLoadingIndicator({animated: !0});
            b.renderMessages();
            b.checkRenderPlaceholder();
            if (a._messageId)return b.showMessageDetail(b.collection.get(a._messageId))
          }}));
          return this
        };
        f.prototype.renderMessages = function () {
          var a = this;
          this.checkRenderPlaceholder();
          this.collection.sort();
          this.collection.each(function (b) {
            return a.renderMessage(b)
          });
          return this
        };
        f.prototype.renderMessage = function (a, b) {
          var d;
          if (!a.get("isArchived"))return!1 === b && this.checkRenderPlaceholder(), d = b ? "prependTo" : "appendTo", this.requestSubView(e, {messageModel: a}).$el[d](this.$messages),
            this
        };
        f.prototype.moveNewMessageToTop = function (a) {
          if (!a.get("isRead"))return a = this.$messages.find("#message-card-" + a.id), a.prependTo(this.$messages), this
        };
        f.prototype.showMessageDetail = function (a) {
          var e, d, f, p, m, r, n = this;
          f = function (a, b) {
            var e, d;
            if (e = a.$activityCreator)return d = !0, a.activityTimelineView.renderCreator(e), e.css({height: 0}).appendTo(n.$detailPanel), e.slideHide = function () {
              if (!d)return d = !0, a.$el.css("bottom", 62), e.css("height", 71), e.transition({height: 0}, 300, "ease", function () {
                return e.hide()
              })
            },
              e.slideShow = function () {
                if (d)return d = !1, e.show(), e.transition({height: 71}, 350, "ease", function () {
                  var d, f;
                  null != (d = a.$el) && d.css("bottom", 130);
                  e.css("height", "auto");
                  if (b)return null != (f = a.activityTimelineView) ? f.scrollToBottom() : void 0
                })
              }, e.slideShow()
          };
          e = this.collection.get(a);
          if (e === this.prevMessageModel)return e.markRead();
          this.prevMessageModel = e;
          null != (a = this.detailView) && null != (m = a.currentView) && "function" === typeof m.close && m.close();
          null != (r = this.detailView) && r.remove();
          p = e.get("_projectId");
          d = s.get(t).get(p);
          e.requestBoundToObject({beforeSend: function () {
            return n.showLoadingIndicator(n.$detailWrapper)
          }, success: function (a, m, r) {
            var t, s, v;
            n.hideLoadingIndicator();
            switch (e.get("boundToObjectType")) {
              case "event":
                t = [
                  {name: d.get("name"), id: d.id, type: "project"}
                ];
                n.$detailHeader.html(B(t));
                n.detailView = n.requestSubView(h, {_eventId: a.id, _projectId: d.id, eventModel: a, success: function (a) {
                  return f(a, !0)
                }});
                n.detailView.$el.addClass("card").appendTo(n.$detailPanel);
                null != (s = n.detailView.$activityCreator) &&
                s.appendTo(n.$detailPanel);
                break;
              case "task":
                t = [
                  {name: d.get("name"), id: d.id, type: "project"},
                  {name: r.get("title"), id: r.id, type: "tasklist"}
                ];
                n.$detailHeader.html(B(t));
                n.detailView = n.requestSubView(g, {taskModel: a, membersCollection: m, success: function (a) {
                  return f(a, !0)
                }});
                n.detailView.$el.addClass("card").appendTo(n.$detailPanel);
                break;
              case "post":
                t = [
                  {name: d.get("name"), id: d.id, type: "project"}
                ];
                n.$detailHeader.html(B(t));
                n.detailView = n.requestSubView(k, {postModel: a, membersCollection: m, hideActivityCreator: !0,
                  success: function (a) {
                    return f(a, !0)
                  }});
                n.detailView.$el.addClass("card").appendTo(n.$detailPanel);
                null != (v = n.detailView.$activityCreator) && v.appendTo(n.$detailPanel);
                break;
              case "work":
              case "works":
                m = {_projectId: p}, "post" === (null != (t = a[0]) ? t.get("objectType") : void 0) ? (m.thumbnailModel = a[0], m.workModels = a.slice(1)) : m.workModels = a, n.detailView = n.requestSubView(b).open(l, m)
            }
            return e.markRead()
          }, error: function (a) {
            n.$detailWrapper.text("Object Missing.");
            return e.destroy()
          }});
          return this
        };
        f.prototype.hideMessageDetail =
          function () {
            return this.$detailWrapper.empty()
          };
        f.prototype.selectPrev = function () {
          var a = this;
          this.prev(function () {
            return a.showMessageDetail(a.getActive().data("model"))
          });
          return this
        };
        f.prototype.selectNext = function () {
          var a = this;
          this.next(function () {
            return a.showMessageDetail(a.getActive().data("model"))
          });
          return this
        };
        f.prototype.handleOpenLink = function () {
          var a;
          null != (a = this.detailView) && a.$el.find(".routing-icon").click();
          return this
        };
        f.prototype.handleDeleteMessage = function () {
          var a;
          if (a = this.getActive())this.hideMessageDetail(),
            a.find(".delete-message-card-handler").click();
          return this
        };
        f.prototype.beforeClose = function () {
          var a;
          null != (a = this.detailView) && a.remove();
          return this
        };
        f.prototype.clear = function () {
          var a;
          a = z.getUrl().replace(/\/inbox.*/, "");
          z.navigate(a, {trigger: !1});
          C.Float.close();
          return this
        };
        f.prototype.clearReadMessages = function () {
          this.collection.archiveRead();
          return this
        };
        f.prototype.readAllMessages = function () {
          this.collection.readAll();
          return this
        };
        f.prototype.checkRenderPlaceholder = function () {
          if (this.collection.getUnarchivedCount())return this.$emptyPlaceholder.hide(),
            this.$messagesWrapper.show(), this.$detailWrapper.show();
          this.$emptyPlaceholder.show();
          this.$messagesWrapper.hide();
          return this.$detailWrapper.hide()
        };
        f.prototype.routeTo = function (a) {
          var b;
          a = $(a.currentTarget).data("url").split(":");
          switch (a.length) {
            case 1:
              b = "project/" + a[0] + "/home";
              break;
            case 2:
              b = "project/" + a[0] + "/board/scrum/" + a[1]
          }
          return z.navigate(b, {trigger: !0})
        };
        return f
      }(d);
      _.extend(d.prototype, m(".message-card"));
      _.extend(d.prototype, n);
      return d
    })
}).call(this);
define("views/board/task/task/templates/list-basic", [], function () {
  return function (d) {
    var a = '<div class="task-priority task-priority-' + d.priority + '"> <div class="task-priority-hint"></div></div>';
    d.hasRight ? a += " <div class=\"check-box\" data-gta='event' data-label='task|check done' data-action='click' data-category=\"div\"> <span class=\"icon icon-tick\"></span> </div>" : (a += ' <div class="check-box non-checkable hinted" data-title="', d.executorData && (a += "" + d.executorData.name + ""), a += "\" data-gta='event' data-label='task|check done' data-action='click' data-category=\"div\"> <span class=\"icon icon-tick\"></span> </div>");
    a += '<div class="task-content-set" data-id="' + d._id + "\" data-gta='event' data-label='task|open task detail' data-action='click' data-category=\"div\" > ";
    d.executorData && (a += " ", a = d.executorData.avatarUrl ? a + (' <div class="avatar img-circle img-24" style="background-image:url(' + d.executorData.avatarUrl + ')"></div> ') : a + ' <div class="avatar img-circle img-24" style="background-image:url(/v3.8.4/images/avatar/nobody-avator@2x.png)"></div> ', a += " ");
    a += ' <div class="task-content-wrapper ';
    if (d.isDone || d.dueDate)a +=
      "shorten";
    a += '"> <div class="task-content"> ' + d.content + " ";
    d.tasklist && d.tasklist.title && d.tasklist._id && (a += ' <a class="task-tag" data-tag="tasklist" data-gta="event" data-label="task|go to tasklist"> #' + d.tasklist.title + " </a> ");
    a += " </div> ";
    !d.isDone && d.dueDate ? a += ' <time class="task-duedate ' + d.dueDate.dateClass + '"> ' + d.dueDate.dateString + " </time> " : d.isDone && d.accomplished && (a += ' <time class="task-accomplished-date"> ' + d.accomplished.dateString + " </time> ");
    return a + " </div></div>"
  }
});
define("views/board/task/task/templates/card-basic", [], function () {
  return function (d) {
    var a = '<div class="task-priority task-priority-' + d.priority + '"> <div class="task-priority-hint"></div></div>';
    d.hasRight ? a += " <div class=\"check-box\" data-gta='event' data-label='check done'> <span class=\"icon icon-tick\"></span> </div>" : (a += ' <div class="check-box non-checkable hinted" data-title="', d.executorData && (a += "" + d.executorData.name + ""), a += "\" data-gta='event' data-label='check done'> <span class=\"icon icon-tick\"></span> </div>");
    a += '<div class="task-content-set open-detail" data-type="task" data-id="' + d._id + "\" data-gta='event' data-label='open task detail'> ";
    d.executorData && (a += " ", a = d.executorData.avatarUrl ? a + (' <div class="avatar img-circle img-24" style="background-image:url(' + d.executorData.avatarUrl + ')"></div> ') : a + ' <div class="avatar img-circle img-24" style="background-image:url(/v3.8.4/images/avatar/nobody-avator@2x.png)"></div> ', a += " ");
    a += ' <div class="task-content-wrapper"> <div class="task-content">' + d.content + "</div> </div> ";
    if (d.accomplished || d.dueDate || d.subtaskCount || d.commentsCount || d.attachmentsCount || d.tasklist && d.tasklist.title)a += ' <div class="task-info-wrapper"> ', d.tasklist && d.tasklist.title && (a += ' <span class="label"><span class="icon icon-th-list"></span> ' + d.tasklist.title + "</span> "), a += " ", d.isDone && d.accomplished ? a += ' <span class="label label-inverse"> <span class="icon icon-calendar"></span> ' + d.accomplished.dateString + " </span> " : (a += " ", d.dueDate && d.dueDate.dateClass && (a += ' <span class="label ', "overdue" ===
      d.dueDate.dateClass ? a += "label-important" : "today" === d.dueDate.dateClass ? a += "label-warning" : "upcoming" === d.dueDate.dateClass && (a += "label-info"), a += '"> <span class="icon icon-calendar ', "normal" !== d.dueDate.dateClass && (a += "icon-white"), a += '"></span> ' + d.dueDate.dateString + " </span> "), a += " ", d.subtaskCount && (a += ' <span class="label"><span class="icon icon-sub-task"></span> ' + d.subtaskCount.done + "/" + d.subtaskCount.total + " </span> "), a += " ", d.commentsCount && (a += ' <span class="label"><span class="icon icon-comment"></span> ' +
      d.commentsCount + " </span> "), a += " ", d.attachmentsCount && (a += ' <span class="label"><span class="icon icon-paperclip"></span> ' + d.attachmentsCount + " </span> "), a += " "), a += " </div> ";
    return a + "</div>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/task/task/index", "view views/board/task/task-priority/index warehouse collections/members util ./templates/list-basic ./templates/card-basic".split(" "), function (d, b, e, g, k, h, l) {
    var n, m, s;
    m = teambition.user;
    n = teambition.router;
    return function (d) {
      function f() {
        return s = f.__super__.constructor.apply(this,
          arguments)
      }

      a(f, d);
      f.prototype.viewName = "TaskView";
      f.prototype.tagName = "li";
      f.prototype.className = "task";
      f.prototype.events = {"click .check-box": "toggleTaskStatus", "click .task-priority-hint": "openTaskPrioritySetter", "click .task-tag": "onClickTaskTag"};
      f.prototype.initialize = function (a) {
        if (null != a && a.model)return this.options = a, this.taskModel = a.model, this.render().initDropHandler().listen(), this
      };
      f.prototype.listen = function () {
        this.listenTo(this.taskModel, "remove destroy", this.remove);
        this.listenTo(this.taskModel,
          "change", this.render);
        return this
      };
      f.prototype.render = function () {
        var a, b, d;
        a = this.taskModel.toJSON();
        this.options.noExecutor || (a.executorData = (null != (b = e.get(g, a._projectId, a._executorId)) ? b.toJSON() : void 0) || {});
        a.dueDate && (a.dueDate = k.formatDate(a.dueDate));
        a.accomplished && (a.accomplished = k.formatDate(a.accomplished));
        0 >= (null != (d = a.subtaskCount) ? d.total : void 0) && (a.subtaskCount = null);
        a.hidePriority = !!this.options.hidePriority;
        a._executorId === m.id && (a.hasRight = 1);
        this.$el.data({_taskId: a._id, _taskListId: a._tasklistId});
        this.$el.toggleClass("done", this.taskModel.get("isDone"));
        this.$el.attr("id", this.taskModel.id);
        "list" === this.options.viewType ? this.$el.html(h(a)) : this.$el.html(l(a));
        return this
      };
      f.prototype.renderExecutor = function () {
        var a, b;
        b = this.taskModel.get("_projectId");
        a = this.taskModel.get("_executorId");
        a = e.get(g, b, a);
        this.$(".avatar").css({"background-image": "url(" + a.get("avatarUrl") + ")"});
        return this
      };
      f.prototype.toggleTaskStatus = function () {
        if (0 < this.taskModel.get("hasRight") || this.taskModel.get("_executorId") ===
          m.id)this.$el.hasClass("done") ? (this.$el.removeClass("done"), this.taskModel.markUndo()) : (this.$el.addClass("done"), this.taskModel.markDone());
        return!1
      };
      f.prototype.popOutAvatar = function () {
        var a = this;
        _.delay(function () {
          return a.$(".avatar").addClass("pop-out")
        }, 200);
        return this
      };
      f.prototype.popBackAvatar = function () {
        var a = this;
        _.delay(function () {
          return a.$(".avatar").removeClass("pop-out")
        }, 200);
        return this
      };
      f.prototype.checkChangeExecutor = function (a, b) {
        return this.taskModel.get("_executorId") !== a ?
          b() : !1
      };
      f.prototype.initDropHandler = function () {
        var a, b = this;
        if (this.taskModel.get("isDone"))return this;
        a = null;
        this.$el.droppable({hoverClass: "hover", accept: ".member", addClasses: !1, tolerance: "pointer", drop: function () {
          if (b.taskModel.hasChanged()) {
            b.taskModel.save();
            b.popBackAvatar();
            try {
              return teambition.gta.event("member", "drop", "task card|drop member")
            } catch (a) {
            }
          }
        }, over: function (e, d) {
          var f;
          f = d.helper.data("id");
          return b.checkChangeExecutor(f, function () {
            a || (a = b.taskModel.get("_executorId"));
            b.taskModel.set("_executorId",
              f, {silent: !0});
            b.renderExecutor();
            b.popOutAvatar();
            return!0
          })
        }, out: function () {
          a && (b.taskModel.set("_executorId", a, {silent: !0}), b.renderExecutor());
          return b.popBackAvatar()
        }});
        return this
      };
      f.prototype.openTaskPrioritySetter = function (a) {
        var e = this;
        this.requestSubView(b, {currentPriority: this.taskModel.get("priority"), select: function (a) {
          return e.taskModel.save({priority: a})
        }}).setup($(a.currentTarget));
        return this
      };
      f.prototype.onClickTaskTag = function (a) {
        var b;
        a.stopPropagation();
        switch ($(a.currentTarget).data("tag")) {
          case "project":
            a =
              this.taskModel.get("project");
            n.navigate("project/" + a._id + "/board", {trigger: !0});
            break;
          case "tasklist":
            a = this.taskModel.get("project"), b = this.taskModel.get("tasklist"), n.navigate("project/" + a._id + "/board/scrum/" + b._id, {trigger: !0})
        }
        return this
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = function (a, e) {
    return function () {
      return a.apply(e, arguments)
    }
  }, a = {}.hasOwnProperty, f = function (b, e) {
    function d() {
      this.constructor = b
    }

    for (var f in e)a.call(e, f) && (b[f] = e[f]);
    d.prototype = e.prototype;
    b.prototype = new d;
    b.__super__ = e.prototype;
    return b
  };
  define("panel-view", ["view", "util"], function (a, e) {
    var g, k, h, l;
    g = $(document);
    $("body");
    h = function () {
      return"full" === teambition.PREFERENCE.get("memberBarMode")
    };
    k = function (a) {
      return"<div class='panel-layer scrollable thin-scroll panel-layer-" +
        a.depth + "'\n     data-depth='" + a.depth + "'></div>"
    };
    return function (a) {
      function b() {
        this.backed = d(this.backed, this);
        this.backing = d(this.backing, this);
        this.entered = d(this.entered, this);
        this.entering = d(this.entering, this);
        this.hidden = d(this.hidden, this);
        this.hiding = d(this.hiding, this);
        this.shown = d(this.shown, this);
        this.showing = d(this.showing, this);
        return l = b.__super__.constructor.apply(this, arguments)
      }

      f(b, a);
      b.prototype.viewName = "PanelView";
      b.prototype.className = "panel";
      b.prototype.panelWidth = 580;
      b.prototype.isIn = !1;
      b.prototype.$layers = [];
      b.prototype.useTransformAnimation = !0;
      b.prototype.events = {"mousewheel .scrollable": e.mousewheel};
      b.prototype.appendTo = "body";
      b.prototype.direction = "right-to-left";
      b.prototype.excludeSelectors = ".delete-handler .datepicker .popover .activity-destroyer .subtask-check-box .check-box .modal".split(" ");
      b.prototype.isSame = function () {
        return!0
      };
      b.prototype._formEvent = function () {
        return{currentTarget: this.$el, currentView: _.last(this.subViews)}
      };
      b.prototype.showing = function () {
        return this
      };
      b.prototype.shown = function () {
        return this
      };
      b.prototype.hiding = function () {
        return this
      };
      b.prototype.hidden = function () {
        return this
      };
      b.prototype.entering = function () {
        return this
      };
      b.prototype.entered = function () {
        return this
      };
      b.prototype.backing = function () {
        return this
      };
      b.prototype.backed = function () {
        return this
      };
      b.prototype.initialize = function (a) {
        var b = this;
        this.options = _.extend({toggle: !0, showing: function () {
          return b
        }, shown: function () {
          return b
        }, hiding: function () {
          return b
        }, hidden: function () {
          return b
        }, entering: function () {
          return b
        },
          entered: function () {
            return b
          }, backing: function () {
            return b
          }, backed: function () {
            return b
          }}, a);
        a = $(".float-view");
        a.length && (this.appendTo = a);
        this.$el.width(this.panelWidth);
        return this
      };
      b.prototype.getHiddenStatus = function () {
        return _.isNumber(this.rightOffset) ? {right: this.rightOffset - this.panelWidth} : h() ? {right: 200 - this.panelWidth} : {right: 60 - this.panelWidth}
      };
      b.prototype.getShownStatus = function () {
        return _.isNumber(this.rightOffset) ? {right: this.rightOffset} : h() ? {right: 200} : {right: 60}
      };
      b.prototype.renderLayer =
        function () {
          var a, b, e, d = this;
          if (2 !== arguments.length && "object" !== typeof arguments[1])return!1;
          a = $(k({depth: this.$layers.length + 1})).appendTo(this.$el);
          this.$layers.push(a);
          arguments[0].prototype.viewName ? (e = arguments[0], b = arguments[1], b = _.extend({noCreator: !0, success: function (b) {
            var e, f;
            if (b.activityTimelineView && b.$activityCreator)return f = !0, e = b.$activityCreator, e.css({height: 0}).addClass("scrollable").appendTo(d.$el), b.activityTimelineView.renderCreator(e), e.slideHide = function () {
              if (!f)return f = !0, a.css("bottom", ""), e.css("height", 71), e.transition({height: 0}, 300, "ease", function () {
                return e.hide()
              })
            }, e.slideShow = function () {
              if (f)return f = !1, e.show(), e.transition({height: 71}, 350, "ease", function () {
                a.css("bottom", 71);
                return null != e ? e.css("height", "auto") : void 0
              })
            }, e.slideShow()
          }}, b), e = this.requestSubView(e, b), e.$el.appendTo(a)) : (e = arguments[0], e.apply(this, [a]));
          return a
        };
      b.prototype.show = function (a) {
        var b, e, d, f = this;
        b = _.extend({showing: function () {
          return f
        }, shown: function () {
          return f
        }}, a);
        e = function (a) {
          f.showing(a);
          f.options.showing(a);
          return b.showing(a)
        };
        d = function (a) {
          f.shown(a);
          f.options.shown(a);
          return b.shown(a)
        };
        this.isIn || function () {
          var a, b;
          f.isIn = !0;
          a = f.getHiddenStatus();
          b = f.getShownStatus();
          f.$el.css(a).appendTo(f.appendTo);
          f.renderLayer(f.defaultLayer, f.options);
          e(f._formEvent());
          f.useTransformAnimation && (null != b.right ? (b.x = a.right - b.right, delete b.right) : null != b.left && (b.x = b.left - a.left, delete b.left));
          return f.$el.transition(b, 400, "ease", function () {
            f.handleClickOutside();
            return d(f._formEvent())
          })
        }();
        return this
      };
      b.prototype.hide = function (a) {
        var b, e, d = this;
        e = _.extend({hiding: function () {
          return d
        }, hidden: function () {
          return d
        }}, a);
        b = function (a) {
          d.hidden(a);
          d.options.hidden(a);
          return e.hidden(a)
        };
        g.off("click.panel");
        (function (a) {
          d.hiding(a);
          d.options.hiding(a);
          return e.hiding(a)
        })(this._formEvent());
        a = this.getHiddenStatus();
        this.getShownStatus();
        this.useTransformAnimation && (a.x = 0);
        null == a.opacity && (a.opacity = 0);
        this.$el.transition(a, 300, "ease", function () {
          for (d.isIn = !1; 0 < d.$layers.length;)d.$layers.pop().remove();
          b(d._formEvent());
          return d.remove()
        });
        return this
      };
      b.prototype.enter = function (a, b) {
        var e, d, f, g, h = this;
        g = _.extend({entering: function () {
          return h
        }, entered: function () {
          return h
        }}, b);
        f = function (a) {
          h.entered(a);
          h.options.entered(a);
          return g.entered(a)
        };
        (function (a) {
          h.entering(a);
          h.options.entering(a);
          return g.entering(a)
        })(this._formEvent());
        e = _.last(this.subViews);
        "function" === typeof e.undelegateEvents && e.undelegateEvents();
        d = _.last(this.$layers);
        e = this.renderLayer(a, b);
        d.transition({x: -30, opacity: 0}, 300,
          "ease");
        e.css({right: -this.panelWidth}).transition({x: -this.panelWidth}, 400, "ease", function () {
          return f(h._formEvent())
        });
        return this
      };
      b.prototype.back = function (a) {
        var b, e, d, f = this;
        d = _.extend({backing: function () {
          return f
        }, backed: function () {
          return f
        }}, a);
        a = function (a) {
          f.backing(a);
          f.options.backing(a);
          return d.backing(a)
        };
        e = function (a) {
          f.backed(a);
          f.options.backed(a);
          return d.backed(a)
        };
        1 >= this.$layers.length ? this.hide() : (a(this._formEvent()), b = this.$layers.pop(), a = _.last(this.$layers), b.transition({x: 0},
          300, "ease"), a.transition({x: 0, opacity: 1}, 400, "ease", function () {
          var a;
          b.remove();
          f.subViews.pop().remove();
          a = _.last(f.subViews);
          "function" === typeof a.delegateEvents && a.delegateEvents();
          return e(f._formEvent())
        }));
        return this
      };
      b.prototype.handleClickOutside = function () {
        var a = this;
        return _.defer(function () {
          return g.one("click.panel", function (b) {
            if (a.hide)return b = $(b.target), b.closest(a.$el).length || b.closest(a.excludeSelectors.join(",")).length ? a.handleClickOutside() : a.hide()
          })
        })
      };
      return b
    }(a)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/task/task-detail-panel/index", ["panel-view", "views/board/task/task-detail/index"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "taskDetailPanel";
      f.prototype.className = "task-detail-panel panel";
      f.prototype.defaultLayer = b;
      f.prototype.initialize = function (a) {
        if (!a || !a.taskModel && !a._taskId)return!1;
        this._taskId = a._taskId || a.taskModel.id;
        _.isNumber(a.rightOffset) && (this.rightOffset = a.rightOffset);
        return f.__super__.initialize.apply(this, arguments)
      };
      f.prototype.isSame = function (a) {
        var b;
        return(a._taskId || (null != (b = a.taskModel) ? b.id : void 0)) === this._taskId
      };
      return f
    }(d)
  })
}).call(this);
define("views/board/task/task-list/templates/group", [], function () {
  return function (d) {
    return'<li class="task-group-by" data-id="' + d._id + '"> <span class="task-group-name">' + d.name + "</span></li>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/task/task-list/index", ["view", "views/board/task/task/index", "views/board/task/task-detail-panel/index", "./templates/group"], function (d, b, e, g) {
    var k, h;
    k = teambition.APP;
    return function (d) {
      function f() {
        return h = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName =
        "TaskListView";
      f.prototype.className = "task-list";
      f.prototype.tagName = "ul";
      f.prototype.events = {"click .task-content-set": "openTaskDetail"};
      f.prototype.initialize = function (a) {
        if (!a.tasksCollection)return!1;
        this.options = a;
        this.tasksCollection = a.tasksCollection;
        this.tasklistModel = a.tasklistModel;
        this.renderBasic().listen(a);
        return this
      };
      f.prototype.listen = function (a) {
        this.listenTo(this.tasksCollection, "add", this.addTask);
        return this
      };
      f.prototype.renderBasic = function () {
        var a = this;
        this.tasksCollection.each(function (b) {
          return a.renderTask(b)
        });
        return this
      };
      f.prototype.renderTask = function (a, e) {
        var d, f, g;
        f = e ? "prependTo" : "appendTo";
        d = this.requestSubView(b, {model: a, viewType: "list", noExecutor: this.options.noExecutor}).$el;
        if (this.options.groupBy && (g = a.get("project")))f = this.getOrRenderGroup(g), d.insertAfter(f); else d[f](this.$el);
        return this
      };
      f.prototype.getOrRenderGroup = function (a) {
        var b;
        b = this.$("[data-id=" + a._id + "]");
        b.length || (b = $(g(a)), b.appendTo(this.$el));
        for (a = b.next(); a.length && !a.hasClass("task-group-by");)b = a, a = b.next();
        return b
      };
      f.prototype.addTask = function (a) {
        this.renderTask(a, null != this.options.isPrepend ? this.options.isPrepend : !0);
        return this
      };
      f.prototype.openTaskDetail = function (a) {
        var b, d, f;
        f = $(a.target).closest(".task").data("_taskId");
        a = this.tasksCollection.get(f);
        null != (b = k.currentView) && b.renderTaskDetail && !_.isNumber(this.options.rightOffset) ? (k.currentView.renderTaskDetail(a), k.currentView.updateUrl({_taskId: f, _tasklistId: (null != (d = this.tasklistModel) ? d.get("_id") : void 0) || a.get("_tasklistId")}, {trigger: !1})) : k.showPanel(e,
          {_projectId: a.get("_projectId"), _tasklistId: a.get("_tasklistId"), taskModel: a, rightOffset: this.options.rightOffset});
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/settings/user-settings/templates/basic", [], function () {
  return function (d) {
    return'<div class="user-settings-content card-content"></div>'
  }
});
define("views/settings/user-settings/templates/profile-tab", [], function () {
  return function (d) {
    for (var a = '<h3></h3><div class="settings-part user-info-settings"> <div class="avatar-uploader"> <div class="avatar"> <a class="edit-handler icon icon-pencil"></a> <div class="progress-mask"></div> </div> </div> <div class="user-info-content"> <form class="user-info-form"> <div class="form-group"> <label></label> <input class="name-input form-control" name="name" value="' + d.name + '"/> </div> <div class="form-group"> <label></label> <input class="setting-info-content member-info-content title-input form-control" name="title" value="' +
      d.title + '"/> </div> <div class="form-group clearfix"> <label></label> <div> <select class="birthday birthday-year form-control pull-left"> <option value="0"></option> ', f = (new Date).getFullYear(), b = 80; 0 < b; b--, f--)a += ' <option value="' + f + '" ', d.birthday && d.birthday.getFullYear() == f && (a += "selected"), a += ">" + f + "</option> ";
    a += ' </select> <select class="birthday birthday-month form-control pull-left"> <option value="0"></option> ';
    for (f = 1; 13 > f; f++)a += ' <option value="' + f + '" ', d.birthday && d.birthday.getMonth() ==
      f - 1 && (a += "selected"), a += ">" + f + "</option> ";
    a += ' </select> <select class="birthday birthday-day form-control pull-left"> <option value="0"></option> ';
    for (f = 1; 32 > f; f++)a += ' <option value="' + f + '" ', d.birthday && d.birthday.getDate() == f && (a += "selected"), a += ">" + f + "</option> ";
    return a += ' </select> </div> </div> <div class="form-group"> <label></label> <input class="setting-info-content member-info-content location-input form-control" name="location" type="text" value="' + d.location + '"/> </div> <div class="form-group"> <label></label> <input class="setting-info-content member-info-content phone-input form-control" name="phone" type="text" value="' +
      d.phone + '"/> </div> <div class="form-group"> <label></label> <input class="setting-info-content member-info-content website-input form-control" name="website" type="text" value="' + d.website + '"/> </div> <button class="btn btn-save btn-primary pull-left disabled" type="submit" data-gta="event" data-label="submit user settings">  </button> </form> </div></div>'
  }
});
define("views/settings/user-settings/templates/security-tab", [], function () {
  return function (d) {
    return'<div class="security-settings"> <h3></h3> <div class="mail-setting settings-part "> <p class="muted mail-desc">teambition</p> <ul class="mail-list"></ul> <div class="form-group clearfix"> <input class="new-mail-input form-control" placeholder="" /> <a class="btn btn-primary new-email-btn"></a> </div> </div> <h3></h3> <form class="password-form settings-part "> <p class="muted">,</p> <a class="btn btn-primary password-reset-handler">  </a> </form></div>'
  }
});
define("views/settings/user-settings/templates/notification-tab", [], function () {
  return function (d) {
    var a = '<h3></h3><div class="settings-part notification-settings"> <form class="notification-form"> <div class="form-group clearfix"> <p class="notification-type-label pull-right"></p> <p class="notification-type-label pull-right"></p> </div> <div class="form-group clearfix"> <label></label> <div class="toggle blue pull-right"> <input class="check" type="checkbox" data-type="newpost.mobile" ';
    d.newpost.mobile && (a += "checked");
    a += '> <div class="switch"></div> <div class="track"></div> </div> <div class="toggle blue pull-right"> <input class="check" type="checkbox" data-type="newpost.email" ';
    d.newpost.email && (a += "checked");
    a += '> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label></label> <div class="toggle blue pull-right"> <input class="check" type="checkbox" data-type="newtask.mobile" ';
    d.newtask.mobile && (a += "checked");
    a += '> <div class="switch"></div> <div class="track"></div> </div> <div class="toggle blue pull-right"> <input class="check" type="checkbox" data-type="newtask.email" ';
    d.newtask.email && (a += "checked");
    a += '> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label></label> <div class="toggle blue pull-right"> <input class="check" type="checkbox" data-type="newwork.mobile" ';
    d.newwork.mobile && (a += "checked");
    a += '> <div class="switch"></div> <div class="track"></div> </div> <div class="toggle blue pull-right"> <input class="check" type="checkbox" data-type="newwork.email" ';
    d.newwork.email && (a += "checked");
    a += '> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label></label> <div class="toggle blue pull-right"> <input class="check" type="checkbox" data-type="comment.mobile" ';
    d.comment.mobile && (a += "checked");
    a += '> <div class="switch"></div> <div class="track"></div> </div> <div class="toggle blue pull-right"> <input class="check" type="checkbox" data-type="comment.email" ';
    d.comment.email && (a += "checked");
    a += '> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label></label> <div class="toggle blue pull-right"> <input class="check" type="checkbox" data-type="involve.mobile" ';
    d.involve.mobile && (a += "checked");
    a += '> <div class="switch"></div> <div class="track"></div> </div> <div class="toggle blue pull-right"> <input class="check" type="checkbox" data-type="involve.email" ';
    d.involve.email && (a += "checked");
    a += '> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label></label> <div class="toggle blue pull-right"> <input class="check" type="checkbox" data-type="update.mobile" ';
    d.update.mobile && (a += "checked");
    a += '> <div class="switch"></div> <div class="track"></div> </div> <div class="toggle blue pull-right"> <input class="check" type="checkbox" data-type="update.email" ';
    d.update.email && (a += "checked");
    a += '> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label></label> <div class="toggle toggle-placeholder pull-right"> </div> <div class="toggle blue pull-right"> <input class="check" type="checkbox" data-type="daily.email" ';
    d.daily.email &&
    (a += "checked");
    a += '> <div class="switch"></div> <div class="track"></div> </div> </div> </form> ';
    d.desktopNotification && (a += ' <hr /> <div class="clearfix"> <a class="btn desktop-notification-handler"></a> </div> ');
    return a + "</div>"
  }
});
define("views/settings/user-settings/templates/error", [], function () {
  return function (d) {
    return'<div class="alert"> <a type="button" class="close pull-right icon icon-remove" data-dismiss="alert"></a> <span class="error-box"><strong>' + d + "</strong></span></div>"
  }
});
define("views/settings/user-settings/templates/email", [], function () {
  return function (d) {
    var a = '<li class="mail-item clearfix primary" data-id="' + d._emailId + '"> ' + d.email + ' <span class="label"></span> ';
    d.isActive || (a += ' <a class="btn btn-mini email-setting-handler" data-action="resend"></a> ');
    var a = a + "</li>", f = d.emails;
    if (f)for (var b, e = -1, g = f.length - 1; e < g;)b = f[e += 1], b.email != d.email && (a += '<li class="mail-item clearfix option"> ' + b.email + ' <div class="mail-handler pull-right" data-id="' + b._id +
      '"> ', a = 1 == b.state ? a + ' <a class="btn btn-mini email-setting-handler" data-action="setMain"></a> ' : a + ' <a class="btn btn-mini email-setting-handler" data-action="resend"></a> ', a += ' <a class="btn btn-mini btn-danger email-setting-handler" data-action="delete"></a> </div></li>');
    return a
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/settings/user-settings/index", "view lib/uploader/index lib/notification/index util moment hotkey ./templates/basic ./templates/profile-tab ./templates/security-tab ./templates/notification-tab ./templates/error ./templates/email essage".split(" "), function (d, b, e, g, k, h, l, n, m, s, r, t) {
    var v,
      p;
    v = teambition.PREFERENCE;
    return function (d) {
      function f() {
        return p = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "UserSettingsView";
      f.prototype.className = "user-settings-view";
      f.prototype.events = {"keyup .user-info-form input": "collectInfoChanges", "click .notification-form .check": "toggleNotificationSetting", "click .password-reset-handler": "resetPassword", "submit .user-info-form": "submitUserInfo", "change .birthday": "changeBirthday", "click .email-setting-handler": "emailSettingHandler",
        "click .new-email-btn": "addNewEmail", "click .desktop-notification-handler": "setupDesktopNotification"};
      f.prototype.initialize = function (a) {
        this.options = a || {};
        this.userModel = teambition.user;
        this.changes = {};
        this.renderBasic().toggle(this.options.tab || "user-info");
        return this
      };
      f.prototype.toggle = function (a) {
        if (a === this.tab)return this;
        this.tab = a;
        this.changes = {};
        switch (a) {
          case "user-info":
            this.renderProfileTab();
            break;
          case "security":
            this.renderSecurityTab();
            break;
          case "notification":
            this.renderNotificationTab()
        }
        this.listen(a);
        return this
      };
      f.prototype.listen = function (a) {
        this.stopListening();
        switch (a) {
          case "user-info":
            this.listenTo(this.userModel, "change:avatarUrl", this.renderAvatar);
            break;
          case "security":
            this.listenTo(this.userModel, "change:email change:emails", this.renderEmail);
            break;
          case "notification":
            this.listenTo(this.userModel, "change:notification")
        }
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(l());
        this.$header = this.$(".user-settings-header");
        this.$content = this.$(".user-settings-content");
        this.$mask =
          this.$content.find(".progress-mask");
        return this
      };
      f.prototype.renderAvatar = function () {
        this.$content.find(".avatar").css({"background-image": "url(" + this.userModel.get("avatarUrl") + ")"});
        return this
      };
      f.prototype.renderProfileTab = function () {
        this.$content.html(n(this.userModel.toJSON()));
        this.$nameInput = this.$content.find(".name-input");
        this.$titleInput = this.$content.find(".title-input");
        this.$locationInput = this.$content.find(".location-input");
        this.$websiteInput = this.$content.find(".website-input");
        this.$phoneInput = this.$content.find(".phone-input");
        this.$year = this.$content.find(".birthday-year");
        this.$month = this.$content.find(".birthday-month");
        this.$day = this.$content.find(".birthday-day");
        this.renderAvatar();
        this.initAvatarUploader();
        return this
      };
      f.prototype.renderSecurityTab = function () {
        this.$content.html(m(this.userModel.toJSON()));
        this.renderEmail(this.userModel);
        return this
      };
      f.prototype.renderEmail = function (a) {
        this.$content.find(".mail-list").html(t(a.toJSON()));
        return this
      };
      f.prototype.renderNotificationTab =
        function () {
          var a;
          a = v.structureNotification(this.changes);
          a.desktopNotification = e.support();
          this.$content.html(s(a));
          return this
        };
      f.prototype.initAvatarUploader = function () {
        var a, e = this;
        a = this.$content.find(".progress-mask");
        this.uploader = new b({model: this.userModel, pick: {id: this.$content.find(".edit-handler"), label: " ", multiple: !1}, dnd: this.$content.find(".avatar"), type: "avatar", onCreate: function (a) {
          return e.userModel.set("avatarUrl", a.thumbnailUrl)
        }, onStart: function () {
          return a.css("clip", "rect(0, 132px, 132px, 0)").html("")
        },
          onProgress: function (b) {
            return a.css("clip", "rect(" + 132 * b / 100 + "px, 132px, 132px, 0)")
          }, onComplete: function (b) {
            a.css("clip", "rect(132px, 132px, 132px, 0)");
            return e.userModel.save("avatarUrl", b.thumbnailUrl)
          }});
        return this
      };
      f.prototype.collectInfoChanges = function (a) {
        var b;
        b = $(a.currentTarget);
        a = b.val();
        b = b.attr("name");
        this.checkInfoChange(b, a);
        return this
      };
      f.prototype.checkInfoChange = function (a, b) {
        this.userModel.get(a) !== b ? this.changes[a] = b : delete this.changes[a];
        g.isEmpty(this.changes) ? this.$content.find(".btn-save").addClass("disabled") :
          this.$content.find(".btn-save").removeClass("disabled");
        return this
      };
      f.prototype.submitUserInfo = function (a) {
        var b = this;
        a.preventDefault();
        this.validUserInfo() && this.userModel.save(this.changes, {success: function () {
          b.$content.find(".btn-save").addClass("disabled");
          return Essage.show({message: "", status: "success"}, 2E3)
        }});
        return this
      };
      f.prototype.toggleNotificationSetting = function (a) {
        var b;
        a = $(a.currentTarget);
        b = a.data("type");
        a.is(":checked") ? this.changes[b] = !0 : this.changes[b] = !1;
        v.updateNotification(this.changes);
        return this
      };
      f.prototype.resetPassword = function (a) {
        var b;
        b = $(a.currentTarget);
        b.hasClass("sended") || (b.removeClass("btn-primary").addClass("sended").html(""), setTimeout(function () {
          return b.addClass("btn-primary").removeClass("sended").html("")
        }, 5E3), this.userModel.sendResetPasswordMail());
        return this
      };
      f.prototype.changeBirthday = function (a) {
        var b, e, d;
        d = this.$year.val();
        e = this.$month.val();
        b = this.$day.val();
        +d && +e && +b && (a = k(this.userModel.get("birthday")), a.set("year", d).set("month", e).set("date",
          b), this.checkInfoChange("birthday", a.toISOString()));
        return this
      };
      f.prototype.validUserInfo = function () {
        var a, b, e, d, f, g = this;
        b = !0;
        f = this.changes;
        for (a in f)switch (d = f[a], a) {
          case "name":
            "" === d.replace(/\s/g, "") && (this.$nameInput.addClass("red").attr("placeholder", "").val(""), setTimeout(function () {
              return g.$nameInput.removeClass("red").attr("placeholder", "")
            }, 3E3), b = !1);
            break;
          case "phone":
            if ("" === d.replace(/\s/g, ""))continue;
            e = /\d{11}$/;
            e.exec(d) || (this.$phoneInput.addClass("red").attr("placeholder",
              "").val(""), setTimeout(function () {
              return g.$phoneInput.removeClass("red").attr("placeholder", "")
            }, 3E3), b = !1)
        }
        return b
      };
      f.prototype.emailSettingHandler = function (a) {
        var b, e, d = this;
        b = $(a.currentTarget);
        a = b.parent().data("id");
        e = b.data("action");
        if ("resend" !== e || !/\d/.test(b.html()))return this.userModel.emailSetting(e, a, function (a, f) {
          var g, h;
          d.emailSettingErrorHandler(a, f);
          if ("resend" === e && !a) {
            b.html("(30)");
            for (h = g = 30; --g;)setTimeout(function () {
                --h;
                return b.html("(" + h + ")")
              },
              1E3 * (30 - g));
            return setTimeout(function () {
              return b.html("")
            }, 3E4)
          }
        })
      };
      f.prototype.addNewEmail = function (a) {
        var b, e = this;
        b = $(a.currentTarget).prev("input").val();
        if (g.isEmail(b))return this.userModel.addEmail(b, function (a, b) {
          return e.emailSettingErrorHandler(a, b)
        }), $(a.currentTarget).prev("input").val("")
      };
      f.prototype.emailSettingErrorHandler = function (a, b) {
        var e, d;
        d = {400209: "", 400211: "!", 400212: ""}[a] || b;
        e = this.$(".security-settings");
        e.find(".alert").remove();
        e.prepend(r(d));
        e.find(".alert").addClass(a ? "alert-danger" : "alert-info");
        return this
      };
      f.prototype.setupDesktopNotification = function () {
        e.setup();
        return this
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/note", ["model"], function (d) {
    var b;
    return function (e) {
      function d() {
        return b = d.__super__.constructor.apply(this, arguments)
      }

      a(d, e);
      d.prototype.name = "note";
      d.prototype.defaults = {objectType: "note", _teamId: "", _userId: "", created: "", updated: "", title: "", content: ""};
      d.prototype.getParams = function (a, b) {
        if ("update" === a)return{title: this.get("title"), content: this.get("content")}
      };
      return d
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/notes", ["collection", "models/note"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.model = b;
      f.prototype.name = "notes";
      f.prototype.orderBy = "latest-updated";
      return f
    }(d)
  })
}).call(this);
define("views/myboard/notes/templates/basic", [], function () {
  return function (d) {
    return'<h3 class="note-header">  <span class="notes-count">0</span></h3><a class="create-note-handler btn btn-primary" data-gta="event" data-label="create note"> \x3c!-- <span class="icon icon-plus"></span> --\x3e </a><ul class="notes-list"></ul>'
  }
});
define("views/myboard/notes/templates/note", [], function () {
  return function (d) {
    return'<li class="note card" data-id="' + d._id + '" data-gta="event" data-label="show note detail"> <input class="note-title" placeholder="..." value="' + (d.title || "") + '"/> <textarea class="note-content" placeholder="...">' + (d.content || "") + '</textarea> <time class="time-stamp">' + (d.dateString || "") + '</time> <div class="note-handler-set clearfix"> <a class="delete-note-handler pull-left" data-gta="event" data-label="delete note"> <span class="icon icon-trash"></span>  </a> <a class="save-note-handler btn btn-primary pull-right" data-gta="event" data-label="save note">  </a> <a class="cancel-note-handler pull-right">  </a> </div></li>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/myboard/notes/index", "view util warehouse collections/notes ./templates/basic ./templates/note".split(" "), function (d, b, e, g, k, h) {
    var l, n;
    l = teambition.user;
    return function (d) {
      function f() {
        return n = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "NotesView";
      f.prototype.tagName =
        "div";
      f.prototype.className = "notes-view clearfix";
      f.prototype.events = {"click .create-note-handler": "createNote", "click .delete-note-handler": "deleteNote", "click .save-note-handler": "saveNote", "click .cancel-note-handler": "blurNote", "focusin .note": "editNote"};
      f.prototype.initialize = function () {
        this.notesCollection = e.get(g, l.id);
        this.renderBasic();
        return this
      };
      f.prototype.listen = function () {
        this.listenTo(this.notesCollection, "add", this.addNote);
        return this
      };
      f.prototype.load = function (a) {
        a || (a = {});
        "function" === typeof a.beforeSend && a.beforeSend();
        e.request(g, l.id, {success: function (b) {
          return"function" === typeof a.success ? a.success() : void 0
        }});
        return this
      };
      f.prototype.renderBasic = function () {
        var a = this;
        this.$el.html(k());
        this.$list = this.$(".notes-list");
        this.load({beforeSend: function () {
          return a.showLoadingIndicator(a.$el)
        }, success: function () {
          a.hideLoadingIndicator();
          a.notesCollection.each(function (b) {
            return a.renderNote(b)
          });
          return a.listen()
        }});
        return this
      };
      f.prototype.renderNote = function (a, e) {
        var d;
        d = a.toJSON();
        d.dateString = b.formatDate(d.updated).dateString;
        d = $(h(d));
        d.find(".note-content").flexText();
        d[!0 === e ? "prependTo" : "appendTo"](this.$list);
        this.refreshNotesCount();
        return this
      };
      f.prototype.addNote = function (a) {
        this.$("[data-id=" + a.id + "]").length || this.renderNote(a, !0);
        return this
      };
      f.prototype.createNote = function () {
        var a;
        a = $(h({_id: "new_note"}));
        a.find(".note-content").flexText();
        a.prependTo(this.$list);
        a.find(".note-title").focus();
        return this
      };
      f.prototype.deleteNote = function (a) {
        var b, e;
        b = $(a.currentTarget).closest(".note");
        null != (e = this.notesCollection.get(b.data("id"))) && e.destroy();
        b.transition({scale: [1, 0.2], opacity: 0}, 218, "ease", function () {
          return b.remove()
        });
        this.refreshNotesCount();
        return this
      };
      f.prototype.saveNote = function (a) {
        var b, e, d = this;
        b = $(a.currentTarget).closest(".note");
        a = {title: b.find(".note-title").val().trim(), content: b.find(".note-content").val().trim()};
        if (a.content)return(e = this.notesCollection.get(b.data("id"))) ? e.save(a, {wait: !0, success: function () {
          return d.updateNote(e)
        }}) : this.notesCollection.create(a,
          {wait: !0, success: function () {
            return b.remove()
          }}), this.blurNote(b), this
      };
      f.prototype.editNote = function (a) {
        var e, d = this;
        e = $(a.currentTarget);
        e.addClass("active");
        b.handleClickOutside(e, function () {
          return d.blurNote(e)
        }, "click");
        return this
      };
      f.prototype.blurNote = function (a) {
        a = a.currentTarget ? $(a.currentTarget).closest(".note") : a;
        "new_note" === a.data("id") ? a.remove() : (a.removeClass("active"), a = this.notesCollection.get(a.data("id")), this.updateNote(a));
        return this
      };
      f.prototype.updateNote = function (a) {
        var e;
        e = this.$("[data-id=" + a.id + "]");
        e.length && (a = a.toJSON(), a.dateString = b.formatDate(a.updated).dateString, e.find(".note-title").val(a.title || ""), e.find(".note-content").val(a.content || ""), e.find(".time-stamp").text(a.dateString || ""));
        return this
      };
      f.prototype.refreshNotesCount = function () {
        this.$(".notes-count").text(this.notesCollection.length);
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/myboard/app-download/templates/basic", [], function () {
  return function (d) {
    return'<div class="link-part"><h3></h3><div class="download-link-wrapper clearfix"><a class="app-store-link" href="https://itunes.apple.com/cn/app/teambition/id656664814?l=en&mt=8" target="_blank"></a><a class="android-link" href="https://dn-st.qbox.me/Teambition-Android.apk"></a></div></div><div class="qr-part"><h3></h3><div class="qr-code-wrapper clearfix"><div class="qr-code"></div><div class="qr-description"><p></p><br><p> <a href="http://www.teambition.com/download_apps" target="_blank">www.teambition.com/download_apps</a></p></div></div></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/myboard/app-download/index", ["view", "util", "./templates/basic"], function (d, b, e) {
    var g;
    return function (b) {
      function d() {
        return g = d.__super__.constructor.apply(this, arguments)
      }

      a(d, b);
      d.prototype.viewName = "AppDownloadView";
      d.prototype.tagName = "div";
      d.prototype.className = "app-download";
      d.prototype.initialize =
        function () {
          this.render();
          return this
        };
      d.prototype.render = function () {
        this.$el.html(e());
        return this
      };
      return d
    }(d)
  })
}).call(this);
define("views/myboard/helper/templates/basic", [], function () {
  return function (d) {
    return'<div class="card-content"> <div class="tab-content"> <div class="tab-pane active" id="help-question"> <h3></h3> <div class="pane-content"> <p> teambition </p> <div class="search-input-wrapper"> <input class="form-control pull-left search-input" style="text"> <a class="btn btn-primary search-submit"><span class="icon icon-search"></span></a> </div> <p></p> <textarea class="form-control feedback-input" autofocus="true" placeholder=""></textarea> <a class="btn btn-primary pull-right feedback-submit disabled"></a> </div> </div> <div class="tab-pane" id="help-shortcuts"> <h3></h3> <div class="cheat-sheet-part"> <ul class="cheat-sheet-item-list"> <li class="cheat-sheet-item"> <span class="key">h</span> <span class="function"></span> </li> <li class="cheat-sheet-item"> <span class="key">i</span> <span class="function"></span> </li> <li class="cheat-sheet-item"> <span class="key">?</span> <span class="key">n</span> <span class="function"></span> </li> <li class="cheat-sheet-item"> <span class="key">`</span> <span class="key">shift + `</span> <span class="function">/</span> </li> <li class="cheat-sheet-item"> <span class="key">shift + m</span> <span class="function">Markdown</span> </li> </ul> </div> <h3></h3> <div class="cheat-sheet-part"> <ul class="cheat-sheet-item-list"> <li class="cheat-sheet-item"> <span class="key">j</span> <span class="function"></span> </li> <li class="cheat-sheet-item"> <span class="key">k</span> <span class="function"></span> </li> <li class="cheat-sheet-item"> <span class="key">a</span> <span class="function"></span> </li> </ul> </div> <h3></h3> <div class="cheat-sheet-part"> <ul class="cheat-sheet-item-list"> <li class="cheat-sheet-item"> <span class="key">c</span> <span class="function"></span> </li> <li class="cheat-sheet-item"> <span class="key">j</span> <span class="function"></span> </li> <li class="cheat-sheet-item"> <span class="key">k</span> <span class="function"></span> </li> <li class="cheat-sheet-item"> <span class="key">r</span> <span class="function"></span> </li> </ul> </div> <h3></h3> <div class="cheat-sheet-part"> <ul class="cheat-sheet-item-list"> <li class="cheat-sheet-item"> <span class="key">c</span> <span class="function"></span> </li> </ul> </div> </div> <div class="tab-pane" id="help-about"> <h3></h3> <ul class="sns-info clearfix"> <li class="sina-info clearfix"> <div class="sns-logo sina pull-left"></div> <div class="sns-desc sina pull-left"> <label></label> <p>@teambition</p> </div> <div class="pull-right"> <a href="http://weibo.com/teambition" target="_blank" class="btn btn-primary"><span class="icon icon-plus"></span> </a> </div> </li> <li class="qq-info clearfix"> <div class="sns-logo qq pull-left"></div> <div class="sns-desc qq pull-left"> <label>QQ</label> <p>329601963</p> </div> <div class="pull-right"> <a href="http://wp.qq.com/wpa/qunwpa?idkey=f12bcaf9c408d7adadf0f204217256e98250e99f41ed7a32fd0b6913aaf7f1d8" target="_blank" class="btn btn-primary"><span class="icon icon-plus"></span> </a> </div> </li> <li class="douban-info clearfix"> <div class="sns-logo douban pull-left"></div> <div class="sns-desc douban pull-left"> <label></label> <p>Teambition</p> </div> <div class="pull-right"> <a href="http://www.douban.com/group/425012/" target="_blank" class="btn btn-primary"><span class="icon icon-plus"></span> </a> </div> </li> <li class="weixin-info clearfix"> <div class="sns-logo weixin pull-left"></div> <div class="sns-desc weixin pull-left"> <label></label> <p></p> </div> <div class="pull-right"> <div class="qr-wrapper"></div> </div> </li> </ul> <div class="footer-info"> <a href="https://www.teambition.com/new" target="_blank"></a> <span class="vertical-line">|</span> <a href="http://blog.teambition.com/" target="_blank"></a> </div> </div> </div></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/myboard/helper/index", ["view", "util", "./templates/basic"], function (d, b, e) {
    var g, k;
    g = teambition.user;
    return function (b) {
      function d() {
        return k = d.__super__.constructor.apply(this, arguments)
      }

      a(d, b);
      d.prototype.viewName = "HelperView";
      d.prototype.tagName = "div";
      d.prototype.className = "helper";
      d.prototype.events =
      {"click .search-submit": "submitSearch", "input .feedback-input": "checkSubmitState", "click .feedback-submit": "submitFeedback"};
      d.prototype.initialize = function () {
        this.render();
        return this
      };
      d.prototype.render = function () {
        this.$el.html(e());
        this.$searchInput = this.$el.find(".search-input");
        this.$feedbackInput = this.$el.find(".feedback-input");
        this.$feedbackSubmit = this.$el.find(".feedback-submit");
        this.autoFocus();
        return this
      };
      d.prototype.autoFocus = function () {
        var a = this;
        return _.delay(function () {
            return a.$searchInput.focus()
          },
          200)
      };
      d.prototype.submitSearch = function () {
        var a;
        a = this.$searchInput.val();
        return window.open("https://www.teambition.com/search?q=" + a, "_blank")
      };
      d.prototype.checkSubmitState = function () {
        return this.$feedbackInput.val() ? this.$feedbackSubmit.removeClass("disabled") : this.$feedbackSubmit.addClass("disabled")
      };
      d.prototype.submitFeedback = function () {
        var a, b, e, d = this;
        a = this.$feedbackInput.val();
        e = g.get("name");
        b = g.get("email");
        if (a)return $.ajax({url: "https://www.teambition.com/ask.json", method: "post", data: {username: e,
          email: b, title: a}, beforeSend: function () {
          d.$feedbackSubmit.addClass("disabled");
          return d.$feedbackInput.attr("disabled", "disabled")
        }}).done(function () {
            d.$feedbackSubmit.removeClass("disabled");
            d.$feedbackInput.removeAttr("disabled", "disabled");
            d.$feedbackInput.val("").trigger("blur");
            return Essage.show({message: "!  :)", status: "success"}, 3E3)
          })
      };
      return d
    }(d)
  })
}).call(this);
define("views/myboard/myboard/templates/basic", [], function () {
  return function (d) {
    return'<header class="myboard-header navbar navbar-fixed-top" data-gta="event" data-label="close myboard"> <div class="navbar-inner"> <a class="brand central"></a> </div></header><div class="myboard-body clearfix"> <div class="myboard-nav"> <ul class="list top-list"> <li><a class="myboard-tasks-handler" data-gta="event" data-label="user tasks"><span class="icon icon-tick"></span></a></li> <li><a class="myboard-notes-handler" data-gta="event" data-label="user notebook"><span class="icon icon-book"></span></a></li> <li class="with-sub-nav"> <a class="myboard-settings-handler" data-gta="event" data-label="user settings"><span class="icon icon-cog"></span></a> <span class="caret"></span> <ul class="user-settings-nav nav nav-tabs sub-nav"> <li class="active"> <a class="user-switcher-toggler" data-toggle="user-info" data-gta="event" data-label="user info"> </a> </li> <li> <a class="user-switcher-toggler" data-toggle="security" data-gta="event" data-label="security settings"> </a> </li> <li> <a class="user-switcher-toggler" data-toggle="notification" data-gta="event" data-label="notification settings"> </a> </li> </ul> </li> </ul> <ul class="list bottom-list"> <li><a class="myboard-app-handler" data-gta="event" data-label="user download app"><span class="icon icon-arrow-down"></span></a></li> <li class="with-sub-nav"> <a class="myboard-help-handler" data-gta="event" data-label="show helper"><span class="icon icon-question"></span></a> <span class="caret"></span> <ul class="helper-nav nav nav-tabs sub-nav"> <li class="active"> <a href="#help-question" data-toggle="pill" class="help-question"></a> </li> <li> <a href="#help-shortcuts" data-toggle="pill"></a> </li> <li> <a href="#help-about" data-toggle="pill"></a> </li> </ul> </li> <li><a class="myboard-logout-handler btn" href="/logout" data-gta="event" data-label="log out"></a></li> </ul> </div> <div class="myboard-content tab-content thin-scroll"> </div></div>'
  }
});
define("views/myboard/myboard/templates/tasks", [], function () {
  return function (d) {
    return'<div class="today-tasks" data-gta="event" data-label="myboard today tasks" data-value="myboard today tasks"> <h3>  <span class="today-task-count">0</span></h3></div><div class="future-tasks" data-gta="event" data-label="myboard future tasks" data-value="myboard future tasks"> <h3>  <span class="future-task-count">0</span></h3></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/myboard/myboard/index", "view moment warehouse collections/tasks views/board/task/task-list/index views/settings/user-settings/index views/myboard/notes/index views/myboard/app-download/index views/myboard/helper/index ./templates/basic ./templates/tasks".split(" "), function (d, b, e, g, k, h, l, n, m, s, r) {
    var t, v, p;
    t = teambition.APP;
    v = teambition.user;
    return function (d) {
      function f() {
        return p = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "MyBoardView";
      f.prototype.tagName = "section";
      f.prototype.className = "my-board-view float-view";
      f.prototype.title = "My board";
      f.prototype.hotkeys = {esc: function (a) {
        a.preventDefault();
        return this.clear()
      }};
      f.prototype.events = {"click .myboard-header": "clear", "click .myboard-footer": "clear", "click .myboard-tasks-handler": "openTasks", "click .myboard-notes-handler": "openNotes",
        "click .myboard-settings-handler": "openUserSettings", "click .myboard-app-handler": "openAppDownload", "click .myboard-help-handler": "openHelpler", "click .user-switcher-toggler": "switchUserSettings", mousewheel: function (a, b) {
          a.stopPropagation();
          if (a.target === this.el)return this.$content.scrollTop(this.$content.scrollTop() - b)
        }};
      f.prototype.settings = {animate_open: "dropout", animate_close: "slideup"};
      f.prototype.clear = function () {
        return t.Float.close()
      };
      f.prototype.initialize = function () {
        this.todayTasksCollection =
          e.get(g, "" + v.id + "_today_tasks");
        this.futureTasksCollection = e.get(g, "" + v.id + "_future_tasks");
        this.renderBasic().listen();
        this.openTasks();
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(s());
        this.$list = this.$(".list");
        this.$helperNav = this.$(".helper-nav");
        this.$content = this.$(".myboard-content");
        this.$userSettingsNav = this.$(".user-settings-nav");
        return this
      };
      f.prototype.listen = function () {
        var a = this;
        this.listenTo(this.todayTasksCollection, "add remove", this.refreshTodayTaskCount);
        this.listenTo(this.futureTasksCollection,
          "add remove", this.refreshFutureTaskCount);
        this.listenTo(this.todayTasksCollection, "change:_executorId", function (b, e) {
          if (e !== v.id)return a.todayTasksCollection.remove(b)
        });
        this.listenTo(this.futureTasksCollection, "change:_executorId", function (b, e) {
          if (e !== v.id)return a.futureTasksCollection.remove(b)
        });
        return this
      };
      f.prototype.queryTasks = function (a) {
        var d, f = this;
        a || (a = {});
        "function" === typeof a.beforeSend && a.beforeSend();
        d = Math.ceil(b().valueOf() / 1E3 / 60 / 20);
        e.request(g, "" + v.id + "_" + d, {boundToObjectType: "",
          params: {_executorId: v.id, isDone: !1}, success: function (b) {
            b.each(function (a) {
              var b;
              b = a.getScope();
              if ("today" === b)return f.todayTasksCollection.add(a, {merge: !0});
              if ("future" === b)return f.futureTasksCollection.add(a, {merge: !0})
            });
            return"function" === typeof a.success ? a.success() : void 0
          }});
        return this
      };
      f.prototype.activeTab = function (a, b) {
        var e;
        e = $(a).parent("li");
        if (!e.hasClass("active"))return b || (b = this.$list), b.children(".active").removeClass("active"), e.addClass("active"), !0
      };
      f.prototype.openTasks = function (a) {
        var b =
          this;
        a = (null != a ? a.currentTarget : void 0) || this.$(".myboard-tasks-handler");
        if (this.activeTab(a))return this.$content.html(""), this.queryTasks({beforeSend: function () {
          return b.showLoadingIndicator(b.$content)
        }, success: function () {
          var a, e;
          b.hideLoadingIndicator();
          null != (a = b.todayTasksListView) && a.remove();
          null != (e = b.futureTasksListView) && e.remove();
          b.todayTasksListView = b.requestSubView(k, {isPrepend: !0, groupBy: !0, noExecutor: !0, rightOffset: 0, tasksCollection: b.todayTasksCollection});
          b.futureTasksListView =
            b.requestSubView(k, {isPrepend: !0, groupBy: !0, noExecutor: !0, rightOffset: 0, tasksCollection: b.futureTasksCollection});
          b.$content.html(r());
          b.todayTasksListView.$el.appendTo(b.$(".today-tasks"));
          b.futureTasksListView.$el.appendTo(b.$(".future-tasks"));
          return b.refreshTodayTaskCount().refreshFutureTaskCount()
        }}), this
      };
      f.prototype.openNotes = function (a) {
        var b;
        if (this.activeTab(a.currentTarget))return null != (b = this.currentView) && b.remove(), this.currentView = this.requestSubView(l), this.$content.html(this.currentView.$el),
          this
      };
      f.prototype.openUserSettings = function (a) {
        var b;
        if (this.activeTab(a.currentTarget))return null != (b = this.currentView) && b.remove(), this.currentView = this.requestSubView(h), this.activeTab(this.$("[data-toggle=user-info]"), this.$userSettingsNav), this.$content.html(this.currentView.$el), this
      };
      f.prototype.openAppDownload = function (a) {
        var b;
        if (this.activeTab(a.currentTarget))return null != (b = this.currentView) && b.remove(), this.currentView = this.requestSubView(n), this.$content.html(this.currentView.$el),
          this
      };
      f.prototype.openHelpler = function (a) {
        var b;
        if (this.activeTab(a.currentTarget))return null != (b = this.currentView) && b.remove(), this.currentView = this.requestSubView(m), this.activeTab(this.$(".help-question"), this.$helperNav), this.$content.html(this.currentView.$el), this
      };
      f.prototype.switchUserSettings = function (a) {
        this.currentView instanceof h && this.currentView.$el && (a = $(a.currentTarget), this.activeTab(a, this.$userSettingsNav), this.currentView.toggle(a.data("toggle")));
        return this
      };
      f.prototype.refreshTodayTaskCount =
        function () {
          this.$(".today-task-count").text(this.todayTasksCollection.length);
          return this
        };
      f.prototype.refreshFutureTaskCount = function () {
        this.$(".future-task-count").text(this.futureTasksCollection.length);
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/core/float/templates/basic", [], function () {
  return function (d) {
    return'<div class="slide-view-wrapper" id="slide-view-wrapper"></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/core/float/index", ["view", "views/inbox/inbox/index", "views/myboard/myboard/index", "./templates/basic"], function (d, b, e, g) {
    var k, h, l, n;
    l = teambition.PREFERENCE;
    h = teambition.APP;
    k = $("body");
    return function (d) {
      function f() {
        return n = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName =
        "FloatView";
      f.prototype.defaultOptions = {animate_open: !1, animate_close: !1, animate_start: !1};
      f.prototype._options = {};
      f.prototype.hotkeys = {i: "toggleInbox", "n|m": "toggleDashboard"};
      f.prototype.open = function (a, b) {
        var e = this;
        h.hidePanel();
        this.currentView instanceof a ? (this.currentView.remove(), this.currentView = this.requestSubView(a, b), this.currentView.$el.appendTo(k), this.listenTo(this.currentView, "close", function () {
          return e.close()
        })) : this.close(function () {
          k.addClass("float-open");
          e.currentView = e.requestSubView(a,
            b);
          e._options = _.extend({}, e.defaultOptions, e.currentView.settings || {}, b || {});
          e.$parent = e._options.$parent || k;
          e._options.animate_open ? e.animate(e.currentView.$el, "open", e._options.animate_open, e._options.afterOpen || function () {
          }) : e.currentView.$el.appendTo(k);
          return e.listenTo(e.currentView, "close", function () {
            return e.close()
          })
        });
        return this
      };
      f.prototype.close = function (a) {
        var b, e, d;
        e = this.currentView;
        b = this.$container;
        null != (d = this.currentView) && "function" === typeof d.beforeClose && d.beforeClose();
        delete this.currentView;
        k.removeClass("float-open");
        this._options.animate_close && e ? this.animate(e.$el, "close", this._options.animate_close, function () {
          null != e && "function" === typeof e.remove && e.remove();
          null != b && "function" === typeof b.remove && b.remove();
          return"function" === typeof a ? a() : void 0
        }) : (null != e && "function" === typeof e.remove && e.remove(), "function" === typeof a && a());
        return this
      };
      f.prototype.toggle = function (a, b) {
        var e = this;
        b || (b = {});
        (b.isSame || function () {
          return e.currentView instanceof a
        })() ? this.close() : this.open(a, b);
        return this
      };
      f.prototype.toggleInbox = function () {
        this.toggle(b);
        return this
      };
      f.prototype.toggleDashboard = function () {
        this.toggle(e);
        return this
      };
      f.prototype.animate = function (a, b, e, d) {
        return"open" === b ? this.animate_open(a, b, e, d) : this.animate_close(a, b, e, d)
      };
      f.prototype.animate_open = function (a, b, e, d) {
        var f, h, m = this;
        switch (e) {
          case "dropout":
            return k.addClass("modal-open"), a.css({top: "-100%"}), a.appendTo(k), a.transition({top: 0}, 300, "ease", function () {
              return a.transition({top: "-1%"}, 80, function () {
                return a.transition({top: 0},
                  40, function () {
                    return"function" === typeof d ? d() : void 0
                  })
              })
            }), null;
          case "slide":
            b = this._options.direction || "left";
            switch (b) {
              case "left":
                f = {position: "absolute", right: "-100%"};
                break;
              case "right":
                f = {position: "absolute", left: "-100%"}
            }
            f = _.extend({}, f, this._options.startCss);
            this.$container = this._options.$container || $(g());
            this.$container.css(f);
            this._options.delay || this.$container.append(a);
            this.$parent.append(this.$container);
            f = this.$container.width();
            switch (b) {
              case "left":
                this.$container.css({right: -f +
                  "px"});
                h = "full" === l.get("memberBarMode") ? 200 : 60;
                h = this._options.endCss || {right: h};
                break;
              case "right":
                this.$container.css({left: -f + "px"}), h = this._options.endCss || {left: 0}
            }
            return this.$container.animate(h, 400, null, function () {
              m._options.delay && m.$container.append(a);
              return d(m.$container, m.$parent)
            })
        }
      };
      f.prototype.animate_close = function (a, b, e, d) {
        var f, g;
        switch (e) {
          case "slideup":
            return k.removeClass("modal-open"), a.transition({top: "-100%"}, 300, "snap", function () {
              return"function" === typeof d ? d() : void 0
            });
          case "slide":
            a = this._options.direction || "left";
            "function" === typeof(g = this._options).beforeClose && g.beforeClose(this.$container, this.$parent);
            g = this.$container.width();
            switch (a) {
              case "left":
                f = {right: -g + "px"};
                break;
              case "right":
                f = {left: -g + "px"}
            }
            return this.$container.animate(f, 200, null, d)
        }
      };
      return f
    }(d)
  })
}).call(this);
define("views/core/guide/templates/basic", [], function () {
  return function (d) {
    return'<div class="card"> <header class="card-header"> <h3 class="card-title">Teambition</h3> <a class="close-window-handler close"> <span class="icon icon-remove-sign"></span> </a> </header> <div class="card-content"> <video src="https://dn-st.qbox.me/teambition2.0.mpg?avthumb/mp4/r/30/vcodec/libx264" autoplay="autoplay" controls="controls"></video> </div></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/core/guide/index", ["view", "./templates/basic"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "GuideView";
      f.prototype.className = "guide-video modal";
      f.prototype.hotkeys = {esc: "close"};
      f.prototype.events =
      {"click .close-window-handler": "close"};
      f.prototype.initialize = function () {
        return this.$el.html(b())
      };
      f.prototype.close = function () {
        var a;
        null != (a = this.parentView) && a.remove();
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/member/member-finder/templates/basic", [], function () {
  return function (d) {
    var a = "";
    d.isEmail ? a += ' <li> <a class="member-item" data-param="' + d.params + '"> ' + d.email + " </a> </li>" : (a += ' <li> <a class="member-item ', d.invited && (a += "added"), a += '"> <div class="avatar img-circle img-24" style="background-image:url(' + d.avatarUrl + ');"> </div> ' + d.name + " ", d.isActive && (a += " " + (d.title || d.location || "") + " "), a += " </a> </li>");
    return a
  }
});
define("jqueryui/position", ["jquery"], function (d) {
  (function (a, d) {
    function b(a, b, e) {
      return[parseInt(a[0], 10) * (t.test(a[0]) ? b / 100 : 1), parseInt(a[1], 10) * (t.test(a[1]) ? e / 100 : 1)]
    }

    function e(b) {
      var e = b[0];
      return 9 === e.nodeType ? {width: b.width(), height: b.height(), offset: {top: 0, left: 0}} : a.isWindow(e) ? {width: b.width(), height: b.height(), offset: {top: b.scrollTop(), left: b.scrollLeft()}} : e.preventDefault ? {width: 0, height: 0, offset: {top: e.pageY, left: e.pageX}} : {width: b.outerWidth(), height: b.outerHeight(), offset: b.offset()}
    }

    a.ui = a.ui || {};
    var g, k = Math.max, h = Math.abs, l = Math.round, n = /left|center|right/, m = /top|center|bottom/, s = /[\+\-]\d+%?/, r = /^\w+/, t = /%$/, v = a.fn.position;
    a.position = {scrollbarWidth: function () {
      if (g !== d)return g;
      var b, e, h = a("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>");
      e = h.children()[0];
      a("body").append(h);
      b = e.offsetWidth;
      h.css("overflow", "scroll");
      e = e.offsetWidth;
      b === e && (e = h[0].clientWidth);
      h.remove();
      return g = b - e
    }, getScrollInfo: function (b) {
      var e =
        b.isWindow ? "" : b.element.css("overflow-x"), d = b.isWindow ? "" : b.element.css("overflow-y"), d = "scroll" === d || "auto" === d && b.height < b.element[0].scrollHeight;
      return{width: "scroll" === e || "auto" === e && b.width < b.element[0].scrollWidth ? a.position.scrollbarWidth() : 0, height: d ? a.position.scrollbarWidth() : 0}
    }, getWithinInfo: function (b) {
      b = a(b || window);
      var e = a.isWindow(b[0]);
      return{element: b, isWindow: e, offset: b.offset() || {left: 0, top: 0}, scrollLeft: b.scrollLeft(), scrollTop: b.scrollTop(), width: e ? b.width() : b.outerWidth(),
        height: e ? b.height() : b.outerHeight()}
    }};
    a.fn.position = function (d) {
      if (!d || !d.of)return v.apply(this, arguments);
      d = a.extend({}, d);
      var f, g, t, z, A, u, w = a(d.of), y = a.position.getWithinInfo(d.within), J = a.position.getScrollInfo(y), F = (d.collision || "flip").split(" "), H = {};
      u = e(w);
      w[0].preventDefault && (d.at = "left top");
      g = u.width;
      t = u.height;
      z = u.offset;
      A = a.extend({}, z);
      a.each(["my", "at"], function () {
        var a = (d[this] || "").split(" "), b, e;
        1 === a.length && (a = n.test(a[0]) ? a.concat(["center"]) : m.test(a[0]) ? ["center"].concat(a) :
          ["center", "center"]);
        a[0] = n.test(a[0]) ? a[0] : "center";
        a[1] = m.test(a[1]) ? a[1] : "center";
        b = s.exec(a[0]);
        e = s.exec(a[1]);
        H[this] = [b ? b[0] : 0, e ? e[0] : 0];
        d[this] = [r.exec(a[0])[0], r.exec(a[1])[0]]
      });
      1 === F.length && (F[1] = F[0]);
      "right" === d.at[0] ? A.left += g : "center" === d.at[0] && (A.left += g / 2);
      "bottom" === d.at[1] ? A.top += t : "center" === d.at[1] && (A.top += t / 2);
      f = b(H.at, g, t);
      A.left += f[0];
      A.top += f[1];
      return this.each(function () {
        var e, m, r = a(this), n = r.outerWidth(), s = r.outerHeight(), v = parseInt(a.css(this, "marginLeft"), 10) || 0, u =
          parseInt(a.css(this, "marginTop"), 10) || 0, D = n + v + (parseInt(a.css(this, "marginRight"), 10) || 0) + J.width, Y = s + u + (parseInt(a.css(this, "marginBottom"), 10) || 0) + J.height, M = a.extend({}, A), T = b(H.my, r.outerWidth(), r.outerHeight());
        "right" === d.my[0] ? M.left -= n : "center" === d.my[0] && (M.left -= n / 2);
        "bottom" === d.my[1] ? M.top -= s : "center" === d.my[1] && (M.top -= s / 2);
        M.left += T[0];
        M.top += T[1];
        a.support.offsetFractions || (M.left = l(M.left), M.top = l(M.top));
        e = {marginLeft: v, marginTop: u};
        a.each(["left", "top"], function (b, h) {
          if (a.ui.position[F[b]])a.ui.position[F[b]][h](M,
            {targetWidth: g, targetHeight: t, elemWidth: n, elemHeight: s, collisionPosition: e, collisionWidth: D, collisionHeight: Y, offset: [f[0] + T[0], f[1] + T[1]], my: d.my, at: d.at, within: y, elem: r})
        });
        d.using && (m = function (a) {
          var b = z.left - M.left, e = b + g - n, f = z.top - M.top, l = f + t - s, m = {target: {element: w, left: z.left, top: z.top, width: g, height: t}, element: {element: r, left: M.left, top: M.top, width: n, height: s}, horizontal: 0 > e ? "left" : 0 < b ? "right" : "center", vertical: 0 > l ? "top" : 0 < f ? "bottom" : "middle"};
          g < n && h(b + e) < g && (m.horizontal = "center");
          t < s && h(f +
            l) < t && (m.vertical = "middle");
          k(h(b), h(e)) > k(h(f), h(l)) ? m.important = "horizontal" : m.important = "vertical";
          d.using.call(this, a, m)
        });
        r.offset(a.extend(M, {using: m}))
      })
    };
    a.ui.position = {fit: {left: function (a, b) {
      var e = b.within, d = e.isWindow ? e.scrollLeft : e.offset.left, f = e.width, g = a.left - b.collisionPosition.marginLeft, e = d - g, h = g + b.collisionWidth - f - d;
      b.collisionWidth > f ? 0 < e && 0 >= h ? (d = a.left + e + b.collisionWidth - f - d, a.left += e - d) : a.left = 0 < h && 0 >= e ? d : e > h ? d + f - b.collisionWidth : d : a.left = 0 < e ? a.left + e : 0 < h ? a.left - h : k(a.left - g,
        a.left)
    }, top: function (a, b) {
      var e = b.within, d = e.isWindow ? e.scrollTop : e.offset.top, f = b.within.height, g = a.top - b.collisionPosition.marginTop, e = d - g, h = g + b.collisionHeight - f - d;
      b.collisionHeight > f ? 0 < e && 0 >= h ? (d = a.top + e + b.collisionHeight - f - d, a.top += e - d) : a.top = 0 < h && 0 >= e ? d : e > h ? d + f - b.collisionHeight : d : a.top = 0 < e ? a.top + e : 0 < h ? a.top - h : k(a.top - g, a.top)
    }}, flip: {left: function (a, b) {
      var e = b.within, d = e.offset.left + e.scrollLeft, f = e.width, g = e.isWindow ? e.scrollLeft : e.offset.left, k = a.left - b.collisionPosition.marginLeft, e = k -
        g, l = k + b.collisionWidth - f - g, k = "left" === b.my[0] ? -b.elemWidth : "right" === b.my[0] ? b.elemWidth : 0, m = "left" === b.at[0] ? b.targetWidth : "right" === b.at[0] ? -b.targetWidth : 0, r = -2 * b.offset[0];
      if (0 > e) {
        if (d = a.left + k + m + r + b.collisionWidth - f - d, 0 > d || d < h(e))a.left += k + m + r
      } else 0 < l && (d = a.left - b.collisionPosition.marginLeft + k + m + r - g, 0 < d || h(d) < l) && (a.left += k + m + r)
    }, top: function (a, b) {
      var e = b.within, d = e.offset.top + e.scrollTop, f = e.height, g = e.isWindow ? e.scrollTop : e.offset.top, k = a.top - b.collisionPosition.marginTop, e = k - g, l = k + b.collisionHeight -
        f - g, k = "top" === b.my[1] ? -b.elemHeight : "bottom" === b.my[1] ? b.elemHeight : 0, m = "top" === b.at[1] ? b.targetHeight : "bottom" === b.at[1] ? -b.targetHeight : 0, r = -2 * b.offset[1];
      0 > e ? (d = a.top + k + m + r + b.collisionHeight - f - d, a.top + k + m + r > e && (0 > d || d < h(e)) && (a.top += k + m + r)) : 0 < l && (d = a.top - b.collisionPosition.marginTop + k + m + r - g, a.top + k + m + r > l && (0 < d || h(d) < l) && (a.top += k + m + r))
    }}, flipfit: {left: function () {
      a.ui.position.flip.left.apply(this, arguments);
      a.ui.position.fit.left.apply(this, arguments)
    }, top: function () {
      a.ui.position.flip.top.apply(this,
        arguments);
      a.ui.position.fit.top.apply(this, arguments)
    }}};
    (function () {
      var b, e, d, f, g = document.getElementsByTagName("body")[0];
      d = document.createElement("div");
      b = document.createElement(g ? "div" : "body");
      e = {visibility: "hidden", width: 0, height: 0, border: 0, margin: 0, background: "none"};
      g && a.extend(e, {position: "absolute", left: "-1000px", top: "-1000px"});
      for (f in e)b.style[f] = e[f];
      b.appendChild(d);
      e = g || document.documentElement;
      e.insertBefore(b, e.firstChild);
      d.style.cssText = "position: absolute; left: 10.7432222px;";
      d = a(d).offset().left;
      a.support.offsetFractions = 10 < d && 11 > d;
      b.innerHTML = "";
      e.removeChild(b)
    })()
  })(d)
});
define("jqueryui/menu", ["jquery", "./core", "./widget", "./position"], function (d) {
  (function (a, d) {
    a.widget("ui.menu", {version: "1.10.0", defaultElement: "<ul>", delay: 300, options: {icons: {submenu: "ui-icon-carat-1-e"}, menus: "ul", position: {my: "left top", at: "right top"}, role: "menu", blur: null, focus: null, select: null}, _create: function () {
      this.activeMenu = this.element;
      this.mouseHandled = !1;
      this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons", !!this.element.find(".ui-icon").length).attr({role: this.options.role,
        tabIndex: 0}).bind("click" + this.eventNamespace, a.proxy(function (a) {
          this.options.disabled && a.preventDefault()
        }, this));
      this.options.disabled && this.element.addClass("ui-state-disabled").attr("aria-disabled", "true");
      this._on({"mousedown .ui-menu-item > a": function (a) {
        a.preventDefault()
      }, "click .ui-state-disabled > a": function (a) {
        a.preventDefault()
      }, "click .ui-menu-item:has(a)": function (b) {
        var e = a(b.target).closest(".ui-menu-item");
        !this.mouseHandled && e.not(".ui-state-disabled").length && (this.mouseHandled = !0, this.select(b), e.has(".ui-menu").length ? this.expand(b) : this.element.is(":focus") || (this.element.trigger("focus", [!0]), this.active && 1 === this.active.parents(".ui-menu").length && clearTimeout(this.timer)))
      }, "mouseenter .ui-menu-item": function (b) {
        var e = a(b.currentTarget);
        e.siblings().children(".ui-state-active").removeClass("ui-state-active");
        this.focus(b, e)
      }, mouseleave: "collapseAll", "mouseleave .ui-menu": "collapseAll", focus: function (a, e) {
        var d = this.active || this.element.children(".ui-menu-item").eq(0);
        e || this.focus(a, d)
      }, blur: function (b) {
        this._delay(function () {
          a.contains(this.element[0], this.document[0].activeElement) || this.collapseAll(b)
        })
      }, keydown: "_keydown"});
      this.refresh();
      this._on(this.document, {click: function (b) {
        a(b.target).closest(".ui-menu").length || this.collapseAll(b);
        this.mouseHandled = !1
      }})
    }, _destroy: function () {
      this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();
      this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function () {
        var b = a(this);
        b.data("ui-menu-submenu-carat") && b.remove()
      });
      this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")
    }, _keydown: function (b) {
      function e(a) {
        return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,
          "\\$&")
      }

      var d, f, h, l, n = !0;
      switch (b.keyCode) {
        case a.ui.keyCode.PAGE_UP:
          this.previousPage(b);
          break;
        case a.ui.keyCode.PAGE_DOWN:
          this.nextPage(b);
          break;
        case a.ui.keyCode.HOME:
          this._move("first", "first", b);
          break;
        case a.ui.keyCode.END:
          this._move("last", "last", b);
          break;
        case a.ui.keyCode.UP:
          this.previous(b);
          break;
        case a.ui.keyCode.DOWN:
          this.next(b);
          break;
        case a.ui.keyCode.LEFT:
          this.collapse(b);
          break;
        case a.ui.keyCode.RIGHT:
          this.active && !this.active.is(".ui-state-disabled") && this.expand(b);
          break;
        case a.ui.keyCode.ENTER:
        case a.ui.keyCode.SPACE:
          this._activate(b);
          break;
        case a.ui.keyCode.ESCAPE:
          this.collapse(b);
          break;
        default:
          n = !1, d = this.previousFilter || "", f = String.fromCharCode(b.keyCode), h = !1, clearTimeout(this.filterTimer), f === d ? h = !0 : f = d + f, l = RegExp("^" + e(f), "i"), d = this.activeMenu.children(".ui-menu-item").filter(function () {
            return l.test(a(this).children("a").text())
          }), d = h && -1 !== d.index(this.active.next()) ? this.active.nextAll(".ui-menu-item") : d, d.length || (f = String.fromCharCode(b.keyCode), l = RegExp("^" + e(f), "i"), d = this.activeMenu.children(".ui-menu-item").filter(function () {
            return l.test(a(this).children("a").text())
          })),
            d.length ? (this.focus(b, d), 1 < d.length ? (this.previousFilter = f, this.filterTimer = this._delay(function () {
              delete this.previousFilter
            }, 1E3)) : delete this.previousFilter) : delete this.previousFilter
      }
      n && b.preventDefault()
    }, _activate: function (a) {
      this.active.is(".ui-state-disabled") || (this.active.children("a[aria-haspopup='true']").length ? this.expand(a) : this.select(a))
    }, refresh: function () {
      var b, e = this.options.icons.submenu;
      b = this.element.find(this.options.menus);
      b.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role: this.options.role,
        "aria-hidden": "true", "aria-expanded": "false"}).each(function () {
          var b = a(this), d = b.prev("a"), f = a("<span>").addClass("ui-menu-icon ui-icon " + e).data("ui-menu-submenu-carat", !0);
          d.attr("aria-haspopup", "true").prepend(f);
          b.attr("aria-labelledby", d.attr("id"))
        });
      b = b.add(this.element);
      b.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role", "presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex: -1, role: this._itemRole()});
      b.children(":not(.ui-menu-item)").each(function () {
        var b =
          a(this);
        /[^\-\s]/.test(b.text()) || b.addClass("ui-widget-content ui-menu-divider")
      });
      b.children(".ui-state-disabled").attr("aria-disabled", "true");
      this.active && !a.contains(this.element[0], this.active[0]) && this.blur()
    }, _itemRole: function () {
      return{menu: "menuitem", listbox: "option"}[this.options.role]
    }, _setOption: function (a, e) {
      "icons" === a && this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu);
      this._super(a, e)
    }, focus: function (a, e) {
      var d;
      this.blur(a, a && "focus" ===
        a.type);
      this._scrollIntoView(e);
      this.active = e.first();
      d = this.active.children("a").addClass("ui-state-focus");
      this.options.role && this.element.attr("aria-activedescendant", d.attr("id"));
      this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");
      a && "keydown" === a.type ? this._close() : this.timer = this._delay(function () {
        this._close()
      }, this.delay);
      d = e.children(".ui-menu");
      d.length && /^mouse/.test(a.type) && this._startOpening(d);
      this.activeMenu = e.parent();
      this._trigger("focus",
        a, {item: e})
    }, _scrollIntoView: function (b) {
      var e, d, f;
      this._hasScroll() && (e = parseFloat(a.css(this.activeMenu[0], "borderTopWidth")) || 0, d = parseFloat(a.css(this.activeMenu[0], "paddingTop")) || 0, e = b.offset().top - this.activeMenu.offset().top - e - d, d = this.activeMenu.scrollTop(), f = this.activeMenu.height(), b = b.height(), 0 > e ? this.activeMenu.scrollTop(d + e) : e + b > f && this.activeMenu.scrollTop(d + e - f + b))
    }, blur: function (a, e) {
      e || clearTimeout(this.timer);
      this.active && (this.active.children("a").removeClass("ui-state-focus"),
        this.active = null, this._trigger("blur", a, {item: this.active}))
    }, _startOpening: function (a) {
      clearTimeout(this.timer);
      "true" === a.attr("aria-hidden") && (this.timer = this._delay(function () {
        this._close();
        this._open(a)
      }, this.delay))
    }, _open: function (b) {
      var e = a.extend({of: this.active}, this.options.position);
      clearTimeout(this.timer);
      this.element.find(".ui-menu").not(b.parents(".ui-menu")).hide().attr("aria-hidden", "true");
      b.show().removeAttr("aria-hidden").attr("aria-expanded", "true").position(e)
    }, collapseAll: function (b, e) {
      clearTimeout(this.timer);
      this.timer = this._delay(function () {
        var d = e ? this.element : a(b && b.target).closest(this.element.find(".ui-menu"));
        d.length || (d = this.element);
        this._close(d);
        this.blur(b);
        this.activeMenu = d
      }, this.delay)
    }, _close: function (a) {
      a || (a = this.active ? this.active.parent() : this.element);
      a.find(".ui-menu").hide().attr("aria-hidden", "true").attr("aria-expanded", "false").end().find("a.ui-state-active").removeClass("ui-state-active")
    }, collapse: function (a) {
      var e = this.active && this.active.parent().closest(".ui-menu-item",
        this.element);
      e && e.length && (this._close(), this.focus(a, e))
    }, expand: function (a) {
      var e = this.active && this.active.children(".ui-menu ").children(".ui-menu-item").first();
      e && e.length && (this._open(e.parent()), this._delay(function () {
        this.focus(a, e)
      }))
    }, next: function (a) {
      this._move("next", "first", a)
    }, previous: function (a) {
      this._move("prev", "last", a)
    }, isFirstItem: function () {
      return this.active && !this.active.prevAll(".ui-menu-item").length
    }, isLastItem: function () {
      return this.active && !this.active.nextAll(".ui-menu-item").length
    },
      _move: function (a, e, d) {
        var f;
        this.active && (f = "first" === a || "last" === a ? this.active["first" === a ? "prevAll" : "nextAll"](".ui-menu-item").eq(-1) : this.active[a + "All"](".ui-menu-item").eq(0));
        f && f.length && this.active || (f = this.activeMenu.children(".ui-menu-item")[e]());
        this.focus(d, f)
      }, nextPage: function (b) {
        var e, d, f;
        this.active ? this.isLastItem() || (this._hasScroll() ? (d = this.active.offset().top, f = this.element.height(), this.active.nextAll(".ui-menu-item").each(function () {
          e = a(this);
          return 0 > e.offset().top - d - f
        }),
          this.focus(b, e)) : this.focus(b, this.activeMenu.children(".ui-menu-item")[this.active ? "last" : "first"]())) : this.next(b)
      }, previousPage: function (b) {
        var e, d, f;
        this.active ? this.isFirstItem() || (this._hasScroll() ? (d = this.active.offset().top, f = this.element.height(), this.active.prevAll(".ui-menu-item").each(function () {
          e = a(this);
          return 0 < e.offset().top - d + f
        }), this.focus(b, e)) : this.focus(b, this.activeMenu.children(".ui-menu-item").first())) : this.next(b)
      }, _hasScroll: function () {
        return this.element.outerHeight() <
          this.element.prop("scrollHeight")
      }, select: function (b) {
        this.active = this.active || a(b.target).closest(".ui-menu-item");
        var e = {item: this.active};
        this.active.has(".ui-menu").length || this.collapseAll(b, !0);
        this._trigger("select", b, e)
      }})
  })(d)
});
define("jqueryui/autocomplete", ["jquery", "./core", "./widget", "./position", "./menu"], function (d) {
  (function (a, d) {
    var b = 0;
    a.widget("ui.autocomplete", {version: "1.10.0", defaultElement: "<input>", options: {appendTo: null, autoFocus: !1, delay: 300, minLength: 1, position: {my: "left top", at: "left bottom", collision: "none"}, source: null, change: null, close: null, focus: null, open: null, response: null, search: null, select: null}, pending: 0, _create: function () {
      var b, d, f;
      this.isMultiLine = this._isMultiLine();
      this.valueMethod = this.element[this.element.is("input,textarea") ?
        "val" : "text"];
      this.isNewMenu = !0;
      this.element.addClass("ui-autocomplete-input").attr("autocomplete", "off");
      this._on(this.element, {keydown: function (h) {
        if (this.element.prop("readOnly"))d = f = b = !0; else {
          d = f = b = !1;
          var l = a.ui.keyCode;
          switch (h.keyCode) {
            case l.PAGE_UP:
              b = !0;
              this._move("previousPage", h);
              break;
            case l.PAGE_DOWN:
              b = !0;
              this._move("nextPage", h);
              break;
            case l.UP:
              b = !0;
              this._keyEvent("previous", h);
              break;
            case l.DOWN:
              b = !0;
              this._keyEvent("next", h);
              break;
            case l.ENTER:
            case l.NUMPAD_ENTER:
              this.menu.active && (b = !0, h.preventDefault(), this.menu.select(h));
              break;
            case l.TAB:
              this.menu.active && this.menu.select(h);
              break;
            case l.ESCAPE:
              this.menu.element.is(":visible") && (this._value(this.term), this.close(h), h.preventDefault());
              break;
            default:
              d = !0, this._searchTimeout(h)
          }
        }
      }, keypress: function (f) {
        if (b)b = !1, f.preventDefault(); else if (!d) {
          var k = a.ui.keyCode;
          switch (f.keyCode) {
            case k.PAGE_UP:
              this._move("previousPage", f);
              break;
            case k.PAGE_DOWN:
              this._move("nextPage", f);
              break;
            case k.UP:
              this._keyEvent("previous", f);
              break;
            case k.DOWN:
              this._keyEvent("next",
                f)
          }
        }
      }, input: function (a) {
        f ? (f = !1, a.preventDefault()) : this._searchTimeout(a)
      }, focus: function () {
        this.selectedItem = null;
        this.previous = this._value()
      }, blur: function (a) {
        this.cancelBlur ? delete this.cancelBlur : (clearTimeout(this.searching), this.close(a), this._change(a))
      }});
      this._initSource();
      this.menu = a("<ul>").addClass("ui-autocomplete").appendTo(this._appendTo()).menu({input: a(), role: null}).zIndex(this.element.zIndex() + 1).hide().data("ui-menu");
      this._on(this.menu.element, {mousedown: function (b) {
        b.preventDefault();
        this.cancelBlur = !0;
        this._delay(function () {
          delete this.cancelBlur
        });
        var e = this.menu.element[0];
        a(b.target).closest(".ui-menu-item").length || this._delay(function () {
          var b = this;
          this.document.one("mousedown", function (d) {
            d.target === b.element[0] || d.target === e || a.contains(e, d.target) || b.close()
          })
        })
      }, menufocus: function (b, e) {
        if (this.isNewMenu && (this.isNewMenu = !1, b.originalEvent && /^mouse/.test(b.originalEvent.type))) {
          this.menu.blur();
          this.document.one("mousemove", function () {
            a(b.target).trigger(b.originalEvent)
          });
          return
        }
        var d = e.item.data("ui-autocomplete-item");
        !1 !== this._trigger("focus", b, {item: d}) ? b.originalEvent && /^key/.test(b.originalEvent.type) && this._value(d.value) : this.liveRegion.text(d.value)
      }, menuselect: function (a, b) {
        var e = b.item.data("ui-autocomplete-item"), d = this.previous;
        this.element[0] !== this.document[0].activeElement && (this.element.focus(), this.previous = d, this._delay(function () {
          this.previous = d;
          this.selectedItem = e
        }));
        !1 !== this._trigger("select", a, {item: e}) && this._value(e.value);
        this.term = this._value();
        this.close(a);
        this.selectedItem = e
      }});
      this.liveRegion = a("<span>", {role: "status", "aria-live": "polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element);
      this._on(this.window, {beforeunload: function () {
        this.element.removeAttr("autocomplete")
      }})
    }, _destroy: function () {
      clearTimeout(this.searching);
      this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");
      this.menu.element.remove();
      this.liveRegion.remove()
    }, _setOption: function (a, b) {
      this._super(a, b);
      "source" === a && this._initSource();
      "appendTo" === a && this.menu.element.appendTo(this._appendTo());
      "disabled" === a && b && this.xhr && this.xhr.abort()
    }, _appendTo: function () {
      var b = this.options.appendTo;
      b && (b = b.jquery || b.nodeType ? a(b) : this.document.find(b).eq(0));
      b || (b = this.element.closest(".ui-front"));
      b.length || (b = this.document[0].body);
      return b
    }, _isMultiLine: function () {
      return this.element.is("textarea") ? !0 : this.element.is("input") ? !1 : this.element.prop("isContentEditable")
    }, _initSource: function () {
      var b, d, f = this;
      a.isArray(this.options.source) ?
        (b = this.options.source, this.source = function (d, f) {
          f(a.ui.autocomplete.filter(b, d.term))
        }) : "string" === typeof this.options.source ? (d = this.options.source, this.source = function (b, e) {
        f.xhr && f.xhr.abort();
        f.xhr = a.ajax({url: d, data: b, dataType: "json", success: function (a) {
          e(a)
        }, error: function () {
          e([])
        }})
      }) : this.source = this.options.source
    }, _searchTimeout: function (a) {
      clearTimeout(this.searching);
      this.searching = this._delay(function () {
        this.term !== this._value() && (this.selectedItem = null, this.search(null, a))
      }, this.options.delay)
    },
      search: function (a, b) {
        a = null != a ? a : this._value();
        this.term = this._value();
        if (a.length < this.options.minLength)return this.close(b);
        if (!1 !== this._trigger("search", b))return this._search(a)
      }, _search: function (a) {
        this.pending++;
        this.element.addClass("ui-autocomplete-loading");
        this.cancelSearch = !1;
        this.source({term: a}, this._response())
      }, _response: function () {
        var a = this, d = ++b;
        return function (f) {
          d === b && a.__response(f);
          a.pending--;
          a.pending || a.element.removeClass("ui-autocomplete-loading")
        }
      }, __response: function (a) {
        a &&
        (a = this._normalize(a));
        this._trigger("response", null, {content: a});
        !this.options.disabled && a && a.length && !this.cancelSearch ? (this._suggest(a), this._trigger("open")) : this._close()
      }, close: function (a) {
        this.cancelSearch = !0;
        this._close(a)
      }, _close: function (a) {
        this.menu.element.is(":visible") && (this.menu.element.hide(), this.menu.blur(), this.isNewMenu = !0, this._trigger("close", a))
      }, _change: function (a) {
        this.previous !== this._value() && this._trigger("change", a, {item: this.selectedItem})
      }, _normalize: function (b) {
        return b.length &&
          b[0].label && b[0].value ? b : a.map(b, function (b) {
          return"string" === typeof b ? {label: b, value: b} : a.extend({label: b.label || b.value, value: b.value || b.label}, b)
        })
      }, _suggest: function (b) {
        var d = this.menu.element.empty().zIndex(this.element.zIndex() + 1);
        this._renderMenu(d, b);
        this.menu.refresh();
        d.show();
        this._resizeMenu();
        d.position(a.extend({of: this.element}, this.options.position));
        this.options.autoFocus && this.menu.next()
      }, _resizeMenu: function () {
        var a = this.menu.element;
        a.outerWidth(Math.max(a.width("").outerWidth() +
          1, this.element.outerWidth()))
      }, _renderMenu: function (b, d) {
        var f = this;
        a.each(d, function (a, d) {
          f._renderItemData(b, d)
        })
      }, _renderItemData: function (a, b) {
        return this._renderItem(a, b).data("ui-autocomplete-item", b)
      }, _renderItem: function (b, d) {
        return a("<li>").append(a("<a>").text(d.label)).appendTo(b)
      }, _move: function (a, b) {
        if (this.menu.element.is(":visible"))if (this.menu.isFirstItem() && /^previous/.test(a) || this.menu.isLastItem() && /^next/.test(a))this._value(this.term), this.menu.blur(); else this.menu[a](b);
        else this.search(null, b)
      }, widget: function () {
        return this.menu.element
      }, _value: function () {
        return this.valueMethod.apply(this.element, arguments)
      }, _keyEvent: function (a, b) {
        if (!this.isMultiLine || this.menu.element.is(":visible"))this._move(a, b), b.preventDefault()
      }});
    a.extend(a.ui.autocomplete, {escapeRegex: function (a) {
      return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&")
    }, filter: function (b, d) {
      var f = RegExp(a.ui.autocomplete.escapeRegex(d), "i");
      return a.grep(b, function (a) {
        return f.test(a.label || a.value || a)
      })
    }});
    a.widget("ui.autocomplete", a.ui.autocomplete, {options: {messages: {noResults: "No search results.", results: function (a) {
      return a + (1 < a ? " results are" : " result is") + " available, use up and down arrow keys to navigate."
    }}}, __response: function (a) {
      var b;
      this._superApply(arguments);
      this.options.disabled || this.cancelSearch || (b = a && a.length ? this.options.messages.results(a.length) : this.options.messages.noResults, this.liveRegion.text(b))
    }})
  })(d)
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, e) {
    function f() {
      this.constructor = a
    }

    for (var k in e)d.call(e, k) && (a[k] = e[k]);
    f.prototype = e.prototype;
    a.prototype = new f;
    a.__super__ = e.prototype;
    return a
  }, f = [].indexOf || function (a) {
    for (var e = 0, d = this.length; e < d; e++)if (e in this && this[e] === a)return e;
    return-1
  };
  define("views/member/member-finder/index", "view util warehouse collections/members ./templates/basic jqueryui/autocomplete".split(" "), function (b, e, d, k, h) {
    var l;
    return function (b) {
      function m() {
        return l =
          m.__super__.constructor.apply(this, arguments)
      }

      a(m, b);
      m.prototype.viewName = "MemberFinderView";
      m.prototype.initialize = function (a) {
        if (null != a && a.collection)return this.options = a, this.reset(a.collection)
      };
      m.prototype.reset = function (a) {
        this.$searchbox = this.options.$searchbox;
        this.collection = a || d.createCollection(k);
        this.initAutoComplete();
        return this
      };
      m.prototype.initAutoComplete = function () {
        var a = this;
        this.$searchbox.autocomplete({appendTo: "body", autoFocus: !0, create: function (a, b) {
          return $("body > .ui-autocomplete.ui-menu").addClass("dropdown-menu").css({zIndex: 1E4,
            visibility: "visible", opacity: 1})
        }, select: function (b, e) {
          var d;
          return"function" === typeof(d = a.options).select ? d.select(e) : void 0
        }, close: function () {
          return a.$searchbox.val("")
        }, source: function (b, e) {
          return a.search(b.term, {beforeSend: function (b) {
            return a.showLoadingIndicator(a.$searchbox, {isPrepend: !0})
          }, success: function (d) {
            a.hideLoadingIndicator();
            d = a.analysisResult(d, b.term);
            _.each(d, function (a) {
              return a.name || (a.name = a.email)
            });
            return e(d)
          }})
        }});
        this.autocomplete = this.$searchbox.data("ui-autocomplete");
        this.autocomplete._renderItem = function (a, b) {
          return $(h(b)).appendTo(a)
        };
        this.autocomplete.liveRegion = $("<span>");
        return this
      };
      m.prototype.search = function (a, b) {
        var d = this;
        e.isEmail(a) && (this.timer && clearTimeout(this.timer), this.timer = setTimeout(function () {
          return d.doSearch(a, b)
        }, 200));
        return!0
      };
      m.prototype.doSearch = function (a, b) {
        return this.collection.search(a, "addmember", b)
      };
      m.prototype.analysisResult = function (a, b) {
        var d, g, h, k, l, m;
        d = this.collection.getActiveMemberIds();
        h = [];
        if (0 < (null != a ? a.length :
          void 0))for (k = 0, l = a.length; k < l; k++) {
          g = a[k];
          g.type = "member";
          if (m = g._id, 0 <= f.call(d, m))g.invited = !0;
          h.push(g)
        } else e.isEmail(b) && h.push({type: "email", email: b, isEmail: !0});
        return h
      };
      return m
    }(b)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/organization", ["model"], function (d) {
    var b;
    return function (e) {
      function d() {
        return b = d.__super__.constructor.apply(this, arguments)
      }

      a(d, e);
      d.prototype.name = "organization";
      d.prototype.defaults = {objectType: "organization"};
      return d
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/organizations", ["collection", "models/organization"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.name = "organizations";
      f.prototype.model = b;
      return f
    }(d)
  })
}).call(this);
define("views/settings/project-settings/templates/basic", [], function () {
  return function (d) {
    var a = '<header class="project-settings-header card-header no-bottom project-cover project-cover-' + d.category + '"> <p class="card-title pull-left"></p> <a class="close-window-handler pull-right icon icon-remove icon-white" data-dismiss="modal"></a> <div class="logo-uploader"> <div class="logo"> <div class="progress-mask"></div> </div> </div></header><nav class="project-settings-navigation"> <ul class="section-switcher nav nav-tabs"> <li class="project-info"> <a class="section-switcher-toggler" data-toggle="project-info" data-gta="event" data-label="go back to project info settings"> </a> </li> <li class="member-settings"> <a class="section-switcher-toggler" data-toggle="member-settings" data-gta="event" data-label="enter project members settings"> </a> </li> <li class="advanced-settings"> <a class="section-switcher-toggler" data-toggle="advanced-settings" data-gta="event" data-label="enter advanced project settings"> </a> </li> </ul></nav><section class="project-settings-content card-content"></section>';
    0 >= d.hasRight && (a += '<footer class="project-settings-footer"> <p class="muted">', d.hasRightMembers && (a += "" + d.hasRightMembers + "."), a += "</p></footer>");
    return a
  }
});
define("views/settings/project-settings/templates/profile-tab", [], function () {
  return function (d) {
    var a = '<div class="settings-part project-info-settings"> <div class="project-info-content"> <form class="project-info-form form-horizontal"> <div class="form-group"> <label></label> <input class="setting-part form-control" type="text" data-type="name" placeholder="" value="' + d.name + '"';
    0 === d.hasRight && (a += "disabled");
    a += ' /> </div> <div class="form-group"> <label></label> <select class="setting-part form-control" data-type="category" ';
    0 === d.hasRight && (a += "disabled");
    a += '> <option value="design" ';
    "design" === d.category && (a += "selected");
    a += '>  </option> <option value="internet" ';
    "internet" === d.category && (a += "selected");
    a += '>  </option> <option value="education" ';
    "education" === d.category && (a += "selected");
    a += '>  </option> <option value="media" ';
    "media" === d.category && (a += "selected");
    a += '>  </option> <option value="app" ';
    "app" === d.category && (a += "selected");
    a += '>  <option value="other" ';
    "other" === d.category &&
    (a += "selected");
    a += '>  </option> </select> </div> <div class="form-group"> <label></label> <textarea class="setting-part form-control" data-type="description" ';
    0 === d.hasRight && (a += "disabled");
    a += ' placeholder="">' + (d.description || "") + "</textarea> </div> ";
    d.hasRight && (a += ' <button class="btn btn-save btn-primary disabled" type="submit" data-gta="event" data-label="save changes" data-action="click" data-category="button" data-value="g5-3">  </button> ');
    return a + " </form> </div></div>"
  }
});
define("views/settings/project-settings/templates/members-tab", [], function () {
  return function (d) {
    var a = '<div class="settings-part project-member-settings"> <h4></h4> <div class="member-finder"> <input class="member-info-input form-control" type="text" placeholder="..."/> </div> <h4></h4> <p class="muted">QQ</p> <br> <input class="input-small invite-member-link-input form-control" value="' + d.inviteLink + '" /> ', a = d._organizationId && 0 <=
      d.hasRight ? a + ' <div class="member-nav"> <h4 class="member-tabs active" data-tab="project">  </h4> <span class="member-tabs-span">|</span> <h4 class="member-tabs" data-tab="organization">  </h4> </div> ' : a + " <h4></h4> ";
    return a + ' <div class="project-member-column member-columns active"> <ul class="members-list list"></ul> </div></div>'
  }
});
define("views/settings/project-settings/templates/advanced-tab", [], function () {
  return function (d) {
    var a = '<div class="settings-part advanced-settings"> ';
    2 === d.hasRight ? (a += " ", 0 < d.organizations.length && (a += ' <h4></h4> <p class="muted">, , </p> <br> <form class="project-transfer-form form-horizontal"> <a class="btn btn-danger project-transfer-handler form-control"></a> </form> <br> '), a += ' <h4></h4> <p class="muted"></p> <br> <a class="btn btn-danger btn-delete-project form-control"></a> <input class="delete-input form-control" type="text" placeholder="DELETE"/> ') :
      a += ' <h4></h4> <p class="muted"></p> <br> <a class="btn authority-handler btn-danger form-control" data-id="' + teambition.user.id + '" data-action="quit"></a> ';
    return a + "</div>"
  }
});
define("views/settings/project-settings/templates/member", [], function () {
  return function (d) {
    var a = "";
    d.isOrgMember ? (a += ' <li class="' + d._id + ' member"> <div class="avatar img-circle img-36" style="background-image:url(' + d.avatarUrl + ');"></div> <p class="abstract"> <strong class="name">' + d.name + '</strong> </p> <p class="muted">' + d.title + "</p> ", d.hasRight && d._id != teambition.user.id && (a += ' <div class="handlerset"> ', a = d.inProject ? a + ' <span class="muted"></span> ' : a + (' <a class="btn btn-primary btn-small authority-handler" data-id="' +
      d._id + '" data-action="add-from-organization">  </a> '), a += " </div> ")) : (a += ' <li class="' + d._id + ' member"> <div class="avatar img-circle img-36" style="background-image:url(' + d.avatarUrl + ');"></div> <p class="abstract"> ', a = d._id === teambition.user.id ? a + (' <strong class="name">(' + d.name + ")</strong> ") : a + (' <strong class="name">' + d.name + "</strong> "), a += ' <strong></strong> <strong class="role"> ', a = d.isOwner || d.isAdmin ? a + "  " : a + "  ", a += ' </strong> </p> <p class="muted">' + d.title + "</p> ",
      d.hasRight && d._id !== teambition.user.id && (a += ' <div class="handlerset"> ', !1 === d.isActive && (a += ' <a class="btn btn-primary btn-small authority-handler" data-id="' + d._id + '" data-action="resend">  </a> '), a += " ", a = d.isAdmin ? a + (' <a class="btn btn-small authority-handler" data-id="' + d._id + '" data-action="member">  </a> ') : a + (' <a class="btn btn-primary btn-small authority-handler" data-id="' + d._id + '" data-action="admin">  </a> '), a += ' <a class="btn btn-danger btn-small authority-handler delete-handler" data-id="' +
        d._id + '" data-action="delete">  </a> </div> '));
    return a + " </li>"
  }
});
define("views/settings/project-settings/templates/transfer-form", [], function () {
  return function (d) {
    var a = '<div class="form-group"> <select class="project-owner-select form-control"> <option value="0" selected></option> ';
    if (d)for (var f, b = -1, e = d.length - 1; b < e;)f = d[b += 1], a += ' <option value="' + f._id + '"> ' + f.name + " </option> ";
    return a + ' </select></div><div class="form-group"> <button class="btn btn-primary form-control transfer-project-submitter" type="submit" disabled>  </button></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, e) {
    function f() {
      this.constructor = a
    }

    for (var k in e)d.call(e, k) && (a[k] = e[k]);
    f.prototype = e.prototype;
    a.prototype = new f;
    a.__super__ = e.prototype;
    return a
  }, f = [].indexOf || function (a) {
    for (var e = 0, d = this.length; e < d; e++)if (e in this && this[e] === a)return e;
    return-1
  };
  define("views/settings/project-settings/index", "view views/member/member-finder/index lib/uploader/index util warehouse collections/organizations collections/members thenjs ./templates/basic ./templates/profile-tab ./templates/members-tab ./templates/advanced-tab ./templates/member ./templates/transfer-form essage".split(" "),
    function (b, e, d, k, h, l, n, m, s, r, t, v, p, x) {
      var B, C, z;
      B = teambition.router;
      C = teambition.user;
      return function (b) {
        function m() {
          return z = m.__super__.constructor.apply(this, arguments)
        }

        a(m, b);
        m.prototype.viewName = "ProjectSettingsView";
        m.prototype.className = "project-settings-view modal-dialog card";
        m.prototype.events = {"click .section-switcher-toggler": "switch", "click .member-tabs": "toggleMemberTab", "change .setting-part": "collectChange", "input .setting-part": "collectChange", "click .authority-handler": "handleMemberAction",
          "click .btn-delete-project": "deleteConfirm", "click .project-transfer-handler": "showTranferForm", "change .project-owner-select": "validateOwner", "submit .project-transfer-form": "submitTransferForm", "submit .project-info-form": "submitProjectInfo"};
        m.prototype.initialize = function (a) {
          if (null == a || !a.projectModel)return!1;
          this.changes = {};
          this.options = a;
          this.projectModel = a.projectModel;
          this.organizationsCollection = h.get(l);
          a = this.projectModel.get("_organizationId");
          this.organizationModel = this.organizationsCollection.get(a);
          this.renderBasic();
          this.toggle(this.options.tab || "project-info");
          return this
        };
        m.prototype["switch"] = function (a) {
          this.toggle($(a.currentTarget).data("toggle"));
          return this
        };
        m.prototype.toggle = function (a) {
          var b = this;
          this.tab = a;
          this.$navigation.find(".active").removeClass("active");
          this.$navigation.find("." + a).addClass("active");
          switch (a) {
            case "project-info":
              this.renderProfileTab();
              this.listen(a);
              break;
            case "member-settings":
              this.loadProjectMembers({beforeSend: function () {
                b.$content.empty();
                return b.showLoadingIndicator(b.$content)
              },
                success: function (e) {
                  b.hideLoadingIndicator();
                  b.renderMembersTab();
                  b.listen(a);
                  return _.delay(function () {
                    return b.$content.find(".member-info-input").focus()
                  }, 218)
                }});
              break;
            case "advanced-settings":
              this.renderAdvancedTab()
          }
          return this
        };
        m.prototype.toggleMemberTab = function (a) {
          var b = this;
          a = $(a.currentTarget);
          a.addClass("active").siblings().removeClass("active");
          switch (a.data("tab")) {
            case "project":
              this.renderMembers("project");
              this.listen("member-settings");
              break;
            case "organization":
              this.loadOrganizationMembers({beforeSend: function () {
                b.$membersList.empty();
                return b.showLoadingIndicator(b.$membersList)
              }, success: function (a) {
                b.hideLoadingIndicator();
                b.renderMembers("organization");
                return b.listen("member-settings", "organization-members")
              }})
          }
          return this
        };
        m.prototype.loadProjectMembers = function (a) {
          var b, e = this;
          b = _.extend({}, a);
          b.success = function (b) {
            e.projectMembersCollection = b;
            return a.success(b)
          };
          h.request(n, this.projectModel.id, b);
          return this
        };
        m.prototype.loadOrganizationMembers = function (a) {
          var b, e = this;
          b = _.extend({boundToObjectType: "organization"}, a);
          b.success = function (b) {
            e.organizationMembersCollection = b;
            return a.success(b)
          };
          h.request(n, this.organizationModel.id, b);
          return this
        };
        m.prototype.listen = function (a, b) {
          var e = this;
          this.stopListening();
          this.listenTo(this.projectModel, "remove", this.close);
          switch (a) {
            case "project-info":
              this.listenTo(this.projectModel, "change:logo", this.renderLogo);
              break;
            case "member-settings":
              "organization-members" === b ? (this.listenTo(this.organizationMembersCollection, "add", function (a) {
                return e.renderMember(a, {isOrgMember: !0})
              }),
                this.listenTo(this.organizationMembersCollection, "change", function (a) {
                  return e.renderMember(a, {isRefresh: !0, isOrgMember: !0})
                }), this.listenTo(this.projectMembersCollection, "change:isQuited", function (a) {
                return e.renderMember(a, {isRefresh: !0, isOrgMember: !0})
              })) : (this.listenTo(this.projectMembersCollection, "add", this.renderMember), this.listenTo(this.projectMembersCollection, "change", function (a) {
                return e.renderMember(a, {isRefresh: !0})
              }), this.listenTo(this.projectMembersCollection, "change:isQuited", this.addOrRemoveMember));
              break;
            case "advanced-settings":
              this.listenTo(this.projectModel, "change", this.renderAdvanced)
          }
          return this
        };
        m.prototype.renderBasic = function () {
          this.$el.html(s(this.projectModel.toJSON()));
          this.$header = this.$(".project-settings-header");
          this.$navigation = this.$(".project-settings-navigation");
          this.$content = this.$(".project-settings-content");
          this.$footer = this.$(".project-settings-footer");
          this.renderLogo();
          this.projectModel.get("hasRight") && this.initLogoUploader();
          return this
        };
        m.prototype.renderLogo =
          function () {
            this.$header.find(".logo").css({"background-image": "url(" + this.projectModel.get("logo") + ")"});
            return this
          };
        m.prototype.renderProfileTab = function () {
          this.$content.html(r(this.projectModel.toJSON()));
          this.$footer.show();
          return this
        };
        m.prototype.renderMembersTab = function () {
          this.$content.html(t(this.projectModel.toJSON()));
          this.renderMembers();
          this.$footer.show();
          this.initMemberFinder();
          return this
        };
        m.prototype.renderAdvancedTab = function () {
          var a;
          a = _.extend(this.projectModel.toJSON(), {organizations: this.organizationsCollection.toJSON()});
          this.$content.html(v(a));
          this.$footer.hide();
          return this
        };
        m.prototype.renderMembers = function (a) {
          var b, e, d;
          this.$membersList = this.$content.find(".members-list").empty();
          if ("organization" === a)for (a = this.organizationMembersCollection, d = a.getActiveMembers(), b = 0, e = d.length; b < e; b++)a = d[b], this.renderMember(a, {isOrgMember: !0}); else for (a = this.projectMembersCollection, d = a.getActiveMembers(), b = 0, e = d.length; b < e; b++)a = d[b], this.renderMember(a);
          return this
        };
        m.prototype.renderMember = function (a, b) {
          var e, d;
          d = _.extend({isPrepend: !1},
            b);
          e = a.toJSON();
          e.hasRight = this.projectModel.get("hasRight");
          e.inProject = this.projectMembersCollection.hasMember(a.id);
          e.isOrgMember = d.isOrgMember;
          d.isRefresh ? this.$content.find("." + a.id).replaceWith($(p(e))) : (d = d.isPrepend ? "prepend" : "append", this.$membersList[d](p(e)));
          return this
        };
        m.prototype.addOrRemoveMember = function (a) {
          a.get("isQuited") ? this.$content.find("." + a.id).remove() : (this.addMember(a), this.renderMember(a));
          return this
        };
        m.prototype.initLogoUploader = function () {
          var a, b, e, f = this;
          b = this.$header.find(".logo");
          a = $('<a class="icon icon-pencil edit-handler"></a>').appendTo(b);
          e = this.$header.find(".progress-mask");
          this.uploader = new d({model: this.projectModel, pick: {id: a, label: " ", multiple: !1}, dnd: b, type: "logo", onCreate: function (a) {
            return f.projectModel.set("logo", a.thumbnailUrl)
          }, onStart: function () {
            return e.css("clip", "rect(0, 132px, 132px, 0)").html("")
          }, onProgress: function (a) {
            return e.css("clip", "rect(" + 132 * a / 100 + "px, 132px, 132px, 0)")
          }, onComplete: function (a) {
            e.css("clip", "rect(132px, 132px, 132px, 0)");
            return f.projectModel.save("logo", a.thumbnailUrl)
          }});
          return this
        };
        m.prototype.initMemberFinder = function () {
          var a = this;
          this.$memberInput = this.$(".member-info-input");
          this.requestSubView(e, {collection: this.projectMembersCollection, $searchbox: this.$memberInput, select: function (b) {
            return a.addMember(b)
          }});
          return this
        };
        m.prototype.submitProjectInfo = function (a) {
          var b = this;
          null != a && a.preventDefault();
          k.isEmpty(this.changes) ? (null != a ? a.success : void 0)instanceof Function ? null != a && a.success() : this.close() : this.projectModel.save(this.changes,
            {success: function () {
              b.changes = {};
              null != a && "function" === typeof a.success && a.success();
              if (a instanceof $.Event)return b.close()
            }});
          return this
        };
        m.prototype.collectChange = function (a) {
          var b, e;
          b = $(".btn-save");
          e = $(a.currentTarget);
          a = e.val();
          e = e.data("type");
          this.projectModel.get(e) === a ? delete this.changes[e] : this.changes[e] = a;
          k.isEmpty(this.changes) ? b.addClass("disabled") : b.removeClass("disabled");
          return this
        };
        m.prototype.handleMemberAction = function (a) {
          var b, e, d, f, g = this;
          b = $(a.currentTarget);
          if (b.hasClass("disabled"))return!1;
          a = b.data("action");
          f = b.data("id");
          e = "add-from-organization" === a ? this.organizationMembersCollection.get(f) : "quit" === a ? C : this.projectMembersCollection.get(f);
          switch (a) {
            case "admin":
              e.save({isAdmin: !0});
              break;
            case "member":
              e.save({isAdmin: !1});
              break;
            case "add-from-organization":
              this.addMember({attributes: !0, id: f}, {beforeSend: function () {
                return b.html("")
              }, success: function () {
                return g.renderMember(e, {isRefresh: !0, isOrgMember: !0})
              }});
              break;
            case "resend":
              this.projectModel.resendInviteEmail({_userId: f});
              b.addClass("disabled").html("(30)");
              for (d = a = 30; --a;)setTimeout(function () {
                --d;
                return b.html("(" + d + ")")
              }, 1E3 * (30 - a));
              setTimeout(function () {
                return b.removeClass("disabled").html("")
              }, 3E4);
              break;
            case "delete":
              this.projectMembersCollection.removeMember(e.id, {beforeSend: function () {
                return b.html("")
              }});
              break;
            case "quit":
              this.projectModel.quit({beforeSend: function () {
                return b.toggleClass("btn-link btn-danger").html("")
              }, success: function () {
                b.html(", ");
                return setTimeout(function () {
                  g.projectModel.collection.remove(g.projectModel);
                  return B.navigate("/projects", {trigger: !0})
                }, 1E3)
              }})
          }
          return this
        };
        m.prototype.addMember = function (a, b) {
          var e;
          e = _.extend({boundToObjectType: "project"}, b);
          this.projectMembersCollection.addMember(a.attributes ? {_userId: a.id} : a.item._id ? {_userId: a.item._id} : {email: a.item.email}, e);
          return this
        };
        m.prototype.showTranferForm = function (a) {
          var b, e, d, f, g;
          b = this.projectModel.get("_organizationId") ? [C.toJSON()] : [];
          g = this.organizationsCollection.toJSON();
          d = 0;
          for (f = g.length; d < f; d++)e = g[d], e._id !== this.projectModel.get("_organizationId") && b.push(e);
          $(a.currentTarget).closest(".project-transfer-form").html(x(b));
          return this
        };
        m.prototype.validateOwner = function (a) {
          a = $(a.currentTarget).val();
          0 <= f.call(this.organizationsCollection.pluck("_id"), a) || a === C.id ? this.$content.find(".transfer-project-submitter").removeAttr("disabled") : this.$content.find(".transfer-project-submitter").attr("disabled", "disabled");
          return this
        };
        m.prototype.submitTransferForm = function (a) {
          var b,
            e, d = this;
          null != a && a.preventDefault();
          e = $(a.currentTarget).find(".project-owner-select").val();
          b = $(a.currentTarget).find(".transfer-project-submitter");
          this.projectModel.transfer(e, {beforeSend: function () {
            return b.toggleClass("btn-link btn-primary").html("")
          }, success: function () {
            b.html(", ");
            return setTimeout(function () {
              B.navigate("/projects", {trigger: !0});
              return d.close()
            }, 1E3)
          }, error: function (a) {
            var e;
            switch (a) {
              case 400207:
                e = "";
                break;
              case 400301:
                e = "";
                break;
              case 400302:
                e = ", "
            }
            b.html("" + e);
            return setTimeout(function () {
              return d.renderAdvancedTab()
            }, 3E3)
          }});
          return this
        };
        m.prototype.deleteConfirm = function (a) {
          var b, e;
          e = this.$(".delete-input:visible");
          e.val() ? "DELETE" === e.val().toUpperCase() ? this.deleteProject() : e.val("") : (a = $(a.currentTarget), b = a.next(), a.transition({width: 200}, function () {
            return b.show().focus()
          }));
          return this
        };
        m.prototype.deleteProject = function () {
          var a = this;
          this.projectModel.destroy({success: function () {
            a.close();
            return B.navigate("projects", {trigger: !0})
          }, error: function (a) {
          }});
          return this
        };
        m.prototype.close = function () {
          var a;
          null != (a = this.parentView) && a.remove();
          return this
        };
        return m
      }(b)
    })
}).call(this);
define("views/settings/organization-settings/templates/basic", [], function () {
  return function (d) {
    return'<header class="organization-settings-header card-header no-bottom organization-cover"> <p class="card-title pull-left"></p> <a class="close-window-handler icon icon-remove icon-white pull-right " data-dismiss="modal"></a> <div class="logo-uploader"> <div class="logo" style="background-image: url(' + d.logo + ');"> <div class="progress-mask"></div> </div> </div></header><nav class="organization-settings-navigation"> <ul class="section-switcher nav nav-tabs"> <li class="organization-info"> <a class="section-switcher-toggler" data-toggle="organization-info"></a> </li> <li class="member-settings"> <a class="section-switcher-toggler" data-toggle="member-settings"></a> </li> </ul></nav><div class="organization-settings-content card-content"></div>'
  }
});
define("views/settings/organization-settings/templates/profile-tab", [], function () {
  return function (d) {
    var a = '<div class="settings-part organization-info-settings"> <div class="organization-info-content"> <form class="form-horizontal organization-info-form"> <div class="form-group"> <label></label> <input class="organization-name setting-part form-control" type="text" data-type="name" value="' + d.name + '"';
    d.isAdmin || (a += "disabled");
    a += ' /> </div> <div class="form-group"> <label></label> <select class="setting-info-content category-select setting-part form-control" data-type="category" ';
    d.isAdmin || (a += "disabled");
    a += '> <option value="design" ';
    "design" === d.category && (a += "selected");
    a += '>  </option> <option value="internet" ';
    "internet" === d.category && (a += "selected");
    a += '>  </option> <option value="education" ';
    "education" === d.category && (a += "selected");
    a += '>  </option> <option value="media" ';
    "media" === d.category && (a += "selected");
    a += '>  </option> <option value="app" ';
    "app" === d.category && (a += "selected");
    a += '>  <option value="other" ';
    "other" === d.category && (a +=
      "selected");
    a += '>  </option> </select> </div> <div class="form-group"> <label></label> <textarea class="setting-info-content organization-description  setting-part form-control" data-type="description" ';
    d.isAdmin || (a += "disabled");
    a += ">" + (d.description || "") + "</textarea> </div> ";
    d.isAdmin && (a += ' <button class="btn btn-save btn-primary disabled" type="submit"></button> ');
    return a + " </form> </div></div>"
  }
});
define("views/settings/organization-settings/templates/members-tab", [], function () {
  return function (d) {
    return'<div class="settings-part organization-member-settings"> <div class="organization-member-column inner-scroll"> <h4></h4> <div class="member-finder"> <input class="member-info-input form-control" type="text" placeholder="..."/> </div> <h4></h4> <ul class="members-list list"></ul> </div></div>'
  }
});
define("views/settings/organization-settings/templates/member", [], function () {
  return function (d) {
    var a = '<li class="' + d._id + ' member"> <div class="avatar img-circle img-36" style="background-image:url(' + d.avatarUrl + ');"></div> <p class="abstract"> ', a = d._id === teambition.user.id ? a + (' <strong class="name">(' + d.name + ")</strong> ") : a + (' <strong class="name">' + d.name + "</strong> "), a = a + ' <strong></strong> <strong class="role"> ', a = d.isOwner ? a + "  " : d.isAdmin ? a + "  " : a + "  ", a = a + (' </strong> </p> <p class="muted">' +
      d.title + "</p> ");
    d.hasRight && d._id != teambition.user.id && (a += ' <div class="handlerset"> ', a = d.isAdmin ? a + (' <a class="btn btn-small authority-handler" data-id="' + d._id + '" data-action="member">  </a> ') : a + (' <a class="btn btn-small btn-primary authority-handler" data-id="' + d._id + '" data-action="admin">  </a> '), a += ' <a class="btn btn-small btn-danger authority-handler" data-id="' + d._id + '" data-action="delete">  </a> </div> ');
    return a + "</li>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/settings/organization-settings/index", "view views/member/member-finder/index lib/uploader/index util warehouse collections/members thenjs ./templates/basic ./templates/profile-tab ./templates/members-tab ./templates/member essage".split(" "), function (d, b, e, g, k, h, l, n, m, s, r) {
    var t, v;
    t = teambition.router;
    return function (d) {
      function f() {
        return v = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "OrganizationSettingsView";
      f.prototype.className = "organization-settings-view modal-dialog card";
      f.prototype.events = {"change .setting-part": "collectChange", "input .setting-part": "collectChange", "click .section-switcher-toggler": "switch", "click .authority-handler": "authorityHandler", "click .btn-delete-organization": "deleteConfirm", "click .member-add-btn": "addMemberFromList", "submit .organization-info-form": "submitOrganizationInfo"};
      f.prototype.initialize = function (a) {
        if (null == a || !a.organizationModel)return!1;
        this.changes = {};
        this.options = a;
        this.organizationModel = a.organizationModel;
        this.membersCollection = k.get(h, this.organizationModel.id, null, {boundToObjectType: "organization"});
        this.renderBasic().toggle(a.tab || "organization-info");
        return this
      };
      f.prototype.toggle = function (a) {
        var b = this;
        this.tab = a;
        this.$navigation.find(".active").removeClass("active");
        this.$navigation.find("." + a).addClass("active");
        switch (a) {
          case "organization-info":
            this.renderProfileTab().listen(a);
            break;
          case "member-settings":
            this.loadMembers({beforeSend: function () {
              b.$content.empty();
              return b.showLoadingIndicator(b.$content)
            }, success: function () {
              b.hideLoadingIndicator(b.$content);
              b.renderMembersTab();
              b.listen(a);
              return _.delay(function () {
                return b.$el.show().find("input").focus()
              }, 50)
            }})
        }
        return this
      };
      f.prototype.loadMembers = function (a) {
        this.membersCollection.fetch(a);
        return this
      };
      f.prototype.listen = function (a) {
        this.stopListening();
        this.listenTo(this.organizationModel, "remove", this.close);
        switch (a) {
          case "organization-info":
            this.listenTo(this.organizationModel,
              "change", this.renderProfileTab);
            this.listenTo(this.organizationModel, "change:logo", this.renderLogo);
            break;
          case "member-settings":
            this.listenTo(this.membersCollection, "add", this.renderMember), this.listenTo(this.membersCollection, "change:isQuited", this.addOrRemoveMember), this.listenTo(this.membersCollection, "change:isAdmin change:avatar change:name", this.refreshMember)
        }
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(n(this.organizationModel.toJSON()));
        this.$header = this.$(".organization-settings-header");
        this.$navigation = this.$(".organization-settings-navigation");
        this.$content = this.$(".organization-settings-content");
        this.renderLogo();
        this.organizationModel.get("hasRight") && this.initUploader();
        return this
      };
      f.prototype.renderLogo = function () {
        this.$header.find(".logo").css({"background-image": "url(" + this.organizationModel.get("logo") + ")"});
        return this
      };
      f.prototype.renderProfileTab = function () {
        this.$content.html(m(this.organizationModel.toJSON()));
        return this
      };
      f.prototype.renderMembersTab = function () {
        this.$content.html(s());
        this.renderMembers();
        this.initMemberFinder();
        return this
      };
      f.prototype.renderMembers = function () {
        var a, b, e, d;
        d = this.membersCollection.getActiveMembers();
        b = 0;
        for (e = d.length; b < e; b++)a = d[b], this.renderMember(a, !1);
        return this
      };
      f.prototype.renderMember = function (a, b) {
        var e = this;
        this.assembleData(a, function (a) {
          var d;
          d = _.isBoolean(b) && b ? "prepend" : "append";
          return e.$content.find(".members-list")[d](r(a))
        });
        return this
      };
      f.prototype.addOrRemoveMember = function (a) {
        a.get("isQuited") ? (this.$content.find("." + a.id).remove(),
          $("#org-" + a.id).find(".member-add-btn").show()) : (this.addMember(a), this.renderMember(a));
        return this
      };
      f.prototype.assembleData = function (a, b) {
        var e;
        e = a.toJSON();
        e.hasRight = this.organizationModel.get("hasRight");
        e.dateString = g.formatDate(a.get("joined")).dateString;
        return b(e)
      };
      f.prototype.refreshMember = function (a) {
        var b = this;
        this.assembleData(a, function (e) {
          return b.$content.find("." + a.id).replaceWith($(r(e)))
        });
        return this
      };
      f.prototype.initMemberFinder = function () {
        var a = this;
        this.requestSubView(b, {collection: this.membersCollection,
          $searchbox: this.$content.find(".member-info-input"), select: function (b) {
            return a.addMember(b)
          }});
        return this
      };
      f.prototype.initUploader = function () {
        var a, b, d, f = this;
        b = this.$header.find(".logo");
        a = $('<a class="icon icon-pencil edit-handler"></a>').appendTo(b);
        d = this.$header.find(".progress-mask");
        this.uploader = new e({model: this.organizationModel, pick: {id: a, label: " ", multiple: !1}, dnd: b, type: "logo", onCreate: function (a) {
          return f.organizationModel.set("logo", a.thumbnailUrl)
        }, onStart: function () {
          return d.css("clip",
            "rect(0, 132px, 132px, 0)").html("")
        }, onProgress: function (a) {
          return d.css("clip", "rect(" + 132 * a / 100 + "px, 132px, 132px, 0)")
        }, onComplete: function (a) {
          d.css("clip", "rect(132px, 132px, 132px, 0)");
          return f.organizationModel.save("logo", a.thumbnailUrl)
        }});
        return this
      };
      f.prototype["switch"] = function (a) {
        a = $(a.currentTarget).data("toggle");
        if (this.tab !== a)return g.isEmpty(this.changes) ? this.toggle(a) : this.autoSubmit(a)
      };
      f.prototype.submitOrganizationInfo = function (a) {
        var b = this;
        a.preventDefault();
        g.isEmpty(this.changes) ?
          (null != a ? a.success : void 0)instanceof Function ? null != a && a.success() : this.close() : this.organizationModel.save(this.changes, {success: function () {
          b.changes = {};
          null != a && "function" === typeof a.success && a.success();
          if (a instanceof $.Event)return b.close()
        }});
        return this
      };
      f.prototype.collectChange = function (a) {
        var b, e;
        b = $(".btn-save");
        e = $(a.currentTarget);
        a = e.val();
        e = e.data("type");
        this.organizationModel.get(e) === a ? delete this.changes[e] : this.changes[e] = a;
        return g.isEmpty(this.changes) ? b.addClass("disabled") :
          b.removeClass("disabled")
      };
      f.prototype.authorityHandler = function (a) {
        var b, e;
        b = $(a.currentTarget);
        a = b.data("action");
        e = b.data("id");
        b = this.membersCollection.get(e);
        switch (a) {
          case "admin":
            return b.save({isAdmin: !0}, {success: function () {
            }});
          case "member":
            return b.save({isAdmin: !1}, {success: function () {
            }});
          case "delete":
            return this.membersCollection.removeMember(e, {success: function () {
            }})
        }
      };
      f.prototype.deleteConfirm = function (a) {
        var b, e;
        e = this.$(".delete-input:visible");
        if (e.val())return"DELETE" === e.val() ?
          this.deleteOrganization() : e.val("");
        a = $(a.currentTarget);
        b = a.next();
        return a.transition({width: 200}, function () {
          return b.show(50)
        })
      };
      f.prototype.deleteOrganization = function () {
        var a = this;
        return this.organizationModel.destroy({success: function () {
          a.close();
          return t.navigate("", {trigger: !0})
        }, error: function (a) {
          return console.error(a)
        }})
      };
      f.prototype.addMember = function (a) {
        this.membersCollection.addMember(a.attributes ? {_userId: a.id} : a.item._id ? {_userId: a.item._id} : {email: a.item.email}, {boundToObjectType: "organization"});
        return this
      };
      f.prototype.addMemberFromList = function (a) {
        var b;
        a = $(a.currentTarget);
        b = a.closest("li")[0].id.split("-")[1];
        b = this.membersCollection.get(b);
        this.addMember(b);
        a.hide();
        return this
      };
      f.prototype.close = function () {
        var a;
        null != (a = this.parentView) && a.remove();
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/project/project-creator/templates/basic", [], function () {
  return function (d) {
    var a = '<header class="card-header no-bottom project-cover project-cover-media"> <p id="project-creator-header-title" class="card-title pull-left"></p> <a class="close-window-handler pull-right icon icon-remove icon-white" data-gta="event" data-label="close project creator"> </a> <div class="project-category-logo"> <div class="logo"> <div class="progress-mask"></div> </div> </div> <div class="project-category-selector"> <a class="dropdown-toggle icon icon-pencil" data-toggle="dropdown" href="javascript:void(0)" data-gta="event" data-label="choose project category" data-action="click" data-category="a" data-value="c2"> </a> <ul class="dropdown-menu"> <li class="project-selector-title"> <span>  </span> </li> ', f =
      d.categories;
    if (f)for (var b, e = -1, g = f.length - 1; e < g;)b = f[e += 1], a += ' <li class="project-category-option ' + b.value + '-logo" data-category="' + b.value + '"> <a> <div class="logo"></div> ' + b.name + " </a> </li> ";
    return a += ' <li class="project-category-option custom"> <a class="custom-logo"> logo </a> </li> </ul> </div></header><section class="project-creator-content card-content"> <div class="project-creator-content-info-section"> <div class="project-info"> <label></label> <input class="project-name-input form-control" type="text" placeholder="..." data-gta="event" data-label="enter project name" data-action="focus" data-category="input" data-value="c3"/> </div> <div class="project-info"> <label></label> <input class="project-description-input form-control" type="text" placeholder="..." data-gta="event" data-label="enter project description" data-action="focus" data-category="input" data-value="c4"/> </div> <div class="project-selector-selected selector-selected"> <div class="selector-label"></div> <div class="open-selector-handler"> <div class="selector-title"> <strong> </strong> <span>(' +
      d.plan.total + "" + d.plan.created + ')</span> </div> <b class="caret"></b> </div> </div> </div></section><footer class="project-creator-footer"> <a class="upgrade-project-plan-handler btn btn-large btn-block btn-primary" style="display: none"></a> <a class="create-project-handler btn btn-large btn-block btn-primary disabled" data-gta="event" data-label="submit create project" data-action="click" data-category="a" data-value="c9"></a></footer>'
  }
});
define("views/project/project-creator/templates/owners", [], function () {
  return function (d) {
    var a = '<div class="selector-create-form"><i class="organization-info"><strong></strong>  <strong></strong> </i></div><ul class="organization-list selector-options thin-scroll">', f = d.collection;
    if (f)for (var b, e = -1, g = f.length - 1; e < g;)b = f[e += 1], a += '<li class="organization-item clearfix selector-item ', b._id == d.selected._id && (a += "active"), a += '" data-id="' + b._id + '"> <div class="organization-info selector-item-content pull-left"> <strong class="organization-name">' +
      b.name + ' </strong> <span class="organization-desc">(' + b.plan.total + "" + b.plan.created + ')</span> </div> <div class="selected-icon pull-left"> </div></li>';
    return a + "</ul>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/project/project-creator/index", "view views/core/selector/index lib/uploader/index warehouse models/project collections/organizations collections/projects util ./templates/basic ./templates/owners essage".split(" "), function (d, b, e, g, k, h, l, n, m, s) {
    var r, t, v, p;
    r = [
      {value: "media", name: ""},
      {value: "design",
        name: ""},
      {value: "education", name: ""},
      {value: "internet", name: ""},
      {value: "app", name: ""},
      {value: "other", name: ""}
    ];
    v = teambition.user;
    t = teambition.router;
    return function (d) {
      function f() {
        return p = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "ProjectCreatorView";
      f.prototype.tagName = "div";
      f.prototype.className = "project-creator modal-dialog card";
      f.prototype.events = {"click .close-window-handler": "close", "click .upgrade-project-plan-handler": "upgradePlan", "click .create-project-handler": "createProject",
        "click .project-category-option": "onSelectProjectCategory", "input .project-name-input": "checkCreateCondition", "input .org-name-input": "refreshOrgCreateBtn", "click .org-creator-handler": "createOrgBtn", "click .org-create-btn": "createOrg"};
      f.prototype.initialize = function (a) {
        this.options = null != a ? a : {};
        this._organizationId = this.options._organizationId;
        this.reset().render();
        return this
      };
      f.prototype.reset = function () {
        this.projectModel = g.createModel(k, {_organizationId: this._organizationId || null});
        this.listenTo(this.projectModel,
          "change:category", this.renderProjectCover);
        this.listenTo(this.projectModel, "change:logo", this.refreshLogo);
        this.listenTo(this.projectModel, "change:_organizationId", this.refreshSelected);
        this.organizationCollection = g.get(h);
        this.listenTo(this.organizationCollection, "add remove change:plan", this.renderOwners);
        return this
      };
      f.prototype.render = function () {
        var a, b = this;
        a = {categories: r, plan: v.get("plan")};
        this.$el.html(m(a));
        this.$content = this.$(".project-creator-content");
        this.$header = this.$(".project-creator-header");
        this.$upgradePlanHandler = this.$(".upgrade-project-plan-handler");
        this.$createHandler = this.$(".create-project-handler");
        this.$projectNameInput = this.$(".project-name-input");
        this.$projectDescInput = this.$(".project-description-input");
        this.$projectCover = this.$(".project-cover");
        this.$projectLogo = this.$(".project-category-logo");
        this.$categorySelector = this.$(".project-category-selector");
        this.$ownerSelector = this.$(".project-owner-selector");
        this.$orgCreatorHandler = this.$(".org-creator-handler");
        this.$orgCreatorHandlerLi =
          this.$orgCreatorHandler.parent();
        this.$orgCreatorWrapper = this.$(".org-creator-wrapper");
        this.$orgNameInput = this.$(".org-name-input");
        this.$orgCreateBtn = this.$(".org-create-btn");
        this.$orgSelector = this.$(".organization-selector");
        _.delay(function () {
          return b.$projectNameInput.focus()
        }, 200);
        this.renderOwners();
        this.initUploader();
        return this
      };
      f.prototype.refreshSelected = function () {
        var a, b;
        (a = this.projectModel.get("_organizationId")) ? (b = g.get(h).get(a), a = b.get("name"), b = b.get("plan")) : (a = "", b = v.get("plan"));
        this.$(".selector-title").html("<strong>" + a + " </strong><span>(" + b.total + "" + b.created + ")</span>");
        return this.renderUpgradeSection(b.total <= b.created)
      };
      f.prototype.renderOwners = function (a) {
        var e, d = this;
        this.$(".selector").remove();
        e = this.getOwners();
        this.requestSubView(b, {$container: this.$el, $opener: this.$(".open-selector-handler"), selected: (a || v).toJSON(), collection: e, template: s, select: function (a) {
          a = $(a.currentTarget).data("id");
          a === v.id && (a = null);
          return d.projectModel.set("_organizationId",
            a)
        }, create: function (a) {
          return d.createOrg(a)
        }});
        return this
      };
      f.prototype.refreshLogo = function () {
        return this.$projectLogo.find(".logo").css("background-image", "url(" + this.projectModel.get("logo") + ")")
      };
      f.prototype.renderUpgradeSection = function (a) {
        a ? (this.$upgradePlanHandler.css("display", "block"), this.$createHandler.css("display", "none")) : (this.$upgradePlanHandler.css("display", "none"), this.$createHandler.css("display", "block"));
        return this
      };
      f.prototype.onSelectProjectCategory = function (a) {
        a = $(a.currentTarget);
        this.projectModel.set({category: a.data("category")});
        return this
      };
      f.prototype.renderProjectCover = function (a) {
        var b, e, d, f;
        e = a.get("category") || "self";
        b = "";
        d = 0;
        for (f = r.length; d < f; d++)a = r[d], b += "project-cover-" + a.value + " ";
        this.$projectCover.removeClass(b).addClass("project-cover-" + e);
        this.$projectLogo.removeClass(_.pluck(r, "value").join("-logo ") + "-logo ").addClass("" + e + "-logo");
        return this
      };
      f.prototype.renderUpgradeSectionTitle = function (a) {
        a = a ? "" : "";
        this.$("#project-creator-header-title").text(a);
        return this
      };
      f.prototype.getOwners = function () {
        var a, b, e, d, f;
        e = [];
        e.push({name: "", plan: v.get("plan"), _id: v.id});
        b = "function" === typeof(a = this.organizationCollection).toJSON ? a.toJSON() : void 0;
        if (0 < (null != b ? b.length : void 0))for (d = 0, f = b.length; d < f; d++)a = b[d], a.isAdmin && e.push(a);
        return e
      };
      f.prototype.upgradePlan = function () {
        window.open("https://www.teambition.com/question/41");
        return this
      };
      f.prototype.createProject = function () {
        var a, b, e = this;
        this.projectModel.set({name: this.$projectNameInput.val().trim(),
          description: this.$projectDescInput.val().trim()});
        a = this.projectModel.toJSON();
        if (!a.name)return this.$projectNameInput.focus();
        b = a._organizationId ? g.get(h, null, a._organizationId).toJSON() : v.toJSON();
        b.plan.created >= b.plan.total && this.renderUpgradeSection({type: a._organizationId ? "organization" : "user", name: b.name});
        g.get(l).create(a, {wait: !0, beforeSend: function () {
          return e.$createHandler.text("...")
        }, success: function (a) {
          e.close();
          return t.navigate("project/" + a.id + "/home", {trigger: !0})
        }, error: function (a) {
          return e.$createHandler.text("")
        }});
        return this
      };
      f.prototype.checkCreateCondition = function () {
        return this.$projectNameInput.val() ? this.$createHandler.removeClass("disabled") : this.$createHandler.addClass("disabled")
      };
      f.prototype.createOrg = function (a) {
        var b = this;
        a = {name: a.trim(), description: "", logo: "https://dn-st.qbox.me/organizations/org" + _.random(1, 6) + ".jpg", isAdmin: !0};
        return"" === a.name ? (this.$orgNameInput.focus(), !1) : g.get(h).create(a, {wait: !0, success: function (a) {
          b._organizationId = a.id;
          return b.projectModel.set("_organizationId", b._organizationId)
        },
          error: function (a) {
            return console.error(a)
          }})
      };
      f.prototype.toggleOrgCreator = function (a) {
        var b = this;
        if (a)return this.$orgCreatorWrapper.stop(!1, !0).transition({height: "76px"}), this.$orgNameInput.focus(), n.handleClickOutside(this.$orgCreatorWrapper.add(this.$orgCreatorHandler), function () {
          return b.createOrgBtn()
        });
        this.$orgCreatorWrapper.stop(!1, !0).transition({height: 0});
        this.$orgNameInput.val("");
        return $(document).off("mousedown")
      };
      f.prototype.refreshOrgCreateBtn = function () {
        return this.$orgCreateBtn.toggleClass("disabled",
          !this.$orgNameInput.val())
      };
      f.prototype.createOrgBtn = function () {
        this.$orgCreatorHandler.toggleClass("show");
        return this.toggleOrgCreator(this.$orgCreatorHandler.hasClass("show"))
      };
      f.prototype.initUploader = function () {
        var a, b = this;
        a = this.$(".progress-mask");
        this.uploader = new e({model: this.projectModel, pick: {id: this.$(".custom-logo"), multiple: !1}, dnd: this.$(".project-category-logo .logo"), type: "logo", onCreate: function (a) {
          return b.projectModel.set("logo", a.thumbnail)
        }, onStart: function () {
          return a.css("clip",
            "rect(0, 132px, 132px, 0)").html("")
        }, onProgress: function (b) {
          return a.css("clip", "rect(" + 132 * b / 100 + "px, 132px, 132px, 0)")
        }, onComplete: function (e) {
          a.css("clip", "rect(132px, 132px, 132px, 0)");
          return b.projectModel.save("logo", e.thumbnailUrl)
        }});
        return this
      };
      f.prototype.close = function () {
        var a;
        null != (a = this.parentView) && a.remove();
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/portal/templates/basic", [], function () {
  return function (d) {
    var a = '<ul class="project-category"> <li class="project-category-item no-project"> <div class="project-category-title"></div> <ul class="projects clearfix flagged-projects"></ul> </li>';
    if (d)for (var f, b = -1, e = d.length - 1; b < e;)f = d[b += 1], a += " ", "null" == f.id ? a += ' <li class="project-category-item personal"> <div class="project-category-title"></div> <ul class="projects clearfix organization-null"></ul> </li> ' : (a += ' <li class="project-category-item organization"> <div class="project-category-title"> ' +
      f.name + " ", f.isAdmin && (a += ' <a class="organization-setting-handler icon icon-cog" data-id="' + f.id + '"></a> '), a += ' </div> <ul class="projects clearfix organization-' + f.id + '"></ul> </li> ');
    return a + "</ul>"
  }
});
define("views/portal/templates/project", [], function () {
  return function (d) {
    var a = '<li class="project pull-left" data-id="' + d._id + '" style="background-image:url(' + d.logo + ')"> <div class="project-info"> <span class="icon icon-star"></span> <p class="project-name">' + d.name + '</p> <span class="project-creator">' + (d.creatorName || "") + " ";
    1 < d.membersCount && (a += " " + d.membersCount + " ");
    return a += ' </span> </div> <div class="project-cover-gradient"> <div class="project-abstract"> <div class="post-number pull-left"> <span class="icon icon-wall"></span> <span>' +
      d.postsCount + '</span> </div> <div class="task-number pull-left"> <span class="icon icon-board"></span> <span>' + d.tasksCount + '</span> </div> <div class="file-number pull-left"> <span class="icon icon-file"></span> <span>' + d.worksCount + '</div> </span> </div> </div> <div class="edit-set"> <a class="icon icon-pencil edit-handler" data-gta="event" data-label="portal||to edit project"></a> <a class="icon icon-star flag-handler"></a> </div></li>'
  }
});
define("views/portal/templates/guide", [], function () {
  return function (d) {
    return'<div class="guide-view"> <div class="guide-portal-detail"> <div class="guide-portal-content guide-detail-wrapper pull-left"> <div class="guide-content-main"> <h2> <span class="teambition-logo"></span></h2> <hr> <p>' + teambition.user.attributes.name + '</p> <p> teambition</p> </div> </div> <div class="guide-portal-figure pull-right"></div> </div></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, e) {
    function f() {
      this.constructor = a
    }

    for (var k in e)d.call(e, k) && (a[k] = e[k]);
    f.prototype = e.prototype;
    a.prototype = new f;
    a.__super__ = e.prototype;
    return a
  }, f = [].indexOf || function (a) {
    for (var e = 0, d = this.length; e < d; e++)if (e in this && this[e] === a)return e;
    return-1
  };
  define("views/portal/index", "view lib/window/index views/core/guide/index views/settings/project-settings/index views/settings/organization-settings/index views/project/project-creator/index warehouse collections/organizations collections/projects util ./templates/basic ./templates/project ./templates/guide jquery.cookie".split(" "),
    function (b, e, d, k, h, l, n, m, s, r, t, v, p) {
      var x, B, C;
      x = teambition.APP;
      B = teambition.router;
      return function (b) {
        function A() {
          return C = A.__super__.constructor.apply(this, arguments)
        }

        a(A, b);
        A.prototype.viewName = "PortalView";
        A.prototype.tagName = "div";
        A.prototype.className = "portal-view";
        A.prototype.title = "myProject";
        A.prototype.routes = {create: "renderProjectCreator", guide: "enterGuide"};
        A.prototype.events = {"click .project": "enterProject", "click .edit-handler": "editProject", "click .flag-handler": "flagProject", "click .organization-setting-handler": "openOrganizationSettings"};
        A.prototype.initialize = function () {
          this.projectsCollection = n.get(s);
          this.orgCollection = n.get(m);
          this.render();
          this.listen();
          this.setupPlaceholder(this.projectsCollection, "project");
          return this
        };
        A.prototype.listen = function () {
          this.listenTo(this.projectsCollection, "add remove", this.render);
          this.listenTo(this.projectsCollection, "change", this.refreshProject);
          this.listenTo(this.projectsCollection, "change:_organizationId", this.render);
          return this
        };
        A.prototype.render = function () {
          var a;
          $(".app-switcher").remove();
          a = this.assembleData();
          this.$el.html(t(a));
          this.$flaggedProjects = this.$(".flagged-projects");
          this.$projects = this.$(".projects");
          this.projectsCollection.length ? this.renderProjects() : this.$projects.append('<li class="portal-placeholder"></li>');
          this.checkFlagged();
          return this
        };
        A.prototype.assembleData = function () {
          var a, b, e, d, g, h;
          e = this.projectsCollection.toJSON();
          a = [];
          d = [];
          g = 0;
          for (h = e.length; g < h; g++)b = e[g], !(b = b._organizationId) || 0 <= f.call(d, b) || (d.push(b), b = this.orgCollection.get(b), a.push({name: b.get("name"),
            id: b.id, isAdmin: b.get("isAdmin"), created: new Date(b.get("created"))}));
          a.sort(function (a, b) {
            return b.created - a.created
          });
          a.unshift({id: "null"});
          return a
        };
        A.prototype.setupGuideVideo = function () {
          if (!(0 < this.projectsCollection.length || $.cookie("guideVideoPlayed")))return this.requestSubView(d).load().$el.appendTo("body"), $.cookie("guideVideoPlayed", !0, {expires: 7})
        };
        A.prototype.renderProjects = function () {
          var a, b = this;
          a = this.projectsCollection.getSelfProjectCount();
          this.$projects.empty();
          2 >= a && _.delay(function () {
            var a;
            a = b.$(".organization-null");
            a.find(".portal-placeholder").remove();
            return a.append('<li class="portal-placeholder"></li>')
          }, 100);
          this.projectsCollection.each(function (a) {
            return b.renderProject(a)
          });
          _.each(this.projectsCollection.getStarProjects(), function (a) {
            return b.$flaggedProjects.append(b.$("[data-id=" + a.id + "]").addClass("flagged").clone())
          });
          return this
        };
        A.prototype.renderProject = function (a) {
          var b;
          b = a.get("_organizationId");
          b = this.$(".organization-" + b);
          a = a.toJSON();
          a = $(v(a));
          b.append(a);
          return this
        };
        A.prototype.removeProject = function (a) {
          this.$("[data-id=" + a.id + "]").remove();
          return this
        };
        A.prototype.refreshProject = function (a) {
          var b;
          if (!("isStar"in a.changed) && (b = a.toJSON(), this.$("[data-id=" + a.id + "]").replaceWith(v(b)), a.get("isStar")))return this.$("[data-id=" + a.id + "]").addClass("flagged")
        };
        A.prototype.enterProject = function (a) {
          var b;
          a = $(a.currentTarget).data("id");
          b = this.projectsCollection.get(a);
          return x.updateUrl({_organizationId: b.get("_organizationId"), _projectId: a}, {trigger: !0})
        };
        A.prototype.editProject =
          function (a) {
            a = $(a.currentTarget).closest(".project").data("id");
            a = this.projectsCollection.get(a);
            this.requestSubView(e).open(k, {projectModel: a});
            return!1
          };
        A.prototype.flagProject = function (a) {
          var b, e, d, f, g, h, k = this;
          a = $(a.currentTarget).closest(".project");
          e = a.data("id");
          f = this.projectsCollection.get(e);
          (d = f.get("isStar")) ? (b = this.$flaggedProjects.find("[data-id=" + e + "]"), b.transition({scale: 0.5, opacity: 0}, 300, function () {
            b.remove();
            return k.checkFlagged()
          }), null != (g = teambition.gta) && g.event("a", "click",
            "unstar project")) : (this.$flaggedProjects.append(a.clone().addClass("animation")), this.checkFlagged(), null != (h = teambition.gta) && h.event("a", "click", "star project"));
          f.save("isStar", !d);
          this.$("[data-id=" + e + "]")[d ? "removeClass" : "addClass"]("flagged");
          return!1
        };
        A.prototype.openOrganizationSettings = function (a) {
          a = $(a.currentTarget).data("id");
          this.requestSubView(e).open(h, {organizationModel: this.orgCollection.get(a)});
          return this
        };
        A.prototype.checkFlagged = function () {
          this.$flaggedProjects.parent()[this.$flaggedProjects.children().length ?
            "removeClass" : "addClass"]("no-project");
          return this
        };
        A.prototype.openProjectCreator = function () {
          this.requestSubView(e).open(l);
          return this
        };
        A.prototype.enterGuide = function () {
          try {
            teambition.gta.event("portal", "view", "portal|start guide")
          } catch (a) {
          }
          teambition.guideView = !0;
          teambition.user.isNewUser = !0;
          return this.guideView(500)
        };
        A.prototype.guideView = function (a) {
          var b, e, d, f, g = this;
          $(".guide-view").remove();
          $(".guide-on").removeClass("guide-on");
          b = $(p());
          e = this.$(".organization-null > .project:first").addClass("guide-on");
          b.appendTo("body");
          r.loadImage("/v3.8.4/images/application/guide/figureen.png", function (a, e, d) {
            b.find(".guide-portal-figure").addClass("with-image");
            return _.delay(function () {
              return b.find(".guide-portal-content").animate({opacity: 1}, 300)
            }, 700)
          });
          this.guideView.destroy = function () {
            e.removeClass("guide-on").off(".guide");
            b.remove();
            g.guideView.response = g.guideView.destroy = null;
            return B.navigate("projects", {trigger: !1})
          };
          e.one("click.guide", function (a) {
            a.stopPropagation();
            g.guideView.destroy();
            return g.enterProject(a)
          });
          b.find(".guide-close").one("click", function () {
            return b.find(".guide-portal-detail").animate({opacity: 0}, 400, function () {
              teambition.guideView = !1;
              return g.guideView.destroy()
            })
          });
          b.find(".guide-next").one("click", function () {
            return b.find(".guide-portal-detail").animate({opacity: 0}, 400, function () {
              return e.trigger("click")
            })
          });
          f = function () {
            return setTimeout(function () {
              return e.removeClass("animated bounce")
            }, 1E3)
          };
          d = function () {
            return setTimeout(function () {
                e.addClass("animated bounce");
                f();
                if (g.$el && teambition.guideView)return d()
              },
              5E3)
          };
          b.on("click", function () {
            e.addClass("animated bounce");
            return f()
          });
          d();
          return this
        };
        return A
      }(b)
    })
}).call(this);
define("views/member/member-detail/templates/basic", [], function () {
  return function (d) {
    var a = ' <header class="member-detail-header"> <div class="avatar img-circle pull-left" style="background-image: url(' + d.avatarUrl + ');"></div> <div class="member-name"> <div class="chinese-name">' + d.name + "</div> ";
    d.title && (a += ' <div class="member-title muted">' + d.title + "</div> ");
    a += ' </div> </header> <section class="member-detail-content"> <ul class="member-detail-info"> ';
    d.birthday && (a += ' <li class="member-info-item"> <div class="member-info-label"></div> <div class="member-info-content">' +
      d.birthday + "</div> </li> ");
    a += " ";
    d.location && (a += ' <li class="member-info-item"> <div class="member-info-label"></div> <div class="member-info-content">' + d.location + "</div> </li> ");
    a += " ";
    d.phone && (a += ' <li class="member-info-item"> <div class="member-info-label"></div> <div class="member-info-content">' + d.phone + "</div> </li> ");
    a += " ";
    d.email && (a += ' <li class="member-info-item"> <div class="member-info-label"></div> <div class="member-info-content"> <a href="mailto:' + d.email + '">' + d.email +
      "</a> </div> </li> ");
    a += " ";
    d.website && (a += ' <li class="member-info-item"> <div class="member-info-label"></div> <div class="member-info-content"> <a href="' + d.website + '" target="_blank">' + d.website + "</a> </div> </li> ");
    return a + " </ul></section>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/member/member-detail/index", ["view", "./templates/basic"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "MemberDetailView";
      f.prototype.className = "member-detail card";
      f.prototype.initialize = function (a) {
        if (null !=
          a && a._projectId && null != a && a.memberModel)return this.options = a, this._projectId = a._projectId, this.memberModel = a.memberModel, this.render().listen(), this
      };
      f.prototype.listen = function () {
        this.listenTo(this.memberModel, "change", this.render);
        return this
      };
      f.prototype.render = function () {
        var a;
        a = this.memberModel.toJSON();
        a.birthday = this.memberModel.getBirthdayString();
        this.$el.html(b(a));
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/wall/post-creator/templates/basic", [], function () {
  return function (d) {
    return'<header class="post-creator-header"> <h4 class="post-creator-title"></h4></header><section class="post-creator-content"> <div class="post-editor-wrapper"></div></section><footer class="post-creator-footer"> <div class="involve-set"> <ul class="involve-members"></ul> </div> <div class="post-editor-handler-set clearfix"> <button class="btn btn-primary submit-handler" data-gta="event" data-label="submit post">  </button> <a class="btn btn-link cancel-handler"></a> </div></footer>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/wall/post-creator/index", "view warehouse views/wall/post-editor/index views/member/member-involve/index models/post collections/members ./templates/basic".split(" "), function (d, b, e, g, k, h, l) {
    var n, m;
    n = teambition.user;
    return function (d) {
      function f() {
        return m = f.__super__.constructor.apply(this,
          arguments)
      }

      a(f, d);
      f.prototype.className = "post-creator";
      f.prototype.events = {"click .submit-handler": "submit", "click .cancel-handler": "cancel", "keydown .post-editor-textarea": "quickSubmit"};
      f.prototype.initialize = function (a) {
        if (null == a || !a._projectId || null == a || !a.postsCollection)return!1;
        this.options = _.extend({creating: function () {
        }, created: function () {
        }, cancel: function () {
        }}, a);
        this._projectId = a._projectId;
        this.postModel = b.createModel(k, {_creatorId: n.id, _projectId: this._projectId});
        this.postsCollection =
          a.postsCollection;
        this.membersCollection = b.get(h, this._projectId);
        this.renderBasic().initInvolve().initEditor();
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(l());
        this.$editor = this.$(".post-editor-wrapper");
        this.$handlers = this.$(".post-editor-handler-set");
        this.$involveSet = this.$(".involve-set");
        this.$submit = this.$(".submit-handler");
        return this
      };
      f.prototype.initEditor = function () {
        this.postEditorView = this.requestSubView(e, {_projectId: this._projectId, postModel: this.postModel});
        this.postEditorView.$el.appendTo(this.$editor);
        return this
      };
      f.prototype.initInvolve = function () {
        this.involveView && (this.involveView.remove(), delete this.involveView);
        this.involveView = this.requestSubView(g, {objectModel: this.postModel, membersCollection: this.membersCollection, resident: [teambition.user.id], $list: this.$(".involve-members")});
        this.involveView.$el.prependTo(this.$involveSet);
        return this
      };
      f.prototype.quickSubmit = function (a) {
        a.ctrlKey && 13 === a.keyCode && this.submit(a);
        return this
      };
      f.prototype.submit = function () {
        var a, b = this;
        if (!this.$submit.prop("disabled"))return a =
          this.postEditorView.save(), null != a && a.content ? (a = _.extend(this.postModel.toJSON(), a), this.disableSubmit(!0), this.postsCollection.create(a, {_projectId: this._projectId, wait: !0, beforeSend: function () {
          return b.options.creating()
        }, error: function () {
          b.disableSubmit(!1);
          return b.postEditorView.focus()
        }, success: function (a) {
          b.disableSubmit(!1);
          return b.options.created(a)
        }})) : this.postEditorView.focus(), this
      };
      f.prototype.disableSubmit = function (a) {
        this.$submit.prop("disabled", a);
        this.$submit[a ? "addClass" : "removeClass"]("disabled");
        return this
      };
      f.prototype.cancel = function () {
        this.options.cancel();
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/wall/wall/templates/basic", [], function () {
  return function (d) {
    return'<div class="wall-left-column"> <header class="wall-left-column-header clearfix"></header> <nav class="posts-navigator thin-scroll"> <ul class="posts-pin"></ul> <ul class="posts-list"></ul> <div class="posts-placeholder placeholder muted"> <a class="icon icon-wall"></a> <br />  </div> </nav></div><div class="wall-right-column"> <div class="post-detail-wrapper"></div></div>'
  }
});
define("views/wall/wall/templates/header", [], function () {
  return function (d) {
    var a = '<div class="btn-group wall-switcher pull-left"> <a class="btn btn-link dropdown-toggle" data-toggle="dropdown"> ', a = "my" === d.section ? a + "" : a + "";
    return a + ' <span class="caret"></span> </a> <ul class="dropdown-menu"> <li> <a class="wall-switcher-btn" data-section="all" data-gta="event" data-label="show all posts"></a> </li> <li> <a class="wall-switcher-btn" data-section="my" data-gta="event" data-label="show my posts"></a> </li> </ul></div><a class="open-post-creator-handler btn btn-primary pull-right"> </a>'
  }
});
define("views/wall/wall/templates/post", [], function () {
  return function (d) {
    var a = '<li class="post" data-id="' + d._id + '" data-type="post" data-gta=\'event\' data-label=\'wall |open post detail\'> <div class="avatar img-24 img-circle pull-left" style="background-image: url(' + d.creator.avatarUrl + ');"></div> <div class="post-content"> <p class="post-title" >' + d.description + '</p> <p class="post-info muted"> ' + d.creator.name + '<time datetime="' + d.created + '"></time>';
    d.activitiesCount && (a += ", " + d.activitiesCount +
      "");
    return a + " </p> </div></li>"
  }
});
define("views/wall/wall/templates/endpoint", [], function () {
  return function (d) {
    return'<div class="end-point-wrapper"> <span class="end-point"></span></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/wall/wall/index", "view lib/window/index views/member/member-detail/index views/wall/post-creator/index views/wall/post-detail/index views/library/previewer/index lib/selectable lib/scrollable util warehouse models/work collections/members collections/posts thenjs ./templates/basic ./templates/header ./templates/post ./templates/endpoint".split(" "), function (d, b, e, g, k, h, l, n, m, s, r, t, v, p, x, B, C, z) {
    var A, u;
    A = teambition.router;
    d = function (b) {
      function e() {
        return u = e.__super__.constructor.apply(this, arguments)
      }

      a(e, b);
      e.prototype.viewName = "WallView";
      e.prototype.className = "wall-view card";
      e.prototype.hotkeys = {j: "next", k: "prev", r: "reply"};
      e.prototype.routes = {":section(/:type)(/:_modelId)": "enterSection", "*paramString": "home"};
      e.prototype.events = {"click .post": "onClickPost", "click .open-post-creator-handler": "openPostCreator", "click .wall-switcher-btn": "nav"};
      e.prototype.initialize =
        function (a) {
          if (null != a && a._projectId)return this.options = a, this._projectId = a._projectId, this.postsCollection = s.get(v, this._projectId, null, {boundToObjectType: "project"}), this.membersCollection = s.get(t, this._projectId), this.renderBasic().listen().setupScroll(this.$(".posts-navigator")), this
        };
      e.prototype.renderBasic = function () {
        this.$el.html(x());
        this.$header = this.$(".wall-left-column-header");
        this.$postsWrapper = this.$(".posts-wrapper");
        this.$posts = this.$(".posts-list");
        this.$pin = this.$(".posts-pin");
        this.$nav = this.$(".wall-switcher-nav");
        this.$detail = this.$(".post-detail-wrapper");
        this.$postsPlaceholder = this.$(".posts-placeholder");
        return this
      };
      e.prototype.listen = function () {
        var a = this;
        this.listenTo(this.postsCollection, "add", function (b) {
          a.checkPlaceholder();
          return a.renderPost(b)
        });
        this.listenTo(this.postsCollection, "change:description change:activitiesCount", this.updatePost);
        this.listenTo(this.postsCollection, "change:pin", this.updatePinPost);
        this.listenTo(this.postsCollection, "remove destroy",
          function (b) {
            a.removePost(b);
            return a.checkPlaceholder()
          });
        return this
      };
      e.prototype.load = function (a) {
        var b = this;
        this.postsCollection.reset();
        this.postsCollection.fetch({remove: !1, silent: !0, section: this.section, beforeSend: function () {
          return b.showLoadingIndicator(b.$posts, {isPrepend: !0})
        }, success: function (e) {
          b.hideLoadingIndicator();
          b.renderPosts(e);
          b.checkPlaceholder();
          return"create" !== a.type && b.postsCollection.length ? (e = a._modelId || b.postsCollection.at(0).id, b.openDetail(e)) : b.openPostCreator()
        }});
        return this
      };
      e.prototype.home = function () {
        this.enterSection("all");
        return this
      };
      e.prototype.enterSection = function (a, b, e) {
        var d;
        d = this.postsCollection.getType(a);
        a !== d && (e = b, b = a, a = d);
        a !== this.section && (this.section = a, this.load({type: b, _modelId: e}), this.renderHeader({section: a}));
        return this
      };
      e.prototype.loadMore = function (a) {
        var b, e, d, f = this;
        d = b = 0;
        e = this.postsCollection.getType(this.section);
        this.postsCollection.loadMore({silent: !0, section: e, beforeSend: function () {
          d = (new Date).getTime();
          return f.showLoadingIndicator(f.$posts)
        },
          success: function (e, g, h) {
            b = (new Date).getTime();
            e = b - d;
            return _.delay(function () {
              f.hideLoadingIndicator({animated: !0});
              f.renderPosts(g);
              return f.postsCollection.hasMore ? "function" === typeof a ? a() : void 0 : f.renderEndPoint()
            }, 1E3 > e ? 1E3 - e : 0)
          }});
        return this
      };
      e.prototype.renderHeader = function (a) {
        this.$header.html(B(a));
        return this
      };
      e.prototype.renderPosts = function (a) {
        var b, e, d, f;
        e = _.isArray(a) ? a : a.toJSON();
        d = 0;
        for (f = e.length; d < f; d++)a = e[d], b = this.postsCollection.get(a._id || a.id), a.pin ? this.pinPost(b, !0) : this.renderPost(b,
          !0);
        return this
      };
      e.prototype.renderPost = function (a, b, e) {
        b = !0 === b ? "appendTo" : "prependTo";
        e || (e = this.$posts);
        a = a.toJSON();
        a.creator = this.membersCollection.get(a._creatorId).toJSON();
        e = $(C(a))[b](e);
        e.find("time").timesince();
        return e
      };
      e.prototype.updatePost = function (a) {
        var b, e;
        e = this.$posts.find("[data-id=" + a.id + "]");
        e.length || (e = this.$pin.find("[data-id=" + a.id + "]"));
        if (e.length)return b = a.toJSON(), b.creator = this.membersCollection.get(b._creatorId).toJSON(), b.latestActivity && (b.latestActivity.creator =
          this.membersCollection.get(b.latestActivity._creatorId).toJSON()), b = $(C(b)), e.replaceWith(b), b.find("time").timesince(), this.currentPostId === a.id && b.addClass("active"), b
      };
      e.prototype.pinPost = function (a, b) {
        this.$posts.find("[data-id=" + a.id + "]").remove();
        this.renderPost(a, b, this.$pin);
        this.checkPin();
        return this
      };
      e.prototype.updatePinPost = function (a) {
        var b;
        b = this.updatePost(a);
        null != b && b.prependTo(a.get("pin") ? this.$pin : this.$posts);
        this.checkPin();
        this.postsCollection.sort();
        return this
      };
      e.prototype.checkPin =
        function () {
          var a = this;
          this.$pin.children().slice(3).each(function (b, e) {
            var d;
            return null != (d = a.postsCollection.get($(e).data("id"))) ? d.save({pin: !1}) : void 0
          });
          return this
        };
      e.prototype.removePost = function (a) {
        var b;
        this.$posts.find("[data-id=" + a.id + "]").remove();
        this.$pin.find("[data-id=" + a.id + "]").remove();
        this.currentPostId = null;
        (a = this.prevPostId || (null != (b = this.postsCollection.at(0)) ? b.id : void 0)) ? this.openDetail(a) : this.openPostCreator();
        return this
      };
      e.prototype.renderPlaceholder = function () {
        this.$content.html(PlaceholderTemplate());
        return this
      };
      e.prototype.renderEndPoint = function () {
        var a;
        this.$endPoint = (null != (a = this.$endPoint) ? a.remove() : void 0) || $(z());
        this.$endPoint.appendTo(this.$posts);
        return this
      };
      e.prototype.checkPlaceholder = function () {
        this.$postsPlaceholder[this.postsCollection.length ? "hide" : "show"]();
        return this
      };
      e.prototype.onClickPost = function (a) {
        a = $(a.currentTarget);
        this.openDetail(a.data("id"), a);
        return this
      };
      e.prototype.openDetail = function (a, b) {
        if (a && !(a === this.currentPostId && this.currentView instanceof k))return this.prevPostId =
          this.currentPostId, this.currentPostId = a, this.open(k, this.$detail, {postModel: this.postsCollection.get(a)}), this.$posts.find(".post.active").removeClass("active"), this.$pin.find(".post.active").removeClass("active"), b || (b = this.$posts.find("[data-id=" + a + "]")), b || (b = this.$pin.find("[data-id=" + a + "]")), b.addClass("active"), this.updateUrl({type: "post", _modelId: a}, {trigger: !1}), this
      };
      e.prototype.openPostCreator = function () {
        var a = this;
        if (!(this.currentView instanceof g))return this.$posts.find(".post.active").removeClass("active"),
          this.open(g, this.$detail, {_projectId: this._projectId, postsCollection: this.postsCollection, created: function (b) {
            return a.openDetail(b.id)
          }, cancel: function () {
            return a.openDetail(a.currentPostId || a.postsCollection.at(0).id)
          }}), this.updateUrl({type: "create"}, {trigger: !1}), this
      };
      e.prototype.open = function (a, b, e) {
        var d;
        null != (d = this.currentView) && d.remove();
        this.currentView = this.requestSubView(a, e);
        b.html(this.currentView.$el);
        return this
      };
      e.prototype.nav = function (a) {
        a = $(a.currentTarget).data("section");
        if (a !== this.section)return this.updateUrl({section: a}, {trigger: !0}), this
      };
      e.prototype.updateUrl = function (a, b) {
        var e, d;
        b = b || {};
        d = A.getPrefix() + "/wall";
        e = a.section ? this.postsCollection.getType(a.section) : this.section;
        "all" !== e && (d += "/" + e);
        a.type && (d += "/" + a.type);
        a._modelId && (d += "/" + a._modelId);
        a.params && (d += "/" + a.params);
        A.navigate(d, b);
        return this
      };
      return e
    }(d);
    _.extend(d.prototype, l(".post"));
    _.extend(d.prototype, n);
    return d
  })
}).call(this);
define("views/board/task/task-creator/templates/basic", [], function () {
  return function (d) {
    return'<div class="task-creator-content"> <span class="icon icon-plus-sign muted"></span> <div class="task-creator-form"> <input class="task-content-input" type="text" placeholder="' + d.placeholder + '"/> </div></div><div class="task-creator-handler-set handler-set"> <div class="handler-group pull-left"> <a class="handler assign-executor-handler" data-gta="event" data-label="task creator|change executor" data-title=""> <div class="avatar img-circle img-24" style="background-image:url(' +
      d.avatarUrl + ')"></div> <strong class="name">' + d.name + '</strong>  </a> </div> <div class="handler-group pull-left"> <a class="handler set-due-handler hinted" data-gta="event" data-label="task creator|change duedate" data-title=""> <span class="icon icon-calendar"></span> <span class="due-text"></span> </a> </div> <div class="handler-group pull-left"> <a class="handler set-task-stage hinted" data-gta="event" data-label="task creator|change stage" data-title=""> <span class="icon icon-stage"></span> <span class="stage-text"></span> </a> </div> <div class="handler-group pull-left"> <a class="handler set-task-priority hinted" data-gta="event" data-label="task creator|change priority" data-title=""> <span class="icon icon-circle"></span> <span class="priority-text"></span> </a> </div> <div class="handler submit-handler hidden pull-right" data-gta="event" data-label="task creator|submit create task"> </div> <label class="checkbox pull-right" data-gta="event" data-label="task creator|quick create"> <input type="checkbox" class="quick-create" checked>  </label></div><div class="task-creator-hint bounce-infinite"> <p><span class="icon icon-plus-sign"></span></p> <p><span class="hint-title"></span></p> <p><span class="hint-info"></span></p></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/task/task-creator/index", "view views/member/member-involve/index views/member/member-menu/index views/board/stage/stage-switcher/index views/board/task/task-priority/index warehouse models/task collections/members util store ./templates/basic".split(" "), function (d, b, e, g, k, h, l, n, m, s, r) {
    var t, v, p, x, B, C;
    B = teambition.user;
    x = teambition.PREFERENCE;
    v = $(document);
    t = $("body");
    p = [".datepicker"];
    return function (d) {
      function f() {
        return C = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "TaskCreatorView";
      f.prototype.tagName = "div";
      f.prototype.className = "task-creator card expand clearfix";
      f.prototype.events = {"focus .task-content-input": "activate", "keydown .task-content-input": "quickSubmit", "change .task-content-input": "cacheTask", "click .submit-handler": "submit",
        "click .tasklist-menu-set .dropdown-menu a": "onTaskMenuSelected", "change .quick-create": "enterQuickCreateMode"};
      f.prototype.hotkeys = {c: "focus"};
      f.prototype.initialize = function (a) {
        if (a)return this.options = a, this._projectId = a._projectId, this.tasksCollection = a.tasksCollection, this.stagesCollection = a.stagesCollection, this.membersCollection = h.get(n, this._projectId), this.localCache = s.namespace("tasks_board"), this.localCacheId = "" + a._projectId + "_" + B.id, this.render().reset(), this.checkQuickCreateMode(), this.options.focus &&
          this.focus(), this
      };
      f.prototype.reset = function () {
        var a, b;
        this.taskModel && this.stopListening(this.taskModel);
        a = this.localCache(this.localCacheId) || {};
        this._tasklistId = this.options._tasklistId || a._tasklistId;
        this._executorId = a._executorId || B.id;
        this.taskModel = h.createModel(l, {_creatorId: B.id, _executorId: this._executorId, _projectId: this._projectId, _tasklistId: this._tasklistId, _stageId: (null != (b = this.stagesCollection.get(a._stageId)) ? b.id : void 0) || this.stagesCollection.getFirstStage().id, priority: a.priority ||
          0, dueDate: a.dueDate || "", involveMembers: a.involveMembers || [B.id], content: a.content || ""});
        this.listenTo(this.taskModel, "change:content", this.renderContent);
        this.listenTo(this.taskModel, "change:_executorId", this.renderExecutor);
        this.listenTo(this.taskModel, "change:dueDate", this.renderDueDate);
        this.listenTo(this.taskModel, "change:_stageId", this.renderStage);
        this.listenTo(this.taskModel, "change:priority", this.renderPriority);
        this.listenTo(this.taskModel, "change:_tasklistId", this.renderTasklistsMenu);
        this.listenTo(this.taskModel,
          "change", this.cacheTask);
        this.initExecutor().initDatePicker().initInvolve().initStageSwitcher().initPriority().renderStage().renderPriority().renderDueDate().renderContent().renderDueDate();
        this.cacheTask();
        return this
      };
      f.prototype.render = function () {
        this.$el.html(r({placeholder: "", avatarUrl: B.get("avatarUrl"), name: B.get("name")}));
        this.renderTaskCreatorHint(B.isNewUser);
        this.$input = this.$("input.task-content-input");
        this.$executorSet = this.$(".assign-executor-handler");
        this.$handlerSet = this.$(".task-creator-handler-set");
        this.$quickCreate = this.$(".quick-create");
        this.$submit = this.$(".submit-handler");
        return this
      };
      f.prototype.focus = function (a) {
        var b;
        null != a && a.preventDefault();
        null != (b = this.$input) && b.focus();
        return this
      };
      f.prototype.updateModel = function (a) {
        this.taskModel.set(a);
        return this
      };
      f.prototype.renderContent = function () {
        this.$input.val(this.taskModel.get("content")).attr({placeholder: ""});
        return this
      };
      f.prototype.initInvolve = function () {
        this.$(".involve-view").remove();
        this.involveView = this.requestSubView(b,
          {objectModel: this.taskModel, membersCollection: this.membersCollection, resident: [B.id], type: "taskCreator"});
        this.involveView.$el.appendTo(this.$handlerSet);
        return this
      };
      f.prototype.initExecutor = function () {
        var a = this;
        this.memberMenuView = this.requestSubView(e, {membersCollection: this.membersCollection, selected: [this._executorId], select: function (b) {
          a._executorId = b;
          a.updateModel({_executorId: b});
          a.renderExecutor();
          return a.focus()
        }}).setup(this.$executorSet, {direction: this.options.direction});
        return this
      };
      f.prototype.initDatePicker = function () {
        var a, b, e = this;
        a = this.$(".set-due-handler");
        b = !1;
        if (!a.data("datepicker"))a.datepicker({format: "mm-dd-yyyy", placement: "bottom" === this.options.direction ? "left" : "top", language: "zh-CN", todayHighlight: !0, todayBtn: "linked", tomorrowBtn: "linked", somedayBtn: "linked"}).on("changeDate",function (b) {
          if (e.$el)return e.updateModel({dueDate: b.date}), a.datepicker("hide"), e.focus()
        }).on("click",function () {
          b = !b;
          return a.data("datepicker").picker.toggle(b)
        }).on("hide", function () {
          return b = !1
        });
        return this
      };
      f.prototype.initStageSwitcher = function () {
        var a = this;
        this.stageSwitcherView ? this.stageSwitcherView.currentStageId = this.taskModel.get("_stageId") : this.stageSwitcherView = this.requestSubView(g, {stagesCollection: this.stagesCollection, currentStageId: this.taskModel.get("_stageId"), select: function (b) {
          a.taskModel.save({_stageId: b});
          return a.focus()
        }}).setup(this.$(".set-task-stage"));
        return this
      };
      f.prototype.initPriority = function () {
        var a = this;
        this.taskPriorityView ? this.taskPriorityView.currentPriority =
          this.taskModel.get("priority") : this.taskPriorityView = this.requestSubView(k, {currentPriority: this.taskModel.get("priority"), select: function (b) {
          a.taskModel.save({priority: b});
          return a.focus()
        }}).setup(this.$(".set-task-priority"));
        return this
      };
      f.prototype.renderExecutor = function () {
        var a;
        a = h.get(n, this.taskModel.get("_projectId"), this._executorId);
        this.$executorSet.find(".avatar").css({"background-image": "url(" + a.get("avatarUrl") + ")"});
        this.$executorSet.find(".name").html(a.get("name"));
        return this
      };
      f.prototype.renderDueDate = function () {
        var a;
        a = (a = this.taskModel.get("dueDate")) ? m.formatDate(a).dateString : "";
        this.$(".due-text").text(a);
        return this
      };
      f.prototype.renderStage = function () {
        var a;
        (a = this.stagesCollection.get(this.taskModel.get("_stageId"))) && this.$(".stage-text").text(a.get("name"));
        return this
      };
      f.prototype.renderPriority = function () {
        var a;
        a = this.taskModel.get("priority");
        this.$(".set-task-priority .icon-circle").removeClass().addClass("icon icon-circle task-priority-" + a);
        this.$(".priority-text").text(m.getPriorityDisplay(a));
        return this
      };
      f.prototype.quickSubmit = function (a) {
        t.children(".hint.on").remove();
        13 === a.keyCode && (a.ctrlKey || x.quickCreateTask()) && this.submit();
        return this
      };
      f.prototype.checkQuickCreateMode = function () {
        var a;
        a = !!x.quickCreateTask();
        this.$quickCreate.prop("checked", a);
        this.$(".submit-handler")[a ? "addClass" : "removeClass"]("hidden");
        this.$input.focus();
        return this
      };
      f.prototype.enterQuickCreateMode = function () {
        x.quickCreateTask(this.$quickCreate.prop("checked"));
        this.checkQuickCreateMode();
        return this
      };
      f.prototype.cacheTask = function () {
        var a;
        a = this.taskModel.toJSON();
        a.content = this.$input.val().trim();
        this.localCache(this.localCacheId, a.content ? a : null);
        return this
      };
      f.prototype.submit = function (a) {
        var b = this;
        null != a && a.preventDefault();
        if (!this.$submit.prop("disabled"))return(a = this.$input.val().trim()) ? (this.disableSubmit(!0), this.updateModel({content: a}), this.tasksCollection.create(this.taskModel, {wait: !0, beforeSend: function () {
          return b.toggleSubmiting(1)
        }, error: function (a) {
          b.toggleSubmiting();
          return b.disableSubmit(!1)
        },
          success: function (a) {
            b.toggleSubmiting();
            b.reset();
            b.localCache.remove(b.localCacheId);
            b.disableSubmit(!1);
            return b.deactivate()
          }})) : this.focus(), !1
      };
      f.prototype.disableSubmit = function (a) {
        this.$submit.prop("disabled", a);
        this.$submit[a ? "addClass" : "removeClass"]("disabled");
        return this
      };
      f.prototype.toggleSubmiting = function (a) {
        this.$input.val("").attr("placeholder", a ? "..." : "");
        this.$input.prop("disabled", !!a);
        return this
      };
      f.prototype.activate = function () {
        var a, b = this;
        this.$el.hasClass("active") ||
        (B.isNewUser && this.renderTaskCreatorHint(B.isNewUser = !1), this.$el.addClass("active").closest(".board-view").addClass("composing"), this.$input.attr("placeholder", ""), this.initInvolve(), a = function (e) {
          if (b.$el)return e = $(event.target), b.$input.val().trim() || e.closest(b.$el).length || e.closest(p.join(",")).length ? v.one("click.taskCreator", a) : b.deactivate()
        }, v.one("click.taskCreator", a));
        return this
      };
      f.prototype.deactivate = function () {
        v.off("click.taskCreator");
        this.$el.removeClass("active").closest(".board-view").removeClass("composing");
        this.$input.val().trim() || this.$input.val("").attr({placeholder: ""}).blur();
        return this
      };
      f.prototype.renderTaskCreatorHint = function (a) {
        this.$(".task-creator-hint")[a ? "addClass" : "removeClass"]("active");
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/board/tasklist/tasklist-tab/templates/basic", [], function () {
  return function (d) {
    var a = '<h4 class="tasklist-title"> <strong>' + d.title + '</strong><span class="muted">  ' + d.doneCount + "/" + d.totalCount + '</span></h4><p class="tasklist-description muted">' + d.description + "</p>";
    0 < d.totalCount && (a += ' <div class="tasklist-strip"> <div class="strip-part done-part hinted" style="width:' + d.doneCount / d.totalCount * 100 + '%;" data-title=" ' + d.doneCount + '"> <div class="strip-part-bar"></div> </div> <div class="strip-part undone-part hinted" style="width:' +
      (d.undoneCount - d.recentCount - d.expiredCount) / d.totalCount * 100 + '%;" data-title=" ' + (d.undoneCount - d.recentCount - d.expiredCount) + '"> <div class="strip-part-bar"></div> </div> <div class="strip-part recent-part hinted" style="width:' + d.recentCount / d.totalCount * 100 + '%;" data-title=" ' + d.recentCount + '"> <div class="strip-part-bar"></div> </div> <div class="strip-part expire-part hinted" style="width:' + d.expiredCount / d.totalCount * 100 + '%;" data-title=" ' + d.expiredCount + '"> <div class="strip-part-bar"></div> </div> </div>');
    if (0 < d.executors.length) {
      a += ' <div class="tasklist-executors clearfix"> ';
      if (d = d.executors)for (var f, b = -1, e = d.length - 1; b < e;)f = d[b += 1], a += ' <div class="tasklist-executor pull-left hinted" data-title="' + f.doneCount + "/" + f.total + '"> <div class="img-circle img-24 pull-left" style="background-image: url(' + f.avatarUrl + ')"></div> </div> ';
      a += " </div>"
    }
    return a
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/tasklist/tasklist-tab/index", ["view", "warehouse", "collections/members", "./templates/basic"], function (d, b, e, g) {
    var k;
    return function (d) {
      function f() {
        return k = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "tasklistTab";
      f.prototype.tagName = "li";
      f.prototype.className =
        "tasklist-tab";
      f.prototype.initialize = function (a) {
        if (null == a || !a.tasklistModel)return!1;
        this.options = a;
        this._projectId = a.tasklistModel.get("_projectId");
        this.tasklistModel = a.tasklistModel;
        this.membersCollection = b.get(e, this._projectId);
        this.renderBasic().listen();
        return this
      };
      f.prototype.listen = function () {
        this.listenTo(this.tasklistModel, "change:title\nchange:description\nchange:totalCount\nchange:undoneCount\nchange:recentCount\nchange:expiredCount\nchange:doneCount\nchange:statistic", this.renderBasic);
        this.listenTo(this.tasklistModel, "destroy remove", this.remove);
        return this
      };
      f.prototype.renderBasic = function () {
        var a, b, e, d, f, h, k;
        a = this.tasklistModel.toJSON();
        a.executors = [];
        if (a.statistic) {
          h = a.statistic;
          d = 0;
          for (f = h.length; d < f; d++)b = h[d], e = null != (k = this.membersCollection.get(b._executorId)) ? k.toJSON() : void 0, b = _.extend(b, e), a.executors.push(b);
          a.executors = _.sortBy(a.executors, function (a) {
            return-a.doneCount
          })
        }
        this.$el.attr("data-id", this.tasklistModel.id);
        this.$el.html(g(a));
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/board/tasklist/tasklist-creator/templates/basic", [], function () {
  return function (d) {
    var a = '<ul class="nav nav-tabs"> <li class="active"> <a class="tab-handler" data-id="#tasklist-create-new"></a> </li> <li> <a class="tab-handler" data-id="#tasklist-create-temps"></a> </li></ul><form class="tasklist-create-form"> <div class="tab-content"> <div class="tab-pane active" id="tasklist-create-new"> <div class="tasklist-create-new"> <input class="form-control" type="text" data-gta="event" data-label="enter tasklist title" placeholder=""/> <textarea class="form-control" data-gta="event" data-label="enter tasklist description" placeholder=""></textarea> </div> </div> <div class="tab-pane" id="tasklist-create-temps"> <ul class="tasklist-create-temps list"> ',
      f = d.temps;
    if (f)for (var b, e = -1, g = f.length - 1; e < g;) {
      b = f[e += 1];
      a += ' <li class="';
      e == d.tempIndex && (a += "active");
      a += '"> <a class="temp-handler" data-index="' + e + '"> <div class="temp-icon ' + b["class"] + ' pull-left" style="';
      b.iconUrl && (a += " background-image:url(" + b.iconUrl + ");");
      a += '"></div> <span class="icon icon-tick temp-selected pull-right"></span> <div class="temp-info"> <strong class="temp-title">' + b.title + '</strong> <div class="temp-stages"> <span class="stage-name">' + b.stages[0] + "</span> ";
      if (b = b.stages.slice(1))for (var k,
                                       h = -1, l = b.length - 1; h < l;)k = b[h += 1], a += ' <span class="stage-name">&gt; ' + k + "</span> ";
      a += " </div> </div> </a> </li> "
    }
    return a + ' </ul> </div> </div> <div class="submit-button-wrapper"> <button class="submit-button btn btn-primary" type="submit"></button> </div></form>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/tasklist/tasklist-creator/index", ["view", "warehouse", "collections/tasklists", "./templates/basic"], function (d, b, e, g) {
    var k, h;
    k = [
      {title: "", "class": "tasklist_design", iconUrl: "", stages: ["", "", "", "", ""]},
      {title: "", "class": "tasklist_develope", iconUrl: "", stages: ["", "",
        "", "", ""]},
      {title: "", "class": "tasklist_support", iconUrl: "", stages: ["", "", "", "&"]}
    ];
    return function (d) {
      function f() {
        return h = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "TasklistCreatorView";
      f.prototype.className = "tasklist-creator";
      f.prototype.options = {title: ""};
      f.prototype.events = {"submit .tasklist-create-form": "submitCreateForm", "click .tab-handler": "switchTabs", "click .temp-handler": "getCreateTemp"};
      f.prototype.initialize = function (a) {
        if (null ==
          a || !a._projectId)return!1;
        this.options = a;
        this.renderBasic();
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(g({temps: k, tempIndex: this.tempIndex || 0}));
        this.$("input").focus();
        return this
      };
      f.prototype.switchTabs = function (a) {
        a = $(a.currentTarget);
        a.parent().hasClass("active") || (this.$(".tab-pane.active, .nav >li.active").removeClass("active"), a.parent().addClass("active"), this.$("" + a.data("id")).addClass("active"));
        return this
      };
      f.prototype.getCreateTemp = function (a) {
        a = $(a.currentTarget);
        a.parent().hasClass("active") || (this.$(".tasklist-create-temps > li.active").removeClass("active"), a.parent().addClass("active"), this.tempIndex = a.data("index"));
        return this
      };
      f.prototype.submitCreateForm = function (a) {
        var d, f, g, h = this;
        a.preventDefault();
        a = $(a.currentTarget);
        "tasklist-create-new" === this.$(".tab-pane.active").attr("id") ? (g = a.find("input").val(), d = a.find("textarea").val()) : (a = k[this.tempIndex || 0], d = g = a.title, f = a.stages);
        (g = g.trim()) ? b.request(e, this.options._projectId, {success: function (a) {
          return a.create({title: g,
            description: d || "", _projectId: h.options._projectId, stages: f || []}, {wait: !0, success: function (a) {
            var b;
            return"function" === typeof(b = h.options).success ? b.success(a) : void 0
          }})
        }}) : $form.find("input").focus();
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/board/tasklist/tasklist-bar/templates/basic", [], function () {
  return function (d) {
    return'<section class="tasklist-bar-content thin-scroll"> <div class="tasklist-creator-toggler" data-gta="event" data-label="create tasklist"> <strong></strong> <span class="icon icon-plus pull-right"></span> </div> <div class="tasklist-creator-wrap"></div> <ul class="tasklist-bar-tasklists"> <li class="smart-group"> <p class="tasklist-smart-title"></p> </li> <li class="smart-group"> <a class="tasklist-smart-today" data-gta="event" data-label="smart group today"></a> </li> <li class="smart-group"> <a class="tasklist-smart-member" data-gta="event" data-label="smart group member"> <span class="caret"></span> </a> </li> </ul></section><footer class="tasklist-bar-footer"> <table class="task-status-hints table"> <tr> <td class="task-status task-status-done"> <span class="task-status-point"></span> <span class="task-status-label muted"></span> </td> <td class="task-status task-status-normal"> <span class="task-status-point"></span> <span class="task-status-label muted"></span> </td> <td class="task-status task-status-upcoming"> <span class="task-status-point"></span> <span class="task-status-label muted"></span> </td> <td class="task-status task-status-overdue"> <span class="task-status-point"></span> <span class="task-status-label muted"></span> </td> </tr> </table></footer>'
  }
});
define("jqueryui/sortable-tb-flavored", ["jquery", "./core", "./mouse", "./widget"], function (d) {
  (function (a, d) {
    function b(a, b, d) {
      return a > b && a < b + d
    }

    a.widget("ui.sortable", a.ui.mouse, {version: "1.10.0", widgetEventPrefix: "sort", ready: !1, options: {appendTo: "parent", axis: !1, connectWith: !1, containment: !1, cursor: "auto", cursorAt: !1, dropOnEmpty: !0, forcePlaceholderSize: !1, forceHelperSize: !1, grid: !1, handle: !1, helper: "original", items: "> *", opacity: !1, placeholder: !1, revert: !1, scroll: !0, scrollSensitivity: 20, scrollSpeed: 20,
      scope: "default", tolerance: "intersect", zIndex: 1E3, activate: null, beforeStop: null, change: null, deactivate: null, out: null, over: null, receive: null, remove: null, sort: null, start: null, stop: null, update: null}, _create: function () {
      var a = this.options;
      this.containerCache = {};
      this.element.addClass("ui-sortable");
      this.refresh();
      this.floating = this.items.length ? "x" === a.axis || /left|right/.test(this.items[0].item.css("float")) || /inline|table-cell/.test(this.items[0].item.css("display")) : !1;
      this.offset = this.element.offset();
      this._mouseInit();
      this.ready = !0
    }, _destroy: function () {
      this.element.removeClass("ui-sortable ui-sortable-disabled");
      this._mouseDestroy();
      for (var a = this.items.length - 1; 0 <= a; a--)this.items[a].item.removeData(this.widgetName + "-item");
      return this
    }, _setOption: function (b, d) {
      "disabled" === b ? (this.options[b] = d, this.widget().toggleClass("ui-sortable-disabled", !!d)) : a.Widget.prototype._setOption.apply(this, arguments)
    }, _mouseCapture: function (b, d) {
      var f = null, h = !1, l = this;
      if (this.reverting || this.options.disabled ||
        "static" === this.options.type)return!1;
      this._refreshItems(b);
      a(b.target).parents().each(function () {
        if (a.data(this, l.widgetName + "-item") === l)return f = a(this), !1
      });
      a.data(b.target, l.widgetName + "-item") === l && (f = a(b.target));
      if (!f || this.options.handle && !d && (a(this.options.handle, f).find("*").addBack().each(function () {
        this === b.target && (h = !0)
      }), !h))return!1;
      this.currentItem = f;
      this._removeCurrentsFromItems();
      return!0
    }, _mouseStart: function (b, d, f) {
      d = this.options;
      this.currentContainer = this;
      this.refreshPositions();
      this.dbHelper = this._createHelper(b);
      this._cacheHelperProportions();
      this._cacheMargins();
      this.scrollParent = this.dbHelper.scrollParent();
      this.offset = this.currentItem.offset();
      this.offset = {top: this.offset.top - this.margins.top, left: this.offset.left - this.margins.left};
      a.extend(this.offset, {click: {left: b.pageX - this.offset.left, top: b.pageY - this.offset.top}, parent: this._getParentOffset(), relative: this._getRelativeOffset()});
      this.dbHelper.css("position", "absolute");
      this.cssPosition = this.dbHelper.css("position");
      this.originalPosition =
        this._generatePosition(b);
      this.originalPageX = b.pageX;
      this.originalPageY = b.pageY;
      d.cursorAt && this._adjustOffsetFromHelper(d.cursorAt);
      this.domPosition = {prev: this.currentItem.prev()[0], parent: this.currentItem.parent()[0]};
      this.dbHelper[0] !== this.currentItem[0] && this.currentItem.hide();
      this._createPlaceholder();
      d.containment && this._setContainment();
      d.cursor && (a("body").css("cursor") && (this._storedCursor = a("body").css("cursor")), a("body").css("cursor", d.cursor));
      d.opacity && (this.dbHelper.css("opacity") &&
        (this._storedOpacity = this.dbHelper.css("opacity")), this.dbHelper.css("opacity", d.opacity));
      d.zIndex && (this.dbHelper.css("zIndex") && (this._storedZIndex = this.dbHelper.css("zIndex")), this.dbHelper.css("zIndex", d.zIndex));
      if (this.scrollParent[0] !== document && "HTML" !== this.scrollParent[0].tagName) {
        this.overflowOffset = this.scrollParent.offset();
        var h = this;
        setTimeout(function () {
          h.SCROLLWIDTH = h.scrollParent[0].scrollWidth;
          h.SCROLLHEIGHT = h.scrollParent[0].scrollHeight;
          h.OFFSETWIDTH = h.scrollParent[0].offsetWidth;
          h.OFFSETHEIGHT =
            h.scrollParent[0].offsetHeight
        }, 0)
      }
      this._trigger("start", b, this._uiHash());
      this._preserveHelperProportions || this._cacheHelperProportions();
      if (!f)for (f = this.containers.length - 1; 0 <= f; f--)this.containers[f]._trigger("activate", b, this._uiHash(this));
      a.ui.ddmanager && (a.ui.ddmanager.current = this);
      a.ui.ddmanager && !d.dropBehaviour && a.ui.ddmanager.prepareOffsets(this, b);
      this.dragging = !0;
      this.dbHelper.addClass("ui-sortable-helper");
      this._mouseDrag(b);
      return!0
    }, _mouseDrag: function (b) {
      var d, f, h, l;
      d = this.options;
      f = !1;
      this.position = this._generatePosition(b);
      this.positionAbs = this._convertPositionTo("absolute");
      this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs);
      this.options.scroll && (this.scrollParent[0] !== document && "HTML" !== this.scrollParent[0].tagName ? (hasXSpace = this.scrollParent[0].scrollLeft < this.SCROLLWIDTH - this.OFFSETWIDTH, hasYSpace = this.scrollParent[0].scrollTop < this.SCROLLHEIGHT - this.OFFSETHEIGHT, this.options.disableScrollY || (this.overflowOffset.top + this.scrollParent[0].offsetHeight - b.pageY <
        d.scrollSensitivity && hasYSpace ? this.scrollParent[0].scrollTop = f = this.scrollParent[0].scrollTop + d.scrollSpeed : b.pageY - this.overflowOffset.top < d.scrollSensitivity && (this.scrollParent[0].scrollTop = f = this.scrollParent[0].scrollTop - d.scrollSpeed)), this.options.disableScrollX || (this.overflowOffset.left + this.scrollParent[0].offsetWidth - b.pageX < d.scrollSensitivity && hasXSpace ? this.scrollParent[0].scrollLeft = f = this.scrollParent[0].scrollLeft + d.scrollSpeed : b.pageX - this.overflowOffset.left < d.scrollSensitivity &&
        (this.scrollParent[0].scrollLeft = f = this.scrollParent[0].scrollLeft - d.scrollSpeed))) : (this.options.disableScrollY || (b.pageY - a(document).scrollTop() < d.scrollSensitivity ? f = a(document).scrollTop(a(document).scrollTop() - d.scrollSpeed) : a(window).height() - (b.pageY - a(document).scrollTop()) < d.scrollSensitivity && (f = a(document).scrollTop(a(document).scrollTop() + d.scrollSpeed))), this.options.disableScrollX || (b.pageX - a(document).scrollLeft() < d.scrollSensitivity ? f = a(document).scrollLeft(a(document).scrollLeft() -
        d.scrollSpeed) : a(window).width() - (b.pageX - a(document).scrollLeft()) < d.scrollSensitivity && (f = a(document).scrollLeft(a(document).scrollLeft() + d.scrollSpeed)))), !1 !== f && a.ui.ddmanager && !d.dropBehaviour && a.ui.ddmanager.prepareOffsets(this, b));
      this.positionAbs = this._convertPositionTo("absolute");
      this.options.axis && "y" === this.options.axis || (this.dbHelper[0].style.left = this.position.left + "px");
      this.options.axis && "x" === this.options.axis || (this.dbHelper[0].style.top = this.position.top + "px");
      for (d = this.items.length -
        1; 0 <= d; d--)if (f = this.items[d], h = f.item[0], (l = this._intersectsWithPointer(f)) && f.instance === this.currentContainer && h !== this.currentItem[0] && this.placeholder[1 === l ? "next" : "prev"]()[0] !== h && !a.contains(this.placeholder[0], h) && ("semi-dynamic" === this.options.type ? !a.contains(this.element[0], h) : 1)) {
        this.direction = 1 === l ? "down" : "up";
        if ("pointer" === this.options.tolerance || this._intersectsWithSides(f))this._rearrange(b, f); else break;
        this._trigger("change", b, this._uiHash());
        break
      }
      this._contactContainers(b);
      a.ui.ddmanager && a.ui.ddmanager.drag(this, b);
      this._trigger("sort", b, this._uiHash());
      this.lastPositionAbs = this.positionAbs;
      return!1
    }, _mouseStop: function (b, d) {
      if (b) {
        a.ui.ddmanager && !this.options.dropBehaviour && a.ui.ddmanager.drop(this, b);
        if (this.options.revert) {
          var f = this, h = this.placeholder.offset();
          this.reverting = !0;
          a(this.dbHelper).animate({left: h.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollLeft), top: h.top - this.offset.parent.top - this.margins.top +
            (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollTop)}, parseInt(this.options.revert, 10) || 500, function () {
            f._clear(b)
          })
        } else this._clear(b, d);
        return!1
      }
    }, cancel: function () {
      if (this.dragging) {
        this._mouseUp({target: null});
        "original" === this.options.helper ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
        for (var b = this.containers.length - 1; 0 <= b; b--)this.containers[b]._trigger("deactivate", null, this._uiHash(this)), this.containers[b].containerCache.over &&
          (this.containers[b]._trigger("out", null, this._uiHash(this)), this.containers[b].containerCache.over = 0)
      }
      this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), "original" !== this.options.helper && this.dbHelper && this.dbHelper[0].parentNode && this.dbHelper.remove(), a.extend(this, {helper: null, dragging: !1, reverting: !1, _noFinalSort: null}), this.domPosition.prev ? a(this.domPosition.prev).after(this.currentItem) : a(this.domPosition.parent).prepend(this.currentItem));
      return this
    }, serialize: function (b) {
      var d = this._getItemsAsjQuery(b && b.connected), f = [];
      b = b || {};
      a(d).each(function () {
        var d = (a(b.item || this).attr(b.attribute || "id") || "").match(b.expression || /(.+)[\-=_](.+)/);
        d && f.push((b.key || d[1] + "[]") + "=" + (b.key && b.expression ? d[1] : d[2]))
      });
      !f.length && b.key && f.push(b.key + "=");
      return f.join("&")
    }, toArray: function (b) {
      var d = this._getItemsAsjQuery(b && b.connected), f = [];
      b = b || {};
      d.each(function () {
        f.push(a(b.item || this).attr(b.attribute || "id") || "")
      });
      return f
    }, _intersectsWith: function (a) {
      var b =
        this.positionAbs.left, d = b + this.helperProportions.width, f = this.positionAbs.top, l = f + this.helperProportions.height, n = a.left, m = n + a.width, s = a.top, r = s + a.height, t = this.offset.click.top, v = this.offset.click.left;
      return"pointer" === this.options.tolerance || this.options.forcePointerForContainers || "pointer" !== this.options.tolerance && this.helperProportions[this.floating ? "width" : "height"] > a[this.floating ? "width" : "height"] ? f + t > s && f + t < r && b + v > n && b + v < m : n < b + this.helperProportions.width / 2 && d - this.helperProportions.width /
        2 < m && s < f + this.helperProportions.height / 2 && l - this.helperProportions.height / 2 < r
    }, _intersectsWithPointer: function (a) {
      var d = "x" === this.options.axis || b(this.positionAbs.top + this.offset.click.top, a.top, a.height);
      a = "y" === this.options.axis || b(this.positionAbs.left + this.offset.click.left, a.left, a.width);
      d = d && a;
      a = this._getDragVerticalDirection();
      var f = this._getDragHorizontalDirection();
      return d ? this.floating ? f && "right" === f || "down" === a ? 2 : 1 : a && ("down" === a ? 2 : 1) : !1
    }, _intersectsWithSides: function (a) {
      var d = b(this.positionAbs.top +
        this.offset.click.top, a.top + a.height / 2, a.height);
      a = b(this.positionAbs.left + this.offset.click.left, a.left + a.width / 2, a.width);
      var f = this._getDragVerticalDirection(), h = this._getDragHorizontalDirection();
      return this.floating && h ? "right" === h && a || "left" === h && !a : f && ("down" === f && d || "up" === f && !d)
    }, _getDragVerticalDirection: function () {
      var a = this.positionAbs.top - this.lastPositionAbs.top;
      return 0 !== a && (0 < a ? "down" : "up")
    }, _getDragHorizontalDirection: function () {
      var a = this.positionAbs.left - this.lastPositionAbs.left;
      return 0 !== a && (0 < a ? "right" : "left")
    }, refresh: function (a) {
      this._refreshItems(a);
      this.refreshPositions();
      return this
    }, _connectWith: function () {
      var a = this.options;
      return a.connectWith.constructor === String ? [a.connectWith] : a.connectWith
    }, _getItemsAsjQuery: function (b) {
      var d, f, h, l = [], n = [], m = this._connectWith();
      if (m && b)for (b = m.length - 1; 0 <= b; b--)for (f = a(m[b]), d = f.length - 1; 0 <= d; d--)(h = a.data(f[d], this.widgetFullName)) && h !== this && !h.options.disabled && n.push([a.isFunction(h.options.items) ? h.options.items.call(h.element) :
        a(h.options.items, h.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), h]);
      n.push([a.isFunction(this.options.items) ? this.options.items.call(this.element, null, {options: this.options, item: this.currentItem}) : a(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);
      for (b = n.length - 1; 0 <= b; b--)n[b][0].each(function () {
        l.push(this)
      });
      return a(l)
    }, _removeCurrentsFromItems: function () {
      var b = this.currentItem.find(":data(" + this.widgetName + "-item)");
      this.items =
        a.grep(this.items, function (a) {
          for (var d = 0; d < b.length; d++)if (b[d] === a.item[0])return!1;
          return!0
        })
    }, _refreshItems: function (b) {
      this.items = [];
      this.containers = [this];
      var d, f, h, l, n, m = this.items, s = [
        [a.isFunction(this.options.items) ? this.options.items.call(this.element[0], b, {item: this.currentItem}) : a(this.options.items, this.element), this]
      ];
      if ((n = this._connectWith()) && this.ready)for (d = n.length - 1; 0 <= d; d--)for (h = a(n[d]), f = h.length - 1; 0 <= f; f--)(l = a.data(h[f], this.widgetFullName)) && l !== this && !l.options.disabled &&
      (s.push([a.isFunction(l.options.items) ? l.options.items.call(l.element[0], b, {item: this.currentItem}) : a(l.options.items, l.element), l]), this.containers.push(l));
      for (d = s.length - 1; 0 <= d; d--)for (b = s[d][1], h = s[d][0], f = 0, n = h.length; f < n; f++)l = a(h[f]), l.data(this.widgetName + "-item", b), m.push({item: l, instance: b, width: 0, height: 0, left: 0, top: 0})
    }, refreshPositions: function (b) {
      this.offsetParent && this.dbHelper && (this.offset.parent = this._getParentOffset());
      var d, f, h;
      for (d = this.items.length - 1; 0 <= d; d--)f = this.items[d],
        f.instance !== this.currentContainer && this.currentContainer && f.item[0] !== this.currentItem[0] || (h = this.options.toleranceElement ? a(this.options.toleranceElement, f.item) : f.item, b || (f.width = h.outerWidth(), f.height = h.outerHeight()), h = h.offset(), f.left = h.left, f.top = h.top);
      if (this.options.custom && this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this); else for (d = this.containers.length - 1; 0 <= d; d--)h = this.containers[d].element.offset(), this.containers[d].containerCache.left = h.left,
        this.containers[d].containerCache.top = h.top, this.containers[d].containerCache.width = this.containers[d].element.outerWidth(), this.containers[d].containerCache.height = this.containers[d].element.outerHeight();
      return this
    }, _createPlaceholder: function (b) {
      b = b || this;
      var d, f = b.options;
      f.placeholder && f.placeholder.constructor !== String || (d = f.placeholder, f.placeholder = {element: function () {
        var f = a(document.createElement(b.currentItem[0].nodeName)).addClass(d || b.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
        d || (f.style.visibility = "hidden");
        return f
      }, update: function (a, l) {
        if (!d || f.forcePlaceholderSize)l.height() || l.height(b.currentItem.innerHeight() - parseInt(b.currentItem.css("paddingTop") || 0, 10) - parseInt(b.currentItem.css("paddingBottom") || 0, 10)), l.width() || l.width(b.currentItem.innerWidth() - parseInt(b.currentItem.css("paddingLeft") || 0, 10) - parseInt(b.currentItem.css("paddingRight") || 0, 10))
      }});
      b.placeholder = a(f.placeholder.element.call(b.element, b.currentItem));
      b.currentItem.after(b.placeholder);
      f.placeholder.update(b,
        b.placeholder)
    }, _contactContainers: function (b) {
      var d, f, h, l, n, m, s, r, t = f = null;
      for (d = this.containers.length - 1; 0 <= d; d--)a.contains(this.currentItem[0], this.containers[d].element[0]) || (this._intersectsWith(this.containers[d].containerCache) ? f && a.contains(this.containers[d].element[0], f.element[0]) || (f = this.containers[d], t = d) : this.containers[d].containerCache.over && (this.containers[d]._trigger("out", b, this._uiHash(this)), this.containers[d].containerCache.over = 0));
      if (f)if (1 === this.containers.length)this.containers[t]._trigger("over",
        b, this._uiHash(this)), this.containers[t].containerCache.over = 1; else {
        f = 1E4;
        h = null;
        l = this.containers[t].floating ? "left" : "top";
        n = this.containers[t].floating ? "width" : "height";
        m = this.positionAbs[l] + this.offset.click[l];
        for (d = this.items.length - 1; 0 <= d; d--)a.contains(this.containers[t].element[0], this.items[d].item[0]) && this.items[d].item[0] !== this.currentItem[0] && (s = this.items[d].item.offset()[l], r = !1, Math.abs(s - m) > Math.abs(s + this.items[d][n] - m) && (r = !0, s += this.items[d][n]), Math.abs(s - m) < f && (f = Math.abs(s -
          m), h = this.items[d], this.direction = r ? "up" : "down"));
        if (h || this.options.dropOnEmpty)this.currentContainer = this.containers[t], h ? this._rearrange(b, h, null, !0) : this._rearrange(b, null, this.containers[t].element, !0), this._trigger("change", b, this._uiHash()), this.containers[t]._trigger("change", b, this._uiHash(this)), this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[t]._trigger("over", b, this._uiHash(this)), this.containers[t].containerCache.over = 1
      }
    }, _createHelper: function (b) {
      var d =
        this.options;
      b = a.isFunction(d.helper) ? a(d.helper.apply(this.element[0], [b, this.currentItem])) : "clone" === d.helper ? this.currentItem.clone() : this.currentItem;
      b.parents("body").length || a("parent" !== d.appendTo ? d.appendTo : this.currentItem[0].parentNode)[0].appendChild(b[0]);
      b[0] === this.currentItem[0] && (this._storedCSS = {width: this.currentItem[0].style.width, height: this.currentItem[0].style.height, position: this.currentItem.css("position"), top: this.currentItem.css("top"), left: this.currentItem.css("left")});
      b[0].style.width && !d.forceHelperSize || b.width(this.currentItem.width());
      b[0].style.height && !d.forceHelperSize || b.height(this.currentItem.height());
      return b
    }, _adjustOffsetFromHelper: function (b) {
      "string" === typeof b && (b = b.split(" "));
      a.isArray(b) && (b = {left: +b[0], top: +b[1] || 0});
      "left"in b && (this.offset.click.left = b.left + this.margins.left);
      "right"in b && (this.offset.click.left = this.helperProportions.width - b.right + this.margins.left);
      "top"in b && (this.offset.click.top = b.top + this.margins.top);
      "bottom"in b &&
      (this.offset.click.top = this.helperProportions.height - b.bottom + this.margins.top)
    }, _getParentOffset: function () {
      this.offsetParent = this.dbHelper.offsetParent();
      var b = this.offsetParent.offset();
      "absolute" === this.cssPosition && this.scrollParent[0] !== document && a.contains(this.scrollParent[0], this.offsetParent[0]) && (b.left += this.scrollParent.scrollLeft(), b.top += this.scrollParent.scrollTop());
      if (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && "html" === this.offsetParent[0].tagName.toLowerCase() &&
        a.ui.ie)b = {top: 0, left: 0};
      return{top: b.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left: b.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
    }, _getRelativeOffset: function () {
      if ("relative" === this.cssPosition) {
        var a = this.currentItem.position();
        return{top: a.top - (parseInt(this.dbHelper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left: a.left - (parseInt(this.dbHelper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
      }
      return{top: 0, left: 0}
    }, _cacheMargins: function () {
      this.margins =
      {left: parseInt(this.currentItem.css("marginLeft"), 10) || 0, top: parseInt(this.currentItem.css("marginTop"), 10) || 0}
    }, _cacheHelperProportions: function () {
      this.helperProportions = {width: this.dbHelper.outerWidth(), height: this.dbHelper.outerHeight()}
    }, _setContainment: function () {
      var b, d, f;
      d = this.options;
      "parent" === d.containment && (d.containment = this.dbHelper[0].parentNode);
      if ("document" === d.containment || "window" === d.containment)this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top -
        this.offset.parent.top, a("document" === d.containment ? document : window).width() - this.helperProportions.width - this.margins.left, (a("document" === d.containment ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top];
      /^(document|window|parent)$/.test(d.containment) || (b = a(d.containment)[0], d = a(d.containment).offset(), f = "hidden" !== a(b).css("overflow"), this.containment = [d.left + (parseInt(a(b).css("borderLeftWidth"), 10) || 0) + (parseInt(a(b).css("paddingLeft"),
        10) || 0) - this.margins.left, d.top + (parseInt(a(b).css("borderTopWidth"), 10) || 0) + (parseInt(a(b).css("paddingTop"), 10) || 0) - this.margins.top, d.left + (f ? Math.max(b.scrollWidth, b.offsetWidth) : b.offsetWidth) - (parseInt(a(b).css("borderLeftWidth"), 10) || 0) - (parseInt(a(b).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, d.top + (f ? Math.max(b.scrollHeight, b.offsetHeight) : b.offsetHeight) - (parseInt(a(b).css("borderTopWidth"), 10) || 0) - (parseInt(a(b).css("paddingBottom"), 10) || 0) - this.helperProportions.height -
        this.margins.top])
    }, _convertPositionTo: function (b, d) {
      d || (d = this.position);
      var f = "absolute" === b ? 1 : -1, h = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && a.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, l = /(html|body)/i.test(h[0].tagName);
      return{top: d.top + this.offset.relative.top * f + this.offset.parent.top * f - ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : l ? 0 : h.scrollTop()) * f, left: d.left + this.offset.relative.left * f + this.offset.parent.left *
        f - ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : l ? 0 : h.scrollLeft()) * f}
    }, _generatePosition: function (b) {
      var d, f, h = this.options;
      f = b.pageX;
      d = b.pageY;
      var l = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && a.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, n = /(html|body)/i.test(l[0].tagName);
      "relative" !== this.cssPosition || this.scrollParent[0] !== document && this.scrollParent[0] !== this.offsetParent[0] || (this.offset.relative = this._getRelativeOffset());
      this.originalPosition && (this.containment && (b.pageX - this.offset.click.left < this.containment[0] && (f = this.containment[0] + this.offset.click.left), b.pageY - this.offset.click.top < this.containment[1] && (d = this.containment[1] + this.offset.click.top), b.pageX - this.offset.click.left > this.containment[2] && (f = this.containment[2] + this.offset.click.left), b.pageY - this.offset.click.top > this.containment[3] && (d = this.containment[3] + this.offset.click.top)), h.grid && (d = this.originalPageY + Math.round((d - this.originalPageY) / h.grid[1]) *
        h.grid[1], d = this.containment ? d - this.offset.click.top >= this.containment[1] && d - this.offset.click.top <= this.containment[3] ? d : d - this.offset.click.top >= this.containment[1] ? d - h.grid[1] : d + h.grid[1] : d, f = this.originalPageX + Math.round((f - this.originalPageX) / h.grid[0]) * h.grid[0], f = this.containment ? f - this.offset.click.left >= this.containment[0] && f - this.offset.click.left <= this.containment[2] ? f : f - this.offset.click.left >= this.containment[0] ? f - h.grid[0] : f + h.grid[0] : f));
      return{top: d - this.offset.click.top - this.offset.relative.top -
        this.offset.parent.top + ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : n ? 0 : l.scrollTop()), left: f - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : n ? 0 : l.scrollLeft())}
    }, _rearrange: function (a, b, d, f) {
      d ? d[0].appendChild(this.placeholder[0]) : b.item[0].parentNode.insertBefore(this.placeholder[0], "down" === this.direction ? b.item[0] : b.item[0].nextSibling);
      var l = this.counter = this.counter ? ++this.counter : 1;
      this._delay(function () {
        l ===
          this.counter && this.refreshPositions(!f)
      })
    }, _clear: function (b, d) {
      this.reverting = !1;
      var f, h = [];
      !this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem);
      this._noFinalSort = null;
      if (this.dbHelper[0] === this.currentItem[0]) {
        for (f in this._storedCSS)if ("auto" === this._storedCSS[f] || "static" === this._storedCSS[f])this._storedCSS[f] = "";
        this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
      } else this.currentItem.show();
      this.fromOutside && !d && h.push(function (a) {
        this._trigger("receive",
          a, this._uiHash(this.fromOutside))
      });
      !this.fromOutside && this.domPosition.prev === this.currentItem.prev().not(".ui-sortable-helper")[0] && this.domPosition.parent === this.currentItem.parent()[0] || d || h.push(function (a) {
        this._trigger("update", a, this._uiHash())
      });
      this === this.currentContainer || d || (h.push(function (a) {
        this._trigger("remove", a, this._uiHash())
      }), h.push(function (a) {
        return function (b) {
          a._trigger("receive", b, this._uiHash(this))
        }
      }.call(this, this.currentContainer)), h.push(function (a) {
        return function (b) {
          a._trigger("update",
            b, this._uiHash(this))
        }
      }.call(this, this.currentContainer)));
      for (f = this.containers.length - 1; 0 <= f; f--)d || h.push(function (a) {
        return function (b) {
          a._trigger("deactivate", b, this._uiHash(this))
        }
      }.call(this, this.containers[f])), this.containers[f].containerCache.over && (h.push(function (a) {
        return function (b) {
          a._trigger("out", b, this._uiHash(this))
        }
      }.call(this, this.containers[f])), this.containers[f].containerCache.over = 0);
      this._storedCursor && a("body").css("cursor", this._storedCursor);
      this._storedOpacity && this.dbHelper.css("opacity",
        this._storedOpacity);
      this._storedZIndex && this.dbHelper.css("zIndex", "auto" === this._storedZIndex ? "" : this._storedZIndex);
      this.dragging = !1;
      if (this.cancelHelperRemoval) {
        if (!d) {
          this._trigger("beforeStop", b, this._uiHash());
          for (f = 0; f < h.length; f++)h[f].call(this, b);
          this._trigger("stop", b, this._uiHash())
        }
        return this.fromOutside = !1
      }
      d || this._trigger("beforeStop", b, this._uiHash());
      this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
      this.dbHelper[0] !== this.currentItem[0] && this.dbHelper.remove();
      this.dbHelper =
        null;
      if (!d) {
        for (f = 0; f < h.length; f++)h[f].call(this, b);
        this._trigger("stop", b, this._uiHash())
      }
      this.fromOutside = !1;
      return!0
    }, _trigger: function () {
      !1 === a.Widget.prototype._trigger.apply(this, arguments) && this.cancel()
    }, _uiHash: function (b) {
      var d = b || this;
      return{helper: d.helper, placeholder: d.placeholder || a([]), position: d.position, originalPosition: d.originalPosition, offset: d.positionAbs, item: d.currentItem, sender: b ? b.element : null}
    }})
  })(d)
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/tasklist/tasklist-bar/index", "panel-view warehouse util collections/members views/board/tasklist/tasklist-tab/index views/board/tasklist/tasklist-creator/index views/member/member-menu/index ./templates/basic jqueryui/sortable-tb-flavored".split(" "), function (d, b, e, g, k, h, l, n) {
    var m;
    return function (d) {
      function e() {
        return m = e.__super__.constructor.apply(this, arguments)
      }

      a(e, d);
      e.prototype.viewName = "tasklistBar";
      e.prototype.className = "tasklist-bar";
      e.prototype.appendTo = ".board-scrum-view";
      e.prototype.panelWidth = 350;
      e.prototype.useTransformAnimation = !0;
      e.prototype.events = {"click .tasklist-creator-toggler": "toggleTasklistCreator"};
      e.prototype.initialize = function (a) {
        if (!(null != a && a.tasklistsCollection && null != a && a._projectId && null != a && a._tasklistId))return!1;
        this.options = a;
        this._projectId =
          a._projectId;
        this._tasklistId = a._tasklistId;
        this.tasklistsCollection = a.tasklistsCollection;
        this.membersCollection = b.get(g, this._projectId);
        return e.__super__.initialize.apply(this, arguments)
      };
      e.prototype.getHiddenStatus = function () {
        return{left: -this.panelWidth}
      };
      e.prototype.getShownStatus = function () {
        return{left: 0}
      };
      e.prototype.defaultLayer = function (a) {
        this.renderBasic(a).renderTasklistCreator().renderTasklists().renderMemberMenu().listen();
        return this
      };
      e.prototype.listen = function () {
        this.listenTo(this.tasklistsCollection,
          "add", this.renderTasklist);
        return this
      };
      e.prototype.renderBasic = function (a) {
        a.html(n());
        this.$content = this.$(".tasklist-bar-content");
        this.$tasklists = this.$(".tasklist-bar-tasklists");
        this.$tasklistCreator = this.$(".tasklist-creator-wrap");
        this.$tasklistSmartMember = this.$(".tasklist-smart-member");
        return this
      };
      e.prototype.renderTasklists = function () {
        var a, b, e, d;
        d = this.tasklistsCollection.models.slice().reverse();
        b = 0;
        for (e = d.length; b < e; b++)a = d[b], this.renderTasklist(a);
        this.setupSortable();
        return this
      };
      e.prototype.renderTasklist = function (a) {
        this.requestSubView(k, {tasklistModel: a}).$el.prependTo(this.$tasklists);
        return this
      };
      e.prototype.renderTasklistCreator = function () {
        var a = this;
        this.tasklistCreator = this.requestSubView(h, {_projectId: this._projectId, success: function (b) {
          return _.delay(function () {
            return a.$("[data-id=" + b.id + "]").trigger("click")
          }, 100)
        }});
        this.tasklistCreator.$el.appendTo(this.$tasklistCreator);
        return this
      };
      e.prototype.renderMemberMenu = function () {
        var a = this;
        this.requestSubView(l, {multi: !1,
          select: function (b) {
            return a.$tasklistSmartMember.trigger("selectMember", [b])
          }, membersCollection: this.membersCollection}).setup(this.$tasklistSmartMember);
        return this
      };
      e.prototype.toggleTasklistCreator = function (a) {
        this.$content.toggleClass("creator-on");
        if (this.$content.hasClass("creator-on"))return this.$(".tasklist-create-new input").focus()
      };
      e.prototype.setupSortable = function (a) {
        var b = this;
        this.$tasklists.disableSelection();
        this.$tasklists.sortable({axis: "y", items: ".tasklist-tab", stop: function (a, e) {
          var d, f, g;
          g = $(e.item[0]).data("id");
          f = $(e.item[0]).prev(".tasklist-tab").data("id") || 0;
          return"function" === typeof(d = b.tasklistsCollection.get(g)).save ? d.save({_pos: f}) : void 0
        }});
        return this
      };
      return e
    }(d)
  })
}).call(this);
define("views/board/tasklist/tasklist-menu/templates/basic", [], function () {
  return function (d) {
    var a = "";
    0 < d.hasRight ? a += ' <ul class="list"> <li> <a class="edit-tasklist-handler" data-gta="event" data-label="open tasklist editor" data-action="click" data-category="a" data-value="h8"> <span class="icon icon-pencil"></span>  </a> </li> <li> <a class="delete-tasklist-handler" data-gta="event" data-label="delete tasklist" data-action="click" data-category="a" data-value="h9"> <span class="icon icon-trash"></span>  </a> </li> </ul>' : (a +=
      ' <p class="muted"> . ', d.hasRightMembers && (a += "" + d.hasRightMembers + "."), a += " </p>");
    return a
  }
});
define("views/board/tasklist/tasklist-menu/templates/edit", [], function () {
  return function (d) {
    return'<form class="tasklist-edit-form"> <input class="form-control" placeholder="" type="text" value="' + d.title + '" /> <textarea class="form-control" placeholder="">' + d.description + '</textarea> <button class="btn btn-primary" type="submit"></button></form>'
  }
});
define("views/board/tasklist/tasklist-menu/templates/delete", [], function () {
  return function (d) {
    var a = "";
    return a = d.isLast ? a + ' <p class="muted"> . </p>' : a + ' <form class="tasklist-delete-form"> <p></p> <button class="btn btn-danger" type="submit"></button> </form>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/tasklist/tasklist-menu/index", ["popover-view", "./templates/basic", "./templates/edit", "./templates/delete"], function (d, b, e, g) {
    var k;
    return function (d) {
      function f() {
        return k = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "TasklistMenuView";
      f.prototype.popoverTitle =
        "";
      f.prototype.events = {"click .edit-tasklist-handler": "enterEditSubMenu", "click .delete-tasklist-handler": "enterDeleteSubMenu", "submit .tasklist-edit-form": "submitEditForm", "submit .tasklist-delete-form": "submitDeleteForm"};
      f.prototype.render = function () {
        var a;
        a = this.options.tasklistModel.toJSON();
        a.hasRight = this.options.tasklistModel.hasRight();
        this.$el.html(b(a));
        return this
      };
      f.prototype.enterEditSubMenu = function () {
        var a = this;
        this.enterSubMenu("", function () {
          a.$el.html(e(a.options.tasklistModel.toJSON()));
          return a.$("input").focus()
        });
        return this
      };
      f.prototype.enterDeleteSubMenu = function () {
        var a = this;
        this.enterSubMenu("", function () {
          return a.$el.html(g({isLast: 1 === a.options.tasklistsCollection.length}))
        });
        return this
      };
      f.prototype.submitEditForm = function (a) {
        var b, e, d = this;
        a.preventDefault();
        a = $(a.currentTarget);
        e = a.find("input").val().trim();
        b = a.find("textarea").val();
        e ? this.options.tasklistModel.save({title: e, description: b}, {success: function () {
          return d.hide()
        }}) : a.find("input").focus();
        return this
      };
      f.prototype.submitDeleteForm = function (a) {
        var b = this;
        a.preventDefault();
        this.options.tasklistModel.destroy({wait: !0, success: function () {
          return b.hide()
        }});
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/board/stage/stage-menu/templates/basic", [], function () {
  return function (d) {
    var a = "";
    0 < d.hasRight ? (a += ' <ul class="list"> <li> <a class="edit-stage-handler"> <span class="icon icon-pencil"></span> </a> </li> ', d._nextId && (a += ' <li> <a class="add-next-stage-handler"> <span class="icon icon-add-stage"></span> </a> </li> '), a += " ", !d.isFirst && d._nextId && (a += ' <li> <a class="delete-stage-handler"> <span class="icon icon-trash"></span> </a> </li> '), a += " </ul>") : (a += ' <p class="muted"> . ',
      d.hasRightMembers && (a += "" + d.hasRightMembers + "."), a += " </p>");
    return a
  }
});
define("views/board/stage/stage-menu/templates/edit", [], function () {
  return function (d) {
    return'<form class="stage-edit-form"> <input class="form-control" placeholder="" type="text" value="' + d.name + '"></input> <button class="btn btn-primary" type="submit" data-gta="event" data-label="edit stage"></button></form>'
  }
});
define("views/board/stage/stage-menu/templates/add", [], function () {
  return function (d) {
    return'<form class="stage-add-form"> <p></p> <input class="form-control" type="text" placeholder=""></input> <button class="btn btn-primary" type="submit" data-gta="event" data-label="add stage"></button></form>'
  }
});
define("views/board/stage/stage-menu/templates/delete", [], function () {
  return function (d) {
    var a = '<form class="stage-delete-form"> ', a = d.deletable ? a + ' <p>?</p> <button class="btn btn-danger" type="submit" data-gta="event" data-label="delete stage"></button> ' : a + " <p>.</p> ";
    return a + "</form>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/stage/stage-menu/index", ["popover-view", "./templates/basic", "./templates/edit", "./templates/add", "./templates/delete"], function (d, b, e, g, k) {
    var h;
    return function (d) {
      function f() {
        return h = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "StageMenuView";
      f.prototype.popoverTitle =
        "";
      f.prototype.events = {"click .edit-stage-handler": "enterEditSubMenu", "click .add-next-stage-handler": "enterAddNextSubMenu", "click .delete-stage-handler": "enterDeleteSubMenu", "submit .stage-edit-form": "submitEditForm", "submit .stage-add-form": "submitAddForm", "submit .stage-delete-form": "submitDeleteForm"};
      f.prototype.render = function () {
        var a;
        console.log(this.cid, this.options.stageModel.id);
        if (this.options.stageModel)return a = this.options.stageModel.toJSON(), a.hasRight = this.options.stageModel.hasRight(),
          this.$el.html(b(a)), this
      };
      f.prototype.enterEditSubMenu = function () {
        var a = this;
        this.enterSubMenu("", function () {
          a.$el.html(e(a.options.stageModel.toJSON()));
          return a.$("input").focus()
        });
        return this
      };
      f.prototype.enterAddNextSubMenu = function () {
        var a = this;
        this.enterSubMenu("", function () {
          a.$el.html(g());
          return a.$el.find("input").focus()
        });
        return this
      };
      f.prototype.enterDeleteSubMenu = function () {
        var a, b, e = this;
        a = null != (b = this.options.tasksCollection) ? b.getByStage(this.options.stageModel.id).length :
          void 0;
        this.enterSubMenu("", function () {
          return e.$el.html(k({deletable: 0 === a ? !0 : !1}))
        });
        return this
      };
      f.prototype.submitEditForm = function (a) {
        var b, e = this;
        a.preventDefault();
        a = $(a.currentTarget);
        (b = a.find("input").val().trim()) ? this.options.stageModel.save({name: b}, {success: function () {
          return e.hide()
        }}) : a.find("input").focus();
        return this
      };
      f.prototype.submitAddForm = function (a) {
        var b, e = this;
        a.preventDefault();
        a = $(a.currentTarget);
        (b = a.find("input").val().trim()) ? this.options.stageModel.collection.create({name: b,
          _tasklistId: this.options.stageModel.get("_tasklistId"), _nextId: this.options.stageModel.get("_nextId")}, {wait: !0, success: function () {
          return e.hide()
        }}) : a.find(input).focus();
        return this
      };
      f.prototype.submitDeleteForm = function (a) {
        var b = this;
        a.preventDefault();
        this.options.stageModel.destroy({success: function () {
          return b.hide()
        }});
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/member/member-filter/templates/basic", [], function () {
  return function (d) {
    return'<div class="btn dropdown-toggle member-filter-trigger pull-right"> <span class="member-filter-list"></span> <span class="caret"></span></div>'
  }
});
define("views/member/member-filter/templates/label", [], function () {
  return function (d) {
    var a = "";
    return a = 0 < d.members.length ? a + " " + (' <div class="img-circle img-24" style="background-image:url(' + d.members[d.members.length - 1].avatarUrl + ');"></div> <span>  ' + d.members.length + "</span>") : a + " "
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/member/member-filter/index", ["view", "views/member/member-menu/index", "./templates/basic", "./templates/label"], function (d, b, e, g) {
    var k;
    return function (d) {
      function f() {
        return k = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "MemberFilterView";
      f.prototype.tagName =
        "div";
      f.prototype.className = "filter-view btn-group pull-right";
      f.prototype.events = {};
      f.prototype.initialize = function (a) {
        this.options = _.extend({}, a);
        this.membersCollection = this.options.membersCollection;
        this.selected = [];
        return this.renderBasic().renderMemberMenu().refrashLabel()
      };
      f.prototype.renderBasic = function () {
        this.$el.html(e());
        this.$memberFilterTrigger = this.$(".member-filter-trigger");
        this.$memberFilterList = this.$(".member-filter-list");
        return this
      };
      f.prototype.renderMemberMenu = function () {
        var a =
          this;
        this.memberMemu = this.requestSubView(b, {multi: !0, selected: this.selected, select: function (b) {
          return a.addMember(b)
        }, unselect: function (b) {
          return a.removeMember(b)
        }, selectAll: function (b) {
          return a.selectedAllMember(b)
        }, membersCollection: this.membersCollection}).setup(this.$memberFilterTrigger);
        return this
      };
      f.prototype.refrashLabel = function () {
        var a, b, e, d, f, h;
        a = {members: []};
        f = this.selected;
        e = 0;
        for (d = f.length; e < d; e++)b = f[e], b = null != (h = this.membersCollection.get(b)) ? h.toJSON() : void 0, null != b && b._id && a.members.push(b);
        return this.$memberFilterList.html(g(a))
      };
      f.prototype.selectedAllMember = function (a) {
        this.selected = a;
        return this.onSelectedChange()
      };
      f.prototype.addMember = function (a) {
        this.selected = _.union(this.selected, a);
        return this.onSelectedChange()
      };
      f.prototype.removeMember = function (a) {
        this.selected = _.without(this.selected, a);
        return this.onSelectedChange()
      };
      f.prototype.onSelectedChange = function () {
        var a;
        this.refrashLabel();
        return"function" === typeof(a = this.options).onSelectedChange ? a.onSelectedChange(this.selected) :
          void 0
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/hidden-task-group", ["model"], function (d) {
    var b;
    return function (e) {
      function d() {
        return b = d.__super__.constructor.apply(this, arguments)
      }

      a(d, e);
      d.prototype.name = "hiddenTaskGroup";
      d.prototype.defaults = {month: "", doneCount: 0};
      return d
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/hidden-task-groups", ["warehouse", "collection", "models/hidden-task-group"], function (d, b, e) {
    var g;
    return function (b) {
      function h() {
        return g = h.__super__.constructor.apply(this, arguments)
      }

      a(h, b);
      h.prototype.name = "hiddenTaskGroups";
      h.prototype.model = e;
      h.prototype.comparator = function (a, b) {
        a =
          a.get("month").split("/");
        b = b.get("month").split("/");
        a = 100 * parseInt(a[0], 10) + parseInt(a[1], 10);
        b = 100 * parseInt(b[0], 10) + parseInt(b[1], 10);
        return a < b
      };
      h.prototype.sync = function (a, b, e) {
        var g = this;
        switch (a) {
          case "read":
            return d.socket.emit("grouptasks:tasklist", {_id: e._tasklistId}), d.socket.once("grouptasks:tasklist/" + e._tasklistId, function (a) {
              if (a.errorCode)return"function" === typeof e.error ? e.error(a.errorCode) : void 0;
              g.synced = !0;
              g.pageNum && (g.hasMore = a.group.length === g.pageNum);
              "function" === typeof e.success &&
              e.success(a.group);
              return g.listen()
            })
        }
      };
      return h
    }(b)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/hidden-tasks", ["collection", "models/task"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.name = "tasks";
      f.prototype.model = b;
      f.prototype.boundToObjectType = "tasklist";
      f.prototype.getByStage = function (a) {
        return this.where({_stageId: a})
      };
      f.prototype.getParams = function (a, b) {
        return{month: "read" === a ? null != b ? b.month : void 0 : void 0, _boundToObjectId: "read" === a ? null != b ? b._boundToObjectId : void 0 : void 0}
      };
      return f
    }(d)
  })
}).call(this);
define("views/board/task/task-archiver/templates/basic", [], function () {
  return function (d) {
    return'<header class="task-archiver-header"> <ul class="nav nav-underscore"> <li> <a href="#"> <h3></h3> </a> </li> <li class="pull-right member-filter-wrapper"> </li> </ul></header><section class="task-archiver-content"> <div class="timeline-wrapper"></div></section>'
  }
});
define("views/board/task/task-archiver/templates/group", [], function () {
  return function (d) {
    var a = '<div class="accordion"> <ul id="task-archiver-accordion"> ';
    if (d = d.groups)for (var f, b = -1, e = d.length - 1; b < e;)f = d[b += 1], a += ' <li class="accordion-group"> <div class="accordion-title group-toggler collapsed" href="#collapse-archive-task' + b + '" data-toggle="collapse" data-parent="#task-archiver-accordion" data-month="' + f.month.val + '"> <span class="caret pull-left"></span> <span>' + f.month.monthString + "  " + f.doneCount +
      '</span> </div> <div id="collapse-archive-task' + b + '" class="collapse"> <ul class="accordion-list group-wrapper tasklist card"></ul> </div> </li> ';
    return a + " </ul></div>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, e) {
    function f() {
      this.constructor = a
    }

    for (var k in e)d.call(e, k) && (a[k] = e[k]);
    f.prototype = e.prototype;
    a.prototype = new f;
    a.__super__ = e.prototype;
    return a
  }, f = [].indexOf || function (a) {
    for (var e = 0, d = this.length; e < d; e++)if (e in this && this[e] === a)return e;
    return-1
  };
  define("views/board/task/task-archiver/index", "view views/member/member-filter/index views/board/task/task/index warehouse collections/members collections/hidden-task-groups collections/hidden-tasks ./templates/basic ./templates/group".split(" "),
    function (b, e, d, k, h, l, n, m, s) {
      var r;
      return function (b) {
        function v() {
          return r = v.__super__.constructor.apply(this, arguments)
        }

        a(v, b);
        v.prototype.viewName = "TaskArchiverView";
        v.prototype.tagName = "div";
        v.prototype.className = "task-archiver";
        v.prototype.events = {"click .group-toggler": "renderGroup"};
        v.prototype.initialize = function (a) {
          var b = this;
          this.options = _.extend({}, a);
          this.membersCollection = k.request(h, this.options._projectId);
          this.hiddenTaskGroupsCollection = k.get(l);
          this.hiddenTasksCollection = k.get(n);
          this.selected = [];
          this.load({success: function (a) {
            b.groupsCollection = a;
            return b.renderBasic().renderMemberFilter().renderMonthGroups()
          }});
          return this
        };
        v.prototype.load = function (a) {
          this.hiddenTasksCollection.reset();
          this.hiddenTaskGroupsCollection.fetch({_tasklistId: this.options._tasklistId, success: function (b) {
            return"function" === typeof a.success ? a.success(b) : void 0
          }});
          return this
        };
        v.prototype.renderBasic = function () {
          this.$el.html(m());
          this.$memberFilterWrapper = this.$(".member-filter-wrapper");
          this.$archiveTaskWrapper =
            this.$(".timeline-wrapper");
          return this
        };
        v.prototype.renderMemberFilter = function () {
          var a = this;
          this.requestSubView(e, {membersCollection: this.membersCollection, onSelectedChange: function (b) {
            return a.onSelectedChange(b)
          }}).$el.appendTo(this.$memberFilterWrapper);
          return this
        };
        v.prototype.renderMonthGroups = function () {
          var a;
          a = this.groupsCollection.toJSON();
          a = _.map(a, function (a) {
            var b;
            b = a.month.split("/").join("") + "";
            a.month = {val: a.month, monthString: b};
            return a
          });
          this.$archiveTaskWrapper.html(s({groups: a}));
          this.$groupTriggers = this.$(".group-toggler");
          return this
        };
        v.prototype.onSelectedChange = function (a) {
          this.selected = a;
          this.$groupTriggers.data("updated", !1);
          return this._renderGroup(this.currentTrigger)
        };
        v.prototype.renderGroup = function (a) {
          a = $(a.currentTarget);
          this._renderGroup(a);
          return this
        };
        v.prototype._renderGroup = function (a) {
          var b, e, h = this;
          this.currentTrigger = a;
          if (!a || a.data("updated"))return this;
          a.data("updated", !0);
          b = a.next().children("ul");
          e = a.data("month");
          b.html("");
          this.showLoadingIndicator(b);
          this.hiddenTasksCollection.reset();
          _.delay(function () {
            return h.hiddenTasksCollection.fetch({month: e, _boundToObjectId: h.options._tasklistId, success: function (a) {
              h.hideLoadingIndicator(b);
              return a.each(function (a) {
                var e;
                h.listenTo(a, "change:isDone", function (a, b) {
                  if (!b)return h.removeTask(a)
                });
                if (0 === h.selected.length || (e = a.get("_executorId"), 0 <= f.call(h.selected, e)))return h.requestSubView(d, {model: a, viewType: "list", hidePriority: !0}).$el.appendTo(b)
              })
            }})
          }, 300);
          return this
        };
        v.prototype.removeTask = function (a) {
          a =
            a.get("_id");
          this.$("#" + a).remove();
          return this
        };
        return v
      }(b)
    })
}).call(this);
define("views/board/task/archive-task-detail/templates/basic", [], function () {
  return function (d) {
    return'<header class="archive-task-detail-header"> <ul class="nav nav-underscore"> <li> <a href="#" class="back-to-task-archiver"> <span class="icon icon-chevron-left"></span> <h3></h3> </a> </li> </ul></header><section class="archive-task-detail-content"></section>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/task/archive-task-detail/index", ["view", "views/board/task/task-detail/index", "./templates/basic"], function (d, b, e) {
    var g;
    return function (d) {
      function f() {
        return g = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "ArchiveTaskDetailView";
      f.prototype.className =
        "archive-task-detail";
      f.prototype.initialize = function (a) {
        this.options = _.extend({}, a);
        this.renderBasic().renderHiddenTaskDetail();
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(e());
        this.$content = this.$(".archive-task-detail-content");
        return this
      };
      f.prototype.renderHiddenTaskDetail = function () {
        this.requestSubView(b, this.options).$el.appendTo(this.$content);
        return this
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/task/task-archiver-panel/index", ["panel-view", "views/board/task/task-archiver/index", "views/board/task/archive-task-detail/index"], function (d, b, e) {
    var g;
    return function (d) {
      function f() {
        return g = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "taskArchiverPanel";
      f.prototype.className = "task-archiver-panel panel";
      f.prototype.defaultLayer = b;
      f.prototype.events = {"click .task-archiver .task-content-set": "enterTaskDetail", "click .back-to-task-archiver": "backToTaskArchiver"};
      f.prototype.initialize = function (a) {
        if (null == a || !a._tasklistId)return!1;
        this._tasklistId = a._tasklistId;
        return f.__super__.initialize.apply(this, arguments)
      };
      f.prototype.isSame = function (a) {
        return null != a && a._tasklistId ? a._tasklistId === this._memberId : !1
      };
      f.prototype.enterTaskDetail = function (a) {
        a =
          $(a.target).closest(".task").data("_taskId");
        this.enter(e, {_projectId: this._projectId, _tasklistId: this._tasklistId, _taskId: a});
        return this
      };
      f.prototype.backToTaskArchiver = function (a) {
        this.back();
        a.preventDefault();
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/board/stage/stage/templates/basic", [], function () {
  return function (d) {
    var a = '<header class="scrum-stage-header"></header><section class="scrum-stage-content thin-scroll stage-scrollbar"> ';
    d.hasHidden && !d._nextId && (a += ' <a class="task-archiver-toggler" data-gta="event" data-label="stage|toggle task archiver"> <span class="icon icon-eye"></span> <span>  ' + d.hiddenTaskCount + "</span> </a> ");
    return a + ' <ul class="scrum-stage-tasks"></ul></section><footer class="bottom-mask"></footer>'
  }
});
define("views/board/stage/stage/templates/header", [], function () {
  return function (d) {
    var a = '<div class="stage-name"> ';
    if (d.isFirst || !d._nextId)a += ' <span class="icon icon-lock"></span> ';
    a += " " + d.name + " ";
    d.tasksCount && (a += ' <span class="task-count">  ' + d.tasksCount + "</span> ");
    a += " ";
    d._nextId && (a += ' <span class="icon icon-chevron-right"></span> ');
    return a + '</div><a class="stage-menu-toggler icon icon-chevron-down hinted" data-title=""></a>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/stage/stage/index", "view views/board/task/task/index views/board/stage/stage-menu/index views/board/task/task-archiver-panel/index ./templates/basic ./templates/header lib/scrollable jqueryui/droppable".split(" "), function (d, b, e, g, k, h, l) {
    var n, m;
    n = teambition.APP;
    d = function (d) {
      function f() {
        return m =
          f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "StageView";
      f.prototype.className = "scrum-stage toggler-parent";
      f.prototype.tagName = "li";
      f.prototype.events = {"click .stage-menu-toggler": "toggleStageMenu", "click .task-content-set": "openTaskDetail", "click .task-archiver-toggler": "toggleTaskArchiver"};
      f.prototype.initialize = function (a) {
        var b = this;
        if (!(a.projectModel || a.stageModel || a.tasksCollection))return!1;
        this.options = a;
        this.projectModel = a.projectModel;
        this.tasksCollection =
          a.tasksCollection;
        this.stageModel = a.stageModel;
        this.stages = a.stageModel.collection;
        this.renderBasic().renderHeader(this.stageModel).renderTasks().listen(a);
        this.setupScroll(this.$content);
        _.defer(function () {
          return b.setupDropable()
        });
        return this
      };
      f.prototype.listen = function (a) {
        this.listenTo(this.tasksCollection, "add", this.checkAddTask);
        this.listenTo(this.tasksCollection, "remove", this.checkRemoveTask);
        this.listenTo(this.tasksCollection, "change:_stageId", this.checkChangeStage);
        this.listenTo(this.stageModel,
          "change", this.renderHeader);
        this.listenTo(this.stageModel, "remove", this.remove);
        return this
      };
      f.prototype.renderBasic = function () {
        var a;
        a = this.stageModel.toJSON();
        a.hiddenTaskCount = this.options.hiddenTaskCount || 0;
        a.hasHidden = this.options.hasHidden;
        this.$el.html(k(a));
        this.$el.data({id: this.stageModel.id});
        this.$el.attr("id", "stage-" + this.stageModel.id);
        this.$header = this.$el.find(".scrum-stage-header");
        this.$content = this.$el.find(".scrum-stage-content");
        this.$tasks = this.$el.find(".scrum-stage-tasks");
        this.$bottomScrollHandler = this.$el.find(".bottom-mask");
        return this
      };
      f.prototype.renderHeader = function (a) {
        var b;
        b = this.tasksCollection.getByStage(a.id);
        a = a.toJSON();
        a.tasksCount = b.length;
        this.options.hasHidden && !a._nextId && (a.tasksCount += this.options.hiddenTaskCount || 0);
        this.$header.html(h(a));
        return this
      };
      f.prototype.renderTasks = function () {
        var a, b, d, e;
        a = this.tasksCollection.getByStage(this.stageModel.id);
        d = 0;
        for (e = a.length; d < e; d++)b = a[d], this.renderTask(b);
        return this
      };
      f.prototype.renderTask = function (a, d) {
        var e, f;
        f = d ? "prependTo" : "appendTo";
        e = this.requestSubView(b, {model: a, viewType: "scrum"}).$el;
        e[f](this.$tasks);
        return e
      };
      f.prototype.setupDropable = function () {
        var a, b, d, e = this;
        d = this.$content[0].scrollHeight;
        b = this.$content.height();
        a = d - b;
        this.$header.droppable({accept: ".task", over: function (a, b) {
          return e.$content.animate({scrollTop: 0}, 1E3)
        }, out: function (a, b) {
          return e.$content.stop()
        }});
        this.$bottomScrollHandler.droppable({accept: ".task", over: function (b, d) {
          return e.$content.animate({scrollTop: a + 200},
            1E3)
        }, out: function (a, b) {
          return e.$content.stop()
        }});
        return this
      };
      f.prototype.changeTasksCount = function () {
        this.renderHeader(this.stageModel);
        return this
      };
      f.prototype.checkAddTask = function (a) {
        a.get("_stageId") === this.stageModel.id && (a = this.renderTask(a), this.scrollTo(a, !0), this.changeTasksCount());
        return this
      };
      f.prototype.checkRemoveTask = function (a) {
        a.get("_stageId") === this.stageModel.id && (this.$tasks.find("#" + a.id).remove(), this.changeTasksCount());
        return this
      };
      f.prototype.checkChangeStage = function (a) {
        var b;
        this.changeTasksCount();
        a.get("_stageId") !== this.stageModel.id || this.$("#" + a.id).length || (b = $("#" + a.id), b.remove(), this.renderTask(a));
        return this
      };
      f.prototype.toggleStageMenu = function (a) {
        a = $(a.currentTarget);
        a.data("bs.popover") || this.requestSubView(e, {$toggler: a, _projectId: this._projectId, stageModel: this.stageModel, tasksCollection: this.tasksCollection}).show();
        return this
      };
      f.prototype.openTaskDetail = function (a) {
        var b;
        b = $(a.target).closest(".task").data("_taskId");
        a = this.tasksCollection.get(b);
        n.currentView.renderTaskDetail(a);
        n.currentView.updateUrl({_taskId: b, _tasklistId: a.get("_tasklistId")}, {trigger: !1});
        return this
      };
      f.prototype.toggleTaskArchiver = function (a) {
        n.showPanel(g, {_projectId: this.projectModel.id, _tasklistId: this.stageModel.get("_tasklistId")});
        return this
      };
      return f
    }(d);
    _.extend(d.prototype, l);
    return d
  })
}).call(this);
define("views/board/scrum/templates/basic", [], function () {
  return function (d) {
    return'<header class="board-scrum-header"></header><section class="board-scrum-content fade"> <ul class="board-scrum-stages horizontal-scroll"></ul></section><footer class="board-scrum-footer fade"></footer>'
  }
});
define("views/board/scrum/templates/header", [], function () {
  return function (d) {
    return'<div class="tasklist-bar-toggler muted" data-gta="event"> <strong class="board-scrum-title">' + d.title + "</strong> " + (d.description || "") + ' <span class="icon icon-chevron-down"></span></div><div class="tasklist-editor-toggler" data-gta="event"> <a class="icon icon-cog"></a></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/scrum/index", "view views/board/task/task-list/index views/board/task/task-creator/index views/board/tasklist/tasklist-bar/index views/board/tasklist/tasklist-menu/index views/board/stage/stage/index warehouse models/tasklist collections/projects collections/members collections/tasklists collections/stages collections/tasks thenjs moment ./templates/basic ./templates/header jqueryui/sortable-tb-flavored".split(" "),
    function (d, b, e, g, k, h, l, n, m, s, r, t, v, p, x, B, C) {
      var z, A, u, w;
      z = teambition.APP;
      u = teambition.router;
      A = teambition.PREFERENCE;
      return function (d) {
        function f() {
          return w = f.__super__.constructor.apply(this, arguments)
        }

        a(f, d);
        f.prototype.viewName = "ScrumView";
        f.prototype.className = "board-view board-scrum-view";
        f.prototype.events = {"click .tasklist-bar-toggler": "toggleTasklistBar", "click .tasklist-editor-toggler": "toggleTasklistEditor", "click .tasklist-tab": "goToTasklist", "click .tasklist-smart-today": "goToTodayTasks",
          selectMember: "goToMemberTasks", "mousedown .board-scrum-stages": "dragStart"};
        f.prototype.initialize = function (a) {
          var b = this;
          if (null == a || !a._projectId)return!1;
          this.options = a;
          this._projectId = a._projectId;
          this._tasklistId = a._tasklistId;
          this._taskId = a._taskId;
          this.projectModel = l.get(m, null, a._projectId);
          this.membersCollection = l.get(s, this._projectId);
          this.currentViews = [];
          this.load({beforeSend: function () {
            b.renderBasic();
            return b.showLoadingIndicator()
          }, success: function (a, d, e) {
            b.tasklistsCollection = a;
            b.tasksCollection =
              e;
            b.stagesCollection = d;
            b.render().renderHeader().renderTaskCreator().renderStages().listen();
            b.$content.addClass("in");
            b.$footer.addClass("in");
            b.hideLoadingIndicator({animated: !0});
            if (b._taskId)return b.renderTaskDetail(e.get(b._taskId))
          }});
          return this
        };
        f.prototype.load = function (a) {
          var b = this;
          "function" === typeof a.beforeSend && a.beforeSend();
          l.request(r, this._projectId, {success: function (d) {
            var e;
            if (!d.length)return b.parentView.onRouteError();
            b._tasklistId || (b._tasklistId = d.at(0).id);
            b.tasklistModel =
              d.get(b._tasklistId);
            if (!b.tasklistModel)return b.parentView.onRouteError();
            e = "project/" + b._projectId + "/board/scrum/" + b._tasklistId;
            b._taskId && (e += "/task/" + b._taskId);
            u.navigate(e, {trigger: !1});
            return p.parallel([function (a) {
                return l.request(t, b._tasklistId, {success: function (b) {
                  return a(null, b)
                }, error: function (b) {
                  return a(b, null)
                }})
              }, function (a) {
                return l.request(v, b._tasklistId, {success: function (b) {
                  return a(null, b)
                }, error: function (b) {
                  return a(b, null)
                }})
              }]).all(function (b, e, f) {
              if (e) {
                if ("function" === typeof a.onError)a.onError(e);
                return z.currentView.onRouteError(e)
              }
              return"function" === typeof a.success ? a.success(d, f[0], f[1]) : void 0
            })
          }});
          return this
        };
        f.prototype.queryTasks = function (a) {
          var b;
          "function" === typeof a.beforeSend && a.beforeSend();
          b = Math.ceil(x().valueOf() / 1E3 / 60 / 10);
          l.request(v, "" + this._projectId + "_" + a.queryType + "_" + b, {boundToObjectType: "", params: a.params, success: function (b) {
            return"function" === typeof a.success ? a.success(b) : void 0
          }});
          return this
        };
        f.prototype.listen = function () {
          var a = this;
          this.stopListening();
          this.listenTo(this.tasklistModel, "destroy remove", function () {
            return a.switchTasklist(a.tasklistsCollection.at(0).id)
          });
          this.listenTo(this.tasklistModel, "change", this.renderHeader);
          this.listenTo(this.stagesCollection, "add", this.addStage);
          return this
        };
        f.prototype.renderBasic = function () {
          this.$el.html(B());
          this.$header = this.$el.find(".board-scrum-header");
          this.$content = this.$el.find(".board-scrum-content");
          this.$stages = this.$el.find(".board-scrum-stages");
          this.$footer = this.$el.find(".board-scrum-footer");
          return this
        };
        f.prototype.renderHeader = function () {
          this.$header.html(C(this.tasklistModel.toJSON()));
          return this
        };
        f.prototype.renderTaskCreator = function () {
          this.taskCreatorView = this.requestSubView(e, {_projectId: this._projectId, _tasklistId: this._tasklistId, tasksCollection: this.tasksCollection, stagesCollection: this.stagesCollection});
          this.taskCreatorView.$el.appendTo(this.$footer);
          this.currentViews.push(this.taskCreatorView);
          return this
        };
        f.prototype.renderStages = function () {
          var a;
          this.$stages.empty();
          a =
            this.stagesCollection.getFirstStage();
          for (this.renderStage(a).$el.appendTo(this.$stages); a.getNextStageModel();)a = a.getNextStageModel(), this.renderStage(a).$el.appendTo(this.$stages);
          this.setupSortable(this.$el);
          return this
        };
        f.prototype.renderStage = function (a) {
          a = this.requestSubView(h, {projectModel: this.projectModel, tasksCollection: this.tasksCollection, stageModel: a, hiddenTaskCount: this.tasklistModel.get("hiddenTaskCount"), hasHidden: this.tasklistModel.get("hasHidden")});
          this.currentViews.push(a);
          return a
        };
        f.prototype.addStage = function (a) {
          var b;
          b = this.renderStage(a);
          b.$el.insertBefore(this.$el.find("#stage-" + a.get("_nextId")));
          this.setupSortable(b.$el);
          return this
        };
        f.prototype.setupSortable = function (a) {
          var b = this;
          a.find(".scrum-stage-tasks").sortable({items: ".task", connectWith: ".scrum-stage-tasks", helper: "clone", placeholder: "scrum-drag-placeholder", zIndex: 2001, appendTo: this.$stages, scroll: !0, disableScrollY: !0, start: function (a, b) {
            b.placeholder.height(b.item.height());
            b.helper.css({rotate: "2deg"});
            try {
              return teambition.gta.event("div",
                "drag", "task list|drag task")
            } catch (d) {
            }
          }, receive: function (a, d) {
            var e, f;
            f = d.item.data("_taskId");
            e = $(a.target).closest(".scrum-stage").data("id");
            return b.tasksCollection.get(f).save({_stageId: e})
          }, update: function (a, b) {
            var d, e;
            e = $(a.target).closest(".scrum-stage").data("id");
            d = $(a.target).sortable("toArray");
            return A.tasksSortInStage(e, d)
          }});
          return this
        };
        f.prototype.dragStart = function (a) {
          var b, d;
          $(a.target).closest("li.task", this.$el).length || (b = $(a.currentTarget), d = a.pageX, b.on("mouseup mouseleave",
            function () {
              return b.off("mousemove")
            }), b.on("mousemove", function (a) {
            b.scrollLeft(d - a.pageX + b.scrollLeft());
            return d = a.pageX
          }));
          return this
        };
        f.prototype.renderTaskDetail = function (a) {
          z.currentView.renderTaskDetail(a);
          return this
        };
        f.prototype.activeTaskCreator = function () {
          this.taskCreatorView.focus();
          return this
        };
        f.prototype.toggleTasklistEditor = function (a) {
          a = $(a.currentTarget);
          a.data("bs.popover") || (a = this.requestSubView(k, {$toggler: a, $ParentView: this.$el, _projectId: this._projectId, tasklistModel: this.tasklistModel,
            tasklistsCollection: this.tasklistsCollection}).show(), this.currentViews.push(a));
          return this
        };
        f.prototype.toggleTasklistBar = function () {
          z.showPanel(g, {_tasklistId: this._tasklistId, _projectId: this._projectId, tasklistsCollection: this.tasklistsCollection});
          return this
        };
        f.prototype.goToTasklist = function (a) {
          a = $(a.currentTarget).data("id");
          this.switchTasklist(a);
          return this
        };
        f.prototype.switchTasklist = function (a) {
          var b = this;
          z.hidePanel();
          a !== this._tasklistId && (this.tasklistModel = this.tasklistsCollection.get(a),
            this._tasklistId = this.tasklistModel.id, this.renderHeader(), this.removeCurrentViews(), this.$el.removeClass("smart-view"), this.load({beforeSend: function () {
            return b.showLoadingIndicator(b.$stages)
          }, success: function (a, d, e) {
            b.stagesCollection = d;
            b.tasksCollection = e;
            return b.hideLoadingIndicator().renderTaskCreator().renderStages().listen()
          }}));
          return this
        };
        f.prototype.goToMemberTasks = function (a, b) {
          var d, e, f = this;
          d = null != (e = this.membersCollection.get(b)) ? e.toJSON() : void 0;
          this.queryTasks({queryType: "" + b,
            params: {_projectId: this._projectId, _executorId: b, isDone: !1}, beforeSend: function () {
              return f.showLoadingIndicator(f.$content)
            }, success: function (a) {
              f.tasklistModel = l.createModel(n, {_id: "membertasks", _creatorId: b, title: d ? "" + d.name + "" : ""});
              f.tasksCollection = a;
              return f.hideLoadingIndicator().switchSmartTasklist()
            }});
          return this
        };
        f.prototype.goToTodayTasks = function () {
          var a, b = this;
          a = x().millisecond(0).second(0).minute(0).hour(0).add("d", 1).toISOString();
          this.queryTasks({queryType: "today", params: {_projectId: this._projectId,
            isDone: !1, dueDate: a}, beforeSend: function () {
            return b.showLoadingIndicator(b.$content)
          }, success: function (a) {
            b.tasklistModel = l.createModel(n, {_id: "todaytasks", title: ""});
            b.tasksCollection = a;
            return b.hideLoadingIndicator().switchSmartTasklist()
          }});
          return this
        };
        f.prototype.switchSmartTasklist = function () {
          z.hidePanel();
          this.removeCurrentViews();
          this.$el.addClass("smart-view");
          u.navigate("project/" + this._projectId + "/board/scrum/" + this.tasklistModel.id, {trigger: !1});
          this.renderHeader();
          this._tasklistId =
            this.tasklistModel.id;
          this.smartListView = this.requestSubView(b, {isPrepend: !1, tasksCollection: this.tasksCollection, tasklistModel: this.tasklistModel});
          this.$content.append(this.smartListView.$el.addClass("board-smart-list"));
          this.currentViews.push(this.smartListView);
          return this
        };
        f.prototype.removeCurrentViews = function () {
          for (var a; this.currentViews.length;)"function" === typeof(a = this.currentViews.pop()).remove && a.remove();
          return this
        };
        return f
      }(d)
    })
}).call(this);
define("views/board/board/templates/guide", [], function () {
  return function (d) {
    return'<div class="guide-view"> <div class="guide-board-detail"> <div class="guide-board-tips guide-detail-wrapper"> <div class="guide-content-main"> <h2></h1> <hr> <ul class="nav board-tips-titles clearfix"> <li><a href="#new-task" data-toggle="tab"><span>1</span> </a></li> <li><a href="#move-stage" data-toggle="tab"><span>2</span> </a></li> <li><a href="#task-detail" data-toggle="tab"><span>3</span> </a></li> </ul> <div class="tab-content"> <div class="tab-pane guideImageType" id="new-task"></div> <div class="tab-pane guideImageType" id="move-stage"></div> <div class="tab-pane guideImageType" id="task-detail"></div> </div> </div> <div class="handler-wrapper clearfix"> <a class="btn btn-inverse pull-left guide-prev" style="display: none;" data-gta="event" data-label="guide|board|prev"></a> <a class="btn btn-primary pull-right guide-next" data-gta="event" data-label="guide|board|next"></a> </div> </div> <div class="guide-new-project  guide-detail-wrapper" style="display: none;"> <div class="guide-content-main"> <h2></h2> <hr> <p><span class="icon icon-plus"></span></p> <p></p> <div class="image-wrapper guideImageType"> <div class="magnifier-wrapper guideImageType"></div> </div> </div> <div class="handler-wrapper clearfix"> <a class="btn btn-primary pull-right guide-close" data-gta="event" data-label="guide|board|start"></a> </div> </div> </div></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/board/board/index", "view views/board/task/task-detail-panel/index views/board/scrum/index views/board/task/archive-task-detail/index lib/selectable lib/scrollable ./templates/guide".split(" "), function (d, b, e, g, k, h, l) {
    var n, m, s;
    n = teambition.APP;
    m = teambition.router;
    return function (d) {
      function f() {
        return s =
          f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "BoardView";
      f.prototype.className = "board-view";
      f.prototype.routes = {"": "smartEnter", "scrum(/:_tasklistId)": "enterScrum", "scrum/:_tasklistId/task/:_taskId": "enterScrum", "*paramString": "onRouteError"};
      f.prototype.initialize = function (a) {
        this._projectId = a._projectId;
        return this
      };
      f.prototype.onRouteError = function () {
        m.home();
        return this
      };
      f.prototype.home = function () {
        this.updateUrl({_tasklistId: null, _taskId: null, viewType: null}, {trigger: !0});
        return this
      };
      f.prototype.smartEnter = function () {
        m.navigate("project/" + this._projectId + "/board/scrum", {trigger: !0});
        return this
      };
      f.prototype.enterScrum = function (a, b) {
        this.requestSubView(e, {_projectId: this._projectId, _tasklistId: a, _taskId: b}).$el.appendTo(this.$el);
        return this
      };
      f.prototype.updateUrl = function (a, b) {
        var d, e, f, g;
        b || (b = {});
        g = a._tasklistId;
        f = a._taskId;
        e = a.viewType || "scrum";
        d = m.getPrefix() + "/board";
        g && (d += "/" + e + "/" + g, f && (d += "/task/" + f));
        !1 === b.trigger && (this._taskId = f, this._tasklistId = g);
        m.navigate(d,
          b);
        return this
      };
      f.prototype.renderTaskDetail = function (a) {
        var d;
        d = {};
        d[_.isObject(a) ? "taskModel" : "_taskId"] = a;
        n.showPanel(b, d);
        return this
      };
      f.prototype.guideView = function () {
        var a, b, d, e, f, g, h, k, r = this;
        $(".guide-view").remove();
        $(".guide-on").removeClass("guide-on");
        b = $(l());
        a = b.find(".guide-board-tips").hide();
        f = b.find(".guide-new-project").hide();
        b.appendTo("body");
        a.show().animate({opacity: 1});
        h = 0;
        k = b.find(".board-tips-titles li").length;
        e = b.find(".guide-prev");
        d = b.find(".guide-next");
        g = function (a) {
          return b.find(".board-tips-titles li:eq(" +
            a + ") a").tab("show")
        };
        b.find(".board-tips-titles").on("show",function (a) {
          b.find($(a.relatedTarget).attr("href")).animate({opacity: 0});
          return e[h ? "show" : "hide"]()
        }).on("shown",function (a) {
          return b.find($(a.target).attr("href")).animate({opacity: 1})
        }).on("click", "li", function (a) {
          return h = $(this).index()
        });
        e.on("click", function () {
          if (h)return h -= 1, g(h)
        });
        d.on("click", function () {
          if (h === k - 1)return a.animate({opacity: 0}, function () {
            a.remove();
            f.show().animate({opacity: 1});
            f.find(".magnifier-wrapper").addClass("active");
            teambition.guideView = !1;
            return m.navigate("projects", {trigger: !0})
          });
          h += 1;
          return g(h)
        });
        g(0);
        this.guideView.destroy = function () {
          b.remove();
          return r.guideView.response = r.guideView.destroy = null
        };
        b.find(".guide-close").one("click", function () {
          return f.animate({opacity: 0}, function () {
            teambition.guideView = !1;
            return r.guideView.destroy()
          })
        });
        return this
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/events/event-detail-panel/index", ["panel-view", "views/events/event-detail/index"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "EventDetailPanel";
      f.prototype.className = "event-detail-panel panel";
      f.prototype.defaultLayer =
        b;
      f.prototype.initialize = function (a) {
        if (!a || !a.eventModel && !a._eventId)return!1;
        this._eventId = a._eventId || a.eventModel.id;
        _.isNumber(a.rightOffset) && (this.rightOffset = a.rightOffset);
        return f.__super__.initialize.apply(this, arguments)
      };
      f.prototype.isSame = function (a) {
        var b;
        return(a._eventId || (null != (b = a.eventModel) ? b.id : void 0)) === this._eventId
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/wall/post-panel/index", ["panel-view", "views/wall/post-detail/index"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "PostPanelView";
      f.prototype.className = "post-panel panel";
      f.prototype.defaultLayer = b;
      f.prototype.initialize = function (a) {
        if (!a || !a.postModel && !a._postId)return!1;
        this._postId = a._postId || a.postModel.id;
        _.isNumber(a.rightOffset) && (this.rightOffset = a.rightOffset);
        return f.__super__.initialize.apply(this, arguments)
      };
      f.prototype.isSame = function (a) {
        var b;
        return(a._postId || (null != (b = a.postModel) ? b.id : void 0)) === this._postId
      };
      return f
    }(d)
  })
}).call(this);
define("views/dashboard/task-creator/templates/basic", [], function () {
  return function (d) {
    return'<form class="task-creator-form"> <textarea class="task-content-input form-control" placeholder=""></textarea> <div class="creator-handler-set clearfix"> <a class="creator-handler executor-handler pull-left"> <span class="avatar img-circle img-24"></span> <span class="name"></span><span></span> </a> <a class="creator-handler duedate-handler"> <span class="icon icon-calendar"></span> <span class="due-text"></span> </a> </div> <div class="creator-handler-set involve clearfix"> <a class="creator-handler tasklist-handler pull-left"> <span class="icon icon-th-list"></span> <span class="tasklist-title"></span> </a> </div> <button class="btn btn-primary submit-handler" type="submit">  </button></form>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/dashboard/task-creator/index", "view views/member/member-menu/index views/member/member-involve/index views/core/mover/index warehouse models/task collections/members collections/tasklists util store ./templates/basic".split(" "), function (d, b, e, g, k, h, l, n, m, s, r) {
    var t, v;
    t = teambition.user;
    return function (d) {
      function f() {
        return v = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "DashboardTaskCreatorView";
      f.prototype.className = "dashboard-task-creator";
      f.prototype.events = {"change .task-content-input": "cacheTask", "keydown .task-content-input": "quickSubmit", "click .submit-handler": "submit"};
      f.prototype.initialize = function (a) {
        var b, d = this;
        if (a && a._projectId && a.tasksCollection)return this.options = a, this._projectId = a._projectId, this.tasksCollection = a.tasksCollection,
          this.membersCollection = k.get(l, this._projectId), this.localCache = s.namespace("tasks_dashboard"), this.localCacheId = "" + a._projectId + "_" + t.id, b = this.localCache(this.localCacheId) || {}, this._tasklistId = a._tasklistId || b._tasklistId, this._executorId = b._executorId || t.id, k.request(n, this._projectId, {success: function (a) {
          d.tasklistCollection = a;
          d._tasklistId ? d.tasklistModel = d.tasklistCollection.get(d._tasklistId) : (d.tasklistModel = d.tasklistCollection.at(0), d._tasklistId = d.tasklistModel.id);
          d.taskModel = k.createModel(h,
            {_creatorId: t.id, _executorId: d._executorId, _projectId: d._projectId, _tasklistId: d._tasklistId, priority: 0, dueDate: b.dueDate || "", involveMembers: b.involveMembers || [t.id], content: b.content || ""});
          return d.render().initExecutor().initDatePicker().initMover().initInvolve().renderExecutor().renderDueDate().renderTasklist().listen().focus().cacheTask()
        }}), this
      };
      f.prototype.listen = function () {
        this.listenTo(this.taskModel, "change", this.cacheTask);
        this.listenTo(this.taskModel, "change:_executorId", this.renderExecutor);
        this.listenTo(this.taskModel, "change:dueDate", this.renderDueDate);
        this.listenTo(this.taskModel, "change:_tasklistId", this.renderTasklist);
        return this
      };
      f.prototype.render = function () {
        this.$el.html(r());
        this.$input = this.$(".task-content-input").val(this.taskModel.get("content"));
        this.$executorHandler = this.$(".executor-handler");
        this.$duedateHandler = this.$(".duedate-handler");
        this.$tasklistHandler = this.$(".tasklist-handler");
        this.$submit = this.$(".submit-handler");
        return this
      };
      f.prototype.focus = function () {
        var a =
          this;
        _.delay(function () {
          var b;
          return null != (b = a.$input) ? b.focus() : void 0
        }, 300);
        return this
      };
      f.prototype.updateModel = function (a) {
        this.taskModel.set(a);
        return this
      };
      f.prototype.initExecutor = function () {
        var a = this;
        this.requestSubView(b, {membersCollection: this.membersCollection, selected: [this._executorId], select: function (b) {
          a._executorId = b;
          a.updateModel({_executorId: b});
          return a.focus()
        }}).setup(this.$executorHandler, {direction: this.options.direction});
        return this
      };
      f.prototype.initDatePicker = function () {
        var a,
          b = this;
        a = !1;
        if (!this.$duedateHandler.data("datepicker"))this.$duedateHandler.datepicker({format: "mm-dd-yyyy", placement: "bottom" === this.options.direction ? "left" : "top", language: "zh-CN", todayHighlight: !0, todayBtn: "linked", tomorrowBtn: "linked", somedayBtn: "linked"}).on("changeDate",function (a) {
          if (b.$el)return b.updateModel({dueDate: a.date}), b.$duedateHandler.datepicker("hide"), b.focus()
        }).on("click",function () {
          a = !a;
          return b.$duedateHandler.data("datepicker").picker.toggle(a)
        }).on("hide", function () {
          return a = !1
        });
        return this
      };
      f.prototype.initMover = function () {
        var a = this;
        this.requestSubView(g, {$opener: this.$tasklistHandler, model: this.taskModel, _projectId: this._projectId, collection: n, select: function (b) {
          a.tasklistModel = b;
          a.updateModel({_tasklistId: b.id});
          return a.focus()
        }});
        return this
      };
      f.prototype.initInvolve = function () {
        this.$(".involve-view").remove();
        this.involveView = this.requestSubView(e, {objectModel: this.taskModel, membersCollection: this.membersCollection, resident: [t.id], showTitle: !0});
        this.involveView.$el.appendTo(this.$(".creator-handler-set.involve"));
        return this
      };
      f.prototype.renderExecutor = function () {
        var a;
        a = this.membersCollection.get(this._executorId);
        this.$executorHandler.find(".avatar").css({"background-image": "url(" + a.get("avatarUrl") + ")"});
        this.$executorHandler.find(".name").text(a.get("name"));
        return this
      };
      f.prototype.renderDueDate = function () {
        var a;
        a = (a = this.taskModel.get("dueDate")) ? m.formatDate(a).dateString : "";
        this.$duedateHandler.find(".due-text").text(a);
        return this
      };
      f.prototype.renderTasklist = function () {
        this.$tasklistHandler.find(".tasklist-title").text(this.tasklistModel.get("title"));
        return this
      };
      f.prototype.cacheTask = function () {
        var a;
        a = this.taskModel.toJSON();
        a.content = this.$input.val().trim();
        this.localCache(this.localCacheId, a.content ? a : null);
        return this
      };
      f.prototype.submit = function (a) {
        var b = this;
        null != a && a.preventDefault();
        if (!this.$submit.prop("disabled"))return(a = this.$input.val().trim()) ? (this.disableSubmit(!0), this.updateModel({content: a}), this.tasksCollection.create(this.taskModel, {wait: !0, error: function () {
          b.disableSubmit(!1);
          return b.focus()
        }, success: function (a) {
          var d;
          a.set("tasklist", b.tasklistModel.toJSON());
          b.localCache.remove(b.localCacheId);
          "function" === typeof(d = b.options).success && d.success(a);
          b.disableSubmit(!1);
          return b.close()
        }})) : this.focus(), !1
      };
      f.prototype.disableSubmit = function (a) {
        this.$submit.prop("disabled", a);
        this.$submit[a ? "addClass" : "removeClass"]("disabled");
        return this
      };
      f.prototype.quickSubmit = function (a) {
        13 === a.keyCode && (a.preventDefault(), this.submit(a));
        return this
      };
      f.prototype.close = function () {
        var a, b, d;
        null != (b = this.parentView) && b.hide ?
          "function" === typeof(a = this.parentView).hide && a.hide() : null != (d = this.parentView) && d.remove();
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/dashboard/post-creator/templates/basic", [], function () {
  return function (d) {
    return'<section class="post-creator-content"> <div class="post-editor-wrapper"></div></section><footer class="post-creator-footer"> <div class="involve-set"> <ul class="involve-members"></ul> </div> <button class="btn btn-primary submit-handler" data-gta="event" data-label="submit post">  </button></footer>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/dashboard/post-creator/index", "view warehouse views/wall/post-editor/index views/member/member-involve/index models/post collections/members ./templates/basic".split(" "), function (d, b, e, g, k, h, l) {
    var n, m;
    n = teambition.user;
    return function (d) {
      function f() {
        return m = f.__super__.constructor.apply(this,
          arguments)
      }

      a(f, d);
      f.prototype.className = "dashboard-post-creator";
      f.prototype.events = {"click .submit-handler": "submit", "keydown .post-editor-textarea": "quickSubmit"};
      f.prototype.initialize = function (a) {
        if (null == a || !a._projectId || null == a || !a.postsCollection)return!1;
        this.options = _.extend({success: function () {
        }}, a);
        this._projectId = a._projectId;
        this.postModel = b.createModel(k, {_creatorId: n.id, _projectId: this._projectId});
        this.postsCollection = a.postsCollection;
        this.membersCollection = b.get(h, this._projectId);
        this.renderBasic().initPostEditor().initInvolve();
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(l());
        this.$editor = this.$(".post-editor-wrapper");
        this.$handlers = this.$(".post-editor-handler-set");
        this.$involveSet = this.$(".involve-set");
        this.$submit = this.$(".submit-handler");
        return this
      };
      f.prototype.initPostEditor = function () {
        this.postEditorView = this.requestSubView(e, {_projectId: this._projectId, postModel: this.postModel, onOpen: !0});
        this.postEditorView.$el.appendTo(this.$editor);
        return this
      };
      f.prototype.onOpen = function () {
        var a;
        null != (a = this.postEditorView) && a.initEditor();
        return this
      };
      f.prototype.initInvolve = function () {
        this.involveView && (this.involveView.remove(), delete this.involveView);
        this.involveView = this.requestSubView(g, {objectModel: this.postModel, membersCollection: this.membersCollection, resident: [teambition.user.id], $list: this.$(".involve-members")});
        this.involveView.$el.prependTo(this.$involveSet);
        return this
      };
      f.prototype.quickSubmit = function (a) {
        a.ctrlKey && 13 === a.keyCode && this.submit(a);
        return this
      };
      f.prototype.submit = function () {
        var a, b = this;
        if (!this.$submit.prop("disabled"))return a = this.postEditorView.save(), null != a && a.content ? (a = _.extend(this.postModel.toJSON(), a), this.disableSubmit(!0), this.postsCollection.create(a, {_projectId: this._projectId, wait: !0, error: function () {
          b.disableSubmit(!1);
          return b.postEditorView.focus()
        }, success: function (a) {
          b.options.success(a);
          b.disableSubmit(!1);
          return b.close()
        }})) : this.postEditorView.focus(), this
      };
      f.prototype.disableSubmit = function (a) {
        this.$submit.prop("disabled",
          a);
        this.$submit[a ? "addClass" : "removeClass"]("disabled");
        return this
      };
      f.prototype.close = function () {
        var a, b, d;
        return null != (b = this.parentView) && b.hide ? "function" === typeof(a = this.parentView).hide ? a.hide() : void 0 : null != (d = this.parentView) ? d.remove() : void 0
      };
      return f
    }(d)
  })
}).call(this);
define("views/dashboard/dashboard-creator/templates/header", [], function () {
  return function (d) {
    return'<header class="modal-dialog-header"> <a class="close-window-handler pull-right icon icon-remove" data-dismiss="modal" data-gta="event" data-label="close creator in dashboard"></a> <h3 class="modal-dialog-title">' + d.title + "</h3></header>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/dashboard/dashboard-creator/index", ["lib/window/index", "views/dashboard/task-creator/index", "views/dashboard/post-creator/index", "views/events/event-creator/index", "./templates/header"], function (d, b, e, g, k) {
    var h;
    return function (d) {
      function f() {
        return h = f.__super__.constructor.apply(this,
          arguments)
      }

      a(f, d);
      f.prototype.viewName = "DashboardCreatorView";
      f.prototype.className = "dashboard-creator-view fade card";
      f.prototype.initialize = function (a) {
        this.options = _.extend({backdrop: "static"}, a);
        this.renderBasic();
        return this
      };
      f.prototype.renderBasic = function () {
        var a, d;
        switch (this.options.type) {
          case "task":
            d = "";
            a = b;
            break;
          case "post":
            d = "";
            a = e;
            break;
          case "event":
            d = "", a = g
        }
        this.open(a, this.options);
        this.$el.prepend(k({title: d}));
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/dashboard/events-card/templates/basic", [], function () {
  return function (d) {
    return'<header class="card-header">  <a class="pull-right open-creator" data-type="event" data-gta="event" data-label="open event creator in dashboard"> <span class="icon icon-plus"></span>  </a></header><section class="card-content"> <ul class="events-list" data-gta="event" data-label="open event detail in dashboard"></ul> <a class="enter-app-handler enter-events-handler" data-app-name="events" data-gta="event" data-label="enter events from dashboard"></a></section>'
  }
});
define("views/dashboard/events-card/templates/event", [], function () {
  return function (d) {
    var a = '<li class="event open-detail" data-id="' + d._id + '" data-date="' + d.date + '" data-type="event"  data-gta=\'event\' data-label=\'dashboard |open event detail\'> <div class="event-content"> <p class="event-title"> ' + d.title + " </p> ";
    d.location && (a += ' <p class="event-place muted">' + d.location + "</p> ");
    a += ' </div> <div class="event-time"> <time>' + d.startDateString + "</time> ";
    d.endDateString && (a += " <time>" + d.endDateString +
      "</time> ");
    return a + " </div></li>"
  }
});
define("views/dashboard/events-card/templates/event-date", [], function () {
  return function (d) {
    return'<li class="event-date-wrap" data-date="' + d.date + '"> <span class="event-date">' + d.dateString + "</span></li>"
  }
});
define("views/dashboard/events-card/templates/placeholder", [], function () {
  return function (d) {
    return'<div class="event-placeholder placeholder muted"> <a class="icon icon-calendar"></a> <br /> </div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/dashboard/events-card/index", "view moment util warehouse collections/projects collections/members ./templates/basic ./templates/event ./templates/event-date ./templates/placeholder".split(" "), function (d, b, e, g, k, h, l, n, m, s) {
    var r;
    return function (d) {
      function f() {
        return r = f.__super__.constructor.apply(this,
          arguments)
      }

      a(f, d);
      f.prototype.className = "dashboard-events card";
      f.prototype.initialize = function (a) {
        if (null == a || !a.eventsCollection || null == a || !a._projectId)return!1;
        this.options = a;
        this._projectId = a._projectId;
        this.projectModel = g.get(k, null, this._projectId);
        this.eventsCollection = a.eventsCollection;
        this.membersCollection = g.get(h, this._projectId);
        this.renderBasic().listen();
        0 < this.eventsCollection.length ? this.renderEvents() : this.renderPlaceholder();
        return this
      };
      f.prototype.listen = function () {
        var a = this;
        this.listenTo(this.eventsCollection, "add change", function (b) {
          a.$(".event-placeholder").remove();
          return a.renderEvent(b, !0)
        });
        this.listenTo(this.eventsCollection, "destroy remove", function (b) {
          a.$(".event[data-id=" + b.id + "]").remove();
          if (!a.eventsCollection.length)return a.renderPlaceholder()
        });
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(l());
        this.$events = this.$(".events-list");
        this.$content = this.$(".card-content");
        return this
      };
      f.prototype.renderEvents = function () {
        var a = this;
        this.eventsCollection.each(function (b) {
          return a.renderEvent(b)
        });
        return this
      };
      f.prototype.renderEvent = function (a) {
        var d, f, g, h;
        g = a.toJSON();
        g.startDateString = b(g.startDate).format("HH:mm");
        h = e.formatDate(new Date(g.startDate)).dateString;
        f = b("today" === a.getScope() ? new Date : g.startDate);
        d = {date: f.format("YYYYMMDD"), dateString: e.formatDate(f).dateString};
        f = this.getOrRenderEventDate(d);
        h !== d.dateString && (g.startDateString = d.dateString + " " + g.startDateString);
        null != g.endDate && (h = e.formatDate(new Date(g.endDate)).dateString, g.endDateString = b(g.endDate).format("HH:mm"),
          g.startDateString += " - ", h !== d.dateString ? g.endDateString = h + " " + g.endDateString : (g.startDateString += g.endDateString, g.endDateString = ""));
        g.date = d.date;
        d = $(n(g));
        h = this.$events.find(".event[data-id=" + a.id + "]");
        a = h.data("date") + "";
        h.length && a === g.date ? h.replaceWith(d) : (h.remove(), g = this.$events.find("[data-date=" + a + "]"), 1 >= g.length && g.remove(), d.insertAfter(f));
        return this
      };
      f.prototype.getOrRenderEventDate = function (a) {
        var b;
        this.eventDates || (this.eventDates = []);
        b = this.$events.find(".event-date-wrap[data-date=" +
          a.date + "]");
        b.length || (b = $(m(a)), this.eventDates.push(+a.date), this.eventDates.sort(), a = this.eventDates.indexOf(+a.date), a < this.eventDates.length - 1 ? b.insertBefore(this.$events.find(".event-date-wrap[data-date=" + this.eventDates[a + 1] + "]")) : b.appendTo(this.$events));
        return b
      };
      f.prototype.renderPlaceholder = function () {
        this.$(".event-placeholder").remove();
        this.$content.prepend(s());
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/dashboard/posts-card/templates/basic", [], function () {
  return function (d) {
    return'<header class="card-header">  <a class="pull-right open-creator" data-type="post" data-gta="event" data-label="open post creator in dashboard"> <span class="icon icon-plus"></span>  </a></header><section class="card-content"> <ul class="posts-list" data-gta="event" data-label="open post detail in dashboard"></ul> <a class="enter-app-handler enter-wall-handler" data-app-name="wall" data-gta="event" data-label="enter wall from dashboard"></a></section>'
  }
});
define("views/dashboard/posts-card/templates/post", [], function () {
  return function (d) {
    var a = '<li class="post post-' + d._id + ' open-detail" data-id="' + d._id + '" data-type="post" data-gta=\'event\' data-label=\'dashboard |open post detail\'> <div class="avatar img-24 img-circle pull-left" style="background-image: url(' + d.creator.avatarUrl + ');"></div> <div class="post-content"> <p class="post-title" >' + d.description + '</p> <p class="post-info muted"> ' + d.creator.name + '<time datetime="' + d.created + '"></time>';
    d.activitiesCount && (a += ", " + d.activitiesCount + "");
    return a + " </p> </div></li>"
  }
});
define("views/dashboard/posts-card/templates/placeholder", [], function () {
  return function (d) {
    return'<div class="post-placeholder placeholder muted"> <a class="icon icon-wall"></a> <br /> </div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/dashboard/posts-card/index", "view warehouse collections/projects collections/members ./templates/basic ./templates/post ./templates/placeholder".split(" "), function (d, b, e, g, k, h, l) {
    var n;
    return function (d) {
      function f() {
        return n = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.className =
        "dashboard-posts card";
      f.prototype.initialize = function (a) {
        if (null == a || !a.postsCollection || null == a || !a._projectId)return!1;
        this.options = a;
        this._projectId = a._projectId;
        this.projectModel = b.get(e, null, this._projectId);
        this.postsCollection = a.postsCollection;
        this.membersCollection = b.get(g, this._projectId);
        this.renderBasic().listen();
        0 < this.postsCollection.length ? this.renderPosts() : this.renderPlaceholder();
        return this
      };
      f.prototype.listen = function () {
        var a = this;
        this.listenTo(this.postsCollection, "add change",
          function (b) {
            a.$(".post-placeholder").remove();
            return a.renderPost(b, !0)
          });
        this.listenTo(this.postsCollection, "destroy remove", function (b) {
          a.$(".post[data-id=" + b.id + "]").remove();
          if (!a.postsCollection.length)return a.renderPlaceholder()
        });
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(k());
        this.$content = this.$(".card-content");
        this.$posts = this.$(".posts-list");
        return this
      };
      f.prototype.renderPosts = function () {
        var a = this;
        this.postsCollection.each(function (b) {
          return a.renderPost(b)
        });
        return this
      };
      f.prototype.renderPost = function (a, b) {
        var d, e;
        d = a.toJSON();
        d.creator = (null != (e = this.membersCollection.get(d._creatorId)) ? e.toJSON() : void 0) || {};
        d = $(h(d));
        d.find("time").timesince();
        e = this.$posts.find(".post[data-id=" + a.id + "]");
        if (e.length)e.replaceWith(d); else this.$posts[!0 === b ? "prepend" : "append"](d);
        return this
      };
      f.prototype.renderPlaceholder = function () {
        this.$(".post-placeholder").remove();
        this.$content.prepend(l());
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/dashboard/tasks-card/templates/basic", [], function () {
  return function (d) {
    return'<header class="card-header">  <a class="pull-right open-creator" data-type="task" data-gta="event" data-label="open task creator in dashboard"> <span class="icon icon-plus"></span>  </a></header><section class="card-content"> <ul class="tasks-list" data-gta="event" data-label="open task detail in dashboard"></ul> <a class="enter-app-handler enter-board-handler" data-app-name="board" data-gta="event" data-label="enter board from dashboard"></a></section>'
  }
});
define("views/dashboard/tasks-card/templates/placeholder", [], function () {
  return function (d) {
    return'<div class="task-placeholder placeholder muted"> <a class="icon icon-board"></a> <br /> </div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/dashboard/tasks-card/index", "view warehouse collections/projects collections/members views/board/task/task/index ./templates/basic ./templates/placeholder".split(" "), function (d, b, e, g, k, h, l) {
    var n;
    return function (d) {
      function f() {
        return n = f.__super__.constructor.apply(this, arguments)
      }

      a(f,
        d);
      f.prototype.className = "dashboard-tasks card";
      f.prototype.initialize = function (a) {
        if (null == a || !a.tasksCollection || null == a || !a._projectId)return!1;
        this.options = a;
        this._projectId = a._projectId;
        this.projectModel = b.get(e, null, this._projectId);
        this.tasksCollection = a.tasksCollection;
        this.membersCollection = b.get(g, this._projectId);
        this.renderBasic().listen();
        0 < this.tasksCollection.length ? this.renderTasks() : this.renderPlaceholder();
        return this
      };
      f.prototype.listen = function () {
        var a = this;
        this.listenTo(this.tasksCollection,
          "add", function (b) {
            a.$(".task-placeholder").remove();
            return a.renderTask(b, !0)
          });
        this.listenTo(this.tasksCollection, "destroy remove", function (b) {
          if (!a.tasksCollection.length)return a.renderPlaceholder()
        });
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(h());
        this.$content = this.$(".card-content");
        this.$tasks = this.$(".tasks-list");
        return this
      };
      f.prototype.renderTasks = function () {
        var a = this;
        this.tasksCollection.each(function (b) {
          return a.renderTask(b)
        });
        return this
      };
      f.prototype.renderTask =
        function (a, b) {
          var d;
          d = !0 === b ? "prependTo" : "appendTo";
          this.requestSubView(k, {model: a}).$el[d](this.$tasks);
          return this
        };
      f.prototype.renderPlaceholder = function () {
        this.$(".task-placeholder").remove();
        this.$content.prepend(l());
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/dashboard/works-card/templates/basic", [], function () {
  return function (d) {
    return'<div class="dashboard-works card"> <header class="card-header">  <a class="pull-right work-creator-handler" data-gta="event" data-label="upload work in dashboard"> <span class="icon icon-plus"></span>  </a> </header> <section class="card-content"> <ul class="works-list clearfix" data-gta="event" data-label="open work detail in dashboard"></ul> <a class="enter-app-handler enter-library-handler" data-app-name="library" data-gta="event" data-label="enter library from dashboard"></a> </section></div>'
  }
});
define("views/dashboard/works-card/templates/work", [], function () {
  return function (d) {
    var a = '<li class="work open-detail clearfix" data-type="work" data-id="' + d._id + '" data-gta="event" data-label=\'dashboard |open work detail\'> <p class="work-title pull-left" rel="collection-' + d._collectionId + '" title="' + d.fileName + '"> ', a = "image" === d.fileCategory ? a + (' <div class="work-thumbnail" style="background-image: url(' + d.thumbnail + ');"> </div> ') : a + (' <div class="work-thumbnail ' + d.fileType + '">' + d.fileType +
      "</div> ");
    return a += " " + d.fileName + ' </p> <p class="work-info muted"> <span class="work-author"> ' + d.creator.name + ' <time class="work-created" datetime="' + d.created + '"></time> </span> <span class="work-comments pull-right"> <span class="icon icon-comment"></span> ' + d.activitiesCount + " </span> </p></li>"
  }
});
define("views/dashboard/works-card/templates/placeholder", [], function () {
  return function (d) {
    return'<div class="work-placeholder placeholder muted"> <a class="icon icon-library"></a> <br /> </div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/dashboard/works-card/index", "view warehouse collections/projects collections/members collections/works views/work/work-uploader/index ./templates/basic ./templates/work ./templates/placeholder".split(" "), function (d, b, e, g, k, h, l, n, m) {
    var s;
    return function (d) {
      function f() {
        return s = f.__super__.constructor.apply(this,
          arguments)
      }

      a(f, d);
      f.prototype.className = "dashboard-works card";
      f.prototype.initialize = function (a) {
        if (null == a || !a.worksCollection || null == a || !a._projectId)return!1;
        this.options = a;
        this._projectId = a._projectId;
        this.projectModel = b.get(e, null, this._projectId);
        this.worksCollection = a.worksCollection;
        this.membersCollection = b.get(g, this._projectId);
        this.renderBasic().initUploader().listen();
        0 < this.worksCollection.length ? this.renderWorks() : this.renderPlaceholder();
        return this
      };
      f.prototype.listen = function () {
        var a =
          this;
        this.listenTo(this.worksCollection, "add change", function (b) {
          a.$(".work-placeholder").remove();
          return a.renderWork(b, !0)
        });
        this.listenTo(this.worksCollection, "destroy remove", function (b) {
          a.$(".work[data-id=" + b.id + "]").remove();
          if (!a.worksCollection.length)return a.renderPlaceholder()
        });
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(l());
        this.$content = this.$(".card-content");
        this.$works = this.$(".works-list");
        return this
      };
      f.prototype.renderWorks = function () {
        var a = this;
        this.worksCollection.each(function (b) {
          return a.renderWork(b)
        });
        return this
      };
      f.prototype.renderWork = function (a, b) {
        var d, e;
        d = a.toJSON();
        d.creator = this.membersCollection.get(d._creatorId).toJSON();
        d = $(n(d));
        d.find("time").timesince();
        e = this.$works.find(".work[data-id=" + a.id + "]");
        if (e.length)e.replaceWith(d); else this.$works[!0 === b ? "prepend" : "append"](d);
        return this
      };
      f.prototype.renderPlaceholder = function () {
        this.$(".work-placeholder").remove();
        this.$content.prepend(m());
        return this
      };
      f.prototype.initUploader = function () {
        var a = this;
        this.requestSubView(h, {_projectId: this._projectId,
          location: "wall", pick: {id: this.$(".work-creator-handler"), multiple: !0}, dnd: this.$content, success: function (d) {
            var e;
            if (d.length)return a.worksCollection.add(d), null != (e = b.get(k, d[0]._collectionId)) ? e.add(d) : void 0
          }});
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/dashboard/dashboard/templates/basic", [], function () {
  return function (d) {
    return'<header class="dashboard-header clearfix"></header><section class="dashboard-body"> <div class="dashboard-content-wrapper clearfix"> <div class="card-wrap-left"></div> <div class="card-wrap-right"></div> </div></section>'
  }
});
define("views/dashboard/dashboard/templates/header", [], function () {
  return function (d) {
    return'<ul class="nav nav-underscore"> <li> <a class="project-title"> <h3>' + d.name + "</h3>" + (d.description || "") + ' </a> <a class="project-edit-handler icon icon-cog"></a> </li></ul>'
  }
});
define("views/dashboard/dashboard/templates/guide", [], function () {
  return function (d) {
    return'<div class="guide-view"> <div class="guide-close"> </div> <div class="guide-switcher-detail guide-detail-wrapper"> <div class="guide-content-main"> <h2></h2> <hr> <p></p> <p></p> </div> <div class="handler-wrapper clearfix"> <a class="btn btn-primary pull-right guide-next1" data-gta="event" data-label="guide|wall|next1"></a> </div> </div> <div class="guide-memberlist-detail guide-detail-wrapper"> <div class="guide-content-main"> <h2></h2> <hr> <p>  </p> </div> <div class="handler-wrapper clearfix"> <a class="btn btn-primary pull-right guide-next2" data-gta="event" data-label="guide|wall|next2"></a> </div> </div></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/dashboard/dashboard/index", "view lib/window/index views/board/task/task-detail-panel/index views/events/event-detail-panel/index views/wall/post-panel/index views/library/previewer/index views/dashboard/dashboard-creator/index views/dashboard/events-card/index views/dashboard/posts-card/index views/dashboard/tasks-card/index views/dashboard/works-card/index views/settings/project-settings/index util moment warehouse collections/tasks collections/posts collections/works collections/events collections/members collections/projects ./templates/basic ./templates/header ./templates/guide jquery.cookie".split(" "),
    function (d, b, e, g, k, h, l, n, m, s, r, t, v, p, x, B, C, z, A, u, w, y, J, F) {
      var H, E, I;
      H = teambition.APP;
      E = teambition.router;
      return function (d) {
        function f() {
          return I = f.__super__.constructor.apply(this, arguments)
        }

        a(f, d);
        f.prototype.viewName = "DashboardView";
        f.prototype.className = "dashboard-view";
        f.prototype.routes = {":type/:_modelId": "enterDetail", "*paramString": "dashboard"};
        f.prototype.events = {"click .open-creator": "openCreator", "click .open-detail": "openDetail", "click .project-edit-handler": "showProjectSettings", "click .enter-app-handler": "enterApp"};
        f.prototype.initialize = function (a) {
          this.options = null != a ? a : {};
          this._projectId = a._projectId;
          a = "" + this._projectId + "_dashboard";
          this.tasksCollection = x.get(B, a);
          this.postsCollection = x.get(C, a);
          this.worksCollection = x.get(z, a);
          this.eventsCollection = x.get(A, a);
          this.tasksCollection.comparator = function (a) {
            return-(new Date(a.get("created"))).getTime()
          };
          this.membersCollection = x.request(u, this._projectId);
          this.projectModel = x.get(w, null, this._projectId);
          this.renderBasic().renderHeader().load();
          return this
        };
        f.prototype.dashboard =
          function () {
            this.updateUrl({}, {trigger: !1});
            return this
          };
        f.prototype.enterDetail = function (a, b) {
          this.openDetail(a, b);
          return this
        };
        f.prototype.listen = function () {
          var a = this;
          this.listenTo(this.projectModel, "change", function () {
            return a.renderHeader()
          });
          return this
        };
        f.prototype.load = function () {
          var a, b = this;
          a = function (a) {
            var b;
            for (b = []; 5 < a.length;)b.push(a.pop());
            return b
          };
          x.fetch("dashboard", this._projectId, {expires: 0, params: {_projectId: this._projectId}, beforeSend: function () {
            return b.showLoadingIndicator(b.$dashboardBody)
          },
            success: function (d) {
              var e;
              b.hideLoadingIndicator();
              e = {remove: !1, parse: !0};
              b.tasksCollection.set(d.tasks, e);
              b.postsCollection.set(d.posts, e);
              b.worksCollection.set(d.works, e);
              b.eventsCollection.set(d.events, e);
              a(b.tasksCollection);
              a(b.postsCollection);
              a(b.worksCollection);
              a(b.eventsCollection);
              return b.renderWorksCard().renderTasksCard().renderPostsCard().renderEventsCard().listen()
            }});
          return this
        };
        f.prototype.renderBasic = function () {
          this.$el.html(y(this.projectModel.toJSON()));
          this.$header = this.$(".dashboard-header");
          this.$dashboardBody = this.$(".dashboard-body");
          return this
        };
        f.prototype.renderHeader = function () {
          this.$header.html(J(this.projectModel.toJSON()));
          return this
        };
        f.prototype.renderTasksCard = function () {
          this.requestSubView(s, {tasksCollection: this.tasksCollection, _projectId: this._projectId}).$el.prependTo(this.$(".card-wrap-left"));
          return this
        };
        f.prototype.renderWorksCard = function () {
          this.requestSubView(r, {worksCollection: this.worksCollection, _projectId: this._projectId}).$el.prependTo(this.$(".card-wrap-left"));
          return this
        };
        f.prototype.renderPostsCard = function () {
          this.requestSubView(m, {postsCollection: this.postsCollection, _projectId: this._projectId}).$el.prependTo(this.$(".card-wrap-right"));
          return this
        };
        f.prototype.renderEventsCard = function () {
          this.requestSubView(n, {eventsCollection: this.eventsCollection, _projectId: this._projectId}).$el.appendTo(this.$(".card-wrap-right"));
          return this
        };
        f.prototype.updateUrl = function (a, b) {
          var d, e, f;
          b = b || {};
          d = a.type;
          f = a._modelId;
          e = E.getPrefix() + "/home";
          d && f && (e += "/" + d + "/" +
            f, a.params && (e += "/" + a.params));
          E.navigate(e, b);
          return this
        };
        f.prototype.openCreator = function (a) {
          var b;
          b = $(a.currentTarget).data("type");
          a = {type: b, _projectId: this._projectId};
          switch (b) {
            case "task":
              a.tasksCollection = this.tasksCollection;
              a.success = function (a) {
                var b;
                return null != (b = x.get(B, a.get("_tasklistId"))) ? b.add(a.toJSON()) : void 0
              };
              break;
            case "post":
              a.postsCollection = this.postsCollection;
              a.success = function (a) {
                var b;
                return null != (b = x.get(C, a.get("_projectId"))) ? b.add(a.toJSON()) : void 0
              };
              break;
            case "event":
              a.eventsCollection =
                this.eventsCollection;
              a.success = function (a) {
                var b;
                return null != (b = x.get(A, a.get("_projectId"))) ? b.add(a.toJSON()) : void 0
              };
              break;
            default:
              return
          }
          this.requestSubView(l, a);
          return this
        };
        f.prototype.openDetail = function (a, d) {
          var f, l, m;
          _.isObject(a) ? (f = $(a.currentTarget), m = f.data("type"), f = f.data("id")) : (m = a, f = d);
          switch (m) {
            case "task":
              H.showPanel(e, {_projectId: this._projectId, _taskId: f, taskModel: this.tasksCollection.get(f)});
              break;
            case "event":
              H.showPanel(g, {_projectId: this._projectId, _eventId: f, eventModel: this.eventsCollection.get(f)});
              break;
            case "post":
              H.showPanel(k, {_projectId: this._projectId, _postId: f, postModel: this.postsCollection.get(f), hideActivityCreator: !0, membersCollection: this.membersCollection});
              break;
            case "work":
              l = this.worksCollection.get(f);
              l = {_projectId: this._projectId, workModel: l, workModels: [l]};
              this.requestSubView(b).open(h, l);
              break;
            default:
              m = ""
          }
          this.updateUrl({type: m, _modelId: f}, {trigger: !1});
          return this
        };
        f.prototype.enterApp = function (a) {
          a = $(a.currentTarget).data("appName");
          a = E.getUrl().replace(/(home)+\S*/, a);
          E.navigate(a, {trigger: !0});
          return this
        };
        f.prototype.showProjectSettings = function () {
          this.requestSubView(b).open(t, {projectModel: this.projectModel, tab: "project-info"});
          return this
        };
        f.prototype.guideView = function () {
          var a, b, d, e, f, g, h = this;
          $(".guide-view").remove();
          $(".guide-on").removeClass("guide-on");
          a = $(F());
          f = a.find(".guide-switcher-detail");
          d = a.find(".guide-memberlist-detail");
          e = $(".app-switcher").addClass("guide-on");
          b = $(".member-bar");
          a.appendTo("body");
          f.animate({opacity: 1}, 600);
          g = function (a) {
            return a.stopPropagation()
          };
          this.guideView.destroy = function () {
            e.children().off(".guide");
            b.children().off(".guide");
            e.removeClass("guide-on");
            b.removeClass("guide-on");
            a.remove();
            return h.guideView.response = h.guideView.destroy = null
          };
          e.children().on("click.guide", g);
          b.children().on("click.guide", g);
          a.find(".guide-next1").one("click", function () {
            return f.animate({opacity: 0}, 600, function () {
              e.removeClass("guide-on");
              b.addClass("guide-on");
              return d.animate({opacity: 1}, 600)
            })
          });
          a.find(".guide-next2").one("click", function () {
            return d.animate({opacity: 0},
              400, function () {
                var a;
                h.guideView.destroy();
                a = E.getPrefix() + "/board";
                return E.navigate(a, {trigger: !0})
              })
          });
          return this
        };
        return f
      }(d)
    })
}).call(this);
define("views/library/collection/collection/templates/basic", [], function () {
  return function (d) {
    return'<header class="collection-header"> <ul class="nav nav-underscore"> <li> <a class="nav-back" data-gta="event" data-label="nav back" data-action="click" data-category="a" data-value="i4"> <span class="icon icon-chevron-left"></span> <h3></h3> </a> </li> <li class="pull-right"> <div class="btn btn-primary add-works-handler" data-gta="event" data-label="upload work" data-action="click" data-category="div" data-value="i8" style="position:relative;"> <span class="icon icon-arrow-up"></span>  </div> </li> </ul></header><div class="collection-wrapper"> <div class="collection card"> <div class="collection-info card-header"></div> <div class="collection-content card-content card-content-fill"> <ul class="collection-works-list"></ul> </div> </div></div>'
  }
});
define("views/library/collection/collection/templates/info", [], function () {
  return function (d) {
    var a = '<h3 class="collection-title card-title"> ' + d.title + "  " + d.workCount + '</h3><p class="collection-abstract card-description"> ';
    d.description && (a += " " + d.description + "&nbsp;&nbsp; ");
    return a += ' <time class="collection-update-time" datetime="' + d.updated + '"> ' + d.updated + " </time></p>"
  }
});
define("views/library/collection/collection/templates/work", [], function () {
  return function (d) {
    var a = '<li class="work ' + d.fileCategory + '-work clearfix " id="' + d._id + '" data-gta="event" data-label="open work detail" data-action="click" data-category="li" data-value="i9"> <div class="work-title pull-left" rel="collection-' + d._collectionId + '" title="' + d.fileName + '"> ', a = "image" === d.fileCategory ? a + (' <div class="work-thumbnail" style="background-image: url(' + d.thumbnail + ');"> </div> ') : a + (' <div class="work-thumbnail ' +
      d.fileType + '">' + d.fileType + "</div> ");
    return a += " " + d.fileName + ' </div> <div class="work-modified pull-left"> <span class="work-author">' + (d.creator.name || "") + '</span> <time class="work-updated"> ' + d.updatedDataString.dateString + ' </time> </div> <div class="work-comments pull-right"> <span class="icon icon-comment"></span> ' + d.activitiesCount + " </div></li>"
  }
});
define("views/library/collection/collection/templates/placeholder", [], function () {
  return function (d) {
    return'<li class="work clearfix"> <div class="work-title pull-left"> <div class="work-thumbnail">file</div> collectionMainPlaceholder </div></li>'
  }
});
define("views/library/collection/collection/templates/endpoint", [], function () {
  return function (d) {
    return'<div class="end-point-wrapper"> <span class="end-point"></span></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/library/collection/collection/index", "view lib/window/index views/work/work-uploader/index views/library/previewer/index warehouse models/work collections/works collections/collections collections/members util thenjs moment lib/scrollable ./templates/basic ./templates/info ./templates/work ./templates/placeholder ./templates/endpoint".split(" "), function (d, b, e, g, k, h, l, n, m, s, r, t, v, p, x, B, C, z) {
    var A, u;
    A = teambition.APP;
    d = function (d) {
      function f() {
        return u = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "CollectionView";
      f.prototype.tagName = "div";
      f.prototype.className = "collection-view";
      f.prototype.events = {"click .work": "showWorkDetail", "click .nav-back": "back"};
      f.prototype.initialize = function (a) {
        if (null != a && a._projectId && null != a && a._collectionId)return this.options = a, this._projectId = a._projectId, this._collectionId = a._collectionId,
          this.membersCollection = k.get(m, this._projectId), this.render().load(a), this
      };
      f.prototype.reset = function (a, b) {
        this.collectionModel = a;
        this.worksCollection = b;
        this.listenTo(a, "change", this.renderCollectionInfo);
        this.listenTo(b, "remove", this.removeWork);
        this.listenTo(b, "add", this.renderWork);
        this.listenTo(b, "change", this.refreshWork);
        return this
      };
      f.prototype.load = function (a) {
        var b = this;
        this.onLoading();
        r.parallel([function (a) {
          return k.request(n, b._projectId, {success: function (b) {
            return a(null, b)
          }, error: function (b) {
            return a(b,
              null)
          }})
        }, function (a) {
          return k.request(l, b._collectionId, {success: function (b) {
            return a(null, b)
          }, error: function (b) {
            return a(b, null)
          }})
        }]).all(function (d, e, f) {
            var g;
            if (e)return a.onError ? a.onError(e) : "function" === typeof(g = A.currentView).onRouteError ? g.onRouteError() : void 0;
            d = f[0].get(b._collectionId);
            b.reset(d, f[1]).renderCollectionInfo().renderWorks().initUploader().onLoaded().setupScroll($(document), {noShadow: !0});
            if (b.options._workId)return b.showWorkDetail(b.options._workId)
          });
        return this
      };
      f.prototype.onLoading =
        function () {
          this.showLoadingIndicator(this.$wrapper, {isPrepend: !0});
          this.$collection.hide();
          return this
        };
      f.prototype.onLoaded = function () {
        this.$collection.show();
        this.hideLoadingIndicator({animated: !0});
        this.setupPlaceholder(this.worksCollection, "work");
        this.setupScroll($("#content-wrapper"), {noShadow: !0});
        return this
      };
      f.prototype.render = function () {
        this.$el.html(p());
        this.$wrapper = this.$(".collection-wrapper");
        this.$collection = this.$(".collection");
        this.$infoset = this.$(".collection-info");
        this.$header =
          this.$(".collection-header");
        this.$worksList = this.$(".collection-works-list");
        this.$addWorksHandler = this.$(".add-works-handler");
        return this
      };
      f.prototype.renderWorks = function (a) {
        var b, d, e;
        a || (a = this.worksCollection.toJSON(), this.$worksList.empty());
        d = 0;
        for (e = a.length; d < e; d++)b = a[d], this.renderWork(b, "append");
        return this
      };
      f.prototype.renderWork = function (a, b) {
        var d;
        d = this.assembleWorkData(a);
        "string" !== typeof b && (b = "prepend");
        this.$worksList[b](B(d));
        return this
      };
      f.prototype.refreshWork = function (a) {
        var b;
        if ((b = this.$("#" + a.id)).length)return a = this.assembleWorkData(a), b.html($(B(a)).html())
      };
      f.prototype.renderCollectionInfo = function (a) {
        var b;
        a = a || this.collectionModel;
        this.$infoset.html(x(a.toJSON()));
        this.$(".nav-underscore h3:first").text(null != (b = a.get("title")) ? b.trim() : void 0);
        this.$infoset.find("time").timesince();
        return this
      };
      f.prototype.assembleWorkData = function (a) {
        var b;
        a = a.toJSON ? a.toJSON() : a;
        a.creator = (null != (b = this.membersCollection.get(a._creatorId)) ? b.toJSON() : void 0) || {};
        b = a.updated;
        t(b).isSame("2014-02-11T06:30:00.000Z", "day") && (b = a.created);
        a.updatedDataString = s.formatDate(b);
        return a
      };
      f.prototype.showPlaceholder = function () {
        this.$placeholder = $(C());
        this.$placeholder.appendTo(this.$(".works"));
        return this
      };
      f.prototype.hidePlaceholder = function () {
        this.$placeholder.remove();
        return this
      };
      f.prototype.loadMore = function (a) {
        var b = this;
        this.worksCollection.hasMore && this.worksCollection.loadMore({silent: !0, beforeSend: function () {
          return b.onLoadingMore()
        }, success: function (d, e, f) {
          var g,
            h, k, l;
          f = [];
          h = 0;
          for (k = e.length; h < k; h++)g = e[h], f.push(null != (l = d.get(g._id)) ? l.toJSON() : void 0);
          b.renderWorks(f);
          b.onLoadedMore();
          return b.worksCollection.hasMore ? "function" === typeof a ? a() : void 0 : b.renderEndPoint()
        }});
        return this
      };
      f.prototype.onLoadingMore = function () {
        this.showLoadingIndicator(this.$wrapper);
        return this
      };
      f.prototype.onLoadedMore = function () {
        this.hideLoadingIndicator({animated: !0});
        return this
      };
      f.prototype.renderEndPoint = function () {
        var a;
        this.$endPoint = (null != (a = this.$endPoint) ? a.remove() :
          void 0) || $(z());
        this.$endPoint.appendTo(this.$worksList);
        return this
      };
      f.prototype.initUploader = function () {
        var a;
        null != (a = this.workuploaderView) && a.remove();
        this.workuploaderView = this.requestSubView(e, {_projectId: this.options._projectId, location: "collection", pick: {id: this.$addWorksHandler, multiple: !0}, dnd: this.$header, collectionModel: this.collectionModel});
        return this
      };
      f.prototype.refreshWork = function (a) {
        var b;
        b = this.assembleWorkData(a);
        $("#" + a.id).html($(B(b)).html());
        return this
      };
      f.prototype.removeWork =
        function (a) {
          $("#" + a.id).remove();
          return this
        };
      f.prototype.showWorkDetail = function (a) {
        var b, d, e = this;
        b = {workModels: this.worksCollection.models, _projectId: this.options._projectId};
        d = "string" === typeof a ? a : $(a.currentTarget).attr("id");
        b.workModel = this.worksCollection.get(d);
        b.workModel ? this.openPreviewer(d, b) : k.fetchOne(h, d, {success: function (a) {
          b.workModel = a;
          b.workModels = [a];
          return e.openPreviewer(d, b)
        }, error: function (a) {
          b.workModel = void 0;
          b.workModels = void 0;
          return e.openPreviewer(d, b)
        }});
        return this
      };
      f.prototype.openPreviewer = function (a, d) {
        d.parentView = this;
        this.requestSubView(b).open(g, d);
        return this
      };
      f.prototype.back = function () {
        return A.currentView.updateUrl({_collectionId: null}, {trigger: !0})
      };
      return f
    }(d);
    _.extend(d.prototype, v);
    return d
  })
}).call(this);
define("views/library/collection/collection-menu/templates/basic", [], function () {
  return function (d) {
    var a = "";
    0 < d.hasRight ? (a += ' <ul class="list collection-menu-list"> <li> <a class="edit-collection-handler" data-gta="event" data-label="edit collection"> <span class="icon icon-pencil"></span> </a> </li> <li> <a class="delete-collection-handler" data-gta="event" data-label="delete collection"> <span class="icon icon-trash"></span> </a> </li> <li class="list-divider"></li> <li class="color-choise"> <ul class="clearfix"> <li class="color blue ', "blue" ==
      d.color && (a += "active"), a += '" data-color="blue"><span class="icon icon-tick icon-white"></span></li> <li class="color orange ', "orange" == d.color && (a += "active"), a += '" data-color="orange"><span class="icon icon-tick icon-white"></span></li> <li class="color green ', "green" == d.color && (a += "active"), a += '" data-color="green"><span class="icon icon-tick icon-white"></span></li> <li class="color red ', "red" == d.color && (a += "active"), a += '" data-color="red"><span class="icon icon-tick icon-white"></span></li> <li class="color inverse ',
      "inverse" == d.color && (a += "active"), a += '" data-color="inverse"><span class="icon icon-tick icon-white"></span></li> </ul> </li> </ul>') : (a += ' <p class="muted"> . ', d.hasRightMembers && (a += "" + d.hasRightMembers + "."), a += " </p>");
    return a
  }
});
define("views/library/collection/collection-menu/templates/edit", [], function () {
  return function (d) {
    return'<form class="collection-edit-form"> <input class="form-control" type="text" value="' + d.title + '" placeholder="..." data-gta="event" data-label="enter collection name" data-action="focus" data-category="input" data-value="i1-2"/> <textarea class="form-control" placeholder="..." data-gta="event" data-label="enter collection description" data-action="focus" data-category="textarea" data-value="i1-3">' + d.description +
      '</textarea> <button class="btn btn-primary" type="submit"></button></form>'
  }
});
define("views/library/collection/collection-menu/templates/delete", [], function () {
  return function (d) {
    return'<form class="collection-delete-form"> <p>?</p> <button class="btn btn-danger" type="submit"></button></form>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/library/collection/collection-menu/index", ["popover-view", "./templates/basic", "./templates/edit", "./templates/delete"], function (d, b, e, g) {
    var k;
    return function (d) {
      function f() {
        return k = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "CollectionMenuView";
      f.prototype.popoverTitle =
        "";
      f.prototype.events = {"click .color": "changeColor", "click .edit-collection-handler": "enterEditSubMenu", "click .delete-collection-handler": "enterDeleteSubMenu", "submit .collection-edit-form": "submitEditForm", "submit .collection-delete-form": "submitDeleteForm"};
      f.prototype.render = function () {
        var a;
        a = this.options.collectionModel.toJSON();
        a.hasRight = this.options.collectionModel.hasRight();
        this.$el.html(b(a));
        return this
      };
      f.prototype.changeColor = function (a) {
        var b;
        a = $(a.currentTarget);
        this.$el.find(".active").removeClass("active");
        b = a.data("color");
        a.addClass("active");
        this.options.collectionModel.save({color: b});
        return this
      };
      f.prototype.enterEditSubMenu = function () {
        var a = this;
        this.enterSubMenu("", function () {
          a.$el.html(e(a.options.collectionModel.toJSON()));
          return a.$("input").focus()
        });
        return this
      };
      f.prototype.enterDeleteSubMenu = function () {
        var a = this;
        this.enterSubMenu("", function () {
          return a.$el.html(g())
        });
        return this
      };
      f.prototype.submitEditForm = function (a) {
        var b, d, e = this;
        a.preventDefault();
        a = $(a.currentTarget);
        d =
          a.find("input").val().trim();
        b = a.find("textarea").val().trim();
        d ? this.options.collectionModel.save({title: d, description: b}, {success: function () {
          return e.hide()
        }}) : a.find("input").focus();
        return this
      };
      f.prototype.submitDeleteForm = function (a) {
        var b = this;
        a.preventDefault();
        this.options.collectionModel.destroy({success: function () {
          return b.hide()
        }});
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/library/collection/collection-card/templates/basic", [], function () {
  return function (d) {
    return'<div class="circle-button"> <div class="button-inner"></div></div><div class="collection-content"></div><p class="collection-title"> <span class="collection-name">' + d.title + '<span class="work-count">  ' + d.workCount + '</span></span></p><div class="handler-set"> <a class="collection-menu-toggler toggler icon icon-chevron-down icon-white" data-gta="event" data-label="open collection menu"> </a></div>'
  }
});
define("views/library/collection/collection-card/templates/works", [], function () {
  return function (d) {
    var a = "";
    return a = d.thumbnail ? a + ('<div class="work-thumbnail" style="background-image:url(' + d.thumbnail + ');"></div>') : a + ('<div class="work-thumbnail file"> <div class="work-name pull-right"> <p>' + d.fileName + '</p> </div> <p class="work-type ' + d.fileType + '">' + d.fileType + "</p></div>")
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/library/collection/collection-card/index", ["view", "thenjs", "views/library/collection/collection-menu/index", "./templates/basic", "./templates/works"], function (d, b, e, g, k) {
    var h, l;
    h = teambition.APP;
    return function (b) {
      function d() {
        return l = d.__super__.constructor.apply(this, arguments)
      }

      a(d, b);
      d.prototype.viewName = "CollectionCardView";
      d.prototype.tagName = "div";
      d.prototype.className = "collection-card toggler-parent";
      d.prototype.events = {click: "enterCollection", "click .collection-menu-toggler": "toggleCollectionMenu"};
      d.prototype.initialize = function (a) {
        if (null != a && a._projectId)return this.options = a, this._projectId = a._projectId, this.model = a.model, this.listenTo(this.model, "destory remove", this.remove), this.listenTo(this.model, "add change", this.render), this.render(), this
      };
      d.prototype.render = function () {
        var a;
        this.$el.html(g(this.model.toJSON()));
        this.$el.data("id", this.model.id).data("gta", "event").data("label", "nav to collection").data("action", "click").data("category", "div").data("value", "i3");
        a = this.model.get("color") || "blue";
        this.$el.removeClass("blue red orange inverse green").addClass(a);
        this.$workThumbnailSet = this.$(".collection-content");
        this.renderWork();
        return this
      };
      d.prototype.renderWork = function () {
        var a;
        if (a = this.model.get("recentWork"))return this.$workThumbnailSet.html(k(a))
      };
      d.prototype.enterCollection =
        function (a) {
          if (0 === $(a.target).closest(".handler-set").length)return a = $(a.currentTarget).data("id"), h.currentView.updateUrl({_collectionId: a}, {trigger: !0})
        };
      d.prototype.toggleCollectionMenu = function (a) {
        a = $(a.currentTarget);
        a.data("bs.popover") || this.requestSubView(e, {$toggler: a, _projectId: this._projectId, collectionModel: this.model}).show();
        return this
      };
      return d
    }(d)
  })
}).call(this);
define("views/library/collection/collection-creator/templates/basic", [], function () {
  return function (d) {
    return'<form class="collection-create-form"> <input class="form-control" type="text" data-gta="event" data-label="enter collection title" data-action="focus" data-category="input" data-value="h3" placeholder="..."/> <textarea class="form-control" data-gta="event" data-label="enter collection description" data-action="focus" data-category="textarea" data-value="h4" placeholder="..."></textarea> <button class="btn btn-primary" type="submit"></button></form>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/library/collection/collection-creator/index", ["popover-view", "util", "warehouse", "collections/collections", "./templates/basic"], function (d, b, e, g, k) {
    var h;
    return function (b) {
      function d() {
        return h = d.__super__.constructor.apply(this, arguments)
      }

      a(d, b);
      d.prototype.viewName = "CollectionCreatorView";
      d.prototype.popoverTitle = "";
      d.prototype.events = {"submit .collection-create-form": "submitCreateForm"};
      d.prototype.render = function () {
        this.$el.html(k());
        this.$("input").focus();
        return this
      };
      d.prototype.submitCreateForm = function (a) {
        var b, d, f = this;
        a.preventDefault();
        a = $(a.currentTarget);
        d = a.find("input").val().trim();
        b = a.find("textarea").val().trim();
        d ? e.request(g, this.options._projectId, {success: function (a) {
          return a.create({title: d, description: b, _projectId: f.options._projectId}, {wait: !0, success: function () {
            return f.hide()
          }})
        }}) :
          a.fint("input").focus();
        return this
      };
      return d
    }(d)
  })
}).call(this);
define("views/library/collection/collections/templates/basic", [], function () {
  return function (d) {
    return'<header class="collections-header"> <ul class="nav nav-underscore"> <li> <a> <h3></h3> </a> </li> <li class="pull-right"> <div class="btn btn-primary upload-works-handler" style="position:relative;" data-gta="event" data-label="upload work" data-action="click" data-category="div" data-value="i2"> <span class="icon icon-arrow-up"></span>  </div> </li> <li class="pull-right"> <div class="btn collection-creator-toggler" data-ui-widget="collectionEditor" data-gta="event" data-label="create collection" data-action="click" data-category="div" data-value="i1"> <span class="icon icon-plus"></span>  </div> </li> </ul></header><div class="collections-collection-cards-wrapper"> <ul class="collections-collection-cards-list clearfix"></ul></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/library/collection/collections/index", "view views/work/work-uploader/index views/library/collection/collection-card/index views/library/collection/collection-creator/index warehouse collections/collections util thenjs ./templates/basic".split(" "), function (d, b, e, g, k, h, l, n, m) {
    var s;
    return function (d) {
      function f() {
        return s =
          f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "CollectionsView";
      f.prototype.tagName = "div";
      f.prototype.className = "collections-view";
      f.prototype.events = {"click .collection-creator-toggler": "toggleCollectionCreator"};
      f.prototype.initialize = function (a) {
        if (null != a && a._projectId)return this._projectId = a._projectId, this.render().load(), this
      };
      f.prototype.reset = function (a) {
        this.collection = a;
        this.listenTo(a, "add", this.renderCollection);
        this.setupPlaceholder(a, "collection");
        return this
      };
      f.prototype.render = function () {
        this.$el.html(m());
        this.$header = this.$(".collections-header");
        this.$uploadWorksHandler = this.$(".upload-works-handler");
        this.$collectionCardsList = this.$(".collections-collection-cards-list");
        return this
      };
      f.prototype.load = function () {
        var a = this;
        k.request(h, this._projectId, {beforeSend: function () {
          return a.showLoadingIndicator(a.$collectionCardsList, {isPrepend: !0})
        }, success: function (b) {
          a.reset(b);
          a.renderCollections();
          a.initUploader();
          return a.hideLoadingIndicator({animated: !0})
        }});
        return this
      };
      f.prototype.renderCollections = function () {
        var a, b, d, e;
        this.$collectionCardsList.empty();
        e = this.collection.models;
        b = 0;
        for (d = e.length; b < d; b++)a = e[b], this.renderCollection(a);
        return this
      };
      f.prototype.renderCollection = function (a) {
        this.requestSubView(e, {_projectId: this._projectId, model: a}).$el.prependTo(this.$collectionCardsList);
        return this
      };
      f.prototype.initUploader = function () {
        this.requestSubView(b, {_projectId: this._projectId, location: "collection", pick: {id: this.$uploadWorksHandler, multiple: !0},
          dnd: this.$header});
        return this
      };
      f.prototype.toggleCollectionCreator = function (a) {
        a = $(a.currentTarget);
        a.data("bs.popover") || this.requestSubView(g, {$toggler: a, _projectId: this._projectId}).show();
        return this
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/library/library/index", ["view", "views/library/collection/collection/index", "views/library/collection/collections/index"], function (d, b, e) {
    var g, k;
    g = teambition.router;
    return function (d) {
      function f() {
        return k = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "LibraryView";
      f.prototype.tagName = "div";
      f.prototype.className = "library-view";
      f.prototype.events = {"click .create": "create"};
      f.prototype.routes = {":_collectionId(/:_workId)": "enterCollection", "": "enterCollections", "*paramString": "home"};
      f.prototype.initialize = function (a) {
        this._projectId = a._projectId;
        return this
      };
      f.prototype.onRouteError = function () {
        return g.home()
      };
      f.prototype.home = function () {
        return this.updateUrl({_collectionId: null, _workId: null}, {trigger: !0})
      };
      f.prototype.enterCollections = function () {
        this._workId =
          this._collectionId = void 0;
        this.requestSubView(e, {_projectId: this._projectId}).$el.appendTo(this.$el);
        return this
      };
      f.prototype.enterCollection = function (a, d) {
        var e, f = this;
        e = {_projectId: this._projectId, _collectionId: a};
        d && (e._workId = d);
        this._collectionId = a;
        this._workId = d;
        e.onError = function () {
          return f.home()
        };
        this.requestSubView(b, e).$el.appendTo(this.$el);
        return this
      };
      f.prototype.updateUrl = function (a, b) {
        var d, e, f;
        e = void 0 === a._collectionId ? this._collectionId : a._collectionId;
        f = void 0 === a._workId ? this._workId :
          a._workId;
        d = g.getPrefix() + "/library";
        e && (d += "/" + e, f && (d += "/" + f));
        return g.navigate(d, b)
      };
      return f
    }(d)
  })
}).call(this);
define("views/events/event/templates/basic", [], function () {
  return function (d) {
    return'<div class="event-time"></div><div class="event-content"> <div class="event-content-container"></div> <div class="involve-set"> <ul class="involve-members"></ul> </div></div><a class="button more icon icon-chevron-right"></a>'
  }
});
define("views/events/event/templates/info", [], function () {
  return function (d) {
    var a = '<h3 class="event-title">' + d.title + '</h3><p class="event-detail">' + d.content + "</p>";
    d.location && (a += ' <p class="event-place"> <span class="icon-location icon"></span> ' + d.location + " </p>");
    return a
  }
});
define("views/events/event/templates/time", [], function () {
  return function (d) {
    var a = " <time>" + d.startDateString + "</time> ";
    d.endDateString && (a += " ~ <time>" + d.endDateString + "</time> ");
    return a
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/events/event/index", "moment util view warehouse collections/members views/member/member-involve/index ./templates/basic ./templates/info ./templates/time".split(" "), function (d, b, e, g, k, h, l, n, m) {
    var s, r;
    s = teambition.APP;
    return function (e) {
      function v() {
        return r = v.__super__.constructor.apply(this,
          arguments)
      }

      a(v, e);
      v.prototype.viewName = "Event";
      v.prototype.tagName = "li";
      v.prototype.className = "event-view";
      v.prototype.events = {click: "toggleEventDetail"};
      v.prototype.initialize = function (a) {
        if (a.eventModel)return this.options = a, this.eventModel = a.eventModel, this.renderBasic(), this.renderTime(), this.renderInfo(), this.renderInvolve(), this.listen(), this
      };
      v.prototype.listen = function () {
        this.listenTo(this.eventModel, "change:title change:content change:location", this.renderInfo);
        this.listenTo(this.eventModel,
          "change:startDate change:endDate", this.renderTime);
        this.listenTo(this.eventModel, "destroy remove", this.remove);
        return this
      };
      v.prototype.renderBasic = function () {
        this.$el.html(l());
        this.$el.attr({"data-gta": "event", "data-id": this.eventModel.id, "data-label": "open event detail"});
        this.$eventTime = this.$(".event-time");
        this.$eventInfoContainer = this.$(".event-content-container");
        this.$involveSet = this.$(".involve-set");
        return this
      };
      v.prototype.renderTime = function () {
        var a, e, g;
        a = this.eventModel.toJSON();
        a.startDateString =
          d(a.startDate).format("A h:mm");
        e = b.formatDate(new Date(a.startDate)).dateString;
        g = d("today" === this.eventModel.getScope() ? new Date : a.startDate);
        g = b.formatDate(g).dateString;
        e !== g && (a.startDateString = g + " " + a.startDateString);
        null != a.endDate && (e = b.formatDate(new Date(a.endDate)).dateString, a.endDateString = d(a.endDate).format("A h:mm"), e !== g && (a.endDateString = e + " " + a.endDateString));
        this.$eventTime.html(m(a));
        return this
      };
      v.prototype.renderInfo = function () {
        var a;
        a = this.eventModel.toJSON();
        this.$eventInfoContainer.html(n(a));
        return this
      };
      v.prototype.renderInvolve = function () {
        this.requestSubView(h, {objectModel: this.eventModel, membersCollection: g.request(k, this.eventModel.get("_projectId")), $list: this.$(".involve-members"), dropArea: this.$el, undeletable: !1, gta: {involveMemberLabel: "event|involve member"}}).$el.prependTo(this.$involveSet);
        return this
      };
      v.prototype.toggleEventDetail = function (a) {
        if (!(0 < $(a.target).closest(".involve-view").length))return s.currentView.enterEventDetail(this.eventModel.id)
      };
      return v
    }(e)
  })
}).call(this);
define("views/events/one-day-events/templates/basic", [], function () {
  return function (d) {
    var a = '<header class="one-day-header card-header"> <span class="witch-day">' + d.dayString + "</span> ";
    d.dateString != d.dayString && (a += ' <span class="date">  ' + d.dateString + "</span> ");
    return a += ' <a class="event-creator-toggler pull-right" data-timestamp="' + d.timestamp + '" data-gta="event" data-label="open event creator from one day" href="#"> <span class="icon icon-plus"></span> </a></header><section class="one-day-content"> <ul class="event-list"> </ul> <div class="no-event"> <span class="no-event-tips"></span>  <a class="event-creator-toggler" data-timestamp="' +
      d.timestamp + '" data-gta="event" data-label="open event creator from no event in one day" href="#"></a> </div></section>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/events/one-day-events/index", "view warehouse collections/events util moment views/events/event/index ./templates/basic".split(" "), function (d, b, e, g, k, h, l) {
    var n;
    return function (b) {
      function d() {
        return n = d.__super__.constructor.apply(this, arguments)
      }

      a(d, b);
      d.prototype.viewName = "OneDayEvents";
      d.prototype.tagName = "div";
      d.prototype.className = "one-day card";
      d.prototype.initialize = function (a) {
        this.options = a;
        this.day = k(this.options.day).startOf("day");
        this.isResident = this.options.isResident;
        this.renderBasic();
        return this
      };
      d.prototype.renderBasic = function () {
        var a;
        a = {dayString: g.formatDate(this.day).dateString, dateString: this.day.format("MMMD"), timestamp: this.day.valueOf()};
        this.$el.html(l(a));
        this.$eventList = this.$(".event-list");
        this.$noEventTips = this.$(".no-event");
        this.checkEvents();
        return this
      };
      d.prototype.addEvent = function (a) {
        var b;
        if (b = a.eventView) {
          if (b.parentView === this)return;
          b.$el && (b.$el.remove(), b.parentView.checkEvents(), b.remove())
        }
        a.eventView = this.requestSubView(h, {eventModel: a});
        a.eventView.$el.appendTo(this.$eventList);
        this.checkEvents();
        return this
      };
      d.prototype.checkEvents = function () {
        var a = this;
        _.delay(function () {
          return a.$noEventTips[0 < a.$eventList.children().length ? "hide" : "show"]()
        });
        return this
      };
      return d
    }(d)
  })
}).call(this);
define("views/events/events-timeline/templates/basic", [], function () {
  return function (d) {
    return'<header class="events-timeline-header"> <ul class="nav nav-underscore"> <li> <a><h3></h3></a> </li> <li class="pull-right"> <div class="btn btn-primary event-creator-toggler" data-gta="event" data-label="open event creator"> <span class="icon icon-plus"></span>  </div> </li> </ul></header><section class="events-timeline-content"></section>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/events/events-timeline/index", "view warehouse collections/events util moment views/events/one-day-events/index views/events/event-creator-popover/index ./templates/basic".split(" "), function (d, b, e, g, k, h, l, n) {
    var m, s;
    m = $("body");
    return function (d) {
      function f() {
        return s = f.__super__.constructor.apply(this,
          arguments)
      }

      a(f, d);
      f.prototype.viewName = "EventsTimeline";
      f.prototype.className = "events-timeline";
      f.prototype.events = {"click .event-creator-toggler": "toggleEventCreator"};
      f.prototype.initialize = function (a) {
        var b = this;
        if (null != a && a._projectId)return this.options = a, this._projectId = this.options._projectId, this.dayView = {}, this.load(function (a) {
          b.eventsCollection = a;
          b.renderBasic();
          b.getDayView(k(), !0);
          b.getDayView(k().add("days", 1), !0);
          b.renderEvents();
          return b.listen()
        }), this
      };
      f.prototype.load = function (a) {
        this.showLoadingIndicator(this.$el);
        b.request(e, this._projectId, {success: function (b) {
          return"function" === typeof a ? a(b) : void 0
        }});
        return this
      };
      f.prototype.listen = function () {
        var a = this;
        this.listenTo(this.eventsCollection, "add change:startDate change:endDate", function (b) {
          a.renderEvent(b);
          return a.scrollToEvent(b)
        });
        this.listenTo(this.eventsCollection, "remove", function (b) {
          return a.removeEvent(b)
        });
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(n());
        this.$eventsTimelineContent = this.$(".events-timeline-content");
        return this
      };
      f.prototype.renderEvents = function () {
        var a = this;
        this.eventsCollection.each(function (b) {
          return a.renderEvent(b)
        });
        return this
      };
      f.prototype.renderEvent = function (a) {
        var b;
        b = a.getScope();
        if ("past" !== b)return b = "today" === b ? k() : k(a.get("startDate")), this.getDayView(b).addEvent(a), this
      };
      f.prototype.removeEvent = function (a) {
        var b;
        b = a.getScope();
        if ("past" !== b)return b = "today" === b ? k() : k(a.get("startDate")), this.getDayView(b).checkEvents(a), this
      };
      f.prototype.getDayView = function (a, b) {
        var d, e, f;
        a.startOf("day");
        e = a.format("YYYYMMDD");
        this.dayView[e] || (this.dayView[e] = this.requestSubView(h, {day: a, _projectId: this._projectId, isResident: !!b}), f = _.keys(this.dayView).sort(), (d = _.indexOf(f, e)) ? (d = this.dayView[f[d - 1]], this.dayView[e].$el.insertAfter(d.$el)) : this.dayView[e].$el.prependTo(this.$eventsTimelineContent));
        return this.dayView[e]
      };
      f.prototype.toggleEventCreator = function (a) {
        var b;
        a.stopPropagation();
        a.preventDefault();
        a = $(a.currentTarget);
        b = a.attr("data-timestamp");
        b = null != b ? new Date(parseInt(b, 10)) : new Date;
        a.data("bs.popover") || this.requestSubView(l, {$toggler: a, eventsCollection: this.eventsCollection, isEdit: !1, _projectId: this._projectId, startDate: b}).show();
        return this
      };
      f.prototype.scrollToEvent = function (a) {
        var b, d = this;
        b = (null != a ? a.id : void 0) || this.eventsCollection.last().id;
        return _.delay(function () {
          var a, e;
          a = $("[data-id=" + b + "]");
          e = function () {
            return a.transition({"background-color": "#fefbdd", duration: 300}).transition({"background-color": "white", duration: 1E3})
          };
          return d._isOutOfViewport(a) ? m.animate({scrollTop: a.offset().top -
            400}, 400, function () {
            return e()
          }) : e()
        }, 200)
      };
      f.prototype._isOutOfViewport = function (a) {
        var b, d;
        b = document.documentElement.scrollTop || document.body.scrollTop;
        d = window.innerHeight;
        a = a.offset();
        return a.top < b || a.top > b + d
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/events/events/index", ["view", "views/events/event-detail-panel/index", "views/events/events-timeline/index"], function (d, b, e) {
    var g, k, h;
    g = teambition.APP;
    k = teambition.router;
    return function (d) {
      function f() {
        return h = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "Events";
      f.prototype.className = "events-view";
      f.prototype.routes = {"": "enterEventsTimeline", ":_eventId": "enterEventsTimelineAndEventDetail", "*paramString": "onRouteError"};
      f.prototype.initialize = function (a) {
        if (null != a && a._projectId)return this.options = a, this._projectId = a._projectId, this
      };
      f.prototype.enterEventsTimeline = function () {
        this.eventsTimeline = this.requestSubView(e, {_projectId: this._projectId});
        this.eventsTimeline.$el.appendTo(this.$el);
        return this
      };
      f.prototype.enterEventsTimelineAndEventDetail = function (a) {
        this.enterEventsTimeline();
        this.enterEventDetail(a);
        return this
      };
      f.prototype.enterEventDetail = function (a, d) {
        var e;
        g.showPanel(b, {_eventId: a, _projectId: this._projectId});
        e = k.getUrl();
        k.navigate(e.substring(0, e.indexOf("events") + 6) + "/event/" + a, {trigger: !1});
        return this
      };
      f.prototype.onRouteError = function () {
        k.home();
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/review/week-picker/templates/basic", [], function () {
  return function (d) {
    var a = "";
    if (d = d.weeks)for (var f, b = -1, e = d.length - 1; b < e;)f = d[b += 1], a += " ", a = "groupBy" == f.type ? a + (' <li class="week-item group-by"> <span class="group-name">' + f.groupName + "</span> </li> ") : a + (' <li class="week-item" data-index="' + b + '" data-gta="event" data-label="review week" data-action="click"> <a> <span class="start-date">' + f.startDateString + '</span> <span> - </span> <span class="end-date">' + f.endDateString + '</span> <span class="week"> (' +
      f.week + ")</span> </a> </li> ");
    return a
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/review/week-picker/index", ["dropdown-view", "moment", "./templates/basic"], function (d, b, e) {
    var g;
    return function (d) {
      function f() {
        return g = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "WeekPickerView";
      f.prototype.className = "week-picker-wrapper";
      f.prototype.events =
      {"click .week-item": "selectedWeek"};
      f.prototype.initialize = function (a) {
        if (null != a && a.projectCreated)return this.options = a, this.options.direction = "auto bottom", this.weeks = [], this.weeksList = [], this.renderBasic().renderSelected(this.weeks[0]), this
      };
      f.prototype._generateWeek = function () {
        var a, d, e, f, g, h, k;
        d = b();
        k = null;
        for (e = 52; 0 < e;)g = d.clone().startOf("week"), a = d.clone().endOf("week"), f = d.format("MMM"), h = d.format("wo"), f !== k && (k = f, this.weeksList.push({type: "groupBy", groupName: f})), a = {startDateString: g.format("MM.DD"),
          endDateString: a.format("MM.DD"), startDate: g.toISOString(), endDate: a.toISOString(), week: h}, this.weeksList.push(a), this.weeks.push(a), e--, g.valueOf() < b(this.options.projectCreated).valueOf() && (e = 0), d.add("weeks", -1);
        return this
      };
      f.prototype.renderBasic = function () {
        this._generateWeek();
        this.$el.html(e({weeks: this.weeksList}));
        return this
      };
      f.prototype.renderSelected = function (a) {
        _.isObject(a) && (a = this.weeksList.indexOf(a));
        this.index = a;
        this.$(".selected").removeClass("selected");
        this.$("[data-index=" + a +
          "]").addClass("selected");
        return this
      };
      f.prototype.selectedWeek = function (a) {
        var b;
        a = $(a.currentTarget).data("index");
        if (this.index !== a && (this.renderSelected(a), "function" === typeof(b = this.options).onSelectedChange))b.onSelectedChange(this.weeksList[a]);
        return this
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/reviews", ["collection", "models/activity"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.name = "reviews";
      f.prototype.model = b;
      f.prototype.comparator = function (a) {
        return-(new Date(a.get("created"))).getTime()
      };
      f.prototype.getParams = function (a, b) {
        if ("read" === a && _.isObject(b.params))return b.params
      };
      return f
    }(d)
  })
}).call(this);
define("views/review/review/templates/basic", [], function () {
  return function (d) {
    var a = '<header class="review-header clearfix"> <a class="dropdown-toggle week-picker-handler pull-left"></a> <div class="content-filter"> <label class="checkbox-inline"> <div class="check-box active" data-type="post" data-gta="event" data-label="review filte posts"><span class="icon icon-tick"></span></div> <span></span> </label> <label class="checkbox-inline"> <div class="check-box active" data-type="work" data-gta="event" data-label="review filte works"><span class="icon icon-tick"></span></div> <span></span> </label> <label class="checkbox-inline"> <div class="check-box active" data-type="event" data-gta="event" data-label="review filte events"><span class="icon icon-tick"></span></div> <span></span> </label> <label class="checkbox-inline"> <div class="check-box active" data-type="task" data-gta="event" data-label="review filte tasks"><span class="icon icon-tick"></span></div> <span></span> </label> </div></header><div class="review-members scrollable thin-scroll"> <ul class="member-filter"> <li class="member-item active all-members" data-gta="event" data-label="review select all member"> <a> <span class="icon icon-users icon-gray"></span> <span class="member-name"></span> </a> </li> ';
    if (d =
      d.members)for (var f, b = -1, e = d.length - 1; b < e;)f = d[b += 1], a += ' <li class="member-item member" data-id="' + f._id + '" data-gta="event" data-label="review select member"> <a> <span class="avatar img-circle img-36" style="background-image:url(' + f.avatarUrl + ');"></span> <span class="member-name">' + f.name + "</span> </a> </li> ";
    return a + ' </ul></div><div class="review-content-wrap"> <div class="review-placeholder muted"> <span class="icon icon-review"></span> <br />  </div> <div class="review-content"></div></div>'
  }
});
define("views/review/review/templates/date", [], function () {
  return function (d) {
    return'<div class="review-date-wrap" data-date="' + d.date + '"> <div class="review-date">' + d.dateString + "</div></div>"
  }
});
define("views/review/review/templates/week", [], function () {
  return function (d) {
    return'<span class="start-date">' + d.startDateString + '</span><span> - </span><span class="end-date">' + d.endDateString + '</span><span class="week"> (' + d.week + ')</span><span class="caret"></span>'
  }
});
define("views/review/review/templates/activity", [], function () {
  return function (d) {
    var a = '<div class="review-member-wrap" data-id="' + d.executor._id + '"> <div class="review-member clearfix"> <span class="avatar img-circle img-36" style="background-image:url(' + d.executor.avatarUrl + ')"></span> <span class="member-name">' + d.executor.name + '</span> </div> <ul class="review-activities"> ';
    if (d = d.activities)for (var f, b = -1, e = d.length - 1; b < e;)f = d[b += 1], a += ' <li class="activity ' + f.boundToObjectType + '" data-id="' +
      f._id + '"> <div class="activity-timeline"> <time class="time-stamp">' + f.createdTime + '</time> </div> <div class="activity-body" data-object-id="' + f._boundToObjectId + '" data-type="' + f.boundToObjectType + '"> <p class="activity-title">' + f.title + "</p> ", "work" == f.boundToObjectType ? (a += " ", "image" === f.boundToObject.fileCategory && "psd" !== f.boundToObject.fileType ? a += ' <div class="attachment-thumbnail image" style="background-image: url(' + f.boundToObject.thumbnail + ');"> </div> ' : (a += ' <div class="attachment-thumbnail file-color ' +
      f.boundToObject.fileType + "-color ", "audio" === f.boundToObject.fileCategory && (a += " audio-color "), a += '"> ', a = "ai" === f.boundToObject.fileType ? a + " Ai " : "psd" === f.boundToObject.fileType ? a + " Ps " : "audio" === f.boundToObject.fileCategory ? a + ' <span class="icon icon-audio"></span> ' : a + (" " + f.boundToObject.fileType + " "), a += " </div> "), a += ' <div class="activity-content work"> ' + f.boundToObject.fileName + ' <span class="attachment-size">(' + f.boundToObject.fileSizeFix + ")</span> </div> ") : a += ' <p class="activity-content">' +
      f.reviewContent + "</p> ", a += ' </div> <div class="activity-arrow-hint"><i class="icon icon-chevron-right"></i></div> </li> ';
    return a + " </ul></div>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/review/review/index", "view lib/window/index views/board/task/task-detail-panel/index views/events/event-detail-panel/index views/wall/post-panel/index views/library/previewer/index views/review/week-picker/index lib/scrollable util moment warehouse collections/works collections/members collections/reviews collections/projects ./templates/basic ./templates/date ./templates/week ./templates/activity".split(" "), function (d, b, e, g, k, h, l, n, m, s, r, t, v, p, x, B, C, z, A) {
    var u, w, y;
    u = teambition.APP;
    w = teambition.router;
    d = function (d) {
      function f() {
        return y = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "ReviewView";
      f.prototype.tagName = "div";
      f.prototype.className = "review-view";
      f.prototype.events = {"click label.checkbox-inline": "changeFilter", "click .member-item": "selectMembers", "click .activity-body": "enterDetail", "mousewheel .scrollable": m.mousewheel};
      f.prototype.initialize = function (a) {
        var b = this;
        if (null !=
          a && a._projectId)return this.options = a, this._projectId = a._projectId, this.projectModel = r.get(x, null, this._projectId), this.membersCollection = r.request(v, this._projectId), this.reviewCollection = r.createCollection(p, this._projectId), this.allMembers = this.membersCollection.getActiveMemberIds(), this.selectedMembers = [], this.renderBasic().initWeekPicker().renderWeek(), this.shownType = ["task", "post", "event", "work"], this.renderedDates = [], this.load({beforeSend: function () {
          return b.showLoadingIndicator(b.$reviewContent)
        },
          success: function (a) {
            b.hideLoadingIndicator();
            b.reviewCollection.reset(a.models);
            return b.groupActivitiesByDate()
          }}), this.setupScroll($(document)), this.setupLoadMore(10, !0), this.registerAsResponsive(), _.delay(function () {
          return b.layout()
        }), this
      };
      f.prototype.layout = function () {
        this.$reviewContent.css("min-height", this.$reviewMembers.height() + 5);
        return this
      };
      f.prototype.renderBasic = function () {
        this.$el.html(B({members: this.membersCollection.getActiveMembersJSON()}));
        this.$weekFilter = this.$(".week-picker-handler");
        this.$contentFilter = this.$(".content-filter");
        this.$reviewMembers = this.$(".review-members");
        this.$memberFilter = this.$(".member-filter");
        this.$allMembers = this.$(".member-item.all-members");
        this.$reviewContent = this.$(".review-content");
        this.$reviewPlaceholder = this.$(".review-placeholder");
        return this
      };
      f.prototype.selectMembers = function (a) {
        var b;
        a = $(a.currentTarget);
        if (b = a.data("id"))a.toggleClass("active"), a.hasClass("active") ? this.selectedMembers.push(b) : m.removeItem(this.selectedMembers, b), a = this.selectedMembers.length &&
          this.selectedMembers.length !== this.allMembers.length ? "removeClass" : "addClass", this.$allMembers[a]("active"); else if (this.selectedMembers.length || !a.hasClass("active"))a.addClass("active"), this.selectedMembers = [], this.$memberFilter.children(".member").removeClass("active");
        this.$reviewContent.html("");
        this.renderedDates = [];
        this.groupActivitiesByDate();
        return this
      };
      f.prototype.initWeekPicker = function () {
        var a = this;
        this.weekPickerView = this.requestSubView(l, {projectCreated: this.projectModel.get("created"),
          onSelectedChange: function (b) {
            a.week = b;
            a.renderWeek();
            return a.load({beforeSend: function () {
              return a.showLoadingIndicator(a.$reviewContent, {isPrepend: !0})
            }, success: function (b) {
              a.hideLoadingIndicator();
              a.reviewCollection.reset(b.models);
              a.$reviewContent.html("");
              a.renderedDates = [];
              return a.groupActivitiesByDate()
            }})
          }}).setup(this.$weekFilter);
        this.week = this.weekPickerView.weeks[0];
        return this
      };
      f.prototype.changeFilter = function (a) {
        var b;
        a = $(a.currentTarget).children(".check-box");
        a.toggleClass("active");
        b = a.data("type");
        m.removeItem(this.shownType, b);
        a.hasClass("active") && this.shownType.push(b);
        this.$reviewContent.html("");
        this.renderedDates = [];
        this.groupActivitiesByDate();
        return this
      };
      f.prototype.renderWeek = function () {
        this.$weekFilter.html(z(this.week));
        return this
      };
      f.prototype.load = function (a) {
        var b;
        if (null != (b = this.week) && b.startDate)return a || (a = {}), "function" === typeof a.beforeSend && a.beforeSend(), b = "" + this._projectId + "_" + this.week.startDate, r.request(p, b, {boundToObjectType: "", params: {_projectId: this._projectId,
          startDate: this.week.startDate, endDate: this.week.endDate}, success: function (b) {
          return"function" === typeof a.success ? a.success(b) : void 0
        }}), this
      };
      f.prototype.loadMore = function (a, b) {
        var d, e = this;
        if (b) {
          if (d = this.weekPickerView.weeks.indexOf(this.week) - 1, 0 > d)return a()
        } else if (d = this.weekPickerView.weeks.indexOf(this.week) + 1, d >= this.weekPickerView.weeks.length)return a();
        this.week = this.weekPickerView.weeks[d];
        this.load({beforeSend: function () {
          return e.showLoadingIndicator(e.$reviewContent, {isPrepend: b})
        },
          success: function (d) {
            e.hideLoadingIndicator();
            e.reviewCollection.add(d.models);
            e.groupActivitiesByDate(d, b);
            return a()
          }});
        this.weekPickerView.renderSelected(this.week);
        this.renderWeek();
        return this
      };
      f.prototype.renderActivitiesByMember = function (a, b, d) {
        var e, f, g = this;
        b = _.groupBy(b, function (a) {
          return a._creatorId
        });
        f = this.selectedMembers.length ? this.selectedMembers : this.allMembers;
        e = $("<div></div>");
        _.each(f, function (d) {
          var f, h;
          h = g.membersCollection.get(d);
          if (b[d] && h)return f = e.find(".review-date-wrap[data-date=" +
            a + "]"), f.length || (f = $(C({date: a, dateString: s(a, "YYYYMMDD").format("MMM Do ddd")})).appendTo(e)), $(A({executor: h.toJSON(), activities: b[d]})).appendTo(f)
        });
        e.children()[d ? "prependTo" : "appendTo"](this.$reviewContent);
        e = null;
        return this
      };
      f.prototype.groupActivitiesByDate = function (a, b) {
        var d, e, f = this;
        d = {};
        a || (a = this.reviewCollection);
        a.each(function (a) {
          var b;
          if (~f.shownType.indexOf(a.get("boundToObjectType")) && (b = s(a.get("created")).format("YYYYMMDD"), !~f.renderedDates.indexOf(b)))return d[b] || (d[b] = []),
            a.genReviewContent(), a = a.toJSON(), a.createdTime = s(a.created).format("HH:mm"), "work" === a.boundToObjectType && (a.boundToObject.fileSizeFix = m.formatFileSize(a.boundToObject.fileSize)), d[b].push(a)
        });
        e = _.keys(d);
        e = _.sortBy(e, function (a) {
          return b ? +a : -a
        });
        _.each(e, function (a) {
          f.renderedDates.push(a);
          return f.renderActivitiesByMember(a, d[a], b)
        });
        this.checkPlaceholder();
        return this
      };
      f.prototype.checkPlaceholder = function () {
        this.$reviewContent.children().length ? this.$reviewPlaceholder.hide() : this.$reviewPlaceholder.show();
        return this
      };
      f.prototype.updateUrl = function (a, b) {
        var d, e, f;
        b = b || {};
        d = a.type;
        f = a._modelId;
        e = w.getPrefix() + "/review";
        d && f && (e += "/" + d + "/" + f, a.params && (e += "/" + a.params));
        w.navigate(e, b);
        return this
      };
      f.prototype.enterDetail = function (a) {
        var d, f = this;
        d = $(a.currentTarget);
        a = d.data("type");
        d = d.data("object-id");
        switch (a) {
          case "task":
            u.showPanel(e, {_projectId: this._projectId, _taskId: d, rightOffset: 0});
            break;
          case "event":
            u.showPanel(g, {_projectId: this._projectId, _eventId: d, rightOffset: 0});
            break;
          case "post":
            u.showPanel(k,
              {_projectId: this._projectId, _postId: d, rightOffset: 0, hideActivityCreator: !0, onlyLast: !1, membersCollection: this.membersCollection});
            break;
          case "work":
            r.request(t, this._projectId, d, {success: function (a) {
              a = {_projectId: f._projectId, workModel: a, workModels: [a]};
              return f.requestSubView(b).open(h, a)
            }})
        }
        this.updateUrl({type: a, _modelId: d}, {trigger: !1});
        return this
      };
      return f
    }(d);
    _.extend(d.prototype, n);
    return d
  })
}).call(this);
define("views/core/navigation/templates/basic", [], function () {
  return function (d) {
    return'<div class="navbar-inner"> <ul class="nav left-side"> <li> <a class="switcher-toggler" data-gta="event" data-label="toggle switcher" data-action="click" data-category="a" data-value="b"> <span class="icon icon-menu"></span> </a> </li> </ul> <a class="brand central" data-gta="event" data-label="back to portal" data-action="click" data-category="a" data-value="a"></a> <ul class="nav right-side"></ul></div>'
  }
});
define("views/core/navigation/templates/title", [], function () {
  return function (d) {
    return"" + d.name + '<b class="caret"></b>'
  }
});
define("views/core/navigation/templates/button", [], function () {
  return function (d) {
    var a = '<li> <a class="new-ribbon" data-gta="event" data-label="go head to new feature introduction" data-action="click" href="/new" target="_blank"></a></li><li> <a class="create-project-handler" data-gta="event" data-label="create project" data-action="click"> <span class="icon icon-plus"></span> <span></span> </a></li><li> <a class="open-inbox-handler ';
    0 < d.inbox && (a += " hold ");
    return a += '" data-gta="event" data-label="open inbox" data-action="click"> <span class="icon icon-inbox"></span> <span class="message-number"> ' +
      d.inbox + '</span> </a></li><li> <a class="myboard-handler" data-gta="event" data-label="my dashboard"> <div class="avatar img-circle" style="background-image:url(' + d.avatarUrl + ');" data-gta="event" data-label="click user avatar" data-action="click"> </div> ' + d.name + " </a></li>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/core/navigation/index", "view lib/window/index views/project/project-creator/index warehouse collections/projects ./templates/basic ./templates/title ./templates/button".split(" "), function (d, b, e, g, k, h, l, n) {
    var m, s, r, t, v;
    m = teambition.APP;
    r = teambition.router;
    t = teambition.user;
    s = teambition.PREFERENCE;
    return function (d) {
      function f() {
        return v = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "NavigationView";
      f.prototype.el = $("#navigator");
      f.prototype.className = "navbar-central navbar";
      f.prototype.events = {"click .switcher-toggler": "fold", "click .brand": "goHomePage", "click .create-project-handler": "openProjectCreator", "click .open-inbox-handler": "openInbox", "click .all-projects-handler": "enterProjects", "click .myboard-handler": "openMyboard", "click .new-ribbon": "updateUserPreference"};
      f.prototype.initialize = function () {
        this.$el.html(h());
        this.$brand = this.$(".brand");
        this.$btnset = this.$(".right-side");
        this.listenTo(teambition.user, "change", this.renderButtons);
        return this
      };
      f.prototype.setup = function (a) {
        var b;
        this.$brand.stop(!1, !0).transition({y: 0, opacity: 1});
        b = a._organizationId;
        this._projectId = a = a._projectId;
        this._organizationId = b;
        b = {};
        this.renderButtons(b);
        if (!a)return this.$brand.empty();
        b = g.get(k).get(a).toJSON();
        this.$brand.html(l(b));
        return this
      };
      f.prototype.renderButtons = function (a) {
        var b,
          d;
        b = t.toJSON();
        this.$btnset.html(n(b));
        a = this.$(".message-number").parent();
        b.inbox ? a.addClass("hold") : a.removeClass("hold");
        null != (d = teambition.favico) && d.badge(b.inbox);
        s.get("hasNew") && this.$(".new-ribbon").css({display: "block"});
        return this
      };
      f.prototype.updateUserPreference = function () {
        this.$(".new-ribbon").hide();
        return s.save({hasNew: !1})
      };
      f.prototype.refreshInboxNum = function () {
        var a, b, d;
        b = t.get("inbox");
        a = this.$inboxNum.parent();
        null != (d = this.$inboxNum) && d.html(b);
        b ? a.addClass("hold") : a.removeClass("hold");
        return this
      };
      f.prototype.clear = function () {
        this.$brand.empty();
        return this
      };
      f.prototype.fold = function () {
        m.initSwitcher().toggle();
        return this
      };
      f.prototype.enterProject = function (a) {
        a = $(a.currentTarget).data("id");
        m.updateUrl({_projectId: a}, {trigger: !0});
        return this
      };
      f.prototype.enterProjects = function () {
        r.navigate("projects", {trigger: !0});
        return this
      };
      f.prototype.openMyboard = function () {
        m.Float.toggleDashboard();
        return this
      };
      f.prototype.openInbox = function () {
        m.Float.toggleInbox();
        return this
      };
      f.prototype.goHomePage =
        function () {
          r.navigate("projects", {trigger: !0});
          return!1
        };
      f.prototype.openProjectCreator = function () {
        this.requestSubView(b).open(e);
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/core/switcher/templates/basic", [], function () {
  return function (d) {
    var a = '<div class="accordion accordion-inverse"> <ul id="switcher-accordion"> ';
    if (d = d.organizations)for (var f, b = -1, e = d.length - 1; b < e;) {
      f = d[b += 1];
      var a = a + (' <li id="organization-' + f._id + '" class="organization-item accordion-group"> <div class="accordion-title collapsed" data-toggle="collapse" href="#list-' + f._id + '" '), a = "myProjects" == f.name ? a + ' data-gta="event" data-label="my projects" data-action="click" data-category="div" data-value="f1"> <span class="icon icon-user"></span> <span>&nbsp;</span> ' :
        a + (' data-gta="event" data-label="organization projects" data-action="click" data-category="div" data-value="f3"> <span class="icon icon-building"></span> <span>&nbsp;' + f.name + "</span> "), a = a + (' <span class="caret pull-right"></span> </div> <ul class="accordion-list list list-inverse collapse" id="list-' + f._id + '"> '), g = f.projects;
      if (g)for (var k, h = -1, l = g.length - 1; h < l;)k = g[h += 1], a += ' <li id="project-' + k._id + '" class="project-item" data-proid="' + k._id + '" data-orgid="' + f._id + '" data-gta="event" data-label="enter project" data-action="click" data-category="li" data-value="f2"> <a> <div class="project-logo icon dim img-rounded pull-left" style="background-image:url(' +
        k.logo + ');"></div> <span>' + k.name + "</span> </a> </li> ";
      a += " </ul> </li> "
    }
    return a + " </ul></div>"
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/core/switcher/index", "view util warehouse collections/projects collections/organizations ./templates/basic".split(" "), function (d, b, e, g, k, h) {
    var l, n, m;
    l = teambition.APP;
    n = teambition.PREFERENCE;
    return function (d) {
      function f() {
        return m = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName =
        "SwitcherView";
      f.prototype.el = $("#switcher");
      f.prototype.collapseShown = [];
      f.prototype.events = {"click .project-item": "selectProject", "shown.bs.collapse": "getCollapseShown", "hidden.bs.collapse": "getCollapseShown", mousewheel: b.mousewheel};
      f.prototype.initialize = function () {
        this.projectCollection = e.get(g);
        this.orgCollection = e.get(k);
        this.render().listen();
        return this
      };
      f.prototype.listen = function () {
        this.listenTo(this.projectCollection, "add remove change:_organizationId change:logo change:name", this.render);
        return this
      };
      f.prototype.prepareData = function () {
        var a, b, d, e, f, g;
        d = this.projectCollection.toJSON();
        a = {};
        e = 0;
        for (f = d.length; e < f; e++)b = d[e], g = b._organizationId, a[g] || (a[g] = []), a[g].push(b);
        return a
      };
      f.prototype.render = function () {
        var a, b, d, e, f = this;
        b = [];
        a = this.prepareData();
        for (e in a)d = a[e], "null" === e ? b.unshift({name: "myProjects", _id: e, projects: d}) : b.push({name: this.orgCollection.get(e).get("name"), _id: e, projects: d});
        this.$el.html(h({organizations: b}));
        _.each(this.collapseShown, function (a) {
          return f.$("#" +
            a).collapse("show")
        });
        this.highLight();
        this.addHint();
        return this
      };
      f.prototype.selectProject = function (a) {
        a = $(a.currentTarget).data("proid");
        this.updateUrl({_projectId: a}, {trigger: !0});
        return this
      };
      f.prototype.toggle = function () {
        $("body").hasClass("show-switcher") ? this.fold() : this.show();
        return this
      };
      f.prototype.show = function () {
        if (!this.projectCollection.length)return this.fold();
        $("body").addClass("show-switcher");
        n.toggleSwitcherOn(!0);
        this.$el.children().length ? this.highLight() : this.render();
        return this
      };
      f.prototype.fold = function () {
        $("body").removeClass("show-switcher");
        n.toggleSwitcherOn(!1);
        this.$el.empty();
        return this
      };
      f.prototype.updateUrl = function (a, b) {
        l.updateUrl(a, b);
        return this
      };
      f.prototype.highLight = function () {
        var a;
        this.$(".project-item.active").removeClass("active");
        this.$(".organization-item.active").removeClass("active");
        a = this.$("#project-" + l._projectId);
        if (!a.length && !this.$el.children().length)return this;
        a.addClass("active");
        a.closest(".collapse", this.$el).collapse("show");
        a.closest(".organization-item",
          this.$el).addClass("active");
        return this
      };
      f.prototype.addHint = function () {
        return this.$(".project-item").each(function () {
          var a;
          a = $(this);
          if (a.find("a").width() <= a.find("span").width())return a.addClass("hinted").data({title: a.find("span").text(), derection: "left"})
        })
      };
      f.prototype.getCollapseShown = function () {
        var a = this;
        this.collapseShown = [];
        return this.$(".collapse.in").each(function (b, d) {
          return a.collapseShown.push(d.id)
        })
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/member/member-detail-panel/index", ["panel-view", "views/member/member-detail/index"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "memberDetailPanel";
      f.prototype.className = "member-detail-panel panel";
      f.prototype.panelWidth = 520;
      f.prototype.defaultLayer = b;
      f.prototype.initialize = function (a) {
        if (!a || !a.memberModel && !a._memberId)return!1;
        this._memberId = a._memberId || a.memberModel.id;
        return f.__super__.initialize.apply(this, arguments)
      };
      f.prototype.isSame = function (a) {
        var b;
        return(a._memberId || (null != (b = a.memberModel) ? b.id : void 0)) === this._memberId
      };
      return f
    }(d)
  })
}).call(this);
define("views/member/member-bar/templates/basic", [], function () {
  return function (d) {
    return'<header class="member-bar-header"></header><section class="member-bar-content scrollable"> <ul class="members-list"></ul></section><footer class="member-bar-footer"> <div class="member-bar-footer-mask"></div> <div class="member-bar-toggler" data-gta="event" data-label="member bar|toggler"> <span class="icon icon-chevron-left"></span> </div></footer>'
  }
});
define("views/member/member-bar/templates/header", [], function () {
  return function (d) {
    var a = "";
    return a = "full" === d.mode ? a + (' <div class="member-bar-inviter"> <span class="icon icon-add-user"></span> <input class="member-invite-input input-small form-control" type="email" placeholder="" data-gta="event" gta-label="member bar|invite by email"></input> </div> <div class="member-bar-link-inviter"> <label class="invite-link-label muted">  <a class="invite-link-hint icon icon-info hinted" data-title="QQ"> \x3c!-- <span class="icon icon-info"></span> --\x3e </a> </label> <input class="invite-link-input input-small form-control" value="' +
      d.inviteLink + '" data-gta="event" gta-label="member bar|invite by link"></input> </div>') : a + ' <a class="member-settings-opener icon icon-plus-sign" data-gta="event" data-label="member bar|open member settings"> </a>'
  }
});
define("views/member/member-bar/templates/member", [], function () {
  return function (d) {
    var a = '<li id="member-' + d._id + '" class="member" data-id="' + d._id + '"> <div class="member-avatar img-circle img-36 pull-left" style="background-image:url(' + d.avatarUrl + ');"></div> <div class="member-info"> <p class="member-name"><strong>' + d.name + '</strong></p> <p class="member-title muted"> ', a = d.title ? a + (" " + d.title + " ") : a + (" " + d.email + " ");
    return a + " </p> </div></li>"
  }
});
define("views/member/member-bar/templates/avatar", [], function () {
  return function (d) {
    return'<div class="member member-in-drag img-circle img-36" data-id="' + d._id + '" style="background-image:url(' + d.avatarUrl + ');"></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/member/member-bar/index", "util view lib/window/index views/member/member-finder/index views/member/member-detail-panel/index views/settings/project-settings/index warehouse collections/projects collections/members ./templates/basic ./templates/header ./templates/member ./templates/avatar".split(" "), function (d, b, e, g, k, h, l, n, m, s, r, t, v) {
    var p, x, B;
    p = teambition.APP;
    x = teambition.PREFERENCE;
    return function (b) {
      function z() {
        return B = z.__super__.constructor.apply(this, arguments)
      }

      a(z, b);
      z.prototype.viewName = "MemberBarView";
      z.prototype.tagName = "aside";
      z.prototype.className = "member-bar";
      z.prototype.events = {"click .member": "showMemberDetail", "click .add-member-handler": "addMemberBtn", "click .member-settings-opener": "openMemberSettings", "click .member-bar-toggler": "toggleMemberBar", "mousewheel .scrollable": d.mousewheel};
      z.prototype.initialize = function (a) {
        if (null == a || !a._projectId)return!1;
        this.options = a;
        this._projectId = this.options._projectId;
        this.projectModel = l.get(n, null, this._projectId);
        this.membersCollection = l.get(m, this._projectId);
        this.renderBasic().renderHeader().renderMembers().switchMode().initDragHandler().listen();
        return this
      };
      z.prototype.listen = function () {
        this.listenTo(this.membersCollection, "change:isQuited change:name change:avatarUrl", this.refreshMember);
        this.listenTo(this.membersCollection, "add",
          this.addMember);
        this.listenTo(this.membersCollection, "remove", this.removeMember);
        return this
      };
      z.prototype.renderBasic = function () {
        this.$el.html(s(this.projectModel.toJSON()));
        this.$header = this.$(".member-bar-header");
        this.$membersList = this.$(".members-list");
        this.$addMemberBtn = this.$(".add-member-handler");
        return this
      };
      z.prototype.renderHeader = function () {
        var a;
        a = this.projectModel.toJSON();
        a.mode = x.get("memberBarMode");
        this.$header.html(r(a));
        "full" === x.get("memberBarMode") && this.initMemberFinder();
        return this
      };
      z.prototype.renderMembers = function () {
        var a, b, d, e;
        e = this.membersCollection.getActiveMembersJSON();
        b = 0;
        for (d = e.length; b < d; b++)a = e[b], this.$membersList.append(t(a));
        this.toggleMembers(this.$(".member"), !0);
        return this
      };
      z.prototype.initMemberFinder = function () {
        var a = this;
        this.requestSubView(g, {collection: this.membersCollection, $searchbox: this.$(".member-invite-input"), select: function (b) {
          return a.membersCollection.addMember(b.item._id ? {_userId: b.item._id} : {email: b.item.email})
        }});
        return this
      };
      z.prototype.initDragHandler = function (a) {
        var b = this;
        a || (a = this.$(".member"));
        a.draggable({zIndex: "10000", appendTo: "body", addClasses: !1, scroll: !1, cursorAt: {top: 18, left: 18}, helper: function (a) {
          a = $(a.currentTarget).data("id");
          a = b.membersCollection.get(a);
          return $(v(a.toJSON()))
        }, start: function () {
          try {
            return teambition.gta.event("member", "drag", "member bar|drag member")
          } catch (a) {
          }
        }});
        return this
      };
      z.prototype.refreshMember = function (a) {
        var b;
        b = a.changed.isQuited;
        _.isBoolean(b) && b ? this.removeMember(a) : _.isBoolean(b) && !b ? this.addMember(a) : (b = $(t(a.toJSON())), this.$("#member-" + a.id).replaceWith(b), this.toggleMembers(b, !0), this.initDragHandler(b));
        return this
      };
      z.prototype.addMember = function (a) {
        var b, d = this;
        b = $(t(a.toJSON())).prependTo(this.$membersList);
        setTimeout(function () {
          return d.initDragHandler(b)
        }, 50);
        return this
      };
      z.prototype.toggleMembers = function (a, b) {
        a.transition(b ? {height: "auto", opacity: 1} : {height: 0, opacity: 0});
        return this
      };
      z.prototype.removeMember = function (a) {
        this.$("#member-" + a.id).transition({height: 0,
          opacity: 0}, function () {
          return $(this).remove()
        });
        return this
      };
      z.prototype.showMemberDetail = function (a) {
        var b;
        b = $(a.currentTarget).data("id");
        a = this.membersCollection.get(b);
        p.showPanel(k, {memberModel: a, _memberId: b, _projectId: this.options._projectId});
        return this
      };
      z.prototype.openMemberSettings = function () {
        this.requestSubView(e).open(h, {projectModel: this.projectModel, tab: "member-settings"});
        return this
      };
      z.prototype.toggleMemberBar = function () {
        x.toggleMemberBarMode();
        this.renderHeader().switchMode();
        return this
      };
      z.prototype.switchMode = function (a, b) {
        var d;
        null == a && (a = x.get("memberBarMode"));
        d = _.extend({animated: !0}, b).animated ? "transition" : "css";
        "full" === a ? (p.$el.addClass("with-full-member-bar")[d]({"padding-right": 140}, 218, "ease"), this.$el[d]({right: 0}, 218, "ease"), this.$el.addClass("member-bar-full-mode")) : (p.$el.removeClass("with-full-member-bar")[d]({"padding-right": 0}, 218, "ease"), this.$el[d]({right: -140}, 218, "ease"), this.$el.removeClass("member-bar-full-mode"));
        return this
      };
      z.prototype.remove = function () {
        p.$el.removeClass("with-full-member-bar").css({"padding-right": 0});
        return z.__super__.remove.apply(this, arguments)
      };
      return z
    }(b)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/app", ["model", "warehouse"], function (d, b) {
    var e;
    return function (d) {
      function f() {
        return e = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.name = "app";
      f.prototype.idAttribute = "name";
      f.prototype.getCollection = function (a) {
        return b.request("apps", null, {success: a})
      };
      f.prototype.getUrl =
        function () {
          return"app:" + this.get("name")
        };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("collections/apps", ["collection", "models/app"], function (d, b) {
    var e, g;
    e = [
      {name: "home", title: ""},
      {name: "board", title: ""},
      {name: "wall", title: ""},
      {name: "library", title: ""},
      {name: "events", title: ""},
      {name: "review", title: ""}
    ];
    return function (d) {
      function f() {
        return g = f.__super__.constructor.apply(this,
          arguments)
      }

      a(f, d);
      f.prototype.name = "apps";
      f.prototype.model = b;
      f.prototype.sync = function (a, b, d) {
        switch (a) {
          case "read":
            return d.success(e), this.synced = 1
        }
      };
      return f
    }(d)
  })
}).call(this);
define("views/core/app-switcher/templates/basic", [], function () {
  return function (d) {
    var a = '<ul class="list list-tabs"> ';
    if (d)for (var f, b = -1, e = d.length - 1; b < e;)f = d[b += 1], a += ' <li> <a class="app ', f.name === d.appName && (a += "active"), a += '" data-app="' + f.name + '" data-gta="event" data-label="enter ' + f.name + '" data-use-mixpanel="true"> <span class="icon icon-', a = "events" == f.name ? a + "calendar" : a + f.name, a += '"></span> <span>' + f.title + "</span> </a> </li> ";
    return a + ' <li> <a class="settings" data-gta="event" data-label="open project settings"> <span class="icon icon-cog"></span> <span></span> </a> </li></ul>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/core/app-switcher/index", "view lib/window/index views/settings/project-settings/index warehouse collections/apps collections/projects ./templates/basic".split(" "), function (d, b, e, g, k, h, l) {
    var n, m;
    n = teambition.router;
    return function (d) {
      function f() {
        return m = f.__super__.constructor.apply(this,
          arguments)
      }

      a(f, d);
      f.prototype.viewName = "AppSwitcherView";
      f.prototype.id = "app-switcher";
      f.prototype.tagName = "nav";
      f.prototype.className = "app-switcher";
      f.prototype.events = {"click .app": "route", "click .settings": "showProjectSettings"};
      f.prototype.initialize = function (a) {
        this.options = null != a ? a : {};
        this.render();
        return this
      };
      f.prototype.render = function () {
        var a;
        $(".app-switcher").remove();
        a = g.get(k, null).toJSON();
        a.appName = this.options.appName;
        a._projectId = this.options._projectId;
        this.$el.html(l(a));
        return this
      };
      f.prototype.route = function (a) {
        var b;
        a = $(a.currentTarget);
        a.hasClass("active") || (a = a.data("app"), b = n.getUrl(), b = b.replace(/(home|wall|board|library|events|review)+\S*/, a), n.navigate(b, {trigger: !0}));
        return this
      };
      f.prototype.showProjectSettings = function () {
        var a;
        if (a = this.options._projectId)a = g.get(h).get(a), this.requestSubView(b).open(e, {projectModel: a, tab: "project-info"});
        return this
      };
      return f
    }(d)
  })
}).call(this);
define("views/core/markdown-helper/templates/basic", [], function () {
  return function (d) {
    return'<header class="markdown-header no-bottom "> <a class="close-window-handler pull-right icon icon-remove icon-white" data-dismiss="modal"></a> <h4 class="markdown-title">Markdown</h4> <p class="markdown-desc">Markdown HTML</p></header><div class="markdown-content"> <h4 class="title"> <small> <a href="http://wowubuntu.com/markdown/" target="_blank">Markdown</a></small></h4> <div class="syntax-content clearfix"> <div class="span4"> <p><span class="syntax">#</span></p> <p><span class="syntax">##</span></p> <p><span class="syntax">###</span></p> <p><span class="syntax">####</span></p> <p><span class="syntax">*</span><span class="syntax">*</span></p> <p><span class="syntax">**</span><span class="syntax">**</span></p> </div> <div class="span4"> <p><span class="syntax">___</span></p> <p><span class="syntax">+ </span>1</p> <p><span class="syntax">+ </span>2</p> <p><span class="syntax">1. </span>1</p> <p><span class="syntax">2. </span>2</p> <p><span class="syntax">3. </span>3</p> </div> <div class="span4"> <p><span class="syntax">&gt; </span></p> <p><span class="syntax">&gt; </span></p> <p><span class="syntax">[</span><span class="syntax">](</span>url.cn<span class="syntax">)</span></p> <p><span class="syntax">![</span><span class="syntax">](</span>url.cn/img.png<span class="syntax">)</span></p> <p><span class="syntax">`</span><span class="syntax">`</span></p> <p><span class="syntax">4</span></p> </div> </div> <h4 class="title"> <small>   Markdown</small></h4> <div class="preview-content clearfix"> <div class="span6"> <div class="markdown-try"> <textarea class="markdown-textarea" data-gta="event" data-label="try markdown" data-action="focus" data-category="textarea" placeholder="Markdown..."></textarea> </div> </div> <div class="span6"> <div class="markdown-preview"></div> </div> </div> </div></div>'
  }
});
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("views/core/markdown-helper/index", ["view", "markdown", "./templates/basic"], function (d, b, e) {
    var g;
    return function (d) {
      function f() {
        return g = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.viewName = "markdownHelperView";
      f.prototype.className = "markdown-helper modal-dialog";
      f.prototype.events =
      {};
      f.prototype.initialize = function (a) {
        this.options = _.extend({}, a);
        this.renderBasic();
        return this
      };
      f.prototype.renderBasic = function () {
        var a = this;
        this.$el.html(e());
        this.$markdown = this.$(".markdown-textarea").flexText();
        this.$preview = this.$(".markdown-preview");
        this.$markdown.on("input", function (d) {
          d = b(_.unescape(a.$markdown[0].value));
          return a.$preview.html(d)
        });
        return this
      };
      return f
    }(d)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("app", "view lib/window/index lib/notification/index views/core/float/index views/portal/index views/wall/wall/index views/board/board/index views/dashboard/dashboard/index views/library/library/index views/events/events/index views/review/review/index views/core/navigation/index views/core/switcher/index views/member/member-bar/index views/core/app-switcher/index views/inbox/inbox/index views/core/markdown-helper/index warehouse collections/messages collections/members collections/projects hotkey".split(" "),
    function (d, b, e, g, k, h, l, n, m, s, r, t, v, p, x, B, C, z, A, u, w, y) {
      var J, F, H, E, I;
      H = teambition.router;
      E = teambition.user;
      J = teambition.PREFERENCE;
      F = {wall: h, home: n, board: l, library: m, events: s, review: r};
      return function (d) {
        function f() {
          return I = f.__super__.constructor.apply(this, arguments)
        }

        a(f, d);
        f.prototype.viewName = "AppView";
        f.prototype.el = $("body");
        f.prototype.responsiveViews = {};
        f.prototype.hotkeys = {"`|shift+`": "toggleSwitcher", h: "backToDashboard", "?": "openMyboard", "shift+m": "openMdHelper", backspace: function (a, b) {
          return a.preventDefault()
        }};
        f.prototype.events = {"click .readable a": "routeLink"};
        f.prototype.initialize = function () {
          var a, b = this;
          this.defaultTitle = document.title;
          this.Float = this.requestSubView(g);
          this.$content = $("#content");
          this.$appContent = $("#app-content");
          this.$navigator = this.$("#navigator");
          this.$toolbar = this.$("#tool-bar");
          this.$backToMain = this.$("#close-extend-wrapper");
          this.navigation = this.requestSubView(t);
          this.projectsCollection = z.get(w);
          this.messagesCollection = z.get(A, E.id);
          this.messagesCollection.listen();
          this.listen();
          a = _.throttle(function () {
            return b.layout()
          }, 500);
          $(window).resize(a);
          y.add(this);
          return this
        };
        f.prototype.layout = function () {
          var a, b, d;
          if (!_.isEmpty(this.responsiveViews)) {
            d = this.responsiveViews;
            for (a in d)b = d[a], "function" === typeof b.layout && b.layout();
            return this
          }
        };
        f.prototype.listen = function () {
          var a, b = this;
          a = function (a) {
            var d;
            if (!a.get("isArchived") && a.get("unreadActivitiesCount") && (d = a.genNotification(), d.creator && d.creator._id !== E.id))return e.show(d, function () {
              window.focus();
              a.markRead();
              return b.Float.open(B,
                {_messageId: a.id})
            })
          };
          this.listenTo(J, "change:memberBarMode change:switcherOn", function () {
            return _.delay(b.layout, 300)
          });
          this.listenTo(this.messagesCollection, "change:latestActivity", a);
          this.listenTo(this.messagesCollection, "add", function (b) {
            if (!b.get("isRead"))return a(b)
          });
          return this
        };
        f.prototype.toggleSwitcher = function () {
          this.initSwitcher().toggle();
          return this
        };
        f.prototype.backToDashboard = function () {
          H.navigate("projects", {trigger: !0});
          return!1
        };
        f.prototype.initSwitcher = function () {
          this.switcher ||
          (this.switcher = this.requestSubView(v));
          H.checkRoute(Backbone.history.getFragment(), this.switcher);
          return this.switcher
        };
        f.prototype.initMemberBar = function (a) {
          this.removeMemberBar();
          this.memberBar = this.requestSubView(p, a);
          this.memberBar.$el.appendTo(this.$el);
          return this
        };
        f.prototype.removeMemberBar = function () {
          var a;
          null != (a = this.memberBar) && a.remove();
          delete this.memberBar;
          return this
        };
        f.prototype.enter = function (a, b) {
          var d, e, f = this;
          this.navigation.setup(b);
          this.Float.close();
          this.hidePanel();
          this.toggleAppSwitcher(a,
            b);
          this.currentAppName = a;
          null != (e = this.currentView) && e.remove();
          this._organizationId = b._organizationId;
          d = this._projectId === b._projectId;
          this._projectId = b._projectId;
          J.get("switcherOn") && this.initSwitcher().show();
          if (F[a]) {
            if (!b._projectId)return;
            this.loadMembers("project", b._projectId, function () {
              d || f.initMemberBar(b);
              "review" === a ? (f.memberBar.$el.hide(), f.$el.hasClass("with-full-member-bar") && f.$el.css({"padding-right": ""})) : (f.memberBar.$el.show(), f.$el.hasClass("with-full-member-bar") && f.$el.css({"padding-right": 140}));
              f.enterApp(F[a], b);
              return $("body").scrollTop(0)
            })
          } else this.enterApp(k, b), this.removeMemberBar(), "inbox" === b.routeString && this.Float.toggleInbox();
          return this
        };
        f.prototype.enterApp = function (a, b) {
          b.onError = function () {
            return H.home()
          };
          this.currentView = this.requestSubView(a, b);
          this.$content.html(this.currentView.$el);
          H.checkRoute(b.routeString, this.currentView);
          return this
        };
        f.prototype.loadMembers = function (a, b, d) {
          z.request(u, b, {boundToObjectType: a, success: d});
          return this
        };
        f.prototype.toggleAppSwitcher =
          function (a, b) {
            this.$("#app-switcher").remove();
            F[a] && (b = {_projectId: b._projectId, appName: a}, this.requestSubView(x, b).$el.appendTo(this.$el));
            return this
          };
        f.prototype.openMdHelper = function () {
          var a;
          null != (a = this.markdownHelperView) && a.$el || (this.markdownHelperView = this.requestSubView(b).open(C));
          return this
        };
        f.prototype.openMyboard = function () {
          this.Float.toggleDashboard();
          return this
        };
        f.prototype.showPanel = function (a, b) {
          var d, e = this;
          null != (d = this.panelView) && d.isIn ? this.panelView.isSame(b) ? this.panelView.hide() :
            this.panelView.hide({hidden: function () {
              e.panelView.remove();
              delete e.panelView;
              e.panelView = e.requestSubView(a, b);
              return e.panelView.show()
            }}) : (this.panelView && (this.panelView.remove(), delete this.panelView), this.panelView = this.requestSubView(a, b), this.panelView.show());
          return this
        };
        f.prototype.hidePanel = function () {
          var a, b = this;
          null != (a = this.panelView) && a.isIn && this.panelView.hide({hidden: function () {
            return delete b.panelView
          }});
          return this
        };
        f.prototype.updateUrl = function (a, b) {
          var d, e;
          e = (d = a._projectId ||
            this._projectId || null) ? "project/" + d + "/home" : "projects";
          d = H.getUrl();
          e !== d.slice(0, e.length) && H.navigate(e, b);
          return this
        };
        f.prototype.routeLink = function (a) {
          var b;
          b = a.currentTarget;
          if (b.href && !$(b).closest(".post-editor-textarea").length)return a.preventDefault(), b.host === window.location.host ? H.navigate(b.pathname, {trigger: !0}) : window.open(b.href)
        };
        f.prototype.dynamicTitle = function () {
          var a, b, d;
          a = H.getUrl().split("/");
          "project" === a[0] && (b = null != (d = this.projectsCollection.get(a[1])) ? d.get("name") : void 0);
          document.title = b ? "" + b + "  Teambition" : this.defaultTitle;
          return this
        };
        return f
      }(d)
    })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/user", ["warehouse", "model"], function (d, b) {
    var e, g;
    e = teambition.user;
    return function (b) {
      function h() {
        return g = h.__super__.constructor.apply(this, arguments)
      }

      a(h, b);
      h.prototype.name = "user";
      h.prototype.defaults = {name: "", title: "", phone: "", location: "", website: "", birthday: "", email: ""};
      h.prototype.initialize =
        function () {
          var a, b, d, e;
          this.formatBirthday();
          this.listenTo(this, "change:birthday", this.formatBirthday);
          e = this.get("emails");
          b = 0;
          for (d = e.length; b < d; b++)a = e[b], a.email === this.get("email") && this.set("_emailId", a._id, {silent: !0});
          return h.__super__.initialize.apply(this, arguments)
        };
      h.prototype.formatBirthday = function () {
        var a;
        if ((a = this.get("birthday")) && !(a instanceof Date))return a = new Date(a), this.set("birthday", a, {silent: !0})
      };
      h.prototype.sync = function (a, b, e) {
        switch (a) {
          case "update":
            return"function" === typeof e.beforeSend && e.beforeSend(b), a = this.changed, d.socket.emit("update:user", a), d.socket.once("update:user", function (a) {
              return a.errorCode ? null != e ? "function" === typeof e.error ? e.error(a.errorCode) : void 0 : void 0 : "function" === typeof e.success ? e.success(a.user) : void 0
            });
          case "password":
            return d.socket.emit("sendresetpasswordmail:user")
        }
      };
      h.prototype.getSetting = function (a, b) {
        var d;
        return~a.indexOf(".") ? (d = a.split("."), this.attributes[b][d[0]][d[1]]) : this.attributes[b][a]
      };
      h.prototype.sendResetPasswordMail =
        function (a) {
          return this.sync("password", this, a)
        };
      h.prototype.updatePassword = function (a, b) {
        return this.sync("password", a, b)
      };
      h.prototype.unBindEverNote = function (a) {
        a.beforeSend();
        d.socket.emit("unbind:evernote", {_userId: e.id});
        return d.socket.once("unbind:evernote" + e.id, function (b) {
          return b.err ? "function" === typeof a.error ? a.error(b.err) : void 0 : "function" === typeof a.success ? a.success() : void 0
        })
      };
      h.prototype.emailSetting = function (a, b, e) {
        var g;
        g = {setMain: "setprimaryemail:user", resend: "sendverifyemail:user",
          "delete": "deleteemail:user"};
        d.socket.emit(g[a], {_emailId: b});
        return d.socket.once(g[a], function (b) {
          var d;
          switch (a) {
            case "setMain":
              d = "";
              break;
            case "resend":
              d = "";
              break;
            case "delete":
              d = ""
          }
          return"function" === typeof e ? e(b.errorCode, d) : void 0
        })
      };
      h.prototype.addEmail = function (a, b) {
        d.socket.emit("addemail:user", {email: a});
        return d.socket.once("addemail:user", function (a) {
          return"function" === typeof b ? b(a.errorCode, "") : void 0
        })
      };
      return h
    }(b)
  })
}).call(this);
(function () {
  var d = {}.hasOwnProperty, a = function (a, b) {
    function e() {
      this.constructor = a
    }

    for (var g in b)d.call(b, g) && (a[g] = b[g]);
    e.prototype = b.prototype;
    a.prototype = new e;
    a.__super__ = b.prototype;
    return a
  };
  define("models/preference", ["model"], function (d) {
    var b;
    return function (d) {
      function f() {
        return b = f.__super__.constructor.apply(this, arguments)
      }

      a(f, d);
      f.prototype.name = "preference";
      f.prototype.defaults = {memberBarMode: "full", switcherOn: !1, hideDoneTasks: 0};
      f.prototype.toggleMemberBarMode = function (a) {
        null ==
          a && (a = "full" === this.get("memberBarMode") ? "mini" : "full");
        this.save({memberBarMode: a});
        return a
      };
      f.prototype.toggleSwitcherOn = function (a) {
        null == a && (a = !this.get("switcherOn"));
        this.save({switcherOn: a});
        return a
      };
      f.prototype.quickReply = function (a) {
        null != a && this.save({quickReply: !!a});
        return this.get("quickReply")
      };
      f.prototype.quickCreateTask = function (a) {
        null != a && this.save({quickCreateTask: !!a});
        return this.get("quickCreateTask")
      };
      f.prototype.togglePostMode = function (a) {
        a && this.save({postMode: a});
        return this.get("postMode")
      };
      f.prototype.tasksSortInStage = function (a, b) {
        var d, e;
        e = this.get("taskSort") || {};
        _.isArray(b) && (e[a] = b, d = {taskSort: {}}, d.taskSort[a] = b, this.sync("patch", this, {attrs: d}));
        return e[a]
      };
      f.prototype.structureNotification = function (a) {
        var b, d, e, f;
        b = this.attributes.notification;
        b = {comment: {mobile: b.comment.mobile, email: b.comment.email}, involve: {mobile: b.involve.mobile, email: b.involve.email}, newpost: {mobile: b.newpost.mobile, email: b.newpost.email}, newtask: {mobile: b.newtask.mobile, email: b.newtask.email}, newwork: {mobile: b.newwork.mobile,
          email: b.newwork.email}, update: {mobile: b.update.mobile, email: b.update.email}, daily: {email: null != (e = b.daily) ? e.email : void 0}};
        for (d in a)f = a[d], e = d.split("."), b[e[0]][e[1]] = f;
        return b
      };
      f.prototype.updateNotification = function (a, b) {
        this.save({notification: this.structureNotification(a)}, b);
        return this
      };
      return f
    }(d)
  })
}).call(this);
+function (d) {
  d.fn.emulateTransitionEnd = function (a) {
    var f = !1, b = this;
    d(this).one(d.support.transition.end, function () {
      f = !0
    });
    setTimeout(function () {
      f || d(b).trigger(d.support.transition.end)
    }, a);
    return this
  };
  d(function () {
    var a = d.support, f;
    a:{
      f = document.createElement("bootstrap");
      var b = {WebkitTransition: "webkitTransitionEnd", MozTransition: "transitionend", OTransition: "oTransitionEnd otransitionend", transition: "transitionend"}, e;
      for (e in b)if (void 0 !== f.style[e]) {
        f = {end: b[e]};
        break a
      }
      f = void 0
    }
    a.transition =
      f
  })
}(window.jQuery);
!function (d) {
  var a = function (a) {
    d(a).on("click", '[data-dismiss="alert"]', this.close)
  };
  a.prototype.close = function (a) {
    function e() {
      h.trigger("closed").remove()
    }

    var f = d(this), k = f.attr("data-target"), h;
    k || (k = (k = f.attr("href")) && k.replace(/.*(?=#[^\s]*$)/, ""));
    h = d(k);
    a && a.preventDefault();
    h.length || (h = f.hasClass("alert") ? f : f.parent());
    h.trigger(a = d.Event("close"));
    a.isDefaultPrevented() || (h.removeClass("in"), d.support.transition && h.hasClass("fade") ? h.on(d.support.transition.end, e) : e())
  };
  var f = d.fn.alert;
  d.fn.alert = function (b) {
    return this.each(function () {
      var e = d(this), f = e.data("alert");
      f || e.data("alert", f = new a(this));
      "string" == typeof b && f[b].call(e)
    })
  };
  d.fn.alert.Constructor = a;
  d.fn.alert.noConflict = function () {
    d.fn.alert = f;
    return this
  };
  d(document).on("click.alert.data-api", '[data-dismiss="alert"]', a.prototype.close)
}(window.jQuery);
!function (d) {
  var a = function (a, e) {
    this.$element = d(a);
    this.options = d.extend({}, d.fn.button.defaults, e)
  };
  a.prototype.setState = function (a) {
    var d = this.$element, f = d.data(), k = d.is("input") ? "val" : "html";
    a += "Text";
    f.resetText || d.data("resetText", d[k]());
    d[k](f[a] || this.options[a]);
    setTimeout(function () {
      "loadingText" == a ? d.addClass("disabled").attr("disabled", "disabled") : d.removeClass("disabled").removeAttr("disabled")
    }, 0)
  };
  a.prototype.toggle = function () {
    var a = this.$element.closest('[data-toggle="buttons-radio"]');
    a && a.find(".active").removeClass("active");
    this.$element.toggleClass("active")
  };
  var f = d.fn.button;
  d.fn.button = function (b) {
    return this.each(function () {
      var e = d(this), f = e.data("button"), k = "object" == typeof b && b;
      f || e.data("button", f = new a(this, k));
      "toggle" == b ? f.toggle() : b && f.setState(b)
    })
  };
  d.fn.button.defaults = {loadingText: "loading..."};
  d.fn.button.Constructor = a;
  d.fn.button.noConflict = function () {
    d.fn.button = f;
    return this
  };
  d(document).on("click.button.data-api", "[data-toggle^=button]", function (a) {
    a = d(a.target);
    a.hasClass("btn") || (a = a.closest(".btn"));
    a.button("toggle")
  })
}(window.jQuery);
!function (d) {
  var a = function (a, e) {
    this.$element = d(a);
    this.$indicators = this.$element.find(".carousel-indicators");
    this.options = e;
    "hover" == this.options.pause && this.$element.on("mouseenter", d.proxy(this.pause, this)).on("mouseleave", d.proxy(this.cycle, this))
  };
  a.prototype = {cycle: function (a) {
    a || (this.paused = !1);
    this.interval && clearInterval(this.interval);
    this.options.interval && !this.paused && (this.interval = setInterval(d.proxy(this.next, this), this.options.interval));
    return this
  }, getActiveIndex: function () {
    this.$active =
      this.$element.find(".item.active");
    this.$items = this.$active.parent().children();
    return this.$items.index(this.$active)
  }, to: function (a) {
    var e = this.getActiveIndex(), f = this;
    if (!(a > this.$items.length - 1 || 0 > a))return this.sliding ? this.$element.one("slid", function () {
      f.to(a)
    }) : e == a ? this.pause().cycle() : this.slide(a > e ? "next" : "prev", d(this.$items[a]))
  }, pause: function (a) {
    a || (this.paused = !0);
    this.$element.find(".next, .prev").length && d.support.transition.end && (this.$element.trigger(d.support.transition.end),
      this.cycle(!0));
    clearInterval(this.interval);
    this.interval = null;
    return this
  }, next: function () {
    if (!this.sliding)return this.slide("next")
  }, prev: function () {
    if (!this.sliding)return this.slide("prev")
  }, slide: function (a, e) {
    var f = this.$element.find(".item.active"), k = e || f[a](), h = this.interval, l = "next" == a ? "left" : "right", n = "next" == a ? "first" : "last", m = this;
    this.sliding = !0;
    h && this.pause();
    k = k.length ? k : this.$element.find(".item")[n]();
    n = d.Event("slide", {relatedTarget: k[0], direction: l});
    if (!k.hasClass("active")) {
      this.$indicators.length &&
      (this.$indicators.find(".active").removeClass("active"), this.$element.one("slid", function () {
        var a = d(m.$indicators.children()[m.getActiveIndex()]);
        a && a.addClass("active")
      }));
      if (d.support.transition && this.$element.hasClass("slide")) {
        this.$element.trigger(n);
        if (n.isDefaultPrevented())return;
        k.addClass(a);
        k[0].offsetWidth;
        f.addClass(l);
        k.addClass(l);
        this.$element.one(d.support.transition.end, function () {
          k.removeClass([a, l].join(" ")).addClass("active");
          f.removeClass(["active", l].join(" "));
          m.sliding = !1;
          setTimeout(function () {
            m.$element.trigger("slid")
          }, 0)
        })
      } else {
        this.$element.trigger(n);
        if (n.isDefaultPrevented())return;
        f.removeClass("active");
        k.addClass("active");
        this.sliding = !1;
        this.$element.trigger("slid")
      }
      h && this.cycle();
      return this
    }
  }};
  var f = d.fn.carousel;
  d.fn.carousel = function (b) {
    return this.each(function () {
      var e = d(this), f = e.data("carousel"), k = d.extend({}, d.fn.carousel.defaults, "object" == typeof b && b), h = "string" == typeof b ? b : k.slide;
      f || e.data("carousel", f = new a(this, k));
      if ("number" == typeof b)f.to(b);
      else if (h)f[h](); else k.interval && f.pause().cycle()
    })
  };
  d.fn.carousel.defaults = {interval: 5E3, pause: "hover"};
  d.fn.carousel.Constructor = a;
  d.fn.carousel.noConflict = function () {
    d.fn.carousel = f;
    return this
  };
  d(document).on("click.carousel.data-api", "[data-slide], [data-slide-to]", function (a) {
    var e = d(this), f, k = d(e.attr("data-target") || (f = e.attr("href")) && f.replace(/.*(?=#[^\s]+$)/, ""));
    f = d.extend({}, k.data(), e.data());
    var h;
    k.carousel(f);
    (h = e.attr("data-slide-to")) && k.data("carousel").pause().to(h).cycle();
    a.preventDefault()
  })
}(window.jQuery);
!function (d) {
  var a = function (a, e) {
    this.$element = d(a);
    this.options = d.extend({}, d.fn.collapse.defaults, e);
    this.options.parent && (this.$parent = d(this.options.parent));
    this.options.trigger && (this.$trigger = d(this.options.trigger));
    this.options.toggle && this.toggle()
  };
  a.prototype = {constructor: a, dimension: function () {
    return this.$element.hasClass("width") ? "width" : "height"
  }, show: function () {
    var a, e, f, k;
    if (!this.transitioning && !this.$element.hasClass("in")) {
      a = this.dimension();
      e = d.camelCase(["scroll", a].join("-"));
      if ((f = this.$parent && this.$parent.find("> .accordion-group > .in")) && f.length) {
        if ((k = f.data("collapse")) && k.transitioning)return;
        f.collapse("hide");
        k || f.data("collapse", null)
      }
      this.$element[a](0);
      this.$trigger.removeClass("collapsed");
      this.transition("addClass", d.Event("show"), "shown");
      d.support.transition && this.$element[a](this.$element[0][e])
    }
  }, hide: function () {
    var a;
    !this.transitioning && this.$element.hasClass("in") && (a = this.dimension(), this.reset(this.$element[a]()), this.$trigger.addClass("collapsed"),
      this.transition("removeClass", d.Event("hide"), "hidden"), this.$element[a](0))
  }, reset: function (a) {
    var d = this.dimension();
    this.$element.removeClass("collapse")[d](a || "auto")[0].offsetWidth;
    this.$element[null !== a ? "addClass" : "removeClass"]("collapse");
    return this
  }, transition: function (a, e, f) {
    var k = this, h = function () {
      "show" == e.type && k.reset();
      k.transitioning = 0;
      k.$element.trigger(f)
    };
    this.$element.trigger(e);
    e.isDefaultPrevented() || (this.transitioning = 1, this.$element[a]("in"), d.support.transition && this.$element.hasClass("collapse") ?
      this.$element.one(d.support.transition.end, h) : h())
  }, toggle: function () {
    this[this.$element.hasClass("in") ? "hide" : "show"]()
  }};
  var f = d.fn.collapse;
  d.fn.collapse = function (b) {
    return this.each(function () {
      var e = d(this), f = e.data("collapse"), k = d.extend({}, d.fn.collapse.defaults, e.data(), "object" == typeof b && b);
      f || e.data("collapse", f = new a(this, d.extend(k, {trigger: d("[href=#" + e.attr("id") + "]")})));
      if ("string" == typeof b)f[b]()
    })
  };
  d.fn.collapse.defaults = {toggle: !0};
  d.fn.collapse.Constructor = a;
  d.fn.collapse.noConflict =
    function () {
      d.fn.collapse = f;
      return this
    };
  d(document).on("click.collapse.data-api", "[data-toggle=collapse]", function (a) {
    var e = d(this), f;
    a = e.attr("data-target") || a.preventDefault() || (f = e.attr("href")) && f.replace(/.*(?=#[^\s]+$)/, "");
    e = d(a).data("collapse") ? "toggle" : e.data();
    d(a).collapse(e)
  })
}(window.jQuery);
+function (d) {
  function a(a, b) {
    function d() {
      e.css({top: "inherit", bottom: "top" == g ? "100%" : "auto"})
    }

    var e = a.find(".dropdown-menu"), f = /\s?auto\s?/i, g = b.direction, h = f.test(g);
    h && (g = g.replace(f, "") || "bottom");
    d();
    if (h) {
      var f = document.documentElement.scrollTop || document.body.scrollTop, h = window.innerHeight, k = e[0].offsetHeight, x = e.offset();
      x.top < f && "top" == g ? g = "bottom" : x.top + k > f + h && "bottom" == g && (g = "top");
      d()
    }
  }

  function f() {
    d(e).remove();
    d(g).each(function (a) {
      var e = b(d(this));
      e.hasClass("open") && (e.trigger(a = d.Event("hide.bs.dropdown")),
        a.isDefaultPrevented() || e.removeClass("open").trigger("hidden.bs.dropdown"))
    })
  }

  function b(a) {
    var b = a.attr("data-target");
    b || (b = (b = a.attr("href")) && /#/.test(b) && b.replace(/.*(?=#[^\s]*$)/, ""));
    return(b = b && d(b)) && b.length ? b : a.parent()
  }

  var e = ".dropdown-backdrop", g = "[data-toggle=dropdown]", k = function (a, b) {
    d(a).on("click.bs.dropdown", this.toggle).data("options", this.getOptions(b))
  };
  k.DEFAULTS = {direction: "auto bottom"};
  k.prototype.getOptions = function (a) {
    a = a || {};
    return a = d.extend({}, k.DEFAULTS, a)
  };
  k.prototype.toggle =
    function (e) {
      var g = d(this);
      if (!g.is(".disabled, :disabled")) {
        var h = b(g);
        e = h.hasClass("open");
        f();
        if (!e) {
          if ("ontouchstart"in document.documentElement)d('<div class="dropdown-backdrop"/>').insertAfter(d(this)).on("click", f);
          h.trigger(e = d.Event("show.bs.dropdown"));
          if (e.isDefaultPrevented())return;
          h.toggleClass("open").trigger("shown.bs.dropdown");
          h.hasClass("open") && a(h, g.data("options") || k.DEFAULTS)
        }
        g.focus();
        return!1
      }
    };
  k.prototype.keydown = function (a) {
    if (/(38|40|27)/.test(a.keyCode)) {
      var e = d(this);
      a.preventDefault();
      a.stopPropagation();
      if (!e.is(".disabled, :disabled")) {
        var f = b(e), h = f.hasClass("open");
        if (!h || h && 27 == a.keyCode)return 27 == a.which && f.find(g).focus(), e.click();
        e = d("[role=menu] li:not(.divider):visible a", f);
        e.length && (f = e.index(e.filter(":focus")), 38 == a.keyCode && 0 < f && f--, 40 == a.keyCode && f < e.length - 1 && f++, ~f || (f = 0), e.eq(f).focus())
      }
    }
  };
  var h = d.fn.dropdown;
  d.fn.dropdown = function (a) {
    return this.each(function () {
      var b = d(this), e = b.data("dropdown");
      e || b.data("dropdown", e = new k(this, a));
      "string" == typeof a && e[a].call(b)
    })
  };
  d.fn.dropdown.Constructor = k;
  d.fn.dropdown.noConflict = function () {
    d.fn.dropdown = h;
    return this
  };
  d(document).on("click.bs.dropdown.data-api", f).on("click.bs.dropdown.data-api", ".dropdown form",function (a) {
    a.stopPropagation()
  }).on("click.bs.dropdown.data-api", g, k.prototype.toggle).on("keydown.bs.dropdown.data-api", g + ", [role=menu]", k.prototype.keydown)
}(window.jQuery);
!function (d) {
  function a(b) {
    var d, f;
    if (f = arguments[1]) {
      for (d in f)b[d] = f[d];
      d = Array.prototype.slice.call(arguments, 2);
      d.unshift(b);
      return a.apply(this, d)
    }
    return b
  }

  var f = function (b, d) {
    var f = this, h;
    a(this, d);
    this.$parent = b;
    h = this.getItems();
    var l = h.find(".selected");
    this.$selected = l.length ? l : h.eq(0);
    h.not(this.$selected).css("display", "none");
    h.bind("click", function (a) {
      f.selectByClick.apply(f, arguments);
      f.toggle.apply(f, arguments);
      a.preventDefault();
      a.stopPropagation()
    });
    this.initStyle()
  };
  f.prototype =
  {constructor: f, initStyle: function () {
    this.getItemHeight();
    var a = this.getParent(), b = this.getItems(), f = a.css("position"), b = d(b[0]);
    this.originItemCss = {position: b.css("position"), left: b.css("left"), right: b.css("right"), top: b.css("top"), bottom: b.css("bottom")};
    this.originParentCss = {position: a.css("position")};
    this.marginTop = +b.css("margin-top").replace("px", "");
    this.marginLeft = +b.css("margin-left").replace("px", "");
    this.marginBottom = +b.css("margin-bottom").replace("px", "");
    this.marginRight = +b.css("margin-right").replace("px",
      "");
    this.paddingTop = +a.css("padding-top").replace("px", "");
    this.paddingLeft = +a.css("padding-left").replace("px", "");
    this.paddingBottom = +a.css("padding-bottom").replace("px", "");
    this.paddingRight = +a.css("padding-right").replace("px", "");
    "static" == f && a.css("position", "relative")
  }, getItemHeight: function () {
    var a = this.itemHeight;
    a || (a = this.itemHeight = this.getItems().first().outerHeight());
    return a
  }, getSelectClasses: function () {
    if (!this.selectClasses) {
      var a = this.getItems(), b, f = [], h;
      for (b = 0; b < a.length; b++)(h =
        d(a[b]).data("select-class")) && f.push(h);
      this.selectClasses = f.join(" ")
    }
    return this.selectClasses
  }, selectByClick: function (a) {
    this._changeSelected(d(a.currentTarget))
  }, _select: function () {
    var a = this.getParent(), b = this.getItems(), f = this.$selected, h = b.length, l = 0;
    a.find(".selected").removeClass("selected");
    for (f.addClass("selected"); l < h; l++)d(b[l]).css({"z-index": h - l});
    f.css({"z-index": h + 1});
    this.$selected = f
  }, _changeSelected: function (a) {
    a.is(this.$selected) || this.$items.not(a).hide();
    a.show();
    this.$selected =
      a
  }, select: function (a) {
    this.getParent();
    var b = typeof a, f;
    "object" === b && (f = a);
    "string" === b ? f = d(a) : "number" === b && (f = d(this.getItems()[a]));
    this._changeSelected(f)
  }, close: function () {
    this.fold()
  }, bindEvents: function (a) {
    if (a instanceof Array)for (var b = 0, d = a.length; b < d; b++)this.bindEvents(a[b]); else {
      var f = this;
      this.getToggleElement(a).bind("click", function () {
        f.toggle.apply(f, arguments)
      })
    }
  }, getItems: function () {
    var a = this.getParent(), b = this.$items;
    b || (b = this.$items = a.find(this.itemSelector));
    return b
  }, getToggleElement: function (a) {
    var b =
      this.getParent();
    a += "Selector";
    return"first" === this[a] ? b.find(this.itemSelector).first() : b.find(this[a])
  }, toggle: function () {
    var a = d(this);
    this.getParent();
    a.is(".disabled, :disabled") || this.animateRunning() || (this.prohibitAnimate(), this.isActive() ? this.fold() : this.spread())
  }, fold: function () {
    var a = this.getParent(), b = this.getItems(), d = this, f = this.getItemHeight();
    this.timer && clearTimeout(this.timer);
    this._select();
    this.onAnimateStart();
    a.removeClass(d.activeClass);
    b.not(".selected").animate({top: this.paddingTop,
      opacity: 0}, "fast");
    this.$selected.animate({top: this.paddingTop}, "fast", null, function () {
      d.permitAnimate();
      d.$parent.trigger("change", d.$selected)
    });
    a.animate({height: f}, "fast")
  }, spread: function () {
    var a = this.getParent(), b = this.getItems(), f = b.length, h = this, l = this.getItemHeight(), n = 0, h = this;
    this.timer = setTimeout(function () {
      h.fold.apply(h)
    }, 1E4);
    for (a.animate({height: l * f + this.paddingTop + this.paddingBottom}, "fast"); n < f; n++)d(b[n]).animate({top: l * n + this.paddingTop, opacity: 1}, "fast", null, function () {
      --f ||
      (h.permitAnimate(), h.onAnimateEnd(), a.addClass(h.activeClass))
    })
  }, animateRunning: function () {
    return this.running
  }, prohibitAnimate: function () {
    this.$parent.addClass("animating");
    this.onAnimateStart();
    this.running = !0
  }, permitAnimate: function () {
    this.$parent.removeClass("animating");
    this.running = !1
  }, onAnimateStart: function () {
    var a = this.getItemHeight(), b = this.getParent(), f = 0, h = this.getItems(), l = 0;
    if (this.isActive())for (f += this.paddingTop; l < h.length; l++)f += this.marginTop, d(h[l]).css({top: f}), f += a + this.marginBottom;
    else h.css({top: this.paddingTop}).show();
    h.css({position: "absolute", left: this.paddingLeft, right: this.paddingRight});
    b.css({height: f || a})
  }, onAnimateEnd: function () {
    this.getItems().css(this.originItemCss);
    this.getParent().css(this.originParentCss)
  }, getParent: function () {
    return this.$parent
  }, isActive: function () {
    return this.getParent().hasClass(this.activeClass) ? !0 : !1
  }, animateOneByOne: function (a, b, f) {
    var h = arguments, l, n = this;
    b.length ? (l = d(Array.prototype.shift.apply(b)), l[a](50, function () {
      setTimeout(function () {
        n.animateOneByOne.apply(n,
          h)
      }, 50)
    })) : f.call(this)
  }, destroy: function () {
  }};
  var b = d.fn.accordion;
  d.fn.accordion = function (a) {
    return this.each(function () {
      var b = d(this), k = b.data("accordion"), h;
      if (h = "object" == typeof a)h = (h = a) || {}, h.itemSelector = h.itemSelector || b.data("item-selector") || "li", h.activeClass = h.activeClass || b.data("active-class") || "active";
      k || b.data("accordion", k = new f(b, h));
      if ("string" == typeof a)k[a]()
    })
  };
  d.fn.accordion.Constructor = f;
  d.fn.accordion.noConflict = function () {
    d.fn.accordion = b;
    return this
  };
  d(document).on("click.accordion.data-api",
    '[data-toggle="accordion"]', function (a) {
      var b = d(this);
      a = d(a.target);
      b.attr("data-toggle", "").accordion();
      a.click();
      return!1
    })
}(window.jQuery);
+function (d) {
  var a = function (a, e) {
    this.options = e;
    this.$element = d(a).on("click.dismiss.modal", '[data-dismiss="modal"]', d.proxy(this.hide, this));
    this.$backdrop = this.isShown = null;
    this.options.remote && this.$element.find(".modal-body").load(this.options.remote)
  };
  a.DEFAULTS = {backdrop: !0, keyboard: !0, show: !0};
  a.prototype.toggle = function () {
    return this[this.isShown ? "hide" : "show"]()
  };
  a.prototype.show = function () {
    var a = this, e = d.Event("show.bs.modal");
    this.$element.trigger(e);
    this.isShown || e.isDefaultPrevented() ||
    (this.isShown = !0, this.escape(), this.backdrop(function () {
      var e = d.support.transition && a.$element.hasClass("fade");
      a.$element.parent().length || a.$element.appendTo(document.body);
      a.$element.show().trigger("showing.bs.modal");
      e && a.$element[0].offsetWidth;
      a.$element.addClass("in").attr("aria-hidden", !1);
      a.enforceFocus();
      e ? a.$element.one(d.support.transition.end,function () {
        a.$element.focus().trigger("shown.bs.modal")
      }).emulateTransitionEnd(300) : a.$element.focus().trigger("shown.bs.modal")
    }))
  };
  a.prototype.hide =
    function (a) {
      a && a.preventDefault();
      a = d.Event("hide.bs.modal");
      this.$element.trigger(a);
      this.isShown && !a.isDefaultPrevented() && (this.isShown = !1, this.escape(), d(document).off("focusin.bs.modal"), this.$element.removeClass("in").attr("aria-hidden", !0), d.support.transition && this.$element.hasClass("fade") ? this.$element.one(d.support.transition.end, d.proxy(this.hideModal, this)).emulateTransitionEnd(300) : this.hideModal())
    };
  a.prototype.enforceFocus = function () {
    d(document).off("focusin.bs.modal").on("focusin.bs.modal",
      d.proxy(function (a) {
        this.$element[0] === a.target || this.$element.has(a.target).length || this.$element.focus()
      }, this))
  };
  a.prototype.escape = function () {
    if (this.isShown && this.options.keyboard)this.$element.on("keyup.dismiss.bs.modal", d.proxy(function (a) {
      27 == a.which && this.hide()
    }, this)); else this.isShown || this.$element.off("keyup.dismiss.bs.modal")
  };
  a.prototype.hideModal = function () {
    var a = this;
    this.$element.hide();
    this.backdrop(function () {
      a.removeBackdrop();
      a.$element.trigger("hidden.bs.modal")
    })
  };
  a.prototype.removeBackdrop =
    function () {
      this.$backdrop && this.$backdrop.remove();
      this.$backdrop = null
    };
  a.prototype.backdrop = function (a) {
    var e = this.$element.hasClass("fade") ? "fade" : "";
    if (this.isShown && this.options.backdrop) {
      var f = d.support.transition && e;
      this.$backdrop = d('<div class="modal-backdrop ' + e + '" />').appendTo(document.body);
      this.$element.on("click", d.proxy(function (a) {
        a.target === a.currentTarget && ("static" == this.options.backdrop ? this.$element[0].focus.call(this.$element[0]) : this.hide.call(this))
      }, this));
      f && this.$backdrop[0].offsetWidth;
      this.$backdrop.addClass("in");
      a && (f ? this.$backdrop.one(d.support.transition.end, a).emulateTransitionEnd(150) : a())
    } else!this.isShown && this.$backdrop ? (this.$backdrop.removeClass("in"), d.support.transition && this.$element.hasClass("fade") ? this.$backdrop.one(d.support.transition.end, a).emulateTransitionEnd(150) : a()) : a && a()
  };
  var f = d.fn.modal;
  d.fn.modal = function (b) {
    return this.each(function () {
      var e = d(this), f = e.data("bs.modal"), k = d.extend({}, a.DEFAULTS, e.data(), "object" == typeof b && b);
      f || e.data("bs.modal",
        f = new a(this, k));
      if ("string" == typeof b)f[b](); else k.show && f.show()
    })
  };
  d.fn.modal.Constructor = a;
  d.fn.modal.noConflict = function () {
    d.fn.modal = f;
    return this
  };
  d(document).on("click.bs.modal.data-api", '[data-toggle="modal"]', function (a) {
    var e = d(this), f = e.attr("href"), k = d(e.attr("data-target") || f && f.replace(/.*(?=#[^\s]+$)/, "")), f = k.data("modal") ? "toggle" : d.extend({remote: !/#/.test(f) && f}, k.data(), e.data());
    a.preventDefault();
    k.modal(f).one("hide", function () {
      e.is(":visible") && e.focus()
    })
  });
  d(function () {
    var a =
      d(document.body).on("show.bs.modal", ".modal",function () {
        a.addClass("modal-open")
      }).on("hide.bs.modal", ".modal", function () {
        a.removeClass("modal-open")
      })
  })
}(window.jQuery);
+function (d) {
  var a = function (a, d) {
    this.type = this.options = this.enabled = this.timeout = this.hoverState = this.$element = null;
    this.init("tooltip", a, d)
  };
  a.DEFAULTS = {animation: !0, placement: "top", selector: !1, template: '<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>', trigger: "hover focus", title: "", delay: 0, html: !1, container: !1, viewportPadding: 50};
  a.prototype.init = function (a, e, f) {
    this.enabled = !0;
    this.type = a;
    this.$element = d(e);
    this.options = this.getOptions(f);
    a = this.options.trigger.split(" ");
    for (e = a.length; e--;)if (f = a[e], "click" == f)this.$element.on("click." + this.type, this.options.selector, d.proxy(this.toggle, this)); else if ("manual" != f) {
      var k = "hover" == f ? "mouseleave" : "blur";
      this.$element.on(("hover" == f ? "mouseenter" : "focus") + "." + this.type, this.options.selector, d.proxy(this.enter, this));
      this.$element.on(k + "." + this.type, this.options.selector, d.proxy(this.leave, this))
    }
    this.options.selector ? this._options = d.extend({}, this.options, {trigger: "manual", selector: ""}) : this.fixTitle()
  };
  a.prototype.getDefaults =
    function () {
      return a.DEFAULTS
    };
  a.prototype.getOptions = function (a) {
    a = d.extend({}, this.getDefaults(), this.$element.data(), a);
    a.delay && "number" == typeof a.delay && (a.delay = {show: a.delay, hide: a.delay});
    return a
  };
  a.prototype.getDelegateOptions = function () {
    var a = {}, e = this.getDefaults();
    this._options && d.each(this._options, function (d, f) {
      e[d] != f && (a[d] = f)
    });
    return a
  };
  a.prototype.enter = function (a) {
    var e = a instanceof this.constructor ? a : d(a.currentTarget)[this.type](this.getDelegateOptions()).data("bs." + this.type);
    clearTimeout(e.timeout);
    e.hoverState = "in";
    if (!e.options.delay || !e.options.delay.show)return e.show();
    e.timeout = setTimeout(function () {
      "in" == e.hoverState && e.show()
    }, e.options.delay.show)
  };
  a.prototype.leave = function (a) {
    var e = a instanceof this.constructor ? a : d(a.currentTarget)[this.type](this.getDelegateOptions()).data("bs." + this.type);
    clearTimeout(e.timeout);
    e.hoverState = "out";
    if (!e.options.delay || !e.options.delay.hide)return e.hide();
    e.timeout = setTimeout(function () {
      "out" == e.hoverState && e.hide()
    }, e.options.delay.hide)
  };
  a.prototype.show = function () {
    var a = d.Event("show.bs." + this.type);
    if (this.hasContent() && this.enabled && (this.$element.trigger(a), !a.isDefaultPrevented())) {
      var e = this.tip();
      e.on("click", function (a) {
        a.stopPropagation()
      });
      this.setContent();
      this.options.animation && e.addClass("fade");
      var a = "function" == typeof this.options.placement ? this.options.placement.call(this, e[0], this.$element[0]) : this.options.placement, f = /\s?auto?\s?/i, k = f.test(a);
      k && (a = a.replace(f, "") || "top");
      e.detach().css({top: 0, left: 0, display: "block"}).addClass(a);
      this.options.container ? e.appendTo(this.options.container) : e.insertAfter(this.$element);
      this.$element.trigger("showing.bs." + this.type);
      var f = this.getPosition(), h = e[0].offsetWidth, l = e[0].offsetHeight, n = document.documentElement.scrollTop || document.body.scrollTop, m = "body" == this.options.container ? window.innerWidth : t.outerWidth(), s = "body" == this.options.container ? window.innerHeight : t.outerHeight(), r = "body" == this.options.container ? 0 : t.offset().left;
      if (k) {
        var t = this.$element.parent(), t = a, a = "bottom" == a && f.top +
          f.height + l - n > s ? "top" : "top" == a && 0 > f.top - n - l ? "bottom" : "right" == a && f.right + h > m ? "left" : "left" == a && f.left - h < r ? "right" : a;
        e.removeClass(t).addClass(a)
      }
      e = this.getCalculatedOffset(a, f, h, l, n, m, s, r);
      this.applyPlacement(e, a);
      this.$element.trigger("shown.bs." + this.type)
    }
  };
  a.prototype.applyPlacement = function (a, d) {
    var f, k = this.tip(), h = k[0].offsetWidth, l = k[0].offsetHeight, n = parseInt(k.css("margin-top"), 10), m = parseInt(k.css("margin-left"), 10);
    isNaN(n) && (n = 0);
    isNaN(m) && (m = 0);
    a.top += n;
    a.left += m;
    k.offset(a).addClass("in");
    n = k[0].offsetWidth;
    m = k[0].offsetHeight;
    "top" == d && m != l && (f = !0, a.top = a.top + l - m);
    /bottom|top/.test(d) ? (l = 0, 0 > a.left && (l = -2 * a.left, a.left = 0, k.offset(a), n = k[0].offsetWidth), this.replaceArrow(l - h + n, n, "left")) : this.replaceArrow(m - l, m, "top");
    f && k.offset(a)
  };
  a.prototype.replaceArrow = function (a, d, f) {
    this.arrow().css(f, a ? 50 * (1 - a / d) + "%" : "")
  };
  a.prototype.setContent = function () {
    var a = this.tip(), d = this.getTitle();
    a.find(".tooltip-inner")[this.options.html ? "html" : "text"](d);
    a.removeClass("fade in top bottom left right")
  };
  a.prototype.hide = function () {
    function a() {
      "in" != e.hoverState && f.detach()
    }

    var e = this, f = this.tip(), k = d.Event("hide.bs." + this.type);
    this.$element.trigger(k);
    if (!k.isDefaultPrevented())return f.removeClass("in"), d.support.transition && this.$tip.hasClass("fade") ? f.one(d.support.transition.end, a).emulateTransitionEnd(150) : a(), this.$element.trigger("hidden.bs." + this.type), this
  };
  a.prototype.fixTitle = function () {
    var a = this.$element;
    (a.attr("title") || "string" != typeof a.attr("data-original-title")) && a.attr("data-original-title",
      a.attr("title") || "").attr("title", "")
  };
  a.prototype.hasContent = function () {
    return this.getTitle()
  };
  a.prototype.getPosition = function () {
    var a = this.$element[0];
    return d.extend({}, "function" == typeof a.getBoundingClientRect ? a.getBoundingClientRect() : {width: a.offsetWidth, height: a.offsetHeight}, this.$element.offset())
  };
  a.prototype.getCalculatedOffset = function (a, d, f, k, h, l, n, m) {
    d = "bottom" == a ? {top: d.top + d.height, left: d.left + d.width / 2 - f / 2} : "top" == a ? {top: d.top - k, left: d.left + d.width / 2 - f / 2} : "left" == a ? {top: d.top +
      d.height / 2 - k / 2, left: d.left - f} : {top: d.top + d.height / 2 - k / 2, left: d.left + d.width};
    var s = this.options.viewportPadding;
    "right" == a || "left" == a ? d.top + k - h + s > n ? d.top = n + h - k - s : 0 > d.top - h - s && (d.top = h + s) : d.left + f + s > l ? d.left = l - f - s : d.left - s < m && (d.left = m + s);
    return d
  };
  a.prototype.getTitle = function () {
    var a = this.$element, d = this.options;
    return a.attr("data-original-title") || ("function" == typeof d.title ? d.title.call(a[0]) : d.title)
  };
  a.prototype.tip = function () {
    return this.$tip = this.$tip || d(this.options.template)
  };
  a.prototype.arrow =
    function () {
      return this.$arrow = this.$arrow || this.tip().find(".tooltip-arrow")
    };
  a.prototype.validate = function () {
    this.$element[0].parentNode || (this.hide(), this.options = this.$element = null)
  };
  a.prototype.enable = function () {
    this.enabled = !0
  };
  a.prototype.disable = function () {
    this.enabled = !1
  };
  a.prototype.toggleEnabled = function () {
    this.enabled = !this.enabled
  };
  a.prototype.toggle = function (a) {
    a = a ? d(a.currentTarget)[this.type](this.getDelegateOptions()).data("bs." + this.type) : this;
    a.tip().hasClass("in") ? a.leave(a) : a.enter(a)
  };
  a.prototype.destroy = function () {
    this.hide().$element.off("." + this.type).removeData("bs." + this.type)
  };
  var f = d.fn.tooltip;
  d.fn.tooltip = function (b) {
    return this.each(function () {
      var e = d(this), f = e.data("bs.tooltip"), k = "object" == typeof b && b;
      f || e.data("bs.tooltip", f = new a(this, k));
      if ("string" == typeof b)f[b]()
    })
  };
  d.fn.tooltip.Constructor = a;
  d.fn.tooltip.noConflict = function () {
    d.fn.tooltip = f;
    return this
  }
}(window.jQuery);
+function (d) {
  var a = function (a, d) {
    this.init("popover", a, d)
  };
  if (!d.fn.tooltip)throw Error("Popover requires tooltip.js");
  a.DEFAULTS = d.extend({}, d.fn.tooltip.Constructor.DEFAULTS, {placement: "right", trigger: "click", content: "", template: '<div class="popover"><header class="popover-header"><a class="popover-back-handler icon icon-chevron-left"></a><h3 class="popover-title">Popover Title</h3><a class="popover-close-handler icon icon-remove"></a></header><div class="popover-content"></div></div>'});
  a.prototype =
    d.extend({}, d.fn.tooltip.Constructor.prototype);
  a.prototype.constructor = a;
  a.prototype.getDefaults = function () {
    return a.DEFAULTS
  };
  a.prototype.setContent = function () {
    var a = this.tip(), d = this.getTitle(), f = this.getContent();
    a.find(".popover-title")[this.options.html ? "html" : "text"](d);
    a.find(".popover-content")[this.options.html ? "html" : "text"](f);
    a.removeClass("fade top bottom left right in");
    a.find(".popover-title").html() || a.find(".popover-title").hide()
  };
  a.prototype.hasContent = function () {
    return this.getTitle() ||
      this.getContent()
  };
  a.prototype.getContent = function () {
    var a = this.$element, d = this.options;
    return a.attr("data-content") || ("function" == typeof d.content ? d.content.call(a[0]) : d.content)
  };
  a.prototype.arrow = function () {
    return this.$arrow = this.$arrow || this.tip().find(".arrow")
  };
  a.prototype.tip = function () {
    this.$tip || (this.$tip = d(this.options.template));
    return this.$tip
  };
  var f = d.fn.popover;
  d.fn.popover = function (b) {
    return this.each(function () {
      var e = d(this), f = e.data("bs.popover"), k = "object" == typeof b && b;
      f || e.data("bs.popover",
        f = new a(this, k));
      if ("string" == typeof b)f[b]()
    })
  };
  d.fn.popover.Constructor = a;
  d.fn.popover.noConflict = function () {
    d.fn.popover = f;
    return this
  }
}(window.jQuery);
!function (d) {
  function a(a, e) {
    var f = d.proxy(this.process, this), k = d(a).is("body") ? d(window) : d(a), h;
    this.options = d.extend({}, d.fn.scrollspy.defaults, e);
    this.$scrollElement = k.on("scroll.scroll-spy.data-api", f);
    this.selector = (this.options.target || (h = d(a).attr("href")) && h.replace(/.*(?=#[^\s]+$)/, "") || "") + " .nav li > a";
    this.$body = d("body");
    this.refresh();
    this.process()
  }

  a.prototype = {constructor: a, refresh: function () {
    var a = this;
    this.offsets = d([]);
    this.targets = d([]);
    this.$body.find(this.selector).map(function () {
      var e =
        d(this), e = e.data("target") || e.attr("href"), f = /^#\w/.test(e) && d(e);
      return f && f.length && [
        [f.position().top + (!d.isWindow(a.$scrollElement.get(0)) && a.$scrollElement.scrollTop()), e]
      ] || null
    }).sort(function (a, b) {
        return a[0] - b[0]
      }).each(function () {
        a.offsets.push(this[0]);
        a.targets.push(this[1])
      })
  }, process: function () {
    var a = this.$scrollElement.scrollTop() + this.options.offset, d = (this.$scrollElement[0].scrollHeight || this.$body[0].scrollHeight) - this.$scrollElement.height(), f = this.offsets, k = this.targets, h = this.activeTarget,
      l;
    if (a >= d)return h != (l = k.last()[0]) && this.activate(l);
    for (l = f.length; l--;)h != k[l] && a >= f[l] && (!f[l + 1] || a <= f[l + 1]) && this.activate(k[l])
  }, activate: function (a) {
    this.activeTarget = a;
    d(this.selector).parent(".active").removeClass("active");
    a = d(this.selector + '[data-target="' + a + '"],' + this.selector + '[href="' + a + '"]').parent("li").addClass("active");
    a.parent(".dropdown-menu").length && (a = a.closest("li.dropdown").addClass("active"));
    a.trigger("activate")
  }};
  var f = d.fn.scrollspy;
  d.fn.scrollspy = function (b) {
    return this.each(function () {
      var e =
        d(this), f = e.data("scrollspy"), k = "object" == typeof b && b;
      f || e.data("scrollspy", f = new a(this, k));
      if ("string" == typeof b)f[b]()
    })
  };
  d.fn.scrollspy.Constructor = a;
  d.fn.scrollspy.defaults = {offset: 10};
  d.fn.scrollspy.noConflict = function () {
    d.fn.scrollspy = f;
    return this
  };
  d(window).on("load", function () {
    d('[data-spy="scroll"]').each(function () {
      var a = d(this);
      a.scrollspy(a.data())
    })
  })
}(window.jQuery);
!function (d) {
  var a = function (a) {
    this.element = d(a)
  };
  a.prototype = {constructor: a, show: function () {
    var a = this.element, e = a.closest("ul:not(.dropdown-menu)"), f = a.attr("data-target"), k, h;
    f || (f = (f = a.attr("href")) && f.replace(/.*(?=#[^\s]*$)/, ""));
    a.parent("li").hasClass("active") || (k = e.find(".active:last a")[0], h = d.Event("show", {relatedTarget: k}), a.trigger(h), h.isDefaultPrevented() || (f = d(f), this.activate(a.parent("li"), e), this.activate(f, f.parent(), function () {
      a.trigger({type: "shown", relatedTarget: k})
    })))
  }, activate: function (a, e, f) {
    function k() {
      h.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");
      a.addClass("active");
      l ? (a[0].offsetWidth, a.addClass("in")) : a.removeClass("fade");
      a.parent(".dropdown-menu") && a.closest("li.dropdown").addClass("active");
      f && f()
    }

    var h = e.find("> .active"), l = f && d.support.transition && h.hasClass("fade");
    l ? h.one(d.support.transition.end, k) : k();
    h.removeClass("in")
  }};
  var f = d.fn.tab;
  d.fn.tab = function (b) {
    return this.each(function () {
      var e = d(this), f = e.data("tab");
      f || e.data("tab",
        f = new a(this));
      if ("string" == typeof b)f[b]()
    })
  };
  d.fn.tab.Constructor = a;
  d.fn.tab.noConflict = function () {
    d.fn.tab = f;
    return this
  };
  d(document).on("click.tab.data-api", '[data-toggle="tab"], [data-toggle="pill"]', function (a) {
    a.preventDefault();
    d(this).tab("show")
  })
}(window.jQuery);
!function (d) {
  var a = function (a, e) {
    this.$element = d(a);
    this.options = d.extend({}, d.fn.typeahead.defaults, e);
    this.matcher = this.options.matcher || this.matcher;
    this.sorter = this.options.sorter || this.sorter;
    this.highlighter = this.options.highlighter || this.highlighter;
    this.updater = this.options.updater || this.updater;
    this.source = this.options.source;
    this.$menu = d(this.options.menu);
    this.shown = !1;
    this.listen()
  };
  a.prototype = {constructor: a, select: function () {
    var a = this.$menu.find(".active").attr("data-value");
    this.$element.val(this.updater(a)).change();
    return this.hide()
  }, updater: function (a) {
    return a
  }, show: function () {
    var a = d.extend({}, this.$element.position(), {height: this.$element[0].offsetHeight});
    this.$menu.insertAfter(this.$element).css({top: a.top + a.height, left: a.left}).show();
    this.shown = !0;
    return this
  }, hide: function () {
    this.$menu.hide();
    this.shown = !1;
    return this
  }, lookup: function (a) {
    this.query = this.$element.val();
    return!this.query || this.query.length < this.options.minLength ? this.shown ? this.hide() : this : (a = d.isFunction(this.source) ? this.source(this.query,
      d.proxy(this.process, this)) : this.source) ? this.process(a) : this
  }, process: function (a) {
    var e = this;
    a = d.grep(a, function (a) {
      return e.matcher(a)
    });
    a = this.sorter(a);
    return a.length ? this.render(a.slice(0, this.options.items)).show() : this.shown ? this.hide() : this
  }, matcher: function (a) {
    return~a.toLowerCase().indexOf(this.query.toLowerCase())
  }, sorter: function (a) {
    for (var d = [], f = [], k = [], h; h = a.shift();)h.toLowerCase().indexOf(this.query.toLowerCase()) ? ~h.indexOf(this.query) ? f.push(h) : k.push(h) : d.push(h);
    return d.concat(f,
      k)
  }, highlighter: function (a) {
    var d = this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&");
    return a.replace(RegExp("(" + d + ")", "ig"), function (a, b) {
      return"<strong>" + b + "</strong>"
    })
  }, render: function (a) {
    var e = this;
    a = d(a).map(function (a, b) {
      a = d(e.options.item).attr("data-value", b);
      a.find("a").html(e.highlighter(b));
      return a[0]
    });
    a.first().addClass("active");
    this.$menu.html(a);
    return this
  }, next: function (a) {
    a = this.$menu.find(".active").removeClass("active").next();
    a.length || (a = d(this.$menu.find("li")[0]));
    a.addClass("active")
  }, prev: function (a) {
    a = this.$menu.find(".active").removeClass("active").prev();
    a.length || (a = this.$menu.find("li").last());
    a.addClass("active")
  }, listen: function () {
    this.$element.on("focus", d.proxy(this.focus, this)).on("blur", d.proxy(this.blur, this)).on("keypress", d.proxy(this.keypress, this)).on("keyup", d.proxy(this.keyup, this));
    if (this.eventSupported("keydown"))this.$element.on("keydown", d.proxy(this.keydown, this));
    this.$menu.on("click", d.proxy(this.click, this)).on("mouseenter", "li",
      d.proxy(this.mouseenter, this)).on("mouseleave", "li", d.proxy(this.mouseleave, this))
  }, eventSupported: function (a) {
    var d = a in this.$element;
    d || (this.$element.setAttribute(a, "return;"), d = "function" === typeof this.$element[a]);
    return d
  }, move: function (a) {
    if (this.shown) {
      switch (a.keyCode) {
        case 9:
        case 13:
        case 27:
          a.preventDefault();
          break;
        case 38:
          a.preventDefault();
          this.prev();
          break;
        case 40:
          a.preventDefault(), this.next()
      }
      a.stopPropagation()
    }
  }, keydown: function (a) {
    this.suppressKeyPressRepeat = ~d.inArray(a.keyCode,
      [40, 38, 9, 13, 27]);
    this.move(a)
  }, keypress: function (a) {
    this.suppressKeyPressRepeat || this.move(a)
  }, keyup: function (a) {
    switch (a.keyCode) {
      case 40:
      case 38:
      case 16:
      case 17:
      case 18:
        break;
      case 9:
      case 13:
        if (!this.shown)return;
        this.select();
        break;
      case 27:
        if (!this.shown)return;
        this.hide();
        break;
      default:
        this.lookup()
    }
    a.stopPropagation();
    a.preventDefault()
  }, focus: function (a) {
    this.focused = !0
  }, blur: function (a) {
    this.focused = !1;
    !this.mousedover && this.shown && this.hide()
  }, click: function (a) {
    a.stopPropagation();
    a.preventDefault();
    this.select();
    this.$element.focus()
  }, mouseenter: function (a) {
    this.mousedover = !0;
    this.$menu.find(".active").removeClass("active");
    d(a.currentTarget).addClass("active")
  }, mouseleave: function (a) {
    this.mousedover = !1;
    !this.focused && this.shown && this.hide()
  }};
  var f = d.fn.typeahead;
  d.fn.typeahead = function (b) {
    return this.each(function () {
      var e = d(this), f = e.data("typeahead"), k = "object" == typeof b && b;
      f || e.data("typeahead", f = new a(this, k));
      if ("string" == typeof b)f[b]()
    })
  };
  d.fn.typeahead.defaults = {source: [], items: 8, menu: '<ul class="typeahead dropdown-menu"></ul>',
    item: '<li><a href="#"></a></li>', minLength: 1};
  d.fn.typeahead.Constructor = a;
  d.fn.typeahead.noConflict = function () {
    d.fn.typeahead = f;
    return this
  };
  d(document).on("focus.typeahead.data-api", '[data-provide="typeahead"]', function (a) {
    a = d(this);
    a.data("typeahead") || a.typeahead(a.data())
  })
}(window.jQuery);
!function (d) {
  var a = function (a, e) {
    this.options = d.extend({}, d.fn.affix.defaults, e);
    this.$window = d(window).on("scroll.affix.data-api", d.proxy(this.checkPosition, this)).on("click.affix.data-api", d.proxy(function () {
      setTimeout(d.proxy(this.checkPosition, this), 1)
    }, this));
    this.$element = d(a);
    this.checkPosition()
  };
  a.prototype.checkPosition = function () {
    if (this.$element.is(":visible")) {
      var a = d(document).height(), e = this.$window.scrollTop(), f = this.$element.offset(), k = this.options.offset, h = k.bottom, l = k.top;
      "object" != typeof k && (h = l = k);
      "function" == typeof l && (l = k.top());
      "function" == typeof h && (h = k.bottom());
      a = null != this.unpin && e + this.unpin <= f.top ? !1 : null != h && f.top + this.$element.height() >= a - h ? "bottom" : null != l && e <= l ? "top" : !1;
      this.affixed !== a && (this.affixed = a, this.unpin = "bottom" == a ? f.top - e : null, this.$element.removeClass("affix affix-top affix-bottom").addClass("affix" + (a ? "-" + a : "")))
    }
  };
  var f = d.fn.affix;
  d.fn.affix = function (b) {
    return this.each(function () {
      var e = d(this), f = e.data("affix"), k = "object" == typeof b && b;
      f || e.data("affix",
        f = new a(this, k));
      if ("string" == typeof b)f[b]()
    })
  };
  d.fn.affix.Constructor = a;
  d.fn.affix.defaults = {offset: 0};
  d.fn.affix.noConflict = function () {
    d.fn.affix = f;
    return this
  };
  d(window).on("load", function () {
    d('[data-spy="affix"]').each(function () {
      var a = d(this), e = a.data();
      e.offset = e.offset || {};
      e.offsetBottom && (e.offset.bottom = e.offsetBottom);
      e.offsetTop && (e.offset.top = e.offsetTop);
      a.affix(e)
    })
  })
}(window.jQuery);
(function (d) {
  function a() {
    return new Date(Date.UTC.apply(Date, arguments))
  }

  function f(a, b) {
    var e = d(a).data(), f = {}, g, h = RegExp("^" + b.toLowerCase() + "([A-Z])");
    b = RegExp("^" + b.toLowerCase());
    for (var k in e)b.test(k) && (g = k.replace(h, function (a, b) {
      return b.toLowerCase()
    }), f[g] = e[k]);
    return f
  }

  function b(a) {
    var b = {};
    if (!m[a] && (a = a.split("-")[0], !m[a]))return;
    var e = m[a];
    d.each(n, function (a, d) {
      d in e && (b[d] = e[d])
    });
    return b
  }

  var e = d(window), g = function (a, b) {
    this._process_options(b);
    this.element = d(a);
    this.isInline = !1;
    this.isInput = this.element.is("input");
    this.hasInput = (this.component = this.element.is(".date") ? this.element.find(".add-on, .btn") : !1) && this.element.find("input").length;
    this.component && 0 === this.component.length && (this.component = !1);
    this.picker = d(s.template);
    this._buildEvents();
    this._attachEvents();
    this.isInline ? this.picker.addClass("datepicker-inline").appendTo(this.element) : this.picker.addClass("datepicker-dropdown dropdown-menu");
    this.o.rtl && (this.picker.addClass("datepicker-rtl"), this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right"));
    this.viewMode = this.o.startView;
    this.o.calendarWeeks && this.picker.find("tfoot th.today").attr("colspan", function (a, b) {
      return parseInt(b, 10) + 1
    });
    this._allow_update = !1;
    this.setStartDate(this._o.startDate);
    this.setEndDate(this._o.endDate);
    this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled);
    this.fillDow();
    this.fillMonths();
    this._allow_update = !0;
    this.update();
    this.showMode();
    this.isInline && this.show()
  };
  g.prototype = {constructor: g, _process_options: function (a) {
    this._o = d.extend({}, this._o, a);
    a = this.o = d.extend({},
      this._o);
    var b = a.language;
    m[b] || (b = b.split("-")[0], m[b] || (b = l.language));
    a.language = b;
    switch (a.startView) {
      case 2:
      case "decade":
        a.startView = 2;
        break;
      case 1:
      case "year":
        a.startView = 1;
        break;
      default:
        a.startView = 0
    }
    switch (a.minViewMode) {
      case 1:
      case "months":
        a.minViewMode = 1;
        break;
      case 2:
      case "years":
        a.minViewMode = 2;
        break;
      default:
        a.minViewMode = 0
    }
    a.startView = Math.max(a.startView, a.minViewMode);
    a.weekStart %= 7;
    a.weekEnd = (a.weekStart + 6) % 7;
    b = s.parseFormat(a.format);
    -Infinity !== a.startDate && (a.startDate = a.startDate ?
      a.startDate instanceof Date ? this._local_to_utc(this._zero_time(a.startDate)) : s.parseDate(a.startDate, b, a.language) : -Infinity);
    Infinity !== a.endDate && (a.endDate = a.endDate ? a.endDate instanceof Date ? this._local_to_utc(this._zero_time(a.endDate)) : s.parseDate(a.endDate, b, a.language) : Infinity);
    a.daysOfWeekDisabled = a.daysOfWeekDisabled || [];
    d.isArray(a.daysOfWeekDisabled) || (a.daysOfWeekDisabled = a.daysOfWeekDisabled.split(/[,\s]*/));
    a.daysOfWeekDisabled = d.map(a.daysOfWeekDisabled, function (a) {
      return parseInt(a,
        10)
    });
    var b = String(a.orientation).toLowerCase().split(/\s+/g), e = a.orientation.toLowerCase(), b = d.grep(b, function (a) {
      return/^auto|left|right|top|bottom$/.test(a)
    });
    a.orientation = {x: "auto", y: "auto"};
    if (e && "auto" !== e)if (1 === b.length)switch (b[0]) {
      case "top":
      case "bottom":
        a.orientation.y = b[0];
        break;
      case "left":
      case "right":
        a.orientation.x = b[0]
    } else e = d.grep(b, function (a) {
      return/^left|right$/.test(a)
    }), a.orientation.x = e[0] || "auto", e = d.grep(b, function (a) {
      return/^top|bottom$/.test(a)
    }), a.orientation.y = e[0] ||
      "auto"
  }, _events: [], _secondaryEvents: [], _applyEvents: function (a) {
    for (var b = 0, d, e; b < a.length; b++)d = a[b][0], e = a[b][1], d.on(e)
  }, _unapplyEvents: function (a) {
    for (var b = 0, d, e; b < a.length; b++)d = a[b][0], e = a[b][1], d.off(e)
  }, _buildEvents: function () {
    this.isInput ? this._events = [
      [this.element, {focus: d.proxy(this.show, this), keyup: d.proxy(this.update, this), keydown: d.proxy(this.keydown, this)}]
    ] : this.component && this.hasInput ? this._events = [
      [this.element.find("input"), {focus: d.proxy(this.show, this), keyup: d.proxy(this.update,
        this), keydown: d.proxy(this.keydown, this)}],
      [this.component, {click: d.proxy(this.show, this)}]
    ] : this.element.is("div") ? this.isInline = !0 : this._events = [
      [this.element, {click: d.proxy(this.show, this)}]
    ];
    this._secondaryEvents = [
      [this.picker, {click: d.proxy(this.click, this)}],
      [d(window), {resize: d.proxy(this.place, this)}],
      [d(document), {"mousedown touchstart": d.proxy(function (a) {
          this.element.is(a.target) || this.element.find(a.target).length || this.picker.is(a.target) || this.picker.find(a.target).length || this.hide()
        },
        this)}]
    ]
  }, _attachEvents: function () {
    this._detachEvents();
    this._applyEvents(this._events)
  }, _detachEvents: function () {
    this._unapplyEvents(this._events)
  }, _attachSecondaryEvents: function () {
    this._detachSecondaryEvents();
    this._applyEvents(this._secondaryEvents)
  }, _detachSecondaryEvents: function () {
    this._unapplyEvents(this._secondaryEvents)
  }, _trigger: function (a, b) {
    var e = b || this.date, f = this._utc_to_local(e);
    this.element.trigger({type: a, date: f, format: d.proxy(function (a) {
      return s.formatDate(e, a || this.o.format,
        this.o.language)
    }, this)})
  }, show: function (a) {
    this.isInline || this.picker.appendTo("body");
    this.picker.show();
    this.height = this.component ? this.component.outerHeight() : this.element.outerHeight();
    this.place();
    this._attachSecondaryEvents();
    a && a.preventDefault();
    this._trigger("show")
  }, hide: function (a) {
    !this.isInline && this.picker.is(":visible") && (this.picker.hide().detach(), this._detachSecondaryEvents(), this.viewMode = this.o.startView, this.showMode(), this.o.forceParse && (this.isInput && this.element.val() || this.hasInput &&
      this.element.find("input").val()) && this.setValue(), this._trigger("hide"))
  }, remove: function () {
    this.hide();
    this._detachEvents();
    this._detachSecondaryEvents();
    this.picker.remove();
    delete this.element.data().datepicker;
    this.isInput || delete this.element.data().date
  }, _utc_to_local: function (a) {
    return new Date(a.getTime() + 6E4 * a.getTimezoneOffset())
  }, _local_to_utc: function (a) {
    return new Date(a.getTime() - 6E4 * a.getTimezoneOffset())
  }, _zero_time: function (a) {
    return new Date(a.getFullYear(), a.getMonth(), a.getDate())
  },
    _zero_utc_time: function (a) {
      return new Date(Date.UTC(a.getUTCFullYear(), a.getUTCMonth(), a.getUTCDate()))
    }, getDate: function () {
      return this._utc_to_local(this.getUTCDate())
    }, getUTCDate: function () {
      return this.date
    }, setDate: function (a) {
      this.setUTCDate(this._local_to_utc(a))
    }, setUTCDate: function (a) {
      this.date = a;
      this.setValue()
    }, setValue: function () {
      var a = this.getFormattedDate();
      this.isInput ? this.element.val(a).change() : this.component && this.element.find("input").val(a).change()
    }, getFormattedDate: function (a) {
      void 0 ===
        a && (a = this.o.format);
      return s.formatDate(this.date, a, this.o.language)
    }, setStartDate: function (a) {
      this._process_options({startDate: a});
      this.update();
      this.updateNavArrows()
    }, setEndDate: function (a) {
      this._process_options({endDate: a});
      this.update();
      this.updateNavArrows()
    }, setDaysOfWeekDisabled: function (a) {
      this._process_options({daysOfWeekDisabled: a});
      this.update();
      this.updateNavArrows()
    }, place: function () {
      if (!this.isInline) {
        var a = this.picker.outerWidth(), b = this.picker.outerHeight(), f = e.width(), g = e.height(),
          h = e.scrollTop(), k = parseInt(this.element.parents().filter(function () {
            var a = d(this).css("z-index");
            return"auto" != a && "0" != a
          }).first().css("z-index"), 10) + 100, l = this.component ? this.component.parent().offset() : this.element.offset(), m = this.component ? this.component.outerHeight(!0) : this.element.outerHeight(!1), n = this.component ? this.component.outerWidth(!0) : this.element.outerWidth(!1), s = l.left, w = l.top;
        this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left");
        "auto" !== this.o.orientation.x ? (this.picker.addClass("datepicker-orient-" + this.o.orientation.x), "right" === this.o.orientation.x && (s -= a - n)) : (this.picker.addClass("datepicker-orient-left"), 0 > l.left ? s -= l.left - 10 : l.left + a > f && (s = f - a - 10));
        a = this.o.orientation.y;
        "auto" === a && (a = -h + l.top - b, g = h + g - (l.top + m + b), a = Math.max(a, g) === g ? "top" : "bottom");
        this.picker.addClass("datepicker-orient-" + a);
        w = "top" === a ? w + m : w - (b + parseInt(this.picker.css("padding-top"), 10));
        this.picker.css({top: w, left: s, zIndex: k})
      }
    }, _allow_update: !0,
    update: function () {
      if (this._allow_update) {
        var a = new Date(this.date), b, d = !1;
        arguments && arguments.length && ("string" === typeof arguments[0] || arguments[0]instanceof Date) ? (b = arguments[0], b instanceof Date && (b = this._local_to_utc(b)), d = !0) : (b = this.isInput ? this.element.val() : this.element.data("date") || this.element.find("input").val(), delete this.element.data().date);
        this.date = s.parseDate(b, this.o.format, this.o.language);
        d ? this.setValue() : b ? a.getTime() !== this.date.getTime() && this._trigger("changeDate") : this._trigger("clearDate");
        this.date < this.o.startDate ? (this.viewDate = new Date(this.o.startDate), this.date = new Date(this.o.startDate)) : this.date > this.o.endDate ? (this.viewDate = new Date(this.o.endDate), this.date = new Date(this.o.endDate)) : (this.viewDate = new Date(this.date), this.date = new Date(this.date));
        this.fill()
      }
    }, fillDow: function () {
      var a = this.o.weekStart, b = "<tr>";
      this.o.calendarWeeks && (b += '<th class="cw">&nbsp;</th>', this.picker.find(".datepicker-days thead tr:first-child").prepend('<th class="cw">&nbsp;</th>'));
      for (; a < this.o.weekStart +
        7;)b += '<th class="dow">' + m[this.o.language].daysMin[a++ % 7] + "</th>";
      b += "</tr>";
      this.picker.find(".datepicker-days thead").append(b)
    }, fillMonths: function () {
      for (var a = "", b = 0; 12 > b;)a += '<span class="month">' + m[this.o.language].monthsShort[b++] + "</span>";
      this.picker.find(".datepicker-months td").html(a)
    }, setRange: function (a) {
      a && a.length ? this.range = d.map(a, function (a) {
        return a.valueOf()
      }) : delete this.range;
      this.fill()
    }, getClassNames: function (a) {
      var b = [], e = this.viewDate.getUTCFullYear(), f = this.viewDate.getUTCMonth(),
        g = this.date.valueOf(), h = new Date;
      a.getUTCFullYear() < e || a.getUTCFullYear() == e && a.getUTCMonth() < f ? b.push("old") : (a.getUTCFullYear() > e || a.getUTCFullYear() == e && a.getUTCMonth() > f) && b.push("new");
      this.o.todayHighlight && a.getUTCFullYear() == h.getFullYear() && a.getUTCMonth() == h.getMonth() && a.getUTCDate() == h.getDate() && b.push("today");
      a.valueOf() == g && b.push("active");
      (a.valueOf() < this.o.startDate || a.valueOf() > this.o.endDate || -1 !== d.inArray(a.getUTCDay(), this.o.daysOfWeekDisabled)) && b.push("disabled");
      this.range &&
      (a > this.range[0] && a < this.range[this.range.length - 1] && b.push("range"), -1 != d.inArray(a.valueOf(), this.range) && b.push("selected"));
      return b
    }, fill: function () {
      var b = new Date(this.viewDate), e = b.getUTCFullYear(), f = b.getUTCMonth(), b = -Infinity !== this.o.startDate ? this.o.startDate.getUTCFullYear() : -Infinity, g = -Infinity !== this.o.startDate ? this.o.startDate.getUTCMonth() : -Infinity, h = Infinity !== this.o.endDate ? this.o.endDate.getUTCFullYear() : Infinity, k = Infinity !== this.o.endDate ? this.o.endDate.getUTCMonth() : Infinity,
        l;
      this.picker.find(".datepicker-days thead th.datepicker-switch").text(m[this.o.language].months[f] + " " + e);
      this.picker.find("tfoot th.today").text(m[this.o.language].today).toggle(!1 !== this.o.todayBtn);
      this.picker.find("tfoot th.tomorrow").text(m[this.o.language].tomorrow).toggle(!1 !== this.o.tomorrowBtn);
      this.picker.find("tfoot th.someday").text(m[this.o.language].someday).toggle(!1 !== this.o.somedayBtn);
      this.updateNavArrows();
      this.fillMonths();
      var n = a(e, f, 1, 0, 0, 0, 0), A;
      A = 0 === f ? s.getDaysInMonth(e - 1,
        11) : s.getDaysInMonth(e, f - 1);
      var u = s.getDaysInMonth(e, f), u = a(e, f, u, 0, 0, 0, 0);
      0 < n.getUTCDay() && (n = a(e, f - 1, A - n.getUTCDay() + 1, 0, 0, 0, 0));
      6 > u.getUTCDay() && (u = a(e, f + 1, 6 - u.getUTCDay(), 0, 0, 0, 0));
      for (f = []; n.valueOf() <= u.valueOf();) {
        if (n.getUTCDay() == this.o.weekStart && (f.push("<tr>"), this.o.calendarWeeks)) {
          A = new Date(+n + (this.o.weekStart - n.getUTCDay() - 7) % 7 * 864E5);
          A = new Date(+A + (11 - A.getUTCDay()) % 7 * 864E5);
          var w = new Date(+(w = a(A.getUTCFullYear(), 0, 1)) + (11 - w.getUTCDay()) % 7 * 864E5);
          f.push('<td class="cw">' + ((A - w) /
            864E5 / 7 + 1) + "</td>")
        }
        A = this.getClassNames(n);
        A.push("day");
        if (this.o.beforeShowDay !== d.noop) {
          var y = this.o.beforeShowDay(this._utc_to_local(n));
          void 0 === y ? y = {} : "boolean" === typeof y ? y = {enabled: y} : "string" === typeof y && (y = {classes: y});
          !1 === y.enabled && A.push("disabled");
          y.classes && (A = A.concat(y.classes.split(/\s+/)));
          y.tooltip && (l = y.tooltip)
        }
        A = d.unique(A);
        f.push('<td class="' + A.join(" ") + '"' + (l ? ' title="' + l + '"' : "") + ">" + n.getUTCDate() + "</td>");
        n.getUTCDay() == this.o.weekEnd && f.push("</tr>");
        n.setUTCDate(n.getUTCDate() +
          1)
      }
      this.picker.find(".datepicker-days tbody").empty().append(f.join(""));
      l = this.date && this.date.getUTCFullYear();
      w = this.picker.find(".datepicker-months").find("th:eq(1)").text(e).end().find("span").removeClass("active");
      l && l == e && w.eq(this.date.getUTCMonth()).addClass("active");
      (e < b || e > h) && w.addClass("disabled");
      e == b && w.slice(0, g).addClass("disabled");
      e == h && w.slice(k + 1).addClass("disabled");
      f = "";
      e = 10 * parseInt(e / 10, 10);
      g = this.picker.find(".datepicker-years").find("th:eq(1)").text(e + "-" + (e + 9)).end().find("td");
      e -= 1;
      for (k = -1; 11 > k; k++)f += '<span class="year' + (-1 == k ? " old" : 10 == k ? " new" : "") + (l == e ? " active" : "") + (e < b || e > h ? " disabled" : "") + '">' + e + "</span>", e += 1;
      g.html(f)
    }, updateNavArrows: function () {
      if (this._allow_update) {
        var a = new Date(this.viewDate), b = a.getUTCFullYear(), a = a.getUTCMonth();
        switch (this.viewMode) {
          case 0:
            -Infinity !== this.o.startDate && b <= this.o.startDate.getUTCFullYear() && a <= this.o.startDate.getUTCMonth() ? this.picker.find(".prev").css({visibility: "hidden"}) : this.picker.find(".prev").css({visibility: "visible"});
            Infinity !== this.o.endDate && b >= this.o.endDate.getUTCFullYear() && a >= this.o.endDate.getUTCMonth() ? this.picker.find(".next").css({visibility: "hidden"}) : this.picker.find(".next").css({visibility: "visible"});
            break;
          case 1:
          case 2:
            -Infinity !== this.o.startDate && b <= this.o.startDate.getUTCFullYear() ? this.picker.find(".prev").css({visibility: "hidden"}) : this.picker.find(".prev").css({visibility: "visible"}), Infinity !== this.o.endDate && b >= this.o.endDate.getUTCFullYear() ? this.picker.find(".next").css({visibility: "hidden"}) :
              this.picker.find(".next").css({visibility: "visible"})
        }
      }
    }, click: function (b) {
      b.preventDefault();
      b.stopPropagation();
      b = d(b.target).closest("span, td, th");
      if (1 == b.length)switch (b[0].nodeName.toLowerCase()) {
        case "th":
          switch (b[0].className) {
            case "datepicker-switch":
              this.showMode(1);
              break;
            case "prev":
            case "next":
              b = s.modes[this.viewMode].navStep * ("prev" == b[0].className ? -1 : 1);
              switch (this.viewMode) {
                case 0:
                  this.viewDate = this.moveMonth(this.viewDate, b);
                  this._trigger("changeMonth", this.viewDate);
                  break;
                case 1:
                case 2:
                  this.viewDate =
                    this.moveYear(this.viewDate, b), 1 === this.viewMode && this._trigger("changeYear", this.viewDate)
              }
              this.fill();
              this.place();
              break;
            case "today":
              b = new Date;
              b = a(b.getFullYear(), b.getMonth(), b.getDate(), 0, 0, 0);
              this.showMode(-2);
              this._setDate(b, "linked" == this.o.todayBtn ? null : "view");
              break;
            case "tomorrow":
              b = new Date(Date.now() + 864E5);
              b = a(b.getFullYear(), b.getMonth(), b.getDate(), 0, 0, 0);
              this.showMode(-2);
              this._setDate(b, "date");
              break;
            case "someday":
              this.showMode(-2), this.element.trigger({type: "changeDate", date: null})
          }
          break;
        case "span":
          if (!b.is(".disabled")) {
            this.viewDate.setUTCDate(1);
            if (b.is(".month")) {
              var e = 1, f = b.parent().find("span").index(b), g = this.viewDate.getUTCFullYear();
              this.viewDate.setUTCMonth(f);
              this._trigger("changeMonth", this.viewDate);
              1 === this.o.minViewMode && this._setDate(a(g, f, e, 0, 0, 0, 0))
            } else g = parseInt(b.text(), 10) || 0, e = 1, f = 0, this.viewDate.setUTCFullYear(g), this._trigger("changeYear", this.viewDate), 2 === this.o.minViewMode && this._setDate(a(g, f, e, 0, 0, 0, 0));
            this.showMode(-1);
            this.fill()
          }
          break;
        case "td":
          b.is(".day") && !b.is(".disabled") && (e = parseInt(b.text(), 10) || 1, g = this.viewDate.getUTCFullYear(), f = this.viewDate.getUTCMonth(), b.is(".old") ? 0 === f ? (f = 11, g -= 1) : f -= 1 : b.is(".new") && (11 == f ? (f = 0, g += 1) : f += 1), this._setDate(a(g, f, e, 0, 0, 0, 0)))
      }
    }, _setDate: function (a, b) {
      b && "date" != b || (this.date = new Date(a));
      b && "view" != b || (this.viewDate = new Date(a));
      this.fill();
      this.setValue();
      this._trigger("changeDate");
      var d;
      this.isInput ? d = this.element : this.component && (d = this.element.find("input"));
      d && d.change();
      !this.o.autoclose || b && "date" !=
        b || this.hide()
    }, moveMonth: function (a, b) {
      if (!b)return a;
      var d = new Date(a.valueOf()), e = d.getUTCDate(), f = d.getUTCMonth(), g = Math.abs(b), h;
      b = 0 < b ? 1 : -1;
      if (1 == g) {
        if (g = -1 == b ? function () {
          return d.getUTCMonth() == f
        } : function () {
          return d.getUTCMonth() != h
        }, h = f + b, d.setUTCMonth(h), 0 > h || 11 < h)h = (h + 12) % 12
      } else {
        for (var k = 0; k < g; k++)d = this.moveMonth(d, b);
        h = d.getUTCMonth();
        d.setUTCDate(e);
        g = function () {
          return h != d.getUTCMonth()
        }
      }
      for (; g();)d.setUTCDate(--e), d.setUTCMonth(h);
      return d
    }, moveYear: function (a, b) {
      return this.moveMonth(a,
        12 * b)
    }, dateWithinRange: function (a) {
      return a >= this.o.startDate && a <= this.o.endDate
    }, keydown: function (a) {
      if (this.picker.is(":not(:visible)"))27 == a.keyCode && this.show(); else {
        var b = !1, d, e, f;
        switch (a.keyCode) {
          case 27:
            this.hide();
            a.preventDefault();
            break;
          case 37:
          case 39:
            if (!this.o.keyboardNavigation)break;
            d = 37 == a.keyCode ? -1 : 1;
            a.ctrlKey ? (e = this.moveYear(this.date, d), f = this.moveYear(this.viewDate, d), this._trigger("changeYear", this.viewDate)) : a.shiftKey ? (e = this.moveMonth(this.date, d), f = this.moveMonth(this.viewDate,
              d), this._trigger("changeMonth", this.viewDate)) : (e = new Date(this.date), e.setUTCDate(this.date.getUTCDate() + d), f = new Date(this.viewDate), f.setUTCDate(this.viewDate.getUTCDate() + d));
            this.dateWithinRange(e) && (this.date = e, this.viewDate = f, this.setValue(), this.update(), a.preventDefault(), b = !0);
            break;
          case 38:
          case 40:
            if (!this.o.keyboardNavigation)break;
            d = 38 == a.keyCode ? -1 : 1;
            a.ctrlKey ? (e = this.moveYear(this.date, d), f = this.moveYear(this.viewDate, d), this._trigger("changeYear", this.viewDate)) : a.shiftKey ? (e = this.moveMonth(this.date,
              d), f = this.moveMonth(this.viewDate, d), this._trigger("changeMonth", this.viewDate)) : (e = new Date(this.date), e.setUTCDate(this.date.getUTCDate() + 7 * d), f = new Date(this.viewDate), f.setUTCDate(this.viewDate.getUTCDate() + 7 * d));
            this.dateWithinRange(e) && (this.date = e, this.viewDate = f, this.setValue(), this.update(), a.preventDefault(), b = !0);
            break;
          case 13:
            this.hide();
            a.preventDefault();
            break;
          case 9:
            this.hide()
        }
        if (b) {
          this._trigger("changeDate");
          var g;
          this.isInput ? g = this.element : this.component && (g = this.element.find("input"));
          g && g.change()
        }
      }
    }, showMode: function (a) {
      a && (this.viewMode = Math.max(this.o.minViewMode, Math.min(2, this.viewMode + a)));
      this.picker.find(">div").hide().filter(".datepicker-" + s.modes[this.viewMode].clsName).css("display", "block");
      this.updateNavArrows()
    }};
  var k = function (a, b) {
    this.element = d(a);
    this.inputs = d.map(b.inputs, function (a) {
      return a.jquery ? a[0] : a
    });
    delete b.inputs;
    d(this.inputs).datepicker(b).bind("changeDate", d.proxy(this.dateUpdated, this));
    this.pickers = d.map(this.inputs, function (a) {
      return d(a).data("datepicker")
    });
    this.updateDates()
  };
  k.prototype = {updateDates: function () {
    this.dates = d.map(this.pickers, function (a) {
      return a.date
    });
    this.updateRanges()
  }, updateRanges: function () {
    var a = d.map(this.dates, function (a) {
      return a.valueOf()
    });
    d.each(this.pickers, function (b, d) {
      d.setRange(a)
    })
  }, dateUpdated: function (a) {
    var b = d(a.target).data("datepicker").getUTCDate();
    a = d.inArray(a.target, this.inputs);
    var e = this.inputs.length;
    if (-1 != a) {
      if (b < this.dates[a])for (; 0 <= a && b < this.dates[a];)this.pickers[a--].setUTCDate(b); else if (b > this.dates[a])for (; a <
                                                                                                                                     e && b > this.dates[a];)this.pickers[a++].setUTCDate(b);
      this.updateDates()
    }
  }, remove: function () {
    d.map(this.pickers, function (a) {
      a.remove()
    });
    delete this.element.data().datepicker
  }};
  var h = d.fn.datepicker;
  d.fn.datepicker = function (a) {
    var e = Array.apply(null, arguments);
    e.shift();
    var h;
    this.each(function () {
      var m = d(this), n = m.data("datepicker"), s = "object" == typeof a && a;
      if (!n) {
        var n = f(this, "date"), C = d.extend({}, l, n, s), C = b(C.language), s = d.extend({}, l, C, n, s);
        m.is(".input-daterange") || s.inputs ? (n = {inputs: s.inputs ||
          m.find("input").toArray()}, m.data("datepicker", n = new k(this, d.extend(s, n)))) : m.data("datepicker", n = new g(this, s))
      }
      if ("string" == typeof a && "function" == typeof n[a] && (h = n[a].apply(n, e), void 0 !== h))return!1
    });
    return void 0 !== h ? h : this
  };
  var l = d.fn.datepicker.defaults = {autoclose: !1, beforeShowDay: d.noop, calendarWeeks: !1, clearBtn: !1, daysOfWeekDisabled: [], endDate: Infinity, forceParse: !0, format: "mm/dd/yyyy", keyboardNavigation: !0, language: "en", minViewMode: 0, orientation: "auto", rtl: !1, startDate: -Infinity, startView: 0,
    todayBtn: !1, tomorrowBtn: !1, somedayBtn: !1, todayHighlight: !0, weekStart: 0}, n = d.fn.datepicker.locale_opts = ["format", "rtl", "weekStart"];
  d.fn.datepicker.Constructor = g;
  var m = d.fn.datepicker.dates = {en: {days: "Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "), daysShort: "Sun Mon Tue Wed Thu Fri Sat Sun".split(" "), daysMin: "Su Mo Tu We Th Fr Sa Su".split(" "), months: "January February March April May June July August September October November December".split(" "), monthsShort: "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
    today: "Today", tomorrow: "Tomorrow", someday: "Clear"}, "zh-CN": {days: "       ".split(" "), daysShort: "       ".split(" "), daysMin: "".split(""), months: "           ".split(" "), monthsShort: "           ".split(" "), today: "", tomorrow: "", someday: ""}}, s = {modes: [
    {clsName: "days", navFnc: "Month", navStep: 1},
    {clsName: "months", navFnc: "FullYear", navStep: 1},
    {clsName: "years", navFnc: "FullYear", navStep: 10}
  ], isLeapYear: function (a) {
    return 0 ===
      a % 4 && 0 !== a % 100 || 0 === a % 400
  }, getDaysInMonth: function (a, b) {
    return[31, s.isLeapYear(a) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][b]
  }, validParts: /dd?|DD?|mm?|MM?|yy(?:yy)?/g, nonpunctuation: /[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g, parseFormat: function (a) {
    var b = a.replace(this.validParts, "\x00").split("\x00");
    a = a.match(this.validParts);
    if (!b || !b.length || !a || 0 === a.length)throw Error("Invalid date format.");
    return{separators: b, parts: a}
  }, parseDate: function (b, e, f) {
    if (b instanceof Date)return b;
    "string" === typeof e &&
    (e = s.parseFormat(e));
    if (/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(b)) {
      var h = /([\-+]\d+)([dmwy])/, k = b.match(/([\-+]\d+)([dmwy])/g), l;
      b = new Date;
      for (var n = 0; n < k.length; n++)switch (e = h.exec(k[n]), l = parseInt(e[1], 10), e[2]) {
        case "d":
          b.setUTCDate(b.getUTCDate() + l);
          break;
        case "m":
          b = g.prototype.moveMonth.call(g.prototype, b, l);
          break;
        case "w":
          b.setUTCDate(b.getUTCDate() + 7 * l);
          break;
        case "y":
          b = g.prototype.moveYear.call(g.prototype, b, l)
      }
      return a(b.getUTCFullYear(), b.getUTCMonth(), b.getUTCDate(), 0, 0, 0)
    }
    k = b &&
      b.match(this.nonpunctuation) || [];
    b = new Date;
    var h = {}, z = "yyyy yy M MM m mm d dd".split(" ");
    l = {yyyy: function (a, b) {
      return a.setUTCFullYear(b)
    }, yy: function (a, b) {
      return a.setUTCFullYear(2E3 + b)
    }, m: function (a, b) {
      if (isNaN(a))return a;
      for (b -= 1; 0 > b;)b += 12;
      b %= 12;
      for (a.setUTCMonth(b); a.getUTCMonth() != b;)a.setUTCDate(a.getUTCDate() - 1);
      return a
    }, d: function (a, b) {
      return a.setUTCDate(b)
    }};
    var A;
    l.M = l.MM = l.mm = l.m;
    l.dd = l.d;
    b = a(b.getFullYear(), b.getMonth(), b.getDate(), 0, 0, 0);
    var u = e.parts.slice();
    k.length != u.length &&
    (u = d(u).filter(function (a, b) {
      return-1 !== d.inArray(b, z)
    }).toArray());
    if (k.length == u.length) {
      for (var n = 0, w = u.length; n < w; n++) {
        A = parseInt(k[n], 10);
        e = u[n];
        if (isNaN(A))switch (e) {
          case "MM":
            A = d(m[f].months).filter(function () {
              var a = this.slice(0, k[n].length), b = k[n].slice(0, a.length);
              return a == b
            });
            A = d.inArray(A[0], m[f].months) + 1;
            break;
          case "M":
            A = d(m[f].monthsShort).filter(function () {
              var a = this.slice(0, k[n].length), b = k[n].slice(0, a.length);
              return a == b
            }), A = d.inArray(A[0], m[f].monthsShort) + 1
        }
        h[e] = A
      }
      for (n = 0; n < z.length; n++)f =
        z[n], f in h && !isNaN(h[f]) && (e = new Date(b), l[f](e, h[f]), isNaN(e) || (b = e))
    }
    return b
  }, formatDate: function (a, b, e) {
    "string" === typeof b && (b = s.parseFormat(b));
    e = {d: a.getUTCDate(), D: m[e].daysShort[a.getUTCDay()], DD: m[e].days[a.getUTCDay()], m: a.getUTCMonth() + 1, M: m[e].monthsShort[a.getUTCMonth()], MM: m[e].months[a.getUTCMonth()], yy: a.getUTCFullYear().toString().substring(2), yyyy: a.getUTCFullYear()};
    e.dd = (10 > e.d ? "0" : "") + e.d;
    e.mm = (10 > e.m ? "0" : "") + e.m;
    a = [];
    for (var f = d.extend([], b.separators), g = 0, h = b.parts.length; g <=
      h; g++)f.length && a.push(f.shift()), a.push(e[b.parts[g]]);
    return a.join("")
  }, headTemplate: '<thead><tr><th class="prev"><a class="icon icon-chevron-left"></span></a><th colspan="5" class="datepicker-switch"></th><th class="next"><a class="icon icon-chevron-right"></span></a></tr></thead>', contTemplate: '<tbody><tr><td colspan="7"></td></tr></tbody>', footTemplate: '<tfoot><tr><th colspan="3" class="today"></th><th colspan="2" class="tomorrow"></th><th colspan="2" class="someday"></th></tr></tfoot>'};
  s.template =
    '<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">' + s.headTemplate + "<tbody></tbody>" + s.footTemplate + '</table></div><div class="datepicker-months"><table class="table-condensed">' + s.headTemplate + s.contTemplate + s.footTemplate + '</table></div><div class="datepicker-years"><table class="table-condensed">' + s.headTemplate + s.contTemplate + s.footTemplate + "</table></div></div>";
  d.fn.datepicker.DPGlobal = s;
  d.fn.datepicker.noConflict = function () {
    d.fn.datepicker = h;
    return this
  };
  d(document).on("focus.datepicker.data-api click.datepicker.data-api", '[data-provide="datepicker"]', function (a) {
    var b = d(this);
    b.data("datepicker") || (a.preventDefault(), b.datepicker("show"))
  });
  d(function () {
    d('[data-provide="datepicker-inline"]').datepicker()
  })
})(window.jQuery);
define("bootstrap-js", function () {
});
(function () {
  var d, a, f = {}.hasOwnProperty, b = function (a, b) {
    function d() {
      this.constructor = a
    }

    for (var h in b)f.call(b, h) && (a[h] = b[h]);
    d.prototype = b.prototype;
    a.prototype = new d;
    a.__super__ = b.prototype;
    return a
  };
  a = a || this;
  d = function () {
    function a(b) {
      var d, f, l;
      this.options = b;
      this.providers = {};
      for (l in b)f = b[l], d = a["" + l[0].toUpperCase() + l.slice(1)], null != d && (this.providers[l] = new d(f));
      window.jQuery && this.delegateEvents()
    }

    a.prototype.pageview = function () {
      var a, b, d;
      d = this.providers;
      for (a in d)b = d[a], b.pageview.apply(b,
        arguments);
      return this
    };
    a.prototype.event = function () {
      var a, b, d;
      d = this.providers;
      for (a in d)b = d[a], b.event.apply(b, arguments);
      return this
    };
    a.prototype.delegateEvents = function () {
      var a = this;
      return $(document).on("click.gta", '[data-gta="event"]', function (b) {
        var d, e, f, m;
        d = $(b.currentTarget);
        e = d.data("category") || d[0].tagName;
        f = d.data("label") || d[0].className;
        b = d.data("action") || b.type;
        m = d.data("value") || d.html();
        d = !!d.data("useMixpanel");
        return a.event(e, b, f, m, d)
      })
    };
    a.appendScript = function (a) {
      var b;
      b =
        document.createElement("script");
      a = document.createTextNode(a);
      b.appendChild(a);
      return document.getElementsByTagName("head")[0].appendChild(b)
    };
    a.Base = function () {
      return function (a) {
        this.option = a;
        this.option.account = a.account || "";
        this._initial()
      }
    }();
    a.Google = function (d) {
      function f(a) {
        f.__super__.constructor.apply(this, arguments)
      }

      b(f, d);
      f.prototype._initial = function () {
        null == window.ga && a.appendScript("(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\nm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n})(window,document,'script','//www.google-analytics.com/analytics.js','ga');\nga('create', '" +
          this.option.account + "');\nga('send', 'pageview');");
        return window.ga
      };
      f.prototype.pageview = function () {
        var a, b, d;
        a = function () {
          var a;
          a = [];
          for (b in arguments)d = arguments[b], a.push(d);
          return a
        }.apply(this, arguments);
        a = "object" === typeof a[0] ? a[0] : a.join("_");
        return"function" === typeof window.ga ? window.ga("send", "pageview", a) : void 0
      };
      f.prototype.event = function () {
        var a, b, d;
        a = function () {
          var a;
          a = [];
          for (b in arguments)d = arguments[b], a.push(d);
          return a
        }.apply(this, arguments);
        return"function" === typeof window.ga ?
          window.ga("send", "events", a) : void 0
      };
      return f
    }(a.Base);
    a.Baidu = function (d) {
      function f(a) {
        f.__super__.constructor.apply(this, arguments)
      }

      b(f, d);
      f.prototype._initial = function () {
        null == window._hmt && a.appendScript('var _hmt = _hmt || [];\n(function() {\n  var hm = document.createElement("script");\n  hm.src = "//hm.baidu.com/hm.js?' + this.option.account + '";\n  var s = document.getElementsByTagName("script")[0];\n  s.parentNode.insertBefore(hm, s);\n})();');
        return window._hmt
      };
      f.prototype.pageview = function () {
        var a,
          b, d, e, f, g;
        a = function () {
          var a;
          a = [];
          for (d in arguments)f = arguments[d], a.push(f);
          return a
        }.apply(this, arguments);
        "object" === typeof a[0] ? null != a[0].page ? b = a[0].page : (b = function () {
          var b, f;
          b = a[0];
          f = [];
          for (d in b)e = b[d], f.push(e);
          return f
        }(), b = b.join("_")) : b = a.join("_");
        return null != (g = window._hmt) ? g.push(["_trackPageview", b]) : void 0
      };
      f.prototype.event = function () {
        var a, b, d, e;
        a = function () {
          var a;
          a = [];
          for (b in arguments)d = arguments[b], a.push(d);
          return a
        }.apply(this, arguments);
        a = ["_trackEvent"].concat(a);
        return null !=
          (e = window._hmt) ? e.push(a) : void 0
      };
      return f
    }(a.Base);
    a.Mixpanel = function (d) {
      function f(a) {
        f.__super__.constructor.apply(this, arguments)
      }

      b(f, d);
      f.prototype._initial = function () {
        window.Mixpanel || a.appendScript("(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;a=e.createElement('script');a.type='text/javascript';a.async=!0;a.src=('https:'===e.location.protocol?'https:':'http:')+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';f=e.getElementsByTagName('script')[0];f.parentNode.insertBefore(a,f);b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split('.');2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;'undefined'!==\ntypeof d?c=b[d]=[]:d='mixpanel';c.people=c.people||[];c.toString=function(b){var a='mixpanel';'mixpanel'!==d&&(a+='.'+d);b||(a+=' (stub)');return a};c.people.toString=function(){return c.toString(1)+'.people (stub)'};i='disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user'.split(' ');for(g=0;g<i.length;g++)f(c,i[g]);\nb._i.push([a,e,d])};b.__SV=1.2}})(document,window.mixpanel||[]);\nmixpanel.init('" +
          this.option.account + "');");
        return window.mixpanel
      };
      f.prototype.pageview = function () {
      };
      f.prototype.event = function (a, b, d, e, f) {
        null == f && (f = !1);
        return f && mixpanel.track(d)
      };
      return f
    }(a.Base);
    return a
  }();
  a.Gta = d
}).call(this);
define("gta", function () {
});
(function (d) {
  function a(a) {
    if (a in m.style)return a;
    var b = ["Moz", "Webkit", "O", "ms"], d = a.charAt(0).toUpperCase() + a.substr(1);
    if (a in m.style)return a;
    for (a = 0; a < b.length; ++a) {
      var e = b[a] + d;
      if (e in m.style)return e
    }
  }

  function f(a) {
    "string" === typeof a && this.parse(a);
    return this
  }

  function b(a, b, d) {
    !0 === b ? a.queue(d) : b ? a.queue(b, d) : d()
  }

  function e(a) {
    var b = [];
    d.each(a, function (a) {
      a = d.camelCase(a);
      a = d.transit.propertyMap[a] || d.cssProps[a] || a;
      a = h(a);
      -1 === d.inArray(a, b) && b.push(a)
    });
    return b
  }

  function g(a, b, f, g) {
    a =
      e(a);
    d.cssEase[f] && (f = d.cssEase[f]);
    var h = "" + n(b) + " " + f;
    0 < parseInt(g, 10) && (h += " " + n(g));
    var k = [];
    d.each(a, function (a, b) {
      k.push(b + " " + h)
    });
    return k.join(", ")
  }

  function k(a, b) {
    b || (d.cssNumber[a] = !0);
    d.transit.propertyMap[a] = s.transform;
    d.cssHooks[a] = {get: function (b) {
      return d(b).css("transit:transform").get(a)
    }, set: function (b, e) {
      var f = d(b).css("transit:transform");
      f.setFromString(a, e);
      d(b).css({"transit:transform": f})
    }}
  }

  function h(a) {
    return a.replace(/([A-Z])/g, function (a) {
      return"-" + a.toLowerCase()
    })
  }

  function l(a, b) {
    return"string" !== typeof a || a.match(/^[\-0-9\.]+$/) ? "" + a + b : a
  }

  function n(a) {
    d.fx.speeds[a] && (a = d.fx.speeds[a]);
    return l(a, "ms")
  }

  d.transit = {version: "0.9.9", propertyMap: {marginLeft: "margin", marginRight: "margin", marginBottom: "margin", marginTop: "margin", paddingLeft: "padding", paddingRight: "padding", paddingBottom: "padding", paddingTop: "padding"}, enabled: !0, useTransitionEnd: !1};
  var m = document.createElement("div"), s = {}, r = -1 < navigator.userAgent.toLowerCase().indexOf("chrome");
  s.transition = a("transition");
  s.transitionDelay = a("transitionDelay");
  s.transform = a("transform");
  s.transformOrigin = a("transformOrigin");
  m.style[s.transform] = "";
  m.style[s.transform] = "rotateY(90deg)";
  s.transform3d = "" !== m.style[s.transform];
  var t = s.transitionEnd = {transition: "transitionEnd", MozTransition: "transitionend", OTransition: "oTransitionEnd", WebkitTransition: "webkitTransitionEnd", msTransition: "MSTransitionEnd"}[s.transition] || null, v;
  for (v in s)s.hasOwnProperty(v) && "undefined" === typeof d.support[v] && (d.support[v] = s[v]);
  m = null;
  d.cssEase = {_default: "ease", "in": "ease-in", out: "ease-out", "in-out": "ease-in-out", snap: "cubic-bezier(0,1,.5,1)", easeOutCubic: "cubic-bezier(.215,.61,.355,1)", easeInOutCubic: "cubic-bezier(.645,.045,.355,1)", easeInCirc: "cubic-bezier(.6,.04,.98,.335)", easeOutCirc: "cubic-bezier(.075,.82,.165,1)", easeInOutCirc: "cubic-bezier(.785,.135,.15,.86)", easeInExpo: "cubic-bezier(.95,.05,.795,.035)", easeOutExpo: "cubic-bezier(.19,1,.22,1)", easeInOutExpo: "cubic-bezier(1,0,0,1)", easeInQuad: "cubic-bezier(.55,.085,.68,.53)",
    easeOutQuad: "cubic-bezier(.25,.46,.45,.94)", easeInOutQuad: "cubic-bezier(.455,.03,.515,.955)", easeInQuart: "cubic-bezier(.895,.03,.685,.22)", easeOutQuart: "cubic-bezier(.165,.84,.44,1)", easeInOutQuart: "cubic-bezier(.77,0,.175,1)", easeInQuint: "cubic-bezier(.755,.05,.855,.06)", easeOutQuint: "cubic-bezier(.23,1,.32,1)", easeInOutQuint: "cubic-bezier(.86,0,.07,1)", easeInSine: "cubic-bezier(.47,0,.745,.715)", easeOutSine: "cubic-bezier(.39,.575,.565,1)", easeInOutSine: "cubic-bezier(.445,.05,.55,.95)", easeInBack: "cubic-bezier(.6,-.28,.735,.045)",
    easeOutBack: "cubic-bezier(.175, .885,.32,1.275)", easeInOutBack: "cubic-bezier(.68,-.55,.265,1.55)"};
  d.cssHooks["transit:transform"] = {get: function (a) {
    return d(a).data("transform") || new f
  }, set: function (a, b) {
    var e = b;
    e instanceof f || (e = new f(e));
    a.style[s.transform] = "WebkitTransform" !== s.transform || r ? e.toString() : e.toString(!0);
    d(a).data("transform", e)
  }};
  d.cssHooks.transform = {set: d.cssHooks["transit:transform"].set};
  "1.8" > d.fn.jquery && (d.cssHooks.transformOrigin = {get: function (a) {
    return a.style[s.transformOrigin]
  },
    set: function (a, b) {
      a.style[s.transformOrigin] = b
    }}, d.cssHooks.transition = {get: function (a) {
    return a.style[s.transition]
  }, set: function (a, b) {
    a.style[s.transition] = b
  }});
  k("scale");
  k("translate");
  k("rotate");
  k("rotateX");
  k("rotateY");
  k("rotate3d");
  k("perspective");
  k("skewX");
  k("skewY");
  k("x", !0);
  k("y", !0);
  f.prototype = {setFromString: function (a, b) {
    var d = "string" === typeof b ? b.split(",") : b.constructor === Array ? b : [b];
    d.unshift(a);
    f.prototype.set.apply(this, d)
  }, set: function (a) {
    var b = Array.prototype.slice.apply(arguments,
      [1]);
    this.setter[a] ? this.setter[a].apply(this, b) : this[a] = b.join(",")
  }, get: function (a) {
    return this.getter[a] ? this.getter[a].apply(this) : this[a] || 0
  }, setter: {rotate: function (a) {
    this.rotate = l(a, "deg")
  }, rotateX: function (a) {
    this.rotateX = l(a, "deg")
  }, rotateY: function (a) {
    this.rotateY = l(a, "deg")
  }, scale: function (a, b) {
    void 0 === b && (b = a);
    this.scale = a + "," + b
  }, skewX: function (a) {
    this.skewX = l(a, "deg")
  }, skewY: function (a) {
    this.skewY = l(a, "deg")
  }, perspective: function (a) {
    this.perspective = l(a, "px")
  }, x: function (a) {
    this.set("translate",
      a, null)
  }, y: function (a) {
    this.set("translate", null, a)
  }, translate: function (a, b) {
    void 0 === this._translateX && (this._translateX = 0);
    void 0 === this._translateY && (this._translateY = 0);
    null !== a && void 0 !== a && (this._translateX = l(a, "px"));
    null !== b && void 0 !== b && (this._translateY = l(b, "px"));
    this.translate = this._translateX + "," + this._translateY
  }}, getter: {x: function () {
    return this._translateX || 0
  }, y: function () {
    return this._translateY || 0
  }, scale: function () {
    var a = (this.scale || "1,1").split(",");
    a[0] && (a[0] = parseFloat(a[0]));
    a[1] && (a[1] = parseFloat(a[1]));
    return a[0] === a[1] ? a[0] : a
  }, rotate3d: function () {
    for (var a = (this.rotate3d || "0,0,0,0deg").split(","), b = 0; 3 >= b; ++b)a[b] && (a[b] = parseFloat(a[b]));
    a[3] && (a[3] = l(a[3], "deg"));
    return a
  }}, parse: function (a) {
    var b = this;
    a.replace(/([a-zA-Z0-9]+)\((.*?)\)/g, function (a, d, e) {
      b.setFromString(d, e)
    })
  }, toString: function (a) {
    var b = [], d;
    for (d in this)this.hasOwnProperty(d) && (s.transform3d || "rotateX" !== d && "rotateY" !== d && "perspective" !== d && "transformOrigin" !== d) && "_" !== d[0] && (a && "scale" === d ?
      b.push(d + "3d(" + this[d] + ",1)") : a && "translate" === d ? b.push(d + "3d(" + this[d] + ",0)") : b.push(d + "(" + this[d] + ")"));
    return b.join(" ")
  }};
  d.fn.transition = d.fn.transit = function (a, e, f, h) {
    var k = this, l = 0, m = !0;
    "function" === typeof e && (h = e, e = void 0);
    "function" === typeof f && (h = f, f = void 0);
    "undefined" !== typeof a.easing && (f = a.easing, delete a.easing);
    "undefined" !== typeof a.duration && (e = a.duration, delete a.duration);
    "undefined" !== typeof a.complete && (h = a.complete, delete a.complete);
    "undefined" !== typeof a.queue && (m = a.queue,
      delete a.queue);
    "undefined" !== typeof a.delay && (l = a.delay, delete a.delay);
    "undefined" === typeof e && (e = d.fx.speeds._default);
    "undefined" === typeof f && (f = d.cssEase._default);
    e = n(e);
    var r = g(a, e, f, l), v = d.transit.enabled && s.transition ? parseInt(e, 10) + parseInt(l, 10) : 0;
    if (0 === v)return b(k, m, function (b) {
      k.css(a);
      h && h.apply(k);
      b && b()
    }), k;
    var J = {}, F = function (b) {
      var e = !1, f = function () {
        e && k.unbind(t, f);
        0 < v && k.each(function () {
          this.style[s.transition] = J[this] || null
        });
        "function" === typeof h && h.apply(k);
        "function" === typeof b &&
        b()
      };
      0 < v && t && d.transit.useTransitionEnd ? (e = !0, k.bind(t, f)) : window.setTimeout(f, v);
      k.each(function () {
        0 < v && (this.style[s.transition] = r);
        d(this).css(a)
      })
    };
    b(k, m, function (a) {
      var b = 0;
      "MozTransition" === s.transition && 25 > b && (b = 25);
      window.setTimeout(function () {
        F(a)
      }, b)
    });
    return this
  };
  d.transit.getTransitionValue = g
})(jQuery);
define("jquery.transit", function () {
});
(function (d) {
  "function" === typeof define && define.amd ? define("jquery.mousewheel", ["jquery"], d) : "object" === typeof exports ? module.exports = d : d(jQuery)
})(function (d) {
  function a(a) {
    var b = a || window.event, e = g.call(arguments, 1), l = 0, v = 0, p = 0, x = 0;
    a = d.event.fix(b);
    a.type = "mousewheel";
    "detail"in b && (p = -1 * b.detail);
    "wheelDelta"in b && (p = b.wheelDelta);
    "wheelDeltaY"in b && (p = b.wheelDeltaY);
    "wheelDeltaX"in b && (v = -1 * b.wheelDeltaX);
    "axis"in b && b.axis === b.HORIZONTAL_AXIS && (v = -1 * p, p = 0);
    l = 0 === p ? v : p;
    "deltaY"in b && (l = p = -1 * b.deltaY);
    "deltaX"in b && (v = b.deltaX, 0 === p && (l = -1 * v));
    if (0 !== p || 0 !== v) {
      1 === b.deltaMode ? (x = d.data(this, "mousewheel-line-height"), l *= x, p *= x, v *= x) : 2 === b.deltaMode && (x = d.data(this, "mousewheel-page-height"), l *= x, p *= x, v *= x);
      x = Math.max(Math.abs(p), Math.abs(v));
      if (!h || x < h)h = x, n.settings.adjustOldDeltas && "mousewheel" === b.type && 0 === x % 120 && (h /= 40);
      n.settings.adjustOldDeltas && "mousewheel" === b.type && 0 === x % 120 && (l /= 40, v /= 40, p /= 40);
      l = Math[1 <= l ? "floor" : "ceil"](l / h);
      v = Math[1 <= v ? "floor" : "ceil"](v / h);
      p = Math[1 <= p ? "floor" : "ceil"](p /
        h);
      a.deltaX = v;
      a.deltaY = p;
      a.deltaFactor = h;
      a.deltaMode = 0;
      e.unshift(a, l, v, p);
      k && clearTimeout(k);
      k = setTimeout(f, 200);
      return(d.event.dispatch || d.event.handle).apply(this, e)
    }
  }

  function f() {
    h = null
  }

  var b = ["wheel", "mousewheel", "DOMMouseScroll", "MozMousePixelScroll"], e = "onwheel"in document || 9 <= document.documentMode ? ["wheel"] : ["mousewheel", "DomMouseScroll", "MozMousePixelScroll"], g = Array.prototype.slice, k, h;
  if (d.event.fixHooks)for (var l = b.length; l;)d.event.fixHooks[b[--l]] = d.event.mouseHooks;
  var n = d.event.special.mousewheel =
  {version: "3.1.9", setup: function () {
    if (this.addEventListener)for (var b = e.length; b;)this.addEventListener(e[--b], a, !1); else this.onmousewheel = a;
    d.data(this, "mousewheel-line-height", n.getLineHeight(this));
    d.data(this, "mousewheel-page-height", n.getPageHeight(this))
  }, teardown: function () {
    if (this.removeEventListener)for (var b = e.length; b;)this.removeEventListener(e[--b], a, !1); else this.onmousewheel = null
  }, getLineHeight: function (a) {
    return parseInt(d(a)["offsetParent"in d.fn ? "offsetParent" : "parent"]().css("fontSize"),
      10)
  }, getPageHeight: function (a) {
    return d(a).height()
  }, settings: {adjustOldDeltas: !0}};
  d.fn.extend({mousewheel: function (a) {
    return a ? this.bind("mousewheel", a) : this.trigger("mousewheel")
  }, unmousewheel: function (a) {
    return this.unbind("mousewheel", a)
  }})
});
(function (d) {
  var a = d.parse, f = d.get, b = d.set;
  d.parse = function (b) {
    b && 0 === b.indexOf("exp@") && (b = b.substring(b.indexOf(";") + 1));
    return a(b)
  };
  d.expires = function (a) {
    return a && 0 === a.indexOf("exp@") ? parseInt(a.substring(4, a.indexOf(";")), 10) : !1
  };
  d.when = function (a) {
    var b = Math.floor((new Date).getTime() / 6E4);
    return a ? new Date(6E4 * (b + a)) : b
  };
  d.cache = function (a, b) {
    var k = f(a, b), h = d.expires(k);
    return h && d.when() >= h ? a.removeItem(b) : k
  };
  d.get = function (a, b) {
    var f = d.cache(a, b);
    return void 0 === f ? null : f
  };
  d.set = function (a, f, k, h) {
    try {
      h && (k = "exp@" + (d.when() + h) + ";" + k), b(a, f, k)
    } catch (l) {
      if ("QUOTA_EXCEEDED_ERR" === l.name || "NS_ERROR_DOM_QUOTA_REACHED" === l.name) {
        for (var n = !1, m = 0, s = a.length; m < s; m++)void 0 === d.cache(a, f) && (n = !0);
        if (n)return d.set.apply(this, arguments)
      }
      throw l;
    }
  }
})(window.store._, void 0);
define("storeCache", function () {
});
(function () {
  require.config({paths: {jquery: "../../bower_components/jquery/jquery", jqueryui: "../../bower_components/jquery-ui-amd/jquery-ui-1.10.0/jqueryui", "jquery.cookie": "../../bower_components/jquery.cookie/jquery.cookie", "jquery.transit": "../../bower_components/jquery.transit/jquery.transit", "bootstrap-js": "../../bower_components/UI/docs/assets/js/bootstrap", underscore: "../../bower_components/underscore/underscore", backbone: "../../bower_components/backbone/backbone", "jquery.mousewheel": "../../bower_components/jquery-mousewheel/jquery.mousewheel",
    flexText: "../../bower_components/tb.flexText/tb.flexText", mousetrap: "../../bower_components/mousetrap/mousetrap", markdown: "../../bower_components/tb.marked/lib/tb.marked", essage: "../../bower_components/tb.essage/src/essage", thenjs: "../../bower_components/thenjs/then", pdf: "../../bower_components/PDFObject/pdfobject", gta: "../../bower_components/gta/lib/index", moment: "../../bower_components/momentjs/moment", webuploader: "../../bower_components/webuploader/dist/webuploader.html5only", wysihtml5: "../../bower_components/wysihtml5/dist/wysihtml5x",
    wysihtml5_rules: "../../bower_components/wysihtml5/parser_rules/advanced_unwrap", store: "../../bower_components/tb.store/dist/store2", storeCache: "../../bower_components/tb.store/src/store.cache", md5: "../../bower_components/blueimp-md5/js/md5", favico: "../../bower_components/favico.js/favico", highlight: "../../bower_components/highlightjs/highlight.tb", model: "../../lib/model", collection: "../../lib/collection", warehouse: "../../lib/warehouse", hotkey: "../../lib/hotkey", util: "../../lib/util", view: "../../lib/view",
    "panel-view": "../../lib/panel/index", "popover-view": "../../lib/popover/index", "dropdown-view": "../../lib/dropdown/index", views: "../../components/views", models: "../../components/models", collections: "../../components/collections", lib: "../../lib"}, shim: {store: {exports: "store"}, storeCache: ["store"], wysihtml5_rules: {exports: "wysihtml5ParserRules"}, wysihtml5: {exports: "wysihtml5"}, "bootstrap-js": ["jquery"], "jquery.cookie": ["jquery"], "jquery.transit": ["jquery"], "jquery.mousewheel": ["jquery"], flexText: ["jquery"],
    webuploader: {deps: ["jquery"], exports: "WebUploader"}}});
  require("jquery underscore backbone favico warehouse util markdown router lib/hint/index app model models/user models/preference collections/projects collections/organizations collections/apps bootstrap-js pdf gta jquery.transit jquery.mousewheel essage storeCache".split(" "), function (d, a, f, b, e, g, k, h, l, n, m, s, r, t, v, p) {
    var x;
    g.initialize();
    l.initialize();
    k.setOptions({breaks: !0, keepBreaks: !0, sanitize: !0, smartLists: !0});
    m.prototype.hasRight = function () {
      var a,
        b;
      return 0 === (a = this.get("hasRight")) || 1 === a || 2 === a ? this.get("hasRight") : (a = this.get("_projectId")) ? (a = e.get(t, null, a), 0 === (b = "function" === typeof a.get ? a.get("hasRight") : void 0) || 1 === b || 2 === b ? a.get("hasRight") : 0) : 0
    };
    teambition.gta = new Gta({Google: {account: "UA-33186961-1"}, Baidu: {account: "ec912ecc405ccd050e4cdf452ef4e85a"}, Mixpanel: {account: "a0378064615fc4a8c3dc1bca7a821e4c"}});
    try {
      teambition.favico = new b({animation: "popFade"})
    } catch (B) {
    }
    x = function () {
      var a;
      if (teambition.loadingStart) {
        a = ((new Date).getTime() -
          teambition.loadingStart) / 1E3;
        try {
          return teambition.gta.event("teambition", "view", "teambition|enter teambition"), mixpanel.track("teambition|enter teambition", {loadTime: a})
        } catch (b) {
        }
      }
    };
    return e.connect(teambition.apiHost, {onConnect: function (b) {
      b = e.socket;
      b.emit("read:application");
      return b.once("read:application", function (b) {
        var f;
        try {
          f = b.user, mixpanel.identify(f._id), mixpanel.people.set({badge: f.badge, created: new Date(f.created), latestActived: new Date(f.latestActived), name: f.name})
        } catch (g) {
        }
        a.extend(teambition.user,
          e.one(s, b.user));
        a.extend(teambition.PREFERENCE, e.one(r, b.preference));
        e.set(t, null, b.projects).listen();
        e.set(v, null, b.organizations).listen();
        e.request(p, null, {success: function () {
        }});
        a.extend(teambition.APP, new n);
        a.extend(teambition.router, new h).start();
        d("#bodyloadinglayer").addClass("fading");
        setTimeout(function () {
          return d("#bodyloadinglayer").remove()
        }, 218);
        return x()
      })
    }, onReconnect: function (a) {
      a = e.socket;
      a.emit("read:application");
      return a.once("read:application", function (a) {
        teambition.user.set(a.user);
        teambition.PREFERENCE.set(a.preference);
        e.set(t, null, a.projects);
        return e.set(v, null, a.organizations)
      })
    }, onDisconnect: function () {
    }, onError: function (a) {
    }})
  })
}).call(this);
define("main", function () {
});
